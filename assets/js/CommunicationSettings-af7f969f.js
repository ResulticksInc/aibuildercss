var e,t,a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b=Object.defineProperty,x=(e,t,a)=>(((e,t,a)=>{t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a})(e,"symbol"!=typeof t?t+"":t,a),a);import{j as y}from"./pdf-editor-8270ab34.js";import{w as S,r as w,i as T,R as k,p as D,d as C,e as E,L as N,u as A,k as I,S as j,j as _}from"./react-vendor-379f659a.js";import{q as O,h as L,c as F,b as M}from"./utils-16c7e021.js";import{S as R,n as P,v as U,b5 as B,b6 as G,b7 as V,b8 as W,ai as H,al as z,ao as Y,b9 as K,ba as q,bb as J,M as X,p as Z,e as Q,f as ee}from"./kendo-5d73125a.js";import{R as te,d as ae,c as se,L as re}from"./RSKendoDropdown-01650470.js";import{R as ie,a as ne}from"./RSCheckbox-2fef59cb.js";import"./style-a86a43a5.js";import{z as le,av as oe,M as ce,CK as de,a8 as ue,B as he,E as fe,aK as me,F as pe,CL as ve,CM as ge,CN as be,CO as xe,BR as ye,CP as Se,CQ as we,CR as Te,ar as ke,CS as De,X as Ce,a0 as Ee,aa as Ne,aS as Ae,CT as Ie,dm as je,az as _e,aj as Oe,CU as Le,CV as Fe,CW as Me,dj as Re,by as Pe,U as Ue,ai as Be,al as Ge,CX as Ve,CY as We,ax as He,qx as ze,dk as Ye,Cs as Ke,Cu as $e,CZ as qe,bg as Je,ep as Xe,aB as Ze,aC as Qe,C_ as et,C$ as tt,aJ as at,D0 as st,D1 as rt,D2 as it,Y as nt,D3 as lt,b1 as ot,D4 as ct,D5 as dt,D6 as ut,BP as ht,dN as ft,D7 as mt,D8 as pt,dh as vt,D9 as gt,Da as bt,Db as xt,Dc as yt,Dd as St,BQ as wt,be as Tt,De as kt,Df as Dt,ad as Ct,ap as Et,Dg as Nt,Dh as At,Di as It,Dj as jt,Dk as _t,Dl as Ot,c$ as Lt,BD as Ft,dd as Mt,BE as Rt,nr as Pt,Dm as Ut,BB as Bt,Dn as Gt,Do as Vt,dp as Wt,dq as Ht,b2 as zt,Dp as Yt,Dq as Kt,Dr as $t,Ds as qt,aY as Jt,Dt as Xt,aZ as Zt,Du as Qt,Dv as ea,Dw as ta,Dx as aa,Dy as sa,d3 as ra,q4 as ia,da as na,ck as la,Dz as oa,DA as ca,DB as da,DC as ua,DD as ha}from"./index-74701706.js";import{R as fa}from"./RSDropdowns-57ad4a66.js";import{U as ma}from"./UploadComponent-2445331b.js";import{s as pa,i as va}from"./inputLimit-ce03b0f6.js";import{R as ga}from"./RSFormGroup-183a553e.js";import{F as ba}from"./FormLabel-e5a81960.js";import{F as xa}from"./FormLabelIcon-9263d80b.js";import{F as ya}from"./FormListWrapper-7a45a553.js";import{S as Sa}from"./SmallText-221f66eb.js";import{C as wa,R as Ta,a as ka,M as Da,A as Ca,c as Ea}from"./ui-e848d714.js";import{L as Na}from"./LayoutPageWrapper-4f1f1143.js";import{B as Aa}from"./BootstrapDropdown-6b9714b5.js";import"./constants-82903eb8.js";import{S as Ia}from"./SkeletonTable-8cb486e7.js";import{RSErrorPopup as ja,RSConfirmAlert as _a}from"./RSConfirmAlert-deac68bb.js";import{K as Oa}from"./index-21f205f2.js";import{R as La}from"./RSSwitch-89e88c7d.js";import{C as Fa}from"./Common-717c9de1.js";import"./Documentation-a383a2c5.js";import{R as Ma}from"./RSIcon-70da13ba.js";import{C as Ra,M as Pa}from"./index-11ed5abc.js";import{R as Ua}from"./RTabbar-ca75b8a9.js";import{C as Ba}from"./CustomEvent_FieldTracking-7aae932c.js";import{v as Ga,m as Va,s as Wa,a as Ha,c as za,w as Ya}from"./BOFController-f105b6f3.js";import{F as Ka}from"./FormFieldIcon-f423e4de.js";import{R as $a}from"./RSDatePicker-8e013858.js";import{b as qa}from"./mobx-e1586d6a.js";import"./BOFPlatform-e2b98fd3.js";import"./BOFWeb-b4ab890b.js";import{f as Ja,c as Xa,s as Za,S as Qa,i as es}from"./FieldTracking-ab36cd8c.js";import{W as ts,s as as}from"./rsp-email-library.es-77a5f5b4.js";import"./charts-f2096496.js";import{S as ss}from"./constantObject-ca27cf51.js";import rs from"./TabsData-b0dee1f3.js";import{N as is}from"./NewAttribute-c61ac18c.js";import ns from"./RSBanner-1c9733b9.js";import{i as ls}from"./Skeleton-fd850846.js";import{C as os}from"./CompanyListDropdown-7d8b4e2c.js";import{r as cs}from"./react-router-dom.min-6f8d67fa.js";import ds from"./ChannalBenchMark-ca933107.js";import"./get-4aa85b1a.js";import"./drag-drop-a86b0275.js";import"./Features.styled-8e9cb0d0.js";import"./index-0fabed00.js";import"./RSMultiIcon-bcfdb955.js";window.ganalytics=[];let us=0;const hs=S((e=>{const t=w.useContext(le),[a,s]=w.useState(null),[r,i]=w.useState(""),[n,l]=w.useState(!1),[o,c]=w.useState(null),[d,u]=w.useState("https://"),[h,f]=w.useState(!1),[m,p]=w.useState(null),[v,g]=w.useState("Upload your logo"),[b,x]=w.useState(""),[S,k]=w.useState("fcmv1http"),[D,C]=w.useState(""),[E,N]=w.useState(""),[A,I]=w.useState(""),[j,_]=w.useState(""),[F,M]=w.useState([]),[P,U]=w.useState(""),[B,G]=w.useState(""),[V,W]=w.useState(""),[H,z]=w.useState(""),[Y,K]=w.useState(""),[$,q]=w.useState(""),[J,X]=w.useState(""),[Z,Q]=w.useState(""),[ee,se]=w.useState(!1),re=T(),[ne,ke]=w.useState(null),[De,Ce]=w.useState(null),[Ee,Ne]=w.useState(null);w.useState(null);const[Ae,Ie]=w.useState(null),[je,_e]=w.useState(null),[Oe,Le]=w.useState([{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]),[Fe,Me]=w.useState(""),[Re,Pe]=w.useState(""),[Ue,Be]=w.useState(""),[Ge,Ve]=w.useState(""),[We,He]=w.useState(""),[ze,Ye]=w.useState(""),[Ke,$e]=w.useState(null),[qe,Je]=w.useState(null),[Xe,Ze]=w.useState([]),[Qe,et]=w.useState(0),[tt,at]=w.useState(""),[st,rt]=w.useState(null);window.addEventListener("cwbackbtnclicked",(function(t){var a,s,r,i,n,l,o,c,d;if(0===us){if(us+=1,oe("Domain OnBoarding Props",re.location.state),!0===(null==(s=null==(a=null==re?void 0:re.location)?void 0:a.state)?void 0:s.isCampaign)){let e=`cId=${null==(i=null==(r=null==re?void 0:re.location)?void 0:r.state)?void 0:i.campaignId}`,t=null==(o=null==(l=null==(n=null==window?void 0:window.location)?void 0:n.search)?void 0:l.slice(1))?void 0:o.replace(e,"");re.push({pathname:"/campaign/creation-notification",search:`cId=${null==(d=null==(c=null==re?void 0:re.location)?void 0:c.state)?void 0:d.campaignId}&${t}`})}else e.cb(0);setTimeout((()=>{us=0}),2e3)}})),w.useEffect((()=>{oe("onboardingId new",e.onboardingId),window.scroll(0,0);let t=O.parse(window.location.search);(null==t?void 0:t.wa)&&(null==t?void 0:t.webGuid)?it(null==t?void 0:t.webGuid,null==t?void 0:t.wa):e.webGuid&&e.onboardingId&&it(e.webGuid,e.onboardingId)}),[]);const it=(e,a)=>{ce({path:de,params:{WebGuid:e,OnboardingId:a},loading:t.globalStateData.setIsLoadingData,ok:e=>{var t,a,r,n,l,o,c,d,h,f,m,p,v,b,y;if(e.status&&e.data){i(e.data.domainName),u(e.data.domainURL),g(e.data.domainLogo);let S="logo.png",w=e.data.domainLogo.split("/");w.length>0&&(S=w[w.length-1]),x(S),k(""===(null==(t=e.data)?void 0:t.notificationProvider)||"G"===(null==(a=e.data)?void 0:a.notificationProvider)?"Google":ue(e.data.notificationProvider.toLowerCase())),C(null==(r=null==e?void 0:e.data)?void 0:r.fcmServiceFileName),N(null==(n=null==e?void 0:e.data)?void 0:n.fcmServiceFileContent),I(e.data.fcmSenderId),_(e.data.fcmServerKey),at((null==(l=null==e?void 0:e.data)?void 0:l.appIdendifier)||""),U((null==(o=null==e?void 0:e.data)?void 0:o.apiKey)||""),X((null==(c=null==e?void 0:e.data)?void 0:c.appID)||""),G((null==(d=null==e?void 0:e.data)?void 0:d.authDomain)||""),W((null==(h=null==e?void 0:e.data)?void 0:h.databaseUrl)||""),z((null==(f=null==e?void 0:e.data)?void 0:f.projectID)||""),K((null==(m=null==e?void 0:e.data)?void 0:m.storageBucket)||""),q((null==(p=null==e?void 0:e.data)?void 0:p.measurementId)||""),et((null==(v=null==e?void 0:e.data)?void 0:v.webfirebaseconfigID)||0),se(null==(b=null==e?void 0:e.data)?void 0:b.isV1),Q((null==(y=null==e?void 0:e.data)?void 0:y.vapidKey)||""),e.data.webanalyticsetting.length>0&&e.data.webanalyticsetting.map(((e,t)=>{Oe[t].serviceAccountEmail=e.serviceAccountEmail,Oe[t].appKey=e.appKey,Oe[t].appSecretId=e.appSecretId,Oe[t].analyticsName=ps.filter((t=>t.id===e.analyticsId))[0].name,Oe[t].analyticsId=e.analyticsId})),M(e.data.webanalyticsetting),s(e.data.webanalyticsetting.length>0)}},fail:e=>{}})},nt=b.length>0?"":"No file chosen",lt=e=>{let t=!1,a=e.length>0?null:"Enter domain name";return""===e?(a="Enter domain name",t=!0,[t,a]):/^[' 'A-Za-z0-9_-]*$/.test(e)?(a=e.length>0?null:"Enter domain name",t=!(e.length>0),[t,a]):(a="Special characters are not allowed",e=e.substring(0,e.length-1),[t,a])};return y.jsxs(wa,{children:[y.jsxs("div",{className:"box-design rs-box-min-height p30 ",children:[y.jsx("div",{className:"marginT10",children:y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:3,children:y.jsx("h4",{className:"font-regular",children:"Domain onboarding"})})})})}),y.jsxs("div",{className:"",children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Domain name"})}),y.jsx(ka,{md:9,children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsx(ie,{name:"Domain name",placeholder:"Domain name",isLoading:n,iconPlaceholder:!0,iconName:null!==o?!0===o?"icon-rs-circle-tick-medium icons-md green":"icon-rs-circle-close-edge-mini icons-md red":"",required:!0,val:r,max:pa,handleOnchange:e=>{if(e.length<=100){let t=e.trimStart();if(t.includes("'"))return;if(!0===/^[' 'A-Za-z0-9_-]*$/.test(t)){let e=t.replace(/\s+/g," ");if(e.length>100)return void ke("Domain name exceeded the limit");let[a,s]=lt(e);return c(null),ke(s),void i(e)}}},handleOnBlur:e=>{let t=e.trim(),[a,s]=lt(t);ke(s),i(t),!1===a&&null===s&&t.length>0&&(e=>{let t={isApp:!1,appName:e};l(!0),ce({path:Se,params:t,ok:e=>{l(!1),!1===e.status?(ke("Domain name already exists"),c(!1)):(ke(null),c(!0))},fail:e=>{ke(null==e?void 0:e.message),c(!1)}})})(t)},errorMessage:ne})})})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Domain URL"})}),y.jsx(ka,{md:9,children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsx(ie,{disabled:"edit"==e.mode,type:"text",isLoading:h,iconPlaceholder:!0,iconName:null!==m?!0===m?"icon-rs-circle-tick-medium icons-md green":"icon-rs-circle-close-edge-mini icons-md red":"",required:!0,name:"domainUrl",placeholder:"Domain URL",val:d,max:va,handleOnBlur:e=>{if(e.length>0){let a=0===e.length?"Enter domain URL":/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w.-]*)*\/?$/i.test(e)?null:"Enter valid domain URL";Ce(a),null===a&&(e=>{let a={domainURL:e};f(!0),ce({path:ye,params:a,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{f(!1),e.status?(Ce(e.message),p(!1)):p(!0)},fail:e=>{f(!0),Ce("SDK domain already exists"),p(!1)}})})(e)}},handleOnchange:e=>{(e=>{let t=e.trim();t.length>=7&&(d.startsWith("https://")?"https://"===t.slice(0,8)&&(u(t),p(null)):u("https://"))})(e)},errorMessage:De})})})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"User identifier"})}),y.jsx(ka,{md:9,children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsx(te,{required:!0,label:"User identifier",data:["Email id","Mobile number","Brand id (brand defined unique id)"],errorMessage:st,value:""!==tt?tt:"-- Select user identifier id --",placeholder:""!==tt?tt:"-- Select user identifier id --",onChange:e=>{let t=e.target.value.length>0?null:"Select user identifier id";at(e.target.value),rt(t)}})})})})]})}),y.jsxs(ga,{children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Upload logo"})}),y.jsx(ka,{md:9,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{disabled:!0,placeholder:"Upload logo",type:"text",required:!0,name:"uploadLogo",val:b.length?b:v,handleOnchange:e=>{let t=e.length>0?null:"Upload logo";Ne(t),g(e)},errorMessage:Ee})}),y.jsx(ka,{md:1,children:y.jsx(ma,{tooltip:nt,type:"web",error:e=>{Ne(e)},onChange:e=>{let t=e[0].length>0?null:"Upload logo";e[0].includes(".png")||e[0].includes(".jpg")||e[0].includes(".jpeg")?(Ne(t),x(e[0]),g(e[1])):Ne("Logo only support image")}})})]})})]}),y.jsx(Ta,{children:y.jsx(ka,{md:{span:4,offset:3},children:y.jsx(xa,{children:y.jsx(Sa,{className:"mt-12",children:"Upload 145x145 px logo in JPEG or PNG format"})})})})]}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Notification provider"})}),y.jsx(ka,{md:9,children:y.jsx(ya,{label:"Providers",children:y.jsx("li",{children:y.jsx(ae,{lbl:"FCM project details",name:"FCM project details",labelId:"FCM project details",checked:"fcmv1http"===S.toLowerCase(),cb:e=>{k("FCMV1HTTP"),se(!0)}})})})})]})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{name:"fcmv1",placeholder:"Upload service account JSON file",required:!0,val:D,cb:e=>{let t=e.length>0?null:"Upload service account JSON file";C(e),_e(t)},errorMessage:je&&je})}),y.jsx(ka,{md:4,children:y.jsx(ma,{type:".json",onChange:e=>{const t=e[0].split(".").at(0);let a=e[0].length>0?null:"Upload json file";C(t+L(new Date).format("YYYY-MM-DD")+".json"),N(e[1]),_e(a)},error:e=>{_e(e)}})})]})})})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"FCM project details"})}),y.jsx(ka,{md:9,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!S.toLowerCase().includes("google"),name:"serverKey",placeholder:S.toLowerCase().includes("google")?"Enter FCM measurement id":"Enter sender id",val:A,max:100,cb:e=>{let t=S.toLowerCase().includes("google")?"Enter FCM measurement id":"Enter sender id",a=e.length>0?null:t;Ie(a),I(e)},errorMessage:Ae})}),y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"fcmSenderiD",placeholder:"Enter FCM api key",max:100,val:P,cb:e=>{let t=e.length>0?null:"Enter FCM api key";Me(t),U(e)},errorMessage:Fe})})]})})]})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"serverKey",placeholder:"Enter FCM auth domain",val:B,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM auth domain";Pe(t),G(e)},errorMessage:Re})}),y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"serverKey",placeholder:"Enter FCM project id",val:H,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM project id";Ve(t),z(e)},errorMessage:Ge})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"fcmSenderiD",placeholder:"Enter FCM storage bucket",val:Y,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM storage bucket";He(t),K(e)},errorMessage:We})}),y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"serverKey",placeholder:"Enter measurement id",val:$,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM measurement id";Ye(t),q(e)},errorMessage:ze})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[!1===S.toLowerCase().includes("google")&&y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"fcmAppId",placeholder:"Enter app id",val:J,max:100,cb:e=>{let t=e.length>0?null:"Enter app id";$e(t),X(e)},errorMessage:Ke})}),y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!0,name:"vapidkey",placeholder:"Enter FCM vapid key",val:Z,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM vapid key";Je(t),Q(e)},errorMessage:qe})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsx(ie,{cls:"label-row",type:"text",required:!1,name:"fcmSenderiD",placeholder:"Enter FCM database URL",val:V,max:100,cb:e=>{let t=e.length>0?null:"Enter FCM database URL";Be(t),W(e)},errorMessage:Ue})})})})})}),y.jsxs(Ta,{className:"d-none",children:[y.jsx(ka,{md:3,children:y.jsx("label",{className:"label-row",children:"Web analytics"})}),y.jsx(ka,{md:3,className:"click-off",children:y.jsx(R,{checked:a,className:"mt10",onChange:e=>{if(!e.target.value){let e=[...Xe];e=F,Ze(e),M([])}Le([{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]),s(e.target.value)}})})]}),a&&y.jsx("div",{className:"marginT30",children:y.jsx(fs,{analyticsError:Oe,analyticsDetails:F,mode:e.mode,onBoardingId:void 0!==e.onboardingId&&null!==e.onBoardingId?e.onboardingId:0,callBack:e=>{M(e)},onErrorChange:e=>{Le(e)},deleteValue:e=>{let t=[...F],a=[...Xe];a.push(t[1]),Ze(a),t.pop(),M(t)}})})]})]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{var t,a,s,r,i,n,l,o,c;if(oe("Domain OnBoarding Props",re.location.state),!0===(null==(a=null==(t=null==re?void 0:re.location)?void 0:t.state)?void 0:a.isCampaign)){let e=`cId=${null==(r=null==(s=null==re?void 0:re.location)?void 0:s.state)?void 0:r.campaignId}`,t=null==(l=null==(n=null==(i=null==window?void 0:window.location)?void 0:i.search)?void 0:n.slice(1))?void 0:l.replace(e,"");re.push({pathname:"/campaign/creation-notification",search:`cId=${null==(c=null==(o=null==re?void 0:re.location)?void 0:o.state)?void 0:c.campaignId}&${t}`})}else{const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t),e.cb(0)}},children:"Cancel"}),y.jsx(fe,{onClick:()=>{!0!==me()?t.globalStateData.getIsPrototype?e.cb(0):function(){var e=!1;if(pe(r))return e=!0,ke("Enter domain name"),e;{const t=/^[' 'A-Za-z0-9_-]*$/;if(""===r)return ke("Enter domain name"),e=!0;if(!t.test(r))return ke("Special characters are not allowed"),e=!0}if(null!==ne)return e=!0;if(pe(d)||d.length<9)return e=!0,Ce("Enter domain URL"),e;if(null!==De)return e=!0;if(pe(tt))return e=!0,rt("Select unique id"),e;if(pe(b))return e=!0,Ne("Upload logo"),e;if(pe(D))return e=!0,_e("Upload service json file"),e;if(pe(A))return e=!0,Ie("Enter FCM sender id"),e;if(pe(P))return e=!0,Me("Enter FCM api key"),e;if(pe(B))return e=!0,Pe("Enter FCM auth domain"),e;if(pe(H))return e=!0,Ve("Enter FCM project id"),e;if(pe(Y))return e=!0,He("Enter FCM storage bucket"),e;if(pe($))return e=!0,Ye("Enter FCM messaging id"),e;if(pe(J))return e=!0,$e("Enter app id"),e;if(pe(Z))return e=!0,Q(""),Je("Enter FCM vapid key"),e;if(F.length>0){var t=0;F.forEach((a=>{if(pe(a.analyticsName)){let a={...Oe};a[t].errAnalyticPlatform=ve,Le(a),e=!0}else if(pe(a.serviceAccountEmail)){let a={...Oe};a[t].errAccountMail=ge,Le(a),e=!0}else if(pe(a.appKey)){let a={...Oe};a[t].errAppKey=be,Le(a),e=!0}else if(pe(a.appSecretId)){let a={...Oe};a[t].errAppSecretID=xe,Le(a),e=!0}t++}))}else if(a){let t={...Oe};t[0].errAnalyticPlatform=ve,Le(t),e=!0}return e}()||(()=>{var a;const s={domainName:r,domainURL:d,domainLogo:v,appIdendifier:tt,appID:J,fcmSenderId:A,fcmServerKey:j,fcmServiceFileName:D,fcmServiceFileContent:E,notificationProvider:"google"===S.toLowerCase()?"G":"FCM V1HTTP ",languageID:0,isAnalytics:F.length>0,webGuid:(null==e?void 0:e.webGuid)||"",webfirebaseconfigID:Qe||0,deleteWebAnalytic:Xe,ApiKey:P,AuthDomain:B,DatabaseUrl:V,ProjectID:H,StorageBucket:Y,MessagingSenderID:A,MeasurementId:$,isV1:ee,vapidKey:""};"fcmv1http"===S.toLowerCase()&&(s.MessagingSenderID=$,s.vapidKey=Z);let i={};for(const e in s)s[e]&&"string"==typeof s[e]?i[e]=null==(a=s[e])?void 0:a.trim():i[e]=s[e];let n="";n="edit"===e.mode?we:Te,ce({path:n,params:i,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{if(t.status){const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t),e.cb(0)}else Ce(t.message)},fail:e=>{Ce(e)}})})():e.cb(0)},children:0===e.webGuid?"Save":"Update"})]})]})})),fs=e=>{const[t,a]=w.useState([]),[s,r]=w.useState(e.analyticsError),[i,n]=w.useState("edit"===e.mode&&e.analyticsDetails.length>0?e.analyticsDetails:[{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",analyticsId:"",OnboardingId:0}]),l={title:"title1",value:"value1"};return w.useEffect((()=>{let s=[];s.push(l),"edit"===e.mode&&e.analyticsError.length>1&&!pe(e.analyticsError[1].analyticsName)&&s.push(l),0===t.length&&a(s),r(e.analyticsError)}),[e.analyticsError]),y.jsx(y.Fragment,{children:t.map(((o,c)=>y.jsxs("div",{className:"position-relative",children:[y.jsx(ms,{analyticsError:s[c],analyticsData:i[c],onBoardingId:e.onBoardingId,callBack:(t,a)=>{let s=[...i];window.ganalytics=s,e.callBack(s)},index:c},c),0===c&&y.jsx("div",{className:"pos-icon-1",onClick:()=>{if(pe(s[c].analyticsName)){let e={...s};return e[c].errAnalyticPlatform=ve,void r(e)}if(pe(s[c].serviceAccountEmail)){let e={...s};return e[c].errAccountMail=ge,void r(e)}if(pe(s[c].appKey)){let e={...s};return e[c].errAppKey=be,void r(e)}if(pe(s[c].appSecretId)){let e={...s};return e[c].errAppSecretID=xe,void r(e)}if(t.length<2){let i=[...t];i.push(l),a(i);let o=[...e.analyticsDetails];if(o.push({serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",analyticsId:"",OnboardingId:0}),n(o),s.length<2){let e=[...s];e.push({serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}),r(e)}e.callBack(o)}},children:y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer "+(t.length>1?"click-off":"clickon"),title:"Add"})}),1===c&&y.jsx("div",{className:"pos-icon-1",onClick:()=>{if(t.length>1){let i=[...t];i.pop(),a(i);let n=[...s];n.pop(),r(n),e.onErrorChange(n),e.deleteValue(c)}},children:y.jsx("i",{className:"icon-rs-circle-minus-fill-edge-medium icons-md red cursor-pointer"})})]})))})};class ms extends w.Component{constructor(){super(...arguments),x(this,"state",{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}),x(this,"componentDidUpdate",(e=>{e!==this.props&&this.setState({serviceAccountEmail:this.props.analyticsError.serviceAccountEmail,appKey:this.props.analyticsError.appKey,appSecretId:this.props.analyticsError.appSecretId,analyticsName:this.props.analyticsError.analyticsName,errAnalyticPlatform:this.props.analyticsError.errAnalyticPlatform,errAccountMail:this.props.analyticsError.errAccountMail,errAppKey:this.props.analyticsError.errAppKey,errAppSecretID:this.props.analyticsError.errAppSecretID})}))}componentDidMount(){this.setState({serviceAccountEmail:this.props.analyticsError.serviceAccountEmail,appKey:this.props.analyticsError.appKey,appSecretId:this.props.analyticsError.appSecretId,analyticsName:this.props.analyticsError.analyticsName,errAnalyticPlatform:this.props.analyticsError.errAnalyticPlatform,errAccountMail:this.props.analyticsError.errAccountMail,errAppKey:this.props.analyticsError.errAppKey,errAppSecretID:this.props.analyticsError.errAppSecretID})}render(){return y.jsxs("div",{className:"mb20",children:[y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:{span:6,offset:0},className:"paddingT15 bgColor4",children:y.jsxs("div",{className:"position-relative",children:[this.state.errAnalyticPlatform&&y.jsx("div",{className:"validation-message",children:this.state.errAnalyticPlatform}),y.jsx(fa,{value:this.state.analyticsName&&""!==this.state.analyticsName?{name:this.state.analyticsName,id:this.state.analyticsId}:{name:"-- Select analytics platform --",id:0},textField:"name",dataItemKey:"id",onChange:e=>{let t=e.target.value.name.length>0?null:ve;this.props.analyticsError.errAnalyticPlatform=t,this.setState({analyticsName:e.target.value.name,analyticsId:e.target.value.id,errAnalyticPlatform:t}),this.props.analyticsError.analyticsName=e.target.value.name,this.props.analyticsData.analyticsName=e.target.value.name,this.props.analyticsData.analyticsId=e.target.value.id,this.props.callBack(this.props.analyticsData,this.props.index)},data:ps})]})}),y.jsx(ka,{md:6,className:"paddingT15 bgColor4",children:y.jsx(ie,{val:this.state.serviceAccountEmail,ob:()=>{this.props.callBack(this.state,this.props.index)},cb:e=>{let t=e.length>0?null:ge;this.props.analyticsError.errAccountMail=t,this.setState({serviceAccountEmail:e,errAccountMail:t}),this.props.analyticsError.serviceAccountEmail=e,this.props.analyticsData.serviceAccountEmail=e,this.props.callBack(this.props.analyticsData,this.props.index)},type:"text",name:"serviceAccountEmail",placeholder:"Service account mail",errorMessage:this.state.errAccountMail})})]})})}),y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:{span:6,offset:0},className:"bgColor4",children:y.jsx(ie,{val:this.state.appKey,cls:"label-row",ob:()=>{this.props.callBack(this.state,this.props.index)},cb:e=>{let t=e.length>0?null:be;this.props.analyticsError.errAppKey=t,this.setState({appKey:e,errAppKey:t}),this.props.analyticsError.appKey=e,this.props.analyticsData.appKey=e,this.props.callBack(this.props.analyticsData,this.props.index)},type:"text",name:"appKey",placeholder:"App key",errorMessage:this.state.errAppKey})}),y.jsx(ka,{md:6,className:"bgColor4",children:y.jsx(ie,{val:this.state.appSecretId,cls:"label-row",ob:()=>{this.props.callBack(this.state,this.props.index)},cb:e=>{let t=e.length>0?null:xe;this.props.analyticsError.errAppSecretID=t,this.setState({appSecretId:e,errAppSecretID:t}),this.props.analyticsError.appSecretId=e,this.props.analyticsData.appSecretId=e,this.props.callBack(this.props.analyticsData,this.props.index)},type:"text",name:"appSecretId",placeholder:"App secret id",errorMessage:this.state.errAppSecretID})})]})})})]})}}const ps=[{name:"Flurry analytics",id:9},{name:"Google analytics",id:1}];let vs=class extends k.Component{render(){return y.jsx("div",{children:y.jsxs(Ta,{children:[y.jsxs(ka,{md:3,children:[" ",y.jsx("label",{children:this.props.limit.label})," "]}),y.jsx(ka,{md:3,children:y.jsx(ie,{val:this.props.limit.value,cb:e=>{this.props.onValueChanged(this.props.limit,e)}})}),y.jsx(ka,{md:4,children:y.jsxs("div",{className:"d-flex align-items-center marginT15",children:[y.jsx("div",{className:"marginR5",children:"/"}),y.jsx(Aa,{data:this.props.limit.dropDownValues,onSelect:e=>{this.props.onDropDownValueChanged(this.props.limit,e)},defaultItem:this.props.limit.dropDownValues[0],customAlignRight:!0,className:"marginR10"}),y.jsx("div",{className:"font-italic",children:this.props.limit.availLabel})]})})]})})}},gs=class extends k.Component{render(){const{limits:e}=this.props;return y.jsx("div",{children:e.map((e=>y.jsx(vs,{limit:e,onValueChanged:this.props.onValueChanged,onDropDownValueChanged:this.props.onDropDownValueChanged},e.id)))})}};var bs=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a={},s=function(e){return e.filter((function(e){return!0!==e&&!!e})).map((function(e){return Array.isArray(e)?s(e):function(e){return"object"==typeof e?Object.keys(e).forEach((function(t){a[t]=e[t]})):a[e]=!0}(e)}))};return s(e),Object.keys(a).map((function(e){return a[e]&&e||null})).filter((function(e){return null!==e})).join(" ")};function xs(e,t,a,s){if(e){var r={syntheticEvent:t,nativeEvent:t.nativeEvent,target:a};e.call(void 0,Object.assign(r,s))}}var ys,Ss,ws={sizeMap:{small:"sm",medium:"md",large:"lg"},roundedMap:{small:"sm",medium:"md",large:"lg"}};(Ss=ys||(ys={})).TOP="top",Ss.BOTTOM="bottom",Ss.LEFT="left",Ss.RIGHT="right",Ss.NONE="none";var Ts,ks,Ds={name:"@progress/kendo-react-listbox",productName:"KendoReact",productCodes:["KENDOUIREACT","KENDOUICOMPLETE"],publishDate:1695802361,version:"",licensingDocsUrl:"https://www.telerik.com/kendo-react-ui/my-license/?utm_medium=product&utm_source=kendoreact&utm_campaign=kendo-ui-react-purchase-license-keys-warning"},Cs=globalThis&&globalThis.__extends||(Ts=function(e,t){return(Ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}Ts(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),Es=globalThis&&globalThis.__assign||function(){return Es=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Es.apply(this,arguments)},Ns=function(e){function t(t){var a,s=e.call(this,t)||this;return s.setSelected=function(e){if(s.props.selectedField)return!!e[s.props.selectedField]},s.renderItem=function(e){return s.props.textField?e[s.props.textField]:e.toString()},s.handleKeyDown=function(e){s.props.onKeyDown&&xs(s.props.onKeyDown,e,s,void 0)},s.handleContainerDrop=function(e){e.target.classList.contains("k-list-scroller")&&(s.props.data.length>0?xs(s.props.onDrop,e,s,{dataItem:s.props.data[s.props.data.length-1]}):xs(s.props.onDrop,e,s,{dataItem:null}))},s.setToolbarPosition=function(){return s.props.toolbarPosition===ys.NONE||void 0===s.props.toolbar?"":"k-listbox-actions-".concat(s.props.toolbarPosition)},s.handleOnDragLeave=function(e){s.props.onDragLeave&&e.target.classList.contains("k-list-scroller")&&xs(s.props.onDragLeave,e,s,void 0)},a=Ds,void 0!==P?U(a):("License activation failed for ".concat(a.name,"\n"),"See ".concat(a.licensingDocsUrl," for more information.\n")),s}return Cs(t,e),t.prototype.render=function(){var e,t=this;return w.createElement("div",{className:bs(this.props.className,"k-listbox",this.setToolbarPosition()),style:this.props.style,unselectable:"on"},this.props.toolbar&&"bottom"!==this.props.toolbarPosition&&w.createElement(this.props.toolbar,null),w.createElement("div",{className:"k-list-scroller k-selectable","data-role":"selectable",onDragOver:function(e){return e.preventDefault()},onDrop:this.handleContainerDrop,onDragLeave:this.handleOnDragLeave},w.createElement("div",{className:bs("k-list",(e={},e["k-list-".concat(ws.sizeMap[this.props.size]||this.props.size)]=this.props.size,e))},w.createElement("div",{className:"k-list-content"},w.createElement("ul",{className:"k-list-ul",role:"listbox","aria-label":"listbox-container",tabIndex:0,onKeyDown:this.handleKeyDown},this.props.data.map((function(e,a){var s=t.setSelected(e),r=function(){var e,t,a="";for(e=0;e<32;e++)t=16*Math.random()|0,8!==e&&12!==e&&16!==e&&20!==e||(a+="-"),a+=(12===e?4:16===e?3&t|8:t).toString(16);return a}(),i={className:bs("k-list-item",{"k-selected":s}),role:"option","aria-selected":s,key:a,id:r+a,"data-uid":r+a,draggable:t.props.draggable,onDragStart:function(a){return xs(t.props.onDragStart,a,t,{dataItem:e})},onDragOver:function(a){a.preventDefault(),xs(t.props.onDragOver,a,t,{dataItem:e})},onDrop:function(a){return xs(t.props.onDrop,a,t,{dataItem:e})},onClick:function(a){return xs(t.props.onItemClick,a,t,{dataItem:e})}};return t.props.item?w.createElement(t.props.item,Es({selected:s,dataItem:e},i),w.createElement("span",{className:"k-list-item-text"},e.name)):w.createElement("li",Es({},i),w.createElement("span",{className:"k-list-item-text"},t.renderItem(e)))})))))),this.props.toolbar&&"bottom"===this.props.toolbarPosition&&w.createElement(this.props.toolbar,null),w.createElement("select",{style:{display:"none"},multiple:!0,"data-role":"listbox"},this.props.data.map((function(e,a){var s=e[t.props.valueField||t.props.textField];return w.createElement("option",{key:a,value:s},s)}))))},t.propTypes={size:D.oneOf([null,"small","medium","large"]),toolbarPosition:D.oneOf(["none","top","bottom","left","right"]),textField:D.string,valueField:D.string,selectedField:D.string,data:D.array},t.defaultProps={toolbarPosition:ys.RIGHT,draggable:!0,size:"medium"},t}(w.PureComponent),As=((ks={})["listbox.moveUp"]="Move Up",ks["listbox.moveDown"]="Move Down",ks["listbox.transferTo"]="Transfer To",ks["listbox.transferFrom"]="Transfer From",ks["listbox.transferAllTo"]="Transfer All To",ks["listbox.transferAllFrom"]="Transfer All From",ks["listbox.remove"]="Delete",ks),Is=globalThis&&globalThis.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(t,a)};return function(t,a){if("function"!=typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),js=[{name:"moveUp",iconName:"caret-alt-up",svgIcon:K},{name:"moveDown",iconName:"caret-alt-down",svgIcon:q},{name:"transferTo",iconName:"caret-alt-right",svgIcon:V},{name:"transferFrom",iconName:"caret-alt-left",svgIcon:W},{name:"transferAllTo",iconName:"caret-double-alt-right",svgIcon:B},{name:"transferAllFrom",iconName:"caret-double-alt-left",svgIcon:G},{name:"remove",iconName:"x",svgIcon:J}],_s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkSvgIcon=function(e){switch(e.name){case"caret-alt-right":return W;case"caret-alt-left":return V;case"caret-double-alt-right":return G;case"caret-double-alt-left":return B}return e},t.checkFontIcon=function(e){switch(e){case"caret-alt-right":return"caret-alt-left";case"caret-alt-left":return"caret-alt-right";case"caret-double-alt-right":return"caret-double-alt-left";case"caret-double-alt-left":return"caret-double-alt-right"}return e},t.handleToolClick=function(e,a){xs(t.props.onToolClick,e,t,{toolName:a})},t.isItemDisabled=function(e){var a=!0,s=t.props.selectedField||"selected",r=t.props.data.length,i=t.props.dataConnected.length,n=t.props.data.findIndex((function(e){return!0===e[s]}))>=0,l=t.props.dataConnected.findIndex((function(e){return!0===e[s]}))>=0;switch(e){case"moveUp":a=n?!(t.props.data.length>0)||t.props.data[0].selected:!l||!(t.props.dataConnected.length>0)||t.props.dataConnected[0].selected;break;case"moveDown":a=n?!t.props.data[r-1]||t.props.data[r-1].selected:!l||!(t.props.dataConnected.length>0)||t.props.dataConnected[i-1].selected;break;case"transferTo":a=!(t.props.dataConnected&&n);break;case"transferFrom":a=!t.props.dataConnected||!(t.props.dataConnected&&l);break;case"transferAllTo":a=!(t.props.dataConnected&&t.props.data.length>0);break;case"transferAllFrom":a=!(t.props.dataConnected&&t.props.dataConnected.length>0);break;case"remove":a=!(n||l)}return a},t}return Is(t,e),Object.defineProperty(t.prototype,"isRtl",{get:function(){return"rtl"===this.props.dir},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=H(this);return w.createElement("div",{className:bs("k-listbox-actions")},this.props.tools&&this.props.tools.map((function(a,s){var r=js.findIndex((function(e){return e.name===a})),i=js[r],n=e.isItemDisabled(i.name),l="listbox.".concat(i.name),o=t.toLanguageString(l,As[l]);return w.createElement(z,{key:s,disabled:n,"data-command":i.name,title:o,"aria-label":o,icon:e.isRtl?e.checkFontIcon(i.iconName):i.iconName,svgIcon:e.isRtl?e.checkSvgIcon(i.svgIcon):i.svgIcon,onClick:function(t){t.preventDefault(),e.handleToolClick(t,i.name||null)}})})))},t.propTypes={data:D.array,dataConnected:D.array,tools:D.array,selectedField:D.string,dir:D.string},t.defaultProps={data:[],dataConnected:[],selectedField:"selected"},t}(w.PureComponent);Y(_s);var Os=globalThis&&globalThis.__spreadArray||function(e,t,a){if(a||2===arguments.length)for(var s,r=0,i=t.length;r<i;r++)!s&&r in t||(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},Ls=function(e,t,a,s){void 0===e&&(e=[]),void 0===t&&(t=[]);var r=[],i=[],n=[],l={listBoxOneData:e,listBoxTwoData:t};switch(a){case"moveUp":(r=Os([],e,!0)).forEach((function(e,t){e[s]&&(r=Fs(t,t-1,r))})),(n=Os([],t,!0)).forEach((function(e,t){e[s]&&(n=Fs(t,t-1,n))})),l.listBoxOneData=r,l.listBoxTwoData=n;break;case"moveDown":(r=e.reverse()).forEach((function(e,t){e[s]&&(r=Fs(t,t-1,r))})),(n=t.reverse()).forEach((function(e,t){e[s]&&(n=Fs(t,t-1,n))})),l.listBoxOneData=Os([],r,!0).reverse(),l.listBoxTwoData=Os([],n,!0).reverse();break;case"transferTo":r=e.filter((function(e){return!e[s]})),i=e.filter((function(e){return e[s]})),n=t.concat(i),l.listBoxOneData=r,l.listBoxTwoData=n;break;case"transferFrom":n=t.filter((function(e){return!e[s]})),i=t.filter((function(e){return e[s]})),r=e.concat(i),l.listBoxOneData=r,l.listBoxTwoData=n;break;case"transferAllTo":l.listBoxOneData=[],l.listBoxTwoData=t.concat(e);break;case"transferAllFrom":l.listBoxOneData=t.concat(e),l.listBoxTwoData=[];break;case"remove":n=t.filter((function(e){return!e[s]})),r=e.filter((function(e){return!e[s]})),l.listBoxOneData=r,l.listBoxTwoData=n}return l},Fs=function(e,t,a){var s=a.splice(e,1)[0];return a.splice(t,0,s),a},Ms=function(e,t,a,s,r){void 0===e&&(e=[]),void 0===t&&(t=[]);var i=e.findIndex((function(e){return e[r]===a[r]})),n=t.findIndex((function(e){return e[r]===a[r]})),l=null!==s?e.findIndex((function(e){return e[r]===s[r]})):-1,o=null!==s?t.findIndex((function(e){return e[r]===s[r]})):-1,c=i>=0,d=n>=0,u=l>=0,h=o>=0,f=Os([],e,!0),m=Os([],t,!0);return c&&u?{listBoxOneData:Fs(i,l,e),listBoxTwoData:t}:d&&h?{listBoxOneData:e,listBoxTwoData:Fs(n,o,t)}:c&&(h||null===s)?(null===s?m.push(e[i]):m.splice(o+1,0,e[i]),f.splice(i,1),{listBoxOneData:f,listBoxTwoData:m}):d&&(u||null===s)?(null===s?f.push(t[n]):f.splice(l+1,0,t[n]),m.splice(n,1),{listBoxOneData:f,listBoxTwoData:m}):{listBoxOneData:e,listBoxTwoData:t}};const Rs=e=>{var t,a,s,r;const[i,n]=k.useState({attrData:null,defaultAttribute:[],availableAttribute:[],assignedAttr:[],isLoadingSkeleton:!1}),l=k.useRef(0),[o,c]=w.useState(!1),[d,u]=w.useState(!1),[h,f]=w.useState(!1),m="selected",p=e=>e.sort(((e,t)=>{const a=e.attributeName.toUpperCase(),s=t.attributeName.toUpperCase();return a<s?-1:a>s?1:0}));w.useEffect((()=>{var t,a,s;if(e.attrData){let r=null==(t=e.attrData)?void 0:t.mobAttributesdefaults,l=null==(a=e.attrData)?void 0:a.mobAttributesavilable;const o=JSON.parse(null==(s=e.attrData)?void 0:s.notifysettingJson);let c=[];const d=JSON.stringify(null==o?void 0:o.assignedAttrs)||"";l.map((e=>{d.includes(e.webAttrId)||c.push(e)}));let u={...i,attrData:e.attrData,defaultAttribute:p(r),availableAttribute:p(c),assignedAttr:(null==o?void 0:o.assignedAttrs)||[]};n(u),e.newState&&e.newState(u)}else n({...i,isLoadingSkeleton:!0}),e.newState&&e.newState(i)}),[e.attrData]);const v=(e,t,a)=>{let s=l.current;const r=[...i[t]],o=r.findIndex((t=>t===e.dataItem));e.nativeEvent.shiftKey||(l.current=s=o),e.nativeEvent.ctrlKey||r.forEach((e=>e.selected=!1));const c=!e.dataItem.selected;for(let i=Math.min(s,o);i<=Math.max(s,o);i++)r[i].selected=c;n({...i,[t]:p(r)})},g=e=>{if((d||h)&&(d&&"transferTo"===e.toolName||h&&"transferFrom"===e.toolName)){let t=e.toolName||"",a=Ls(i.availableAttribute,i.assignedAttr,t,m);u(!1),f(!1),n({...i,availableAttribute:p(a.listBoxOneData),assignedAttr:p(a.listBoxTwoData)})}},b=e=>{n({...i,draggedItem:e.dataItem})},x=e=>{let t=Ms(i.availableAttribute,i.assignedAttr,i.draggedItem,e.dataItem,"attributeName");n({...i,availableAttribute:t.listBoxOneData,assignedAttr:t.listBoxTwoData})};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex justify-content-between mb20",children:[y.jsx("h3",{children:"Attributes"}),y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",tooltip:"Edit attributes",onClick:()=>{c(!o)}})]}),y.jsx("div",{className:"chips-container com-set",children:y.jsx("div",{className:"chips-box",children:e.attrData?y.jsxs(y.Fragment,{children:[y.jsxs("h6",{className:"mb10",children:["Default",y.jsx("div",{className:"count-label",children:null==(t=null==i?void 0:i.defaultAttribute)?void 0:t.length})]}),y.jsx("div",{className:"no-close multi-attr-default-max pointer-none",children:(null==(a=null==i?void 0:i.defaultAttribute)?void 0:a.length)&&y.jsx(X,{data:null==i?void 0:i.defaultAttribute,textField:"attributeName",dataItemKey:"webAttrID",onChange:e=>{},value:null==i?void 0:i.defaultAttribute,allowCustom:!1})}),y.jsx("div",{className:"dotted-line my10"}),y.jsxs("h6",{className:"mb10",children:["Additional"," ",y.jsx("div",{className:"count-label",children:null==(s=null==i?void 0:i.assignedAttr)?void 0:s.length})]}),y.jsx("div",{className:"no-search multi-attr-additional-max",children:(null==(r=i.assignedAttr)?void 0:r.length)>0&&y.jsx(X,{disabled:!0,data:null==i?void 0:i.assignedAttr,textField:"attributeName",dataItemKey:"webAttrId",onChange:t=>{let a={...i};if(t.target.value.length>0){let e=a.assignedAttr.filter((e=>!t.target.value.find((t=>e.webAttrId===t.webAttrId))))[0];e.selected=!1,a.availableAttribute.push(e),a.assignedAttr.filter((t=>t.webAttrID!==e.webAttrID)),a.assignedAttr=t.target.value}else{let e=a.assignedAttr[0];e.selected=!1,a.availableAttribute.push(e),a.assignedAttr=[]}n(a),e.newState&&e.newState(a)},value:null==i?void 0:i.assignedAttr,allowCustom:!1})})]}):y.jsx(Ia,{count:5,isError:!1})})}),y.jsx(y.Fragment,{children:y.jsxs(Da,{show:o,size:"lg",centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:"Add attributes"})}),y.jsx(Da.Body,{children:y.jsx(wa,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"justify-content-between mb20 listbox-toolbox",children:[y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Available attributes"}),i.availableAttribute&&y.jsx(Ns,{style:{height:240,width:"100%"},data:i.availableAttribute,textField:"attributeName",selectedField:d?m:"",onItemClick:e=>{u(!0),v(e,"availableAttribute")},onDragStart:b,onDrop:x,toolbar:()=>y.jsx(_s,{tools:["transferTo","transferFrom"],data:i.availableAttribute,dataConnected:i.assignedAttr,onToolClick:g})})]}),y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Assigned attributes"}),i.assignedAttr&&y.jsx(Ns,{style:{height:240,width:"100%"},data:i.assignedAttr,textField:"attributeName",selectedField:h?m:"",onItemClick:e=>{f(!0),v(e,"assignedAttr")},onDragStart:b,onDrop:x})]})]})})})}),y.jsx(Da.Footer,{children:y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{c(!o),e.newState&&e.newState(i)},children:"Close"})})})]})})]})},Ps=e=>{w.useState(!1);const[t,a]=k.useState({availEvents:[],assignedEvents:[],clientEvents:[],clientAssignedEvents:[],deleteEvents:[],isLoadingSkeleton:!1}),[s,r]=w.useState(!1),i=k.useRef(0),[n,l]=w.useState(!1),[o,c]=w.useState(!1),d="selected",u=e=>e.sort(((e,t)=>{const a=e.eventName.toUpperCase(),s=t.eventName.toUpperCase();return a<s?-1:a>s?1:0}));w.useEffect((()=>{var s,r;if(e.eventsData){const i=JSON.parse(null==(s=e.eventsData)?void 0:s.notifysettingJson),n=[],l=JSON.stringify(null==i?void 0:i.assignedEvents)||"";null==(r=e.eventsData)||r.mobappevents.map((e=>{l.includes(e.eventId)||n.push(e)}));let o={...t,availEvents:u(n),assignedEvents:u((null==i?void 0:i.assignedEvents)||[])};a(o),e.newState(o)}else a({...t,isLoadingSkeleton:!0}),e.newState(t)}),[e.eventsData]);const h=(e,s,r)=>{let n=i.current;const l=[...t[s]],o=l.findIndex((t=>t===e.dataItem));e.nativeEvent.shiftKey||(i.current=n=o),e.nativeEvent.ctrlKey||l.forEach((e=>e.selected=!1));const c=!e.dataItem.selected;for(let t=Math.min(n,o);t<=Math.max(n,o);t++)l[t].selected=c;a({...t,[s]:u(l)})},f=e=>{a({...t,draggedItem:e.dataItem})},m=e=>{let s=Ms(t.availEvents,t.assignedEvents,t.draggedItem,e.dataItem,"eventName");a({...t,availEvents:u(s.listBoxOneData),assignedEvents:u(s.listBoxTwoData)})},p=e=>{if((n||o)&&(n&&"transferTo"===e.toolName||o&&"transferFrom"===e.toolName)){let s=e.toolName||"",r=Ls(t.availEvents,t.assignedEvents,s,d);l(!1),c(!1),a({...t,availEvents:u(r.listBoxOneData),assignedEvents:u(r.listBoxTwoData)})}};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex justify-content-between mb20",children:[y.jsx("h3",{children:"Events"}),y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",tooltip:"Edit events",onClick:()=>{r(!s)}})]}),y.jsx("div",{className:"chips-container com-set",children:y.jsx("div",{className:"chips-box",children:e.eventsData?y.jsx("div",{className:"no-search multi-events-max",children:t.assignedEvents&&y.jsx(X,{placeholder:"Add events",disabled:!0,textField:"eventName",dataItemKey:"eventId",onChange:s=>{let r={...t},i=(e=>{let a=t.assignedEvents,s=[];return a.map((t=>{0===e.filter((e=>t.eventId===e.eventId)).length&&(t.selected=!1,s.push(t))})),u(s)})(s.target.value);r.availEvents.push(i[0]),r.assignedEvents=s.target.value,a(r),e.newState&&e.newState(r)},value:t.assignedEvents,allowCustom:!0})}):y.jsx(Ia,{count:5,isError:!1})})}),y.jsx(y.Fragment,{children:y.jsxs(Da,{show:s,size:"lg",centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:"Add events"})}),y.jsx(Da.Body,{children:y.jsx(y.Fragment,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"justify-content-between mb20 listbox-toolbox",children:[y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Available events"}),t.availEvents&&y.jsx(Ns,{style:{height:240,width:"100%"},data:t.availEvents,textField:"eventName",selectedField:n?d:"",onItemClick:e=>{l(!0),h(e,"availEvents")},onDragStart:f,onDrop:m,toolbar:()=>y.jsx(_s,{tools:["transferTo","transferFrom"],data:t.availEvents,dataConnected:t.assignedEvents,onToolClick:p})})]}),y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Assigned events"}),t.availEvents&&y.jsx(Ns,{style:{height:240,width:"100%"},data:t.assignedEvents,textField:"eventName",selectedField:o?d:"",onItemClick:e=>{c(!0),h(e,"assignedEvents")},onDragStart:f,onDrop:m})]})]})})})}),y.jsx(Da.Footer,{children:y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{r(!s),e.newState&&e.newState(t)},children:"Close"})})})]})})]})},Us="selected",Bs=["transferTo","transferFrom"];let Gs=class extends k.Component{constructor(){super(...arguments),x(this,"state",{rightColumnValues:this.props.rightColumnValues,leftColumnValues:this.props.leftColumnValues,draggedItem:{},isOpen:this.props.isOpen}),x(this,"handleItemClick",((e,t,a)=>{this.setState({[t]:this.state[t].map((t=>(t.name===e.dataItem.name?t[Us]=!t[Us]:e.nativeEvent.ctrlKey||(t[Us]=!1),t))),[a]:this.state[a].map((e=>(e[Us]=!1,e)))})})),x(this,"handleToolBarClick",((e,t,a)=>{let s=Ls(this.state[t],this.state[a],e.toolName,Us);this.setState({[t]:s.listBoxOneData,[a]:s.listBoxTwoData})})),x(this,"handleDragStart",(e=>{e.dataItem.dataCollection=e.target.props.name,this.setState({draggedItem:e.dataItem})})),x(this,"handleDrop",(e=>{let t=this.state.draggedItem.dataCollection,a=e.target.props.name,s=Ms(this.state[t],this.state[a],this.state.draggedItem,e.dataItem,"name");this.setState({[t]:s.listBoxOneData,[a]:s.listBoxTwoData})}))}componentDidMount(){this.setState({rightColumnValues:this.props.rightColumnValues,leftColumnValues:this.props.leftColumnValues,isOpen:this.props.isOpen})}render(){return y.jsxs(Da,{show:this.state.isOpen,centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:this.props.modalTitle})}),y.jsx(Da.Body,{children:y.jsx(wa,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"row justify-content-between",children:[y.jsxs(ka,{children:[y.jsxs("h6",{children:[this.props.leftColumnTitle," "]}),y.jsx(Ns,{style:{height:150,width:"100%"},data:this.state.leftColumnValues,textField:"name",selectedField:Us,onItemClick:e=>this.handleItemClick(e,"leftColumnValues","rightColumnValues"),onDragStart:this.handleDragStart,onDrop:this.handleDrop,name:"leftColumnValues",toolbar:()=>y.jsx(_s,{tools:Bs,data:this.state.leftColumnValues,dataConnected:this.state.rightColumnValues,onToolClick:e=>this.handleToolBarClick(e,"leftColumnValues","rightColumnValues")})})]}),y.jsxs(ka,{children:[y.jsx("h6",{children:this.props.rightColumnTitle}),y.jsx(Ns,{style:{height:150,width:"100%"},data:this.state.rightColumnValues,textField:"name",selectedField:Us,onItemClick:e=>this.handleItemClick(e,"rightColumnValues","leftColumnValues"),onDragStart:this.handleDragStart,onDrop:this.handleDrop,name:"rightColumnValues"})]})]})})})}),y.jsx(Da.Footer,{children:y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{this.setState({isOpen:!this.state.isOpen}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),y.jsx(fe,{onClick:()=>{this.setState({isOpen:!this.state.isOpen}),this.props.onChangeIsOpen(!1);const e=this.state.rightColumnValues.map((e=>e.name));this.props.onSaveButtonClicked(e,this.state.leftColumnValues,this.state.rightColumnValues)},children:"Save"})]})})]})}};const Vs=e=>{const t=w.useContext(le),a=T(),[s,r]=w.useState(null),[i,n]=w.useState(null),[l,o]=w.useState([]),[c,d]=w.useState(!1),[u,h]=k.useState([]),[f,m]=k.useState(null),[p,v]=k.useState(Ws),[g,b]=w.useState(null),[x,S]=w.useState(null),[D,C]=w.useState(!1),[E,N]=w.useState(""),[A,I]=w.useState(""),[j,_]=w.useState(""),[L,F]=w.useState([]),[M,R]=w.useState([]),[P,U]=w.useState(!1),[B,G]=w.useState(null),[V,W]=w.useState(null),[H,z]=w.useState(!1);w.useEffect((()=>{window.scroll(0,0);const a={onBoardingId:e.appPermissionData.mpid,appGuid:e.appPermissionData.appGuId};ce({path:De,params:a,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{e.status?Y(e.data):(U(!0),G((null==e?void 0:e.message)||Ce))},fail:e=>{}})}),[]);const Y=e=>{r(e),K(e),$(e)},K=e=>{var t,a;let s=(null==e?void 0:e.mobPermissionclientnew)||(null==(t=JSON.parse(null==e?void 0:e.notifysettingJson))?void 0:t.appPermission)||[];if((null==s?void 0:s.length)>0){let e=null==s?void 0:s.filter((e=>"SDK"===e.accessName));(null==e?void 0:e.length)>0&&z((null==(a=e[0])?void 0:a.isActive)||!1)}d(0===s.length),o(s)},$=e=>{const t=JSON.parse(null==e?void 0:e.notifysettingJson);m(null==t?void 0:t.inboxClassifyStatus),h(null==t?void 0:t.inboxClassify)};return y.jsxs(Na,{children:[y.jsx(wa,{fluid:!0,className:"main-heading-wrapper mb0",children:y.jsxs(wa,{className:"mhw-container",children:[y.jsx("div",{className:"mhwc-left",children:y.jsx("h1",{children:y.jsx("div",{className:"mh-wrapper",children:y.jsx("span",{className:"mh-text",children:"Settings"})})})}),y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",onClick:()=>{var t,s,r,i,n,l,o;if(!0===(null==(s=null==(t=null==a?void 0:a.location)?void 0:t.state)?void 0:s.isCampaign)){const e=O.parse(null==(r=null==a?void 0:a.location)?void 0:r.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,c=null==(l=null==(n=null==(i=null==window?void 0:window.location)?void 0:i.search)?void 0:n.slice(1))?void 0:l.replace(s,"");return void a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${c}`,state:null==(o=null==a?void 0:a.location)?void 0:o.state})}const c=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:c},"",c),e.cb(!1)},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})]})}),y.jsx(wa,{fluid:!0,className:"page-header",children:y.jsxs(wa,{children:[y.jsxs("div",{className:me()?"click-off":"",children:[null!==i&&y.jsxs(y.Fragment,{children:[y.jsx("h3",{className:"marginY25",children:"Limits"}),y.jsx("div",{className:"marginL15",children:y.jsx(gs,{limits:i,frequency:s.frequency,onValueChanged:(e,t)=>{const a=[...i],s=i.indexOf(e);a[s]={...e},a[s].limitvalue=t,n(a)},onDropDownValueChanged:(e,t)=>{const a=[...i],r=i.indexOf(e);a[r]={...e},a[r].selectedDropDownValue=t;let l=s.webPushLimits.filter((a=>a.lId===e.limitId&&a.frequency===t.freqId));if(l.length>0){let e=l[0].availableLimit;a[r].availableLimit=e}n(a)}})})]}),y.jsx(ga,{className:"mb30",children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsxs("div",{className:"box-design",children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx("h3",{className:"mb10",children:"SDK settings"})}),y.jsx(ka,{children:y.jsx("div",{className:"mb10 float-end",children:y.jsx(La,{onChange:e=>{let t=[...l];t.map(((t,a)=>{t.isActive=e.target.value})),o(t),z(e.target.value)},checked:H})})})]}),y.jsx("div",{className:"sdk-settings-border",children:(null==l?void 0:l.length)?y.jsx(Oa,{gridClassName:"table-alert-notify SDKTableListCSS",scrollable:!0,data:l,column:[{field:"accessName",filter:"text",title:"Access name",cell:e=>{var t;return y.jsx("td",{children:y.jsx("span",{children:null==(t=e.dataItem)?void 0:t.accessName})})}},{field:"action",title:"Action",width:"120",cell:e=>y.jsx(Hs,{...e,onCheckedChange:t=>{let a=[...l];0===e.dataIndex?a.map(((e,a)=>{e.isActive=t})):a[e.dataIndex].isActive=t,o(a)}})}],settings:{total:null==l?void 0:l.length},pageable:!1,config:{take:100,skip:0}}):y.jsx(Ia,{count:6,isError:!l})})]})}),y.jsx(ka,{md:6,children:y.jsx("div",{className:"box-design",children:y.jsx(Rs,{attrData:s,newState:e=>{b(e)}})})})]})}),y.jsx(ga,{className:"mb30",children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx("div",{className:"box-design",children:y.jsx(Ps,{eventsData:s,newState:e=>S(e)})})}),y.jsx(ka,{md:6,children:y.jsxs("div",{className:"position-releative",children:[V?y.jsx("div",{className:"validation-message multi-select-valid-msg",style:{left:15,top:0},children:V}):null,y.jsxs("div",{className:"box-design",children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between mb20",children:[y.jsx("h3",{className:"mb0",children:"Inbox classification"}),y.jsx(La,{onChange:()=>m(!f),checked:f})]}),y.jsx("div",{className:"chips-container com-set "+(f?"":"click-off"),children:y.jsx("div",{className:"chips-box",children:y.jsx("div",{className:"no-search multi-inbox-class-max",children:y.jsx(se,{noDropdown:!0,noinput:!0,textField:"classifyName",placeholder:"Enter inbox classification",onChange:e=>{const t=e.target.value.reduce(((e,t)=>e.find((e=>e.classifyName===t.classifyName))?e:e.concat([t])),[]);if(t.length>10)return W("Limit exceed"),void setTimeout((()=>{W(null)}),3e3);h(t)},value:u,allowCustom:!0})})})})]})]})})]})}),y.jsx(Ta,{children:y.jsxs(ka,{md:6,className:"d-none",children:[y.jsx("h3",{className:"marginT30 marginB10",children:"Whitelisting & throttling"}),y.jsx("div",{className:"chips-container com-set",children:y.jsx("div",{className:"chips-box",children:s?y.jsxs(y.Fragment,{children:[y.jsx("h6",{children:"FCM IP whitelist"}),y.jsx("div",{className:"no-close multi-whitelist-max",children:y.jsx(X,{onChange:e=>{v(e.target.value)},listNoDataRender:re,disabled:!0,value:p,allowCustom:!0})}),y.jsx("div",{className:"dotted-line my10 marginX-10"}),y.jsxs("div",{className:"d-flex justify-content-between",children:[y.jsx("h6",{children:"Notification delivery throttle"}),y.jsx("div",{children:"1,000,000 / Minute"})]})]}):y.jsx(Ia,{count:5,isError:!0})})})]})})]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{var t,s,r,i,n,l,o;if(!0!==(null==(s=null==(t=a.location)?void 0:t.state)?void 0:s.isCampaign)){var c=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.pushState({path:c},"",c),e.cb(!1)}else{const e=O.parse(null==(r=null==a?void 0:a.location)?void 0:r.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,c=null==(l=null==(n=null==(i=null==window?void 0:window.location)?void 0:i.search)?void 0:n.slice(1))?void 0:l.replace(s,"");a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${c}`,state:null==(o=null==a?void 0:a.location)?void 0:o.state})}},children:"Cancel"}),y.jsx(fe,{className:me()?"click-off":"",onClick:()=>{if(oe("webPermission",g.assignedAttr),me()){const t=`${window.location.origin}${window.location.pathname}`;return window.history.pushState({path:t},"",t),void e.cb(!1)}const s={onBoardingId:e.appPermissionData.mpid,appGuid:e.appPermissionData.appGuId,limits:[],appPermission:l,assignedAttrs:g?g.assignedAttr:[],assignedEvents:x?x.assignedEvents:[],whitelisting:[],inboxClassify:u,inboxClassifyStatus:f};ce({path:Ie,params:s,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{var s,r,i,n,l,o,c;if(t.status){if(!0===(null==(r=null==(s=a.location)?void 0:s.state)?void 0:r.isCampaign)){const e=O.parse(null==(i=null==a?void 0:a.location)?void 0:i.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,r=null==(o=null==(l=null==(n=null==window?void 0:window.location)?void 0:n.search)?void 0:l.slice(1))?void 0:o.replace(s,"");return void a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${r}`,state:null==(c=null==a?void 0:a.location)?void 0:c.state})}const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t),e.cb(!1)}else U(!0),G((null==t?void 0:t.message)||Ce)},fail:e=>{}})},children:"Save"})]}),!0===D?y.jsx(Gs,{isOpen:D,onChangeIsOpen:e=>{C(e)},modalTitle:E,leftColumnTitle:A,leftColumnValues:L,rightColumnTitle:j,rightColumnValues:M,onSaveButtonClicked:(e,t,a)=>{}}):null,!0===P&&y.jsx(ja,{headerTitle:"Sorry",para:B,primaryButtonText:"OK",buttonClicked:e=>{U(!1)}})]})})]})},Ws=["162.134.21.152","192.201.91.35","192.189.221.135"],Hs=e=>y.jsx("td",{children:y.jsx("div",{className:"float-end",children:y.jsx(La,{onChange:t=>{e.onCheckedChange(t.target.value)},checked:e.dataItem.isActive})})});var zs,Ys={exports:{}};(zs=Ys).exports=function(){var e,t;function a(){return e.apply(null,arguments)}function s(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function n(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(i(e,t))return!1;return!0}function l(e){return void 0===e}function o(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var a,s=[],r=e.length;for(a=0;a<r;++a)s.push(t(e[a],a));return s}function u(e,t){for(var a in t)i(t,a)&&(e[a]=t[a]);return i(t,"toString")&&(e.toString=t.toString),i(t,"valueOf")&&(e.valueOf=t.valueOf),e}function h(e,t,a,s){return Ot(e,t,a,s,!0).utc()}function f(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function m(e){var a=null,s=!1,r=e._d&&!isNaN(e._d.getTime());return r&&(a=f(e),s=t.call(a.parsedDateParts,(function(e){return null!=e})),r=a.overflow<0&&!a.empty&&!a.invalidEra&&!a.invalidMonth&&!a.invalidWeekday&&!a.weekdayMismatch&&!a.nullInput&&!a.invalidFormat&&!a.userInvalidated&&(!a.meridiem||a.meridiem&&s),e._strict&&(r=r&&0===a.charsLeftOver&&0===a.unusedTokens.length&&void 0===a.bigHour)),null!=Object.isFrozen&&Object.isFrozen(e)?r:(e._isValid=r,e._isValid)}function p(e){var t=h(NaN);return null!=e?u(f(t),e):f(t).userInvalidated=!0,t}t=Array.prototype.some?Array.prototype.some:function(e){var t,a=Object(this),s=a.length>>>0;for(t=0;t<s;t++)if(t in a&&e.call(this,a[t],t,a))return!0;return!1};var v=a.momentProperties=[],g=!1;function b(e,t){var a,s,r,i=v.length;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=f(t)),l(t._locale)||(e._locale=t._locale),i>0)for(a=0;a<i;a++)l(r=t[s=v[a]])||(e[s]=r);return e}function x(e){b(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===g&&(g=!0,a.updateOffset(this),g=!1)}function y(e){return e instanceof x||null!=e&&null!=e._isAMomentObject}function S(e){!1===a.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn}function w(e,t){var s=!0;return u((function(){if(null!=a.deprecationHandler&&a.deprecationHandler(null,e),s){var r,n,l,o=[],c=arguments.length;for(n=0;n<c;n++){if(r="","object"==typeof arguments[n]){for(l in r+="\n["+n+"] ",arguments[0])i(arguments[0],l)&&(r+=l+": "+arguments[0][l]+", ");r=r.slice(0,-2)}else r=arguments[n];o.push(r)}S((Array.prototype.slice.call(o).join(""),(new Error).stack)),s=!1}return t.apply(this,arguments)}),t)}var T,k={};function D(e,t){null!=a.deprecationHandler&&a.deprecationHandler(e,t),k[e]||(S(),k[e]=!0)}function C(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function E(e,t){var a,s=u({},e);for(a in t)i(t,a)&&(r(e[a])&&r(t[a])?(s[a]={},u(s[a],e[a]),u(s[a],t[a])):null!=t[a]?s[a]=t[a]:delete s[a]);for(a in e)i(e,a)&&!i(t,a)&&r(e[a])&&(s[a]=u({},s[a]));return s}function N(e){null!=e&&this.set(e)}a.suppressDeprecationWarnings=!1,a.deprecationHandler=null,T=Object.keys?Object.keys:function(e){var t,a=[];for(t in e)i(e,t)&&a.push(t);return a};function A(e,t,a){var s=""+Math.abs(e),r=t-s.length;return(e>=0?a?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+s}var I=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,_={},O={};function L(e,t,a,s){var r=s;"string"==typeof s&&(r=function(){return this[s]()}),e&&(O[e]=r),t&&(O[t[0]]=function(){return A(r.apply(this,arguments),t[1],t[2])}),a&&(O[a]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function M(e,t){return e.isValid()?(t=R(t,e.localeData()),_[t]=_[t]||function(e){var t,a,s,r=e.match(I);for(t=0,a=r.length;t<a;t++)O[r[t]]?r[t]=O[r[t]]:r[t]=(s=r[t]).match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"");return function(t){var s,i="";for(s=0;s<a;s++)i+=C(r[s])?r[s].call(t,e):r[s];return i}}(t),_[t](e)):e.localeData().invalidDate()}function R(e,t){var a=5;function s(e){return t.longDateFormat(e)||e}for(j.lastIndex=0;a>=0&&j.test(e);)e=e.replace(j,s),j.lastIndex=0,a-=1;return e}var P={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function U(e){return"string"==typeof e?P[e]||P[e.toLowerCase()]:void 0}function B(e){var t,a,s={};for(a in e)i(e,a)&&(t=U(a))&&(s[t]=e[a]);return s}var G={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};var V,W=/\d/,H=/\d\d/,z=/\d{3}/,Y=/\d{4}/,K=/[+-]?\d{6}/,$=/\d\d?/,q=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,X=/\d{1,3}/,Z=/\d{1,4}/,Q=/[+-]?\d{1,6}/,ee=/\d+/,te=/[+-]?\d+/,ae=/Z|[+-]\d\d:?\d\d/gi,se=/Z|[+-]\d\d(?::?\d\d)?/gi,re=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ie=/^[1-9]\d?/,ne=/^([1-9]\d|\d)/;function le(e,t,a){V[e]=C(t)?t:function(e,s){return e&&a?a:t}}function oe(e,t){return i(V,e)?V[e](t._strict,t._locale):new RegExp(ce(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,a,s,r){return t||a||s||r}))))}function ce(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function de(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ue(e){var t=+e,a=0;return 0!==t&&isFinite(t)&&(a=de(t)),a}V={};var he={};function fe(e,t){var a,s,r=t;for("string"==typeof e&&(e=[e]),o(t)&&(r=function(e,a){a[t]=ue(e)}),s=e.length,a=0;a<s;a++)he[e[a]]=r}function me(e,t){fe(e,(function(e,a,s,r){s._w=s._w||{},t(e,s._w,s,r)}))}function pe(e,t,a){null!=t&&i(he,e)&&he[e](t,a._a,a,e)}function ve(e){return e%4==0&&e%100!=0||e%400==0}var ge=0,be=1,xe=2,ye=3,Se=4,we=5,Te=6,ke=7,De=8;function Ce(e){return ve(e)?366:365}L("Y",0,0,(function(){var e=this.year();return e<=9999?A(e,4):"+"+e})),L(0,["YY",2],0,(function(){return this.year()%100})),L(0,["YYYY",4],0,"year"),L(0,["YYYYY",5],0,"year"),L(0,["YYYYYY",6,!0],0,"year"),le("Y",te),le("YY",$,H),le("YYYY",Z,Y),le("YYYYY",Q,K),le("YYYYYY",Q,K),fe(["YYYYY","YYYYYY"],ge),fe("YYYY",(function(e,t){t[ge]=2===e.length?a.parseTwoDigitYear(e):ue(e)})),fe("YY",(function(e,t){t[ge]=a.parseTwoDigitYear(e)})),fe("Y",(function(e,t){t[ge]=parseInt(e,10)})),a.parseTwoDigitYear=function(e){return ue(e)+(ue(e)>68?1900:2e3)};var Ee,Ne=Ae("FullYear",!0);function Ae(e,t){return function(s){return null!=s?(je(this,e,s),a.updateOffset(this,t),this):Ie(this,e)}}function Ie(e,t){if(!e.isValid())return NaN;var a=e._d,s=e._isUTC;switch(t){case"Milliseconds":return s?a.getUTCMilliseconds():a.getMilliseconds();case"Seconds":return s?a.getUTCSeconds():a.getSeconds();case"Minutes":return s?a.getUTCMinutes():a.getMinutes();case"Hours":return s?a.getUTCHours():a.getHours();case"Date":return s?a.getUTCDate():a.getDate();case"Day":return s?a.getUTCDay():a.getDay();case"Month":return s?a.getUTCMonth():a.getMonth();case"FullYear":return s?a.getUTCFullYear():a.getFullYear();default:return NaN}}function je(e,t,a){var s,r,i,n,l;if(e.isValid()&&!isNaN(a)){switch(s=e._d,r=e._isUTC,t){case"Milliseconds":return void(r?s.setUTCMilliseconds(a):s.setMilliseconds(a));case"Seconds":return void(r?s.setUTCSeconds(a):s.setSeconds(a));case"Minutes":return void(r?s.setUTCMinutes(a):s.setMinutes(a));case"Hours":return void(r?s.setUTCHours(a):s.setHours(a));case"Date":return void(r?s.setUTCDate(a):s.setDate(a));case"FullYear":break;default:return}i=a,n=e.month(),l=29!==(l=e.date())||1!==n||ve(i)?l:28,r?s.setUTCFullYear(i,n,l):s.setFullYear(i,n,l)}}function _e(e,t){if(isNaN(e)||isNaN(t))return NaN;var a,s=(t%(a=12)+a)%a;return e+=(t-s)/12,1===s?ve(e)?29:28:31-s%7%2}Ee=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},L("M",["MM",2],"Mo",(function(){return this.month()+1})),L("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),L("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),le("M",$,ie),le("MM",$,H),le("MMM",(function(e,t){return t.monthsShortRegex(e)})),le("MMMM",(function(e,t){return t.monthsRegex(e)})),fe(["M","MM"],(function(e,t){t[be]=ue(e)-1})),fe(["MMM","MMMM"],(function(e,t,a,s){var r=a._locale.monthsParse(e,s,a._strict);null!=r?t[be]=r:f(a).invalidMonth=e}));var Oe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Le="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Fe=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Me=re,Re=re;function Pe(e,t,a){var s,r,i,n=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)i=h([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(i,"").toLocaleLowerCase();return a?"MMM"===t?-1!==(r=Ee.call(this._shortMonthsParse,n))?r:null:-1!==(r=Ee.call(this._longMonthsParse,n))?r:null:"MMM"===t?-1!==(r=Ee.call(this._shortMonthsParse,n))||-1!==(r=Ee.call(this._longMonthsParse,n))?r:null:-1!==(r=Ee.call(this._longMonthsParse,n))||-1!==(r=Ee.call(this._shortMonthsParse,n))?r:null}function Ue(e,t){if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=ue(t);else if(!o(t=e.localeData().monthsParse(t)))return e;var a=t,s=e.date();return s=s<29?s:Math.min(s,_e(e.year(),a)),e._isUTC?e._d.setUTCMonth(a,s):e._d.setMonth(a,s),e}function Be(e){return null!=e?(Ue(this,e),a.updateOffset(this,!0),this):Ie(this,"Month")}function Ge(){function e(e,t){return t.length-e.length}var t,a,s,r,i=[],n=[],l=[];for(t=0;t<12;t++)a=h([2e3,t]),s=ce(this.monthsShort(a,"")),r=ce(this.months(a,"")),i.push(s),n.push(r),l.push(r),l.push(s);i.sort(e),n.sort(e),l.sort(e),this._monthsRegex=new RegExp("^("+l.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function Ve(e,t,a,s,r,i,n){var l;return e<100&&e>=0?(l=new Date(e+400,t,a,s,r,i,n),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,t,a,s,r,i,n),l}function We(e){var t,a;return e<100&&e>=0?((a=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,a)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function He(e,t,a){var s=7+t-a;return-(7+We(e,0,s).getUTCDay()-t)%7+s-1}function ze(e,t,a,s,r){var i,n,l=1+7*(t-1)+(7+a-s)%7+He(e,s,r);return l<=0?n=Ce(i=e-1)+l:l>Ce(e)?(i=e+1,n=l-Ce(e)):(i=e,n=l),{year:i,dayOfYear:n}}function Ye(e,t,a){var s,r,i=He(e.year(),t,a),n=Math.floor((e.dayOfYear()-i-1)/7)+1;return n<1?s=n+Ke(r=e.year()-1,t,a):n>Ke(e.year(),t,a)?(s=n-Ke(e.year(),t,a),r=e.year()+1):(r=e.year(),s=n),{week:s,year:r}}function Ke(e,t,a){var s=He(e,t,a),r=He(e+1,t,a);return(Ce(e)-s+r)/7}L("w",["ww",2],"wo","week"),L("W",["WW",2],"Wo","isoWeek"),le("w",$,ie),le("ww",$,H),le("W",$,ie),le("WW",$,H),me(["w","ww","W","WW"],(function(e,t,a,s){t[s.substr(0,1)]=ue(e)}));function $e(e,t){return e.slice(t,7).concat(e.slice(0,t))}L("d",0,"do","day"),L("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),L("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),L("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),L("e",0,0,"weekday"),L("E",0,0,"isoWeekday"),le("d",$),le("e",$),le("E",$),le("dd",(function(e,t){return t.weekdaysMinRegex(e)})),le("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),le("dddd",(function(e,t){return t.weekdaysRegex(e)})),me(["dd","ddd","dddd"],(function(e,t,a,s){var r=a._locale.weekdaysParse(e,s,a._strict);null!=r?t.d=r:f(a).invalidWeekday=e})),me(["d","e","E"],(function(e,t,a,s){t[s]=ue(e)}));var qe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Je="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Xe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ze=re,Qe=re,et=re;function tt(e,t,a){var s,r,i,n=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)i=h([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(i,"").toLocaleLowerCase();return a?"dddd"===t?-1!==(r=Ee.call(this._weekdaysParse,n))?r:null:"ddd"===t?-1!==(r=Ee.call(this._shortWeekdaysParse,n))?r:null:-1!==(r=Ee.call(this._minWeekdaysParse,n))?r:null:"dddd"===t?-1!==(r=Ee.call(this._weekdaysParse,n))||-1!==(r=Ee.call(this._shortWeekdaysParse,n))||-1!==(r=Ee.call(this._minWeekdaysParse,n))?r:null:"ddd"===t?-1!==(r=Ee.call(this._shortWeekdaysParse,n))||-1!==(r=Ee.call(this._weekdaysParse,n))||-1!==(r=Ee.call(this._minWeekdaysParse,n))?r:null:-1!==(r=Ee.call(this._minWeekdaysParse,n))||-1!==(r=Ee.call(this._weekdaysParse,n))||-1!==(r=Ee.call(this._shortWeekdaysParse,n))?r:null}function at(){function e(e,t){return t.length-e.length}var t,a,s,r,i,n=[],l=[],o=[],c=[];for(t=0;t<7;t++)a=h([2e3,1]).day(t),s=ce(this.weekdaysMin(a,"")),r=ce(this.weekdaysShort(a,"")),i=ce(this.weekdays(a,"")),n.push(s),l.push(r),o.push(i),c.push(s),c.push(r),c.push(i);n.sort(e),l.sort(e),o.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+n.join("|")+")","i")}function st(){return this.hours()%12||12}function rt(e,t){L(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function it(e,t){return t._meridiemParse}L("H",["HH",2],0,"hour"),L("h",["hh",2],0,st),L("k",["kk",2],0,(function(){return this.hours()||24})),L("hmm",0,0,(function(){return""+st.apply(this)+A(this.minutes(),2)})),L("hmmss",0,0,(function(){return""+st.apply(this)+A(this.minutes(),2)+A(this.seconds(),2)})),L("Hmm",0,0,(function(){return""+this.hours()+A(this.minutes(),2)})),L("Hmmss",0,0,(function(){return""+this.hours()+A(this.minutes(),2)+A(this.seconds(),2)})),rt("a",!0),rt("A",!1),le("a",it),le("A",it),le("H",$,ne),le("h",$,ie),le("k",$,ie),le("HH",$,H),le("hh",$,H),le("kk",$,H),le("hmm",q),le("hmmss",J),le("Hmm",q),le("Hmmss",J),fe(["H","HH"],ye),fe(["k","kk"],(function(e,t,a){var s=ue(e);t[ye]=24===s?0:s})),fe(["a","A"],(function(e,t,a){a._isPm=a._locale.isPM(e),a._meridiem=e})),fe(["h","hh"],(function(e,t,a){t[ye]=ue(e),f(a).bigHour=!0})),fe("hmm",(function(e,t,a){var s=e.length-2;t[ye]=ue(e.substr(0,s)),t[Se]=ue(e.substr(s)),f(a).bigHour=!0})),fe("hmmss",(function(e,t,a){var s=e.length-4,r=e.length-2;t[ye]=ue(e.substr(0,s)),t[Se]=ue(e.substr(s,2)),t[we]=ue(e.substr(r)),f(a).bigHour=!0})),fe("Hmm",(function(e,t,a){var s=e.length-2;t[ye]=ue(e.substr(0,s)),t[Se]=ue(e.substr(s))})),fe("Hmmss",(function(e,t,a){var s=e.length-4,r=e.length-2;t[ye]=ue(e.substr(0,s)),t[Se]=ue(e.substr(s,2)),t[we]=ue(e.substr(r))}));var nt=Ae("Hours",!0);var lt,ot={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Oe,monthsShort:Le,week:{dow:0,doy:6},weekdays:qe,weekdaysMin:Xe,weekdaysShort:Je,meridiemParse:/[ap]\.?m?\.?/i},ct={},dt={};function ut(e,t){var a,s=Math.min(e.length,t.length);for(a=0;a<s;a+=1)if(e[a]!==t[a])return a;return s}function ht(e){return e?e.toLowerCase().replace("_","-"):e}function ft(e){var t=null;if(void 0===ct[e]&&zs&&zs.exports&&function(e){return!(!e||!e.match("^[^/\\\\]*$"))}(e))try{t=lt._abbr,F("./locale/"+e),mt(t)}catch(a){ct[e]=null}return ct[e]}function mt(e,t){var a;return e&&((a=l(t)?vt(e):pt(e,t))?lt=a:"undefined"!=typeof console&&console.warn),lt._abbr}function pt(e,t){if(null!==t){var a,s=ot;if(t.abbr=e,null!=ct[e])D("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=ct[e]._config;else if(null!=t.parentLocale)if(null!=ct[t.parentLocale])s=ct[t.parentLocale]._config;else{if(null==(a=ft(t.parentLocale)))return dt[t.parentLocale]||(dt[t.parentLocale]=[]),dt[t.parentLocale].push({name:e,config:t}),null;s=a._config}return ct[e]=new N(E(s,t)),dt[e]&&dt[e].forEach((function(e){pt(e.name,e.config)})),mt(e),ct[e]}return delete ct[e],null}function vt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return lt;if(!s(e)){if(t=ft(e))return t;e=[e]}return function(e){for(var t,a,s,r,i=0;i<e.length;){for(t=(r=ht(e[i]).split("-")).length,a=(a=ht(e[i+1]))?a.split("-"):null;t>0;){if(s=ft(r.slice(0,t).join("-")))return s;if(a&&a.length>=t&&ut(r,a)>=t-1)break;t--}i++}return lt}(e)}function gt(e){var t,a=e._a;return a&&-2===f(e).overflow&&(t=a[be]<0||a[be]>11?be:a[xe]<1||a[xe]>_e(a[ge],a[be])?xe:a[ye]<0||a[ye]>24||24===a[ye]&&(0!==a[Se]||0!==a[we]||0!==a[Te])?ye:a[Se]<0||a[Se]>59?Se:a[we]<0||a[we]>59?we:a[Te]<0||a[Te]>999?Te:-1,f(e)._overflowDayOfYear&&(t<ge||t>xe)&&(t=xe),f(e)._overflowWeeks&&-1===t&&(t=ke),f(e)._overflowWeekday&&-1===t&&(t=De),f(e).overflow=t),e}var bt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,xt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yt=/Z|[+-]\d\d(?::?\d\d)?/,St=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],wt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Tt=/^\/?Date\((-?\d+)/i,kt=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Dt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ct(e){var t,a,s,r,i,n,l=e._i,o=bt.exec(l)||xt.exec(l),c=St.length,d=wt.length;if(o){for(f(e).iso=!0,t=0,a=c;t<a;t++)if(St[t][1].exec(o[1])){r=St[t][0],s=!1!==St[t][2];break}if(null==r)return void(e._isValid=!1);if(o[3]){for(t=0,a=d;t<a;t++)if(wt[t][1].exec(o[3])){i=(o[2]||" ")+wt[t][0];break}if(null==i)return void(e._isValid=!1)}if(!s&&null!=i)return void(e._isValid=!1);if(o[4]){if(!yt.exec(o[4]))return void(e._isValid=!1);n="Z"}e._f=r+(i||"")+(n||""),jt(e)}else e._isValid=!1}function Et(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Nt(e){var t,a,s,r,i,n,l,o,c=kt.exec(e._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(c){if(a=c[4],s=c[3],r=c[2],i=c[5],n=c[6],l=c[7],o=[Et(a),Le.indexOf(s),parseInt(r,10),parseInt(i,10),parseInt(n,10)],l&&o.push(parseInt(l,10)),t=o,!function(e,t,a){return!e||Je.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(f(a).weekdayMismatch=!0,a._isValid=!1,!1)}(c[1],t,e))return;e._a=t,e._tzm=function(e,t,a){if(e)return Dt[e];if(t)return 0;var s=parseInt(a,10),r=s%100;return(s-r)/100*60+r}(c[8],c[9],c[10]),e._d=We.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),f(e).rfc2822=!0}else e._isValid=!1}function At(e,t,a){return null!=e?e:null!=t?t:a}function It(e){var t,s,r,i,n,l=[];if(!e._d){for(r=function(e){var t=new Date(a.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}(e),e._w&&null==e._a[xe]&&null==e._a[be]&&function(e){var t,a,s,r,i,n,l,o,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(i=1,n=4,a=At(t.GG,e._a[ge],Ye(Lt(),1,4).year),s=At(t.W,1),((r=At(t.E,1))<1||r>7)&&(o=!0)):(i=e._locale._week.dow,n=e._locale._week.doy,c=Ye(Lt(),i,n),a=At(t.gg,e._a[ge],c.year),s=At(t.w,c.week),null!=t.d?((r=t.d)<0||r>6)&&(o=!0):null!=t.e?(r=t.e+i,(t.e<0||t.e>6)&&(o=!0)):r=i),s<1||s>Ke(a,i,n)?f(e)._overflowWeeks=!0:null!=o?f(e)._overflowWeekday=!0:(l=ze(a,s,r,i,n),e._a[ge]=l.year,e._dayOfYear=l.dayOfYear)}(e),null!=e._dayOfYear&&(n=At(e._a[ge],r[ge]),(e._dayOfYear>Ce(n)||0===e._dayOfYear)&&(f(e)._overflowDayOfYear=!0),s=We(n,0,e._dayOfYear),e._a[be]=s.getUTCMonth(),e._a[xe]=s.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=l[t]=r[t];for(;t<7;t++)e._a[t]=l[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ye]&&0===e._a[Se]&&0===e._a[we]&&0===e._a[Te]&&(e._nextDay=!0,e._a[ye]=0),e._d=(e._useUTC?We:Ve).apply(null,l),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ye]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(f(e).weekdayMismatch=!0)}}function jt(e){if(e._f!==a.ISO_8601)if(e._f!==a.RFC_2822){e._a=[],f(e).empty=!0;var t,s,r,i,n,l,o,c=""+e._i,d=c.length,u=0;for(o=(r=R(e._f,e._locale).match(I)||[]).length,t=0;t<o;t++)i=r[t],(s=(c.match(oe(i,e))||[])[0])&&((n=c.substr(0,c.indexOf(s))).length>0&&f(e).unusedInput.push(n),c=c.slice(c.indexOf(s)+s.length),u+=s.length),O[i]?(s?f(e).empty=!1:f(e).unusedTokens.push(i),pe(i,s,e)):e._strict&&!s&&f(e).unusedTokens.push(i);f(e).charsLeftOver=d-u,c.length>0&&f(e).unusedInput.push(c),e._a[ye]<=12&&!0===f(e).bigHour&&e._a[ye]>0&&(f(e).bigHour=void 0),f(e).parsedDateParts=e._a.slice(0),f(e).meridiem=e._meridiem,e._a[ye]=(h=e._locale,m=e._a[ye],null==(p=e._meridiem)?m:null!=h.meridiemHour?h.meridiemHour(m,p):null!=h.isPM?((v=h.isPM(p))&&m<12&&(m+=12),v||12!==m||(m=0),m):m),null!==(l=f(e).era)&&(e._a[ge]=e._locale.erasConvertYear(l,e._a[ge])),It(e),gt(e)}else Nt(e);else Ct(e);var h,m,p,v}function _t(e){var t=e._i,i=e._f;return e._locale=e._locale||vt(e._l),null===t||void 0===i&&""===t?p({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new x(gt(t)):(c(t)?e._d=t:s(i)?function(e){var t,a,s,r,i,n,l=!1,o=e._f.length;if(0===o)return f(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<o;r++)i=0,n=!1,t=b({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],jt(t),m(t)&&(n=!0),i+=f(t).charsLeftOver,i+=10*f(t).unusedTokens.length,f(t).score=i,l?i<s&&(s=i,a=t):(null==s||i<s||n)&&(s=i,a=t,n&&(l=!0));u(e,a||t)}(e):i?jt(e):function(e){var t=e._i;l(t)?e._d=new Date(a.now()):c(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=Tt.exec(e._i);null===t?(Ct(e),!1===e._isValid&&(delete e._isValid,Nt(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:a.createFromInputFallback(e)))):e._d=new Date(+t[1])}(e):s(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),It(e)):r(t)?function(e){if(!e._d){var t=B(e._i),a=void 0===t.day?t.date:t.day;e._a=d([t.year,t.month,a,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),It(e)}}(e):o(t)?e._d=new Date(t):a.createFromInputFallback(e)}(e),m(e)||(e._d=null),e))}function Ot(e,t,a,i,l){var o,c={};return!0!==t&&!1!==t||(i=t,t=void 0),!0!==a&&!1!==a||(i=a,a=void 0),(r(e)&&n(e)||s(e)&&0===e.length)&&(e=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=l,c._l=a,c._i=e,c._f=t,c._strict=i,(o=new x(gt(_t(c))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function Lt(e,t,a,s){return Ot(e,t,a,s,!1)}a.createFromInputFallback=w("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),a.ISO_8601=function(){},a.RFC_2822=function(){};var Ft=w("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Lt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:p()})),Mt=w("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Lt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:p()}));function Rt(e,t){var a,r;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return Lt();for(a=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](a)||(a=t[r]);return a}var Pt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Ut(e){var t=B(e),a=t.year||0,s=t.quarter||0,r=t.month||0,n=t.week||t.isoWeek||0,l=t.day||0,o=t.hour||0,c=t.minute||0,d=t.second||0,u=t.millisecond||0;this._isValid=function(e){var t,a,s=!1,r=Pt.length;for(t in e)if(i(e,t)&&(-1===Ee.call(Pt,t)||null!=e[t]&&isNaN(e[t])))return!1;for(a=0;a<r;++a)if(e[Pt[a]]){if(s)return!1;parseFloat(e[Pt[a]])!==ue(e[Pt[a]])&&(s=!0)}return!0}(t),this._milliseconds=+u+1e3*d+6e4*c+1e3*o*60*60,this._days=+l+7*n,this._months=+r+3*s+12*a,this._data={},this._locale=vt(),this._bubble()}function Bt(e){return e instanceof Ut}function Gt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Vt(e,t){L(e,0,0,(function(){var e=this.utcOffset(),a="+";return e<0&&(e=-e,a="-"),a+A(~~(e/60),2)+t+A(~~e%60,2)}))}Vt("Z",":"),Vt("ZZ",""),le("Z",se),le("ZZ",se),fe(["Z","ZZ"],(function(e,t,a){a._useUTC=!0,a._tzm=Ht(se,e)}));var Wt=/([\+\-]|\d\d)/gi;function Ht(e,t){var a,s,r=(t||"").match(e);return null===r?null:0===(s=60*(a=((r[r.length-1]||[])+"").match(Wt)||["-",0,0])[1]+ue(a[2]))?0:"+"===a[0]?s:-s}function zt(e,t){var s,r;return t._isUTC?(s=t.clone(),r=(y(e)||c(e)?e.valueOf():Lt(e).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+r),a.updateOffset(s,!1),s):Lt(e).local()}function Yt(e){return-Math.round(e._d.getTimezoneOffset())}function Kt(){return!!this.isValid()&&this._isUTC&&0===this._offset}a.updateOffset=function(){};var $t=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,qt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Jt(e,t){var a,s,r,n,l,c,d=e,u=null;return Bt(e)?d={ms:e._milliseconds,d:e._days,M:e._months}:o(e)||!isNaN(+e)?(d={},t?d[t]=+e:d.milliseconds=+e):(u=$t.exec(e))?(a="-"===u[1]?-1:1,d={y:0,d:ue(u[xe])*a,h:ue(u[ye])*a,m:ue(u[Se])*a,s:ue(u[we])*a,ms:ue(Gt(1e3*u[Te]))*a}):(u=qt.exec(e))?(a="-"===u[1]?-1:1,d={y:Xt(u[2],a),M:Xt(u[3],a),w:Xt(u[4],a),d:Xt(u[5],a),h:Xt(u[6],a),m:Xt(u[7],a),s:Xt(u[8],a)}):null==d?d={}:"object"==typeof d&&("from"in d||"to"in d)&&(n=Lt(d.from),l=Lt(d.to),r=n.isValid()&&l.isValid()?(l=zt(l,n),n.isBefore(l)?c=Zt(n,l):((c=Zt(l,n)).milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0},(d={}).ms=r.milliseconds,d.M=r.months),s=new Ut(d),Bt(e)&&i(e,"_locale")&&(s._locale=e._locale),Bt(e)&&i(e,"_isValid")&&(s._isValid=e._isValid),s}function Xt(e,t){var a=e&&parseFloat(e.replace(",","."));return(isNaN(a)?0:a)*t}function Zt(e,t){var a={};return a.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(a.months,"M").isAfter(t)&&--a.months,a.milliseconds=+t-+e.clone().add(a.months,"M"),a}function Qt(e,t){return function(a,s){var r;return null===s||isNaN(+s)||(D(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=a,a=s,s=r),ea(this,Jt(a,s),e),this}}function ea(e,t,s,r){var i=t._milliseconds,n=Gt(t._days),l=Gt(t._months);e.isValid()&&(r=null==r||r,l&&Ue(e,Ie(e,"Month")+l*s),n&&je(e,"Date",Ie(e,"Date")+n*s),i&&e._d.setTime(e._d.valueOf()+i*s),r&&a.updateOffset(e,n||l))}Jt.fn=Ut.prototype,Jt.invalid=function(){return Jt(NaN)};var ta=Qt(1,"add"),aa=Qt(-1,"subtract");function sa(e){return"string"==typeof e||e instanceof String}function ra(e){return y(e)||c(e)||sa(e)||o(e)||function(e){var t=s(e),a=!1;return t&&(a=0===e.filter((function(t){return!o(t)&&sa(e)})).length),t&&a}(e)||function(e){var t,a,s=r(e)&&!n(e),l=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],c=o.length;for(t=0;t<c;t+=1)a=o[t],l=l||i(e,a);return s&&l}(e)||null==e}function ia(e,t){if(e.date()<t.date())return-ia(t,e);var a=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(a,"months");return-(a+(t-s<0?(t-s)/(s-e.clone().add(a-1,"months")):(t-s)/(e.clone().add(a+1,"months")-s)))||0}function na(e){var t;return void 0===e?this._locale._abbr:(null!=(t=vt(e))&&(this._locale=t),this)}a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",a.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var la=w("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function oa(){return this._locale}var ca=1e3,da=6e4,ua=36e5,ha=126227808e5;function fa(e,t){return(e%t+t)%t}function ma(e,t,a){return e<100&&e>=0?new Date(e+400,t,a)-ha:new Date(e,t,a).valueOf()}function pa(e,t,a){return e<100&&e>=0?Date.UTC(e+400,t,a)-ha:Date.UTC(e,t,a)}function va(e,t){return t.erasAbbrRegex(e)}function ga(){var e,t,a,s,r,i=[],n=[],l=[],o=[],c=this.eras();for(e=0,t=c.length;e<t;++e)a=ce(c[e].name),s=ce(c[e].abbr),r=ce(c[e].narrow),n.push(a),i.push(s),l.push(r),o.push(a),o.push(s),o.push(r);this._erasRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+l.join("|")+")","i")}function ba(e,t){L(0,[e,e.length],0,t)}function xa(e,t,a,s,r){var i;return null==e?Ye(this,s,r).year:(t>(i=Ke(e,s,r))&&(t=i),ya.call(this,e,t,a,s,r))}function ya(e,t,a,s,r){var i=ze(e,t,a,s,r),n=We(i.year,0,i.dayOfYear);return this.year(n.getUTCFullYear()),this.month(n.getUTCMonth()),this.date(n.getUTCDate()),this}L("N",0,0,"eraAbbr"),L("NN",0,0,"eraAbbr"),L("NNN",0,0,"eraAbbr"),L("NNNN",0,0,"eraName"),L("NNNNN",0,0,"eraNarrow"),L("y",["y",1],"yo","eraYear"),L("y",["yy",2],0,"eraYear"),L("y",["yyy",3],0,"eraYear"),L("y",["yyyy",4],0,"eraYear"),le("N",va),le("NN",va),le("NNN",va),le("NNNN",(function(e,t){return t.erasNameRegex(e)})),le("NNNNN",(function(e,t){return t.erasNarrowRegex(e)})),fe(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,a,s){var r=a._locale.erasParse(e,s,a._strict);r?f(a).era=r:f(a).invalidEra=e})),le("y",ee),le("yy",ee),le("yyy",ee),le("yyyy",ee),le("yo",(function(e,t){return t._eraYearOrdinalRegex||ee})),fe(["y","yy","yyy","yyyy"],ge),fe(["yo"],(function(e,t,a,s){var r;a._locale._eraYearOrdinalRegex&&(r=e.match(a._locale._eraYearOrdinalRegex)),a._locale.eraYearOrdinalParse?t[ge]=a._locale.eraYearOrdinalParse(e,r):t[ge]=parseInt(e,10)})),L(0,["gg",2],0,(function(){return this.weekYear()%100})),L(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),ba("gggg","weekYear"),ba("ggggg","weekYear"),ba("GGGG","isoWeekYear"),ba("GGGGG","isoWeekYear"),le("G",te),le("g",te),le("GG",$,H),le("gg",$,H),le("GGGG",Z,Y),le("gggg",Z,Y),le("GGGGG",Q,K),le("ggggg",Q,K),me(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,a,s){t[s.substr(0,2)]=ue(e)})),me(["gg","GG"],(function(e,t,s,r){t[r]=a.parseTwoDigitYear(e)})),L("Q",0,"Qo","quarter"),le("Q",W),fe("Q",(function(e,t){t[be]=3*(ue(e)-1)})),L("D",["DD",2],"Do","date"),le("D",$,ie),le("DD",$,H),le("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),fe(["D","DD"],xe),fe("Do",(function(e,t){t[xe]=ue(e.match($)[0])}));var Sa=Ae("Date",!0);L("DDD",["DDDD",3],"DDDo","dayOfYear"),le("DDD",X),le("DDDD",z),fe(["DDD","DDDD"],(function(e,t,a){a._dayOfYear=ue(e)})),L("m",["mm",2],0,"minute"),le("m",$,ne),le("mm",$,H),fe(["m","mm"],Se);var wa=Ae("Minutes",!1);L("s",["ss",2],0,"second"),le("s",$,ne),le("ss",$,H),fe(["s","ss"],we);var Ta,ka,Da=Ae("Seconds",!1);for(L("S",0,0,(function(){return~~(this.millisecond()/100)})),L(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),L(0,["SSS",3],0,"millisecond"),L(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),L(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),L(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),L(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),L(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),L(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),le("S",X,W),le("SS",X,H),le("SSS",X,z),Ta="SSSS";Ta.length<=9;Ta+="S")le(Ta,ee);function Ca(e,t){t[Te]=ue(1e3*("0."+e))}for(Ta="S";Ta.length<=9;Ta+="S")fe(Ta,Ca);ka=Ae("Milliseconds",!1),L("z",0,0,"zoneAbbr"),L("zz",0,0,"zoneName");var Ea=x.prototype;function Na(e){return e}Ea.add=ta,Ea.calendar=function(e,t){1===arguments.length&&(arguments[0]?ra(arguments[0])?(e=arguments[0],t=void 0):function(e){var t,a=r(e)&&!n(e),s=!1,l=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<l.length;t+=1)s=s||i(e,l[t]);return a&&s}(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var s=e||Lt(),l=zt(s,this).startOf("day"),o=a.calendarFormat(this,l)||"sameElse",c=t&&(C(t[o])?t[o].call(this,s):t[o]);return this.format(c||this.localeData().calendar(o,this,Lt(s)))},Ea.clone=function(){return new x(this)},Ea.diff=function(e,t,a){var s,r,i;if(!this.isValid())return NaN;if(!(s=zt(e,this)).isValid())return NaN;switch(r=6e4*(s.utcOffset()-this.utcOffset()),t=U(t)){case"year":i=ia(this,s)/12;break;case"month":i=ia(this,s);break;case"quarter":i=ia(this,s)/3;break;case"second":i=(this-s)/1e3;break;case"minute":i=(this-s)/6e4;break;case"hour":i=(this-s)/36e5;break;case"day":i=(this-s-r)/864e5;break;case"week":i=(this-s-r)/6048e5;break;default:i=this-s}return a?i:de(i)},Ea.endOf=function(e){var t,s;if(void 0===(e=U(e))||"millisecond"===e||!this.isValid())return this;switch(s=this._isUTC?pa:ma,e){case"year":t=s(this.year()+1,0,1)-1;break;case"quarter":t=s(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=s(this.year(),this.month()+1,1)-1;break;case"week":t=s(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=s(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=ua-fa(t+(this._isUTC?0:this.utcOffset()*da),ua)-1;break;case"minute":t=this._d.valueOf(),t+=da-fa(t,da)-1;break;case"second":t=this._d.valueOf(),t+=ca-fa(t,ca)-1}return this._d.setTime(t),a.updateOffset(this,!0),this},Ea.format=function(e){e||(e=this.isUtc()?a.defaultFormatUtc:a.defaultFormat);var t=M(this,e);return this.localeData().postformat(t)},Ea.from=function(e,t){return this.isValid()&&(y(e)&&e.isValid()||Lt(e).isValid())?Jt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Ea.fromNow=function(e){return this.from(Lt(),e)},Ea.to=function(e,t){return this.isValid()&&(y(e)&&e.isValid()||Lt(e).isValid())?Jt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Ea.toNow=function(e){return this.to(Lt(),e)},Ea.get=function(e){return C(this[e=U(e)])?this[e]():this},Ea.invalidAt=function(){return f(this).overflow},Ea.isAfter=function(e,t){var a=y(e)?e:Lt(e);return!(!this.isValid()||!a.isValid())&&("millisecond"===(t=U(t)||"millisecond")?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(t).valueOf())},Ea.isBefore=function(e,t){var a=y(e)?e:Lt(e);return!(!this.isValid()||!a.isValid())&&("millisecond"===(t=U(t)||"millisecond")?this.valueOf()<a.valueOf():this.clone().endOf(t).valueOf()<a.valueOf())},Ea.isBetween=function(e,t,a,s){var r=y(e)?e:Lt(e),i=y(t)?t:Lt(t);return!!(this.isValid()&&r.isValid()&&i.isValid())&&("("===(s=s||"()")[0]?this.isAfter(r,a):!this.isBefore(r,a))&&(")"===s[1]?this.isBefore(i,a):!this.isAfter(i,a))},Ea.isSame=function(e,t){var a,s=y(e)?e:Lt(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=U(t)||"millisecond")?this.valueOf()===s.valueOf():(a=s.valueOf(),this.clone().startOf(t).valueOf()<=a&&a<=this.clone().endOf(t).valueOf()))},Ea.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},Ea.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},Ea.isValid=function(){return m(this)},Ea.lang=la,Ea.locale=na,Ea.localeData=oa,Ea.max=Mt,Ea.min=Ft,Ea.parsingFlags=function(){return u({},f(this))},Ea.set=function(e,t){if("object"==typeof e){var a,s=function(e){var t,a=[];for(t in e)i(e,t)&&a.push({unit:t,priority:G[t]});return a.sort((function(e,t){return e.priority-t.priority})),a}(e=B(e)),r=s.length;for(a=0;a<r;a++)this[s[a].unit](e[s[a].unit])}else if(C(this[e=U(e)]))return this[e](t);return this},Ea.startOf=function(e){var t,s;if(void 0===(e=U(e))||"millisecond"===e||!this.isValid())return this;switch(s=this._isUTC?pa:ma,e){case"year":t=s(this.year(),0,1);break;case"quarter":t=s(this.year(),this.month()-this.month()%3,1);break;case"month":t=s(this.year(),this.month(),1);break;case"week":t=s(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=s(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=s(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fa(t+(this._isUTC?0:this.utcOffset()*da),ua);break;case"minute":t=this._d.valueOf(),t-=fa(t,da);break;case"second":t=this._d.valueOf(),t-=fa(t,ca)}return this._d.setTime(t),a.updateOffset(this,!0),this},Ea.subtract=aa,Ea.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},Ea.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},Ea.toDate=function(){return new Date(this.valueOf())},Ea.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,a=t?this.clone().utc():this;return a.year()<0||a.year()>9999?M(a,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):C(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",M(a,"Z")):M(a,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Ea.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,a,s="moment",r="";return this.isLocal()||(s=0===this.utcOffset()?"moment.utc":"moment.parseZone",r="Z"),e="["+s+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a=r+'[")]',this.format(e+t+"-MM-DD[T]HH:mm:ss.SSS"+a)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(Ea[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Ea.toJSON=function(){return this.isValid()?this.toISOString():null},Ea.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Ea.unix=function(){return Math.floor(this.valueOf()/1e3)},Ea.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Ea.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Ea.eraName=function(){var e,t,a,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until)return s[e].name;if(s[e].until<=a&&a<=s[e].since)return s[e].name}return""},Ea.eraNarrow=function(){var e,t,a,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until)return s[e].narrow;if(s[e].until<=a&&a<=s[e].since)return s[e].narrow}return""},Ea.eraAbbr=function(){var e,t,a,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(a=this.clone().startOf("day").valueOf(),s[e].since<=a&&a<=s[e].until)return s[e].abbr;if(s[e].until<=a&&a<=s[e].since)return s[e].abbr}return""},Ea.eraYear=function(){var e,t,s,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e)if(s=i[e].since<=i[e].until?1:-1,r=this.clone().startOf("day").valueOf(),i[e].since<=r&&r<=i[e].until||i[e].until<=r&&r<=i[e].since)return(this.year()-a(i[e].since).year())*s+i[e].offset;return this.year()},Ea.year=Ne,Ea.isLeapYear=function(){return ve(this.year())},Ea.weekYear=function(e){return xa.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)},Ea.isoWeekYear=function(e){return xa.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},Ea.quarter=Ea.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Ea.month=Be,Ea.daysInMonth=function(){return _e(this.year(),this.month())},Ea.week=Ea.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},Ea.isoWeek=Ea.isoWeeks=function(e){var t=Ye(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},Ea.weeksInYear=function(){var e=this.localeData()._week;return Ke(this.year(),e.dow,e.doy)},Ea.weeksInWeekYear=function(){var e=this.localeData()._week;return Ke(this.weekYear(),e.dow,e.doy)},Ea.isoWeeksInYear=function(){return Ke(this.year(),1,4)},Ea.isoWeeksInISOWeekYear=function(){return Ke(this.isoWeekYear(),1,4)},Ea.date=Sa,Ea.day=Ea.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=Ie(this,"Day");return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},Ea.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},Ea.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},Ea.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},Ea.hour=Ea.hours=nt,Ea.minute=Ea.minutes=wa,Ea.second=Ea.seconds=Da,Ea.millisecond=Ea.milliseconds=ka,Ea.utcOffset=function(e,t,s){var r,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ht(se,e)))return this}else Math.abs(e)<16&&!s&&(e*=60);return!this._isUTC&&t&&(r=Yt(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?ea(this,Jt(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:Yt(this)},Ea.utc=function(e){return this.utcOffset(0,e)},Ea.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Yt(this),"m")),this},Ea.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ht(ae,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},Ea.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Lt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},Ea.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Ea.isLocal=function(){return!!this.isValid()&&!this._isUTC},Ea.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Ea.isUtc=Kt,Ea.isUTC=Kt,Ea.zoneAbbr=function(){return this._isUTC?"UTC":""},Ea.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Ea.dates=w("dates accessor is deprecated. Use date instead.",Sa),Ea.months=w("months accessor is deprecated. Use month instead",Be),Ea.years=w("years accessor is deprecated. Use year instead",Ne),Ea.zone=w("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),Ea.isDSTShifted=w("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e,t={};return b(t,this),(t=_t(t))._a?(e=t._isUTC?h(t._a):Lt(t._a),this._isDSTShifted=this.isValid()&&function(e,t,a){var s,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),n=0;for(s=0;s<r;s++)(a&&e[s]!==t[s]||!a&&ue(e[s])!==ue(t[s]))&&n++;return n+i}(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}));var Aa=N.prototype;function Ia(e,t,a,s){var r=vt(),i=h().set(s,t);return r[a](i,e)}function ja(e,t,a){if(o(e)&&(t=e,e=void 0),e=e||"",null!=t)return Ia(e,t,a,"month");var s,r=[];for(s=0;s<12;s++)r[s]=Ia(e,s,a,"month");return r}function _a(e,t,a,s){"boolean"==typeof e?(o(t)&&(a=t,t=void 0),t=t||""):(a=t=e,e=!1,o(t)&&(a=t,t=void 0),t=t||"");var r,i=vt(),n=e?i._week.dow:0,l=[];if(null!=a)return Ia(t,(a+n)%7,s,"day");for(r=0;r<7;r++)l[r]=Ia(t,(r+n)%7,s,"day");return l}Aa.calendar=function(e,t,a){var s=this._calendar[e]||this._calendar.sameElse;return C(s)?s.call(t,a):s},Aa.longDateFormat=function(e){var t=this._longDateFormat[e],a=this._longDateFormat[e.toUpperCase()];return t||!a?t:(this._longDateFormat[e]=a.match(I).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])},Aa.invalidDate=function(){return this._invalidDate},Aa.ordinal=function(e){return this._ordinal.replace("%d",e)},Aa.preparse=Na,Aa.postformat=Na,Aa.relativeTime=function(e,t,a,s){var r=this._relativeTime[a];return C(r)?r(e,t,a,s):r.replace(/%d/i,e)},Aa.pastFuture=function(e,t){var a=this._relativeTime[e>0?"future":"past"];return C(a)?a(t):a.replace(/%s/i,t)},Aa.set=function(e){var t,a;for(a in e)i(e,a)&&(C(t=e[a])?this[a]=t:this["_"+a]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Aa.eras=function(e,t){var s,r,i,n=this._eras||vt("en")._eras;for(s=0,r=n.length;s<r;++s)switch("string"==typeof n[s].since&&(i=a(n[s].since).startOf("day"),n[s].since=i.valueOf()),typeof n[s].until){case"undefined":n[s].until=1/0;break;case"string":i=a(n[s].until).startOf("day").valueOf(),n[s].until=i.valueOf()}return n},Aa.erasParse=function(e,t,a){var s,r,i,n,l,o=this.eras();for(e=e.toUpperCase(),s=0,r=o.length;s<r;++s)if(i=o[s].name.toUpperCase(),n=o[s].abbr.toUpperCase(),l=o[s].narrow.toUpperCase(),a)switch(t){case"N":case"NN":case"NNN":if(n===e)return o[s];break;case"NNNN":if(i===e)return o[s];break;case"NNNNN":if(l===e)return o[s]}else if([i,n,l].indexOf(e)>=0)return o[s]},Aa.erasConvertYear=function(e,t){var s=e.since<=e.until?1:-1;return void 0===t?a(e.since).year():a(e.since).year()+(t-e.offset)*s},Aa.erasAbbrRegex=function(e){return i(this,"_erasAbbrRegex")||ga.call(this),e?this._erasAbbrRegex:this._erasRegex},Aa.erasNameRegex=function(e){return i(this,"_erasNameRegex")||ga.call(this),e?this._erasNameRegex:this._erasRegex},Aa.erasNarrowRegex=function(e){return i(this,"_erasNarrowRegex")||ga.call(this),e?this._erasNarrowRegex:this._erasRegex},Aa.months=function(e,t){return e?s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Fe).test(t)?"format":"standalone"][e.month()]:s(this._months)?this._months:this._months.standalone},Aa.monthsShort=function(e,t){return e?s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Fe.test(t)?"format":"standalone"][e.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Aa.monthsParse=function(e,t,a){var s,r,i;if(this._monthsParseExact)return Pe.call(this,e,t,a);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(r=h([2e3,s]),a&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),a||this._monthsParse[s]||(i="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[s]=new RegExp(i.replace(".",""),"i")),a&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(a&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!a&&this._monthsParse[s].test(e))return s}},Aa.monthsRegex=function(e){return this._monthsParseExact?(i(this,"_monthsRegex")||Ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(i(this,"_monthsRegex")||(this._monthsRegex=Re),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Aa.monthsShortRegex=function(e){return this._monthsParseExact?(i(this,"_monthsRegex")||Ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(i(this,"_monthsShortRegex")||(this._monthsShortRegex=Me),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Aa.week=function(e){return Ye(e,this._week.dow,this._week.doy).week},Aa.firstDayOfYear=function(){return this._week.doy},Aa.firstDayOfWeek=function(){return this._week.dow},Aa.weekdays=function(e,t){var a=s(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?$e(a,this._week.dow):e?a[e.day()]:a},Aa.weekdaysMin=function(e){return!0===e?$e(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Aa.weekdaysShort=function(e){return!0===e?$e(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Aa.weekdaysParse=function(e,t,a){var s,r,i;if(this._weekdaysParseExact)return tt.call(this,e,t,a);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(r=h([2e3,1]).day(s),a&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(i="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[s]=new RegExp(i.replace(".",""),"i")),a&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(a&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(a&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!a&&this._weekdaysParse[s].test(e))return s}},Aa.weekdaysRegex=function(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||at.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(i(this,"_weekdaysRegex")||(this._weekdaysRegex=Ze),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Aa.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||at.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(i(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Qe),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Aa.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(i(this,"_weekdaysRegex")||at.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(i(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=et),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Aa.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Aa.meridiem=function(e,t,a){return e>11?a?"pm":"PM":a?"am":"AM"},mt("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===ue(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),a.lang=w("moment.lang is deprecated. Use moment.locale instead.",mt),a.langData=w("moment.langData is deprecated. Use moment.localeData instead.",vt);var Oa=Math.abs;function La(e,t,a,s){var r=Jt(t,a);return e._milliseconds+=s*r._milliseconds,e._days+=s*r._days,e._months+=s*r._months,e._bubble()}function Fa(e){return e<0?Math.floor(e):Math.ceil(e)}function Ma(e){return 4800*e/146097}function Ra(e){return 146097*e/4800}function Pa(e){return function(){return this.as(e)}}var Ua=Pa("ms"),Ba=Pa("s"),Ga=Pa("m"),Va=Pa("h"),Wa=Pa("d"),Ha=Pa("w"),za=Pa("M"),Ya=Pa("Q"),Ka=Pa("y"),$a=Ua;function qa(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ja=qa("milliseconds"),Xa=qa("seconds"),Za=qa("minutes"),Qa=qa("hours"),es=qa("days"),ts=qa("months"),as=qa("years");var ss=Math.round,rs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function is(e,t,a,s,r){return r.relativeTime(t||1,!!a,e,s)}var ns=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function os(){if(!this.isValid())return this.localeData().invalidDate();var e,t,a,s,r,i,n,l,o=ns(this._milliseconds)/1e3,c=ns(this._days),d=ns(this._months),u=this.asSeconds();return u?(e=de(o/60),t=de(e/60),o%=60,e%=60,a=de(d/12),d%=12,s=o?o.toFixed(3).replace(/\.?0+$/,""):"",r=u<0?"-":"",i=ls(this._months)!==ls(u)?"-":"",n=ls(this._days)!==ls(u)?"-":"",l=ls(this._milliseconds)!==ls(u)?"-":"",r+"P"+(a?i+a+"Y":"")+(d?i+d+"M":"")+(c?n+c+"D":"")+(t||e||o?"T":"")+(t?l+t+"H":"")+(e?l+e+"M":"")+(o?l+s+"S":"")):"P0D"}var cs=Ut.prototype;return cs.isValid=function(){return this._isValid},cs.abs=function(){var e=this._data;return this._milliseconds=Oa(this._milliseconds),this._days=Oa(this._days),this._months=Oa(this._months),e.milliseconds=Oa(e.milliseconds),e.seconds=Oa(e.seconds),e.minutes=Oa(e.minutes),e.hours=Oa(e.hours),e.months=Oa(e.months),e.years=Oa(e.years),this},cs.add=function(e,t){return La(this,e,t,1)},cs.subtract=function(e,t){return La(this,e,t,-1)},cs.as=function(e){if(!this.isValid())return NaN;var t,a,s=this._milliseconds;if("month"===(e=U(e))||"quarter"===e||"year"===e)switch(t=this._days+s/864e5,a=this._months+Ma(t),e){case"month":return a;case"quarter":return a/3;case"year":return a/12}else switch(t=this._days+Math.round(Ra(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},cs.asMilliseconds=Ua,cs.asSeconds=Ba,cs.asMinutes=Ga,cs.asHours=Va,cs.asDays=Wa,cs.asWeeks=Ha,cs.asMonths=za,cs.asQuarters=Ya,cs.asYears=Ka,cs.valueOf=$a,cs._bubble=function(){var e,t,a,s,r,i=this._milliseconds,n=this._days,l=this._months,o=this._data;return i>=0&&n>=0&&l>=0||i<=0&&n<=0&&l<=0||(i+=864e5*Fa(Ra(l)+n),n=0,l=0),o.milliseconds=i%1e3,e=de(i/1e3),o.seconds=e%60,t=de(e/60),o.minutes=t%60,a=de(t/60),o.hours=a%24,n+=de(a/24),l+=r=de(Ma(n)),n-=Fa(Ra(r)),s=de(l/12),l%=12,o.days=n,o.months=l,o.years=s,this},cs.clone=function(){return Jt(this)},cs.get=function(e){return e=U(e),this.isValid()?this[e+"s"]():NaN},cs.milliseconds=Ja,cs.seconds=Xa,cs.minutes=Za,cs.hours=Qa,cs.days=es,cs.weeks=function(){return de(this.days()/7)},cs.months=ts,cs.years=as,cs.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var a,s,r=!1,i=rs;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(r=e),"object"==typeof t&&(i=Object.assign({},rs,t),null!=t.s&&null==t.ss&&(i.ss=t.s-1)),s=function(e,t,a,s){var r=Jt(e).abs(),i=ss(r.as("s")),n=ss(r.as("m")),l=ss(r.as("h")),o=ss(r.as("d")),c=ss(r.as("M")),d=ss(r.as("w")),u=ss(r.as("y")),h=i<=a.ss&&["s",i]||i<a.s&&["ss",i]||n<=1&&["m"]||n<a.m&&["mm",n]||l<=1&&["h"]||l<a.h&&["hh",l]||o<=1&&["d"]||o<a.d&&["dd",o];return null!=a.w&&(h=h||d<=1&&["w"]||d<a.w&&["ww",d]),(h=h||c<=1&&["M"]||c<a.M&&["MM",c]||u<=1&&["y"]||["yy",u])[2]=t,h[3]=+e>0,h[4]=s,is.apply(null,h)}(this,!r,i,a=this.localeData()),r&&(s=a.pastFuture(+this,s)),a.postformat(s)},cs.toISOString=os,cs.toString=os,cs.toJSON=os,cs.locale=na,cs.localeData=oa,cs.toIsoString=w("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",os),cs.lang=la,L("X",0,0,"unix"),L("x",0,0,"valueOf"),le("x",te),le("X",/[+-]?\d+(\.\d{1,3})?/),fe("X",(function(e,t,a){a._d=new Date(1e3*parseFloat(e))})),fe("x",(function(e,t,a){a._d=new Date(ue(e))})),a.version="2.30.1",e=Lt,a.fn=Ea,a.min=function(){return Rt("isBefore",[].slice.call(arguments,0))},a.max=function(){return Rt("isAfter",[].slice.call(arguments,0))},a.now=function(){return Date.now?Date.now():+new Date},a.utc=h,a.unix=function(e){return Lt(1e3*e)},a.months=function(e,t){return ja(e,t,"months")},a.isDate=c,a.locale=mt,a.invalid=p,a.duration=Jt,a.isMoment=y,a.weekdays=function(e,t,a){return _a(e,t,a,"weekdays")},a.parseZone=function(){return Lt.apply(null,arguments).parseZone()},a.localeData=vt,a.isDuration=Bt,a.monthsShort=function(e,t){return ja(e,t,"monthsShort")},a.weekdaysMin=function(e,t,a){return _a(e,t,a,"weekdaysMin")},a.defineLocale=pt,a.updateLocale=function(e,t){if(null!=t){var a,s,r=ot;null!=ct[e]&&null!=ct[e].parentLocale?ct[e].set(E(ct[e]._config,t)):(null!=(s=ft(e))&&(r=s._config),t=E(r,t),null==s&&(t.abbr=e),(a=new N(t)).parentLocale=ct[e],ct[e]=a),mt(e)}else null!=ct[e]&&(null!=ct[e].parentLocale?(ct[e]=ct[e].parentLocale,e===mt()&&mt(e)):null!=ct[e]&&delete ct[e]);return ct[e]},a.locales=function(){return T(ct)},a.weekdaysShort=function(e,t,a){return _a(e,t,a,"weekdaysShort")},a.normalizeUnits=U,a.relativeTimeRounding=function(e){return void 0===e?ss:"function"==typeof e&&(ss=e,!0)},a.relativeTimeThreshold=function(e,t){return void 0!==rs[e]&&(void 0===t?rs[e]:(rs[e]=t,"s"===e&&(rs.ss=t-1),!0))},a.calendarFormat=function(e,t){var a=e.diff(t,"days",!0);return a<-6?"sameElse":a<-1?"lastWeek":a<0?"lastDay":a<1?"sameDay":a<2?"nextDay":a<7?"nextWeek":"sameElse"},a.prototype=Ea,a.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},a}();const Ks=E(Ys.exports),$s=new Date,qs=qa((e=>{const[t,a]=w.useState([]);return w.useEffect((()=>{ce({path:je,ok:e=>{if(1==e.status){let t=e.data;a(t)}},fail:e=>{}})}),[]),y.jsx(y.Fragment,{children:y.jsx("td",{children:y.jsxs(_e,{className:"float-end",children:[y.jsx(ke,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",onClick:()=>{e.editId(e.dataItem.id)}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",onClick:()=>{e.deleteId(e.dataItem.id)}})]})})})})),Js=S((e=class extends w.Component{constructor(){super(...arguments),x(this,"state",{platFormTypes:["Android phone","Android Tablet","iPhone","iPad"],isFieldTrack:!1,commonMsg:null,deviceList:[{friendlyName:null,deviceType:null,mobileApp:null,imageData:null,error:{errfriendlyName:null,errDeviceType:null,errMobileApp:null},fieldList:[]}],friendlyName:null,fieldTrackData:null,deviceType:null,mobileApp:null,mobileAppList:[],activationKey:0,showFormNameComponent:!1,formName:"",errFormName:null,fieldTrack_AppName:null,mobileAppFilterList:null,startDate:null,endDate:null,errStartDate:null,errEndDate:null,endDateMinValue:"",getEventData:null,showFormFiels:null,editShowCondition:!1,getAllData:"",editFieldTrack:null,controlsArray:null,controlsArrayCopy:null,formFieldShowCondition:!0}),x(this,"createDeviceList",(()=>({deviceType:null,mobileApp:this.state.mobileApp,error:{errfriendlyName:errfriendlyName,errDeviceType:null,errMobileApp:null},fieldList:[]}))),x(this,"createError",(()=>({errPlayStoreUrl:null,errLanguage:null,errWebUrl:null,errDeviceType:null}))),x(this,"getPlatformTypes",(()=>{let e=this.state.platFormTypes,t=[];return e.map((e=>{0===this.state.deviceList.filter((t=>e===t.deviceType)).length&&t.push(e)})),t})),x(this,"addBtnClick",(()=>{let e=Ga(this.state.deviceList);if(e.error){let t=[...this.state.deviceList];1===e.errType?t[e.errIndex].error.errDeviceType=e.errMsg:2===e.errType?t[e.errIndex].error.errMobileApp=e.errMsg:3===e.errType&&(this.setState({commonMsg:e.errMsg}),setTimeout((()=>{this.setState({commonMsg:null})}),2e3)),this.setState({deviceList:t})}else{let e=[...this.state.deviceList];e.push(this.createDeviceList()),this.accordinChanges(e.length-1),this.setState({deviceList:e})}})),x(this,"removeBtnClick",(e=>{let t=[...this.state.deviceList];t.splice(e,1),this.setState({deviceList:t})})),x(this,"valueChange",((e,t,a,s,r)=>{let i=[...this.state.deviceList];i[e][t]=a,i[e].error[s]=r,this.setState({deviceList:i})})),x(this,"getFriendlyName",((e,t,a,s,r)=>{let i=a.length>0?a:null,n=[...this.state.deviceList];n[e][t]=i,n[e].error[s]=r,this.setState({deviceList:n})})),x(this,"accordinChanges",(e=>{this.state.activationKey===e?this.setState({activationKey:"-1"}):this.setState({activationKey:e})})),x(this,"deleteFieldList",((e,t)=>{let a=this.state.deviceList[0];a.fieldList.splice(t,1),this.setState({deviceList:[a],elementArray:[a]});let s=[...this.state.controlsArray];null==s||s.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)}));let r=[...this.state.selectControls];null==r||r.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)})),this.setState({selectControls:r,controlsArray:s})})),x(this,"AddFormEvents",(e=>y.jsxs(Ta,{children:[y.jsxs("div",{className:"align-items-center d-flex mb10",children:[y.jsx("i",{className:"icon-rs-events-mini icon-sm color-primary-blue padding-R5"}),y.jsx("h4",{className:"mb-0 padding-L5",style:{paddingLeft:5},children:"Form fields"}),this.state.editShowCondition?y.jsx(ka,{md:1,children:y.jsx(Ka,{children:y.jsx(_e,{children:y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",iconColor:"blue",iconSize:"md",tooltip:"Field tracking",color:"blue",onClick:()=>{let e={appName:this.state.deviceList[0].mobileApp.appName,appId:this.state.deviceList[0].mobileApp.appGuid,deviceType:this.state.deviceList[0].deviceType,mode:"edit"};this.setState({isFieldTrack:!0,fieldTrackData:e,editFieldTrack:!0})}})})})}):null]}),this.state.deviceList[(null==e?void 0:e.index)||0].fieldList.length>0&&this.state.deviceList[(null==e?void 0:e.index)||0].fieldList.map(((e,t)=>{var a,s;return y.jsxs("div",{className:"DK-event-tracking-list",children:[y.jsxs("div",{className:"DK-event-section",children:[y.jsxs("div",{className:"DK-event-row",children:[y.jsx("span",{className:"DK-label-field",children:"Event name"}),y.jsx("span",{className:"DK-label-value",children:e.eventTracking.eventName})]}),(null==(a=e.eventTracking.trackingType)?void 0:a.displayName)?y.jsxs("div",{className:"DK-event-row",children:[y.jsx("span",{className:"DK-label-field",children:"Tracking action"}),y.jsx("span",{className:"DK-label-value",children:null==(s=e.eventTracking.trackingType)?void 0:s.displayName})]}):null]}),y.jsx("div",{className:"event-actions-form-icon",children:y.jsx("span",{children:y.jsx("i",{className:"icon-rs-delete-medium icons-md color-primary-blue cursor-pointer",onClick:()=>{this.deleteFieldList(e,t)}})})})]})}))]}))),x(this,"emptyDeviceList",(()=>{const e=[{friendlyName:"",mobileApp:sessionStorage.getItem("AppNameTracking")||null,deviceType:null,imageData:null,error:{errfriendlyName:null,errDeviceType:null,errMobileApp:null},fieldList:[]}];this.setState({deviceList:e,startDate:"",endDate:""})})),x(this,"getEventDetails",(()=>{ce({path:je,ok:e=>{if(1==e.status){let t=e.data;this.setState({getEventData:t})}},fail:e=>{}}),this.emptyDeviceList()})),x(this,"editFieldTrackData",(e=>{const t=JSON.parse(e).map((e=>({friendlyName:e.controls[0].friendlyName,deviceType:e.controls[0].deviceType,imageData:e.controls[0].imageData,mobileApp:{appName:e.controls[0].mobileApp.appName,appGuid:e.controls[0].mobileApp.appGuid,mpId:e.controls[0].mobileApp.mpId,playstoreURL:e.controls[0].mobileApp.playstoreURL},error:e.controls[0].error,fieldList:e.controls[0].fieldList.map((e=>({field:e.field,screenTracking:e.screenTracking,eventTracking:{eventName:e.eventTracking.eventName,eventDescription:e.eventTracking.eventDescription,markAsGoal:e.eventTracking.markAsGoal,trackingType:e.eventTracking.trackingType,mandadory:e.eventTracking.mandadory}})))})));this.setState({deviceList:t,showFormFiels:!0})})),x(this,"convertDate",(e=>{const t=new Date(e),a=new Date(t.getTime()+198e5);return a.toLocaleDateString("en-IN",{weekday:"short",year:"numeric",month:"long",day:"numeric"})+" "+a.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})+" GMT+0530 (India Standard Time) {}"})),x(this,"editFieldTrackData12",(e=>{var t,a,s,r,i,n,l,o,c,d,u,h,f;let m=JSON.parse(e.viewJson),p=null;p={friendlyName:null==(t=m[0])?void 0:t.friendlyName,deviceType:null==(a=m[0])?void 0:a.deviceType,imageData:null==(s=m[0])?void 0:s.imageData,mobileApp:{appName:null==(i=null==(r=m[0])?void 0:r.mobileApp)?void 0:i.appName,appGuid:null==(l=null==(n=m[0])?void 0:n.mobileApp)?void 0:l.appGuid,mpId:null==(c=null==(o=m[0])?void 0:o.mobileApp)?void 0:c.mpId,playstoreURL:null==(u=null==(d=m[0])?void 0:d.mobileApp)?void 0:u.playstoreURL},error:null==(h=m[0])?void 0:h.error,fieldList:null==(f=m[0])?void 0:f.fieldList.map((e=>{var t,a,s,r,i;return{field:null==e?void 0:e.field,screenTracking:null==e?void 0:e.screenTracking,eventTracking:{eventName:null==(t=null==e?void 0:e.eventTracking)?void 0:t.eventName,eventDescription:null==(a=null==e?void 0:e.eventTracking)?void 0:a.eventDescription,markAsGoal:null==(s=null==e?void 0:e.eventTracking)?void 0:s.markAsGoal,trackingType:null==(r=null==e?void 0:e.eventTracking)?void 0:r.trackingType,mandadory:null==(i=null==e?void 0:e.eventTracking)?void 0:i.mandadory}}}))};const v=m.filter(((e,t)=>0!==t));let g=(null==e?void 0:e.startDate.includes("T"))?Ks(null==e?void 0:e.startDate).add(-1,"day").toDate():Ks(null==e?void 0:e.startDate).add(0,"day").toDate(),b=(null==e?void 0:e.endDate.includes("T"))?Ks(null==e?void 0:e.endDate).add(-1,"day").toDate():Ks(null==e?void 0:e.endDate).add(0,"day").toDate();this.setState({deviceList:[p],startDate:g,endDate:b,showFormFiels:!0,controlsArray:v,controlsArrayCopy:v})})),x(this,"editFieldTrackData1",(e=>{ce({path:Le,params:{id:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(1==e.status){let t=e.data;this.editFieldTrackData12(t),Va.setcustomEventID(e.data.id)}},fail:e=>{}})})),x(this,"deleteCustomEvent",(e=>{ce({path:Fe,params:{id:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{1==e.status&&this.getEventDetails()},fail:e=>{}})})),x(this,"MyCustomCell",(e=>y.jsx(qs,{editFieldTrackData:e=>{this.editFieldTrackData(e)},...e,editId:e=>{this.editFieldTrackData1(e),this.setState({editShowCondition:!0})},deleteId:e=>{this.deleteCustomEvent(e)}}))),x(this,"closeFieldTrackComponent",(()=>{}))}componentDidMount(){let e=sessionStorage.getItem("AppNameTracking")||null;this.setState({fieldTrack_AppName:e});let t=Oe();if(null!=e&&null!==t&&null!==t.mobileAppsList){let a=t.mobileAppsList.filter(((t,a)=>t.appName==e)),s=[{friendlyName:null,deviceType:null,mobileApp:null,imageData:null,error:{errfriendlyName:null,errDeviceType:null,errMobileApp:null},fieldList:[]}];s[0].mobileApp=a[0],this.setState({mobileAppFilterList:a,deviceList:s})}null!==t&&null!==t.mobileAppsList&&this.setState({mobileAppList:t.mobileAppsList}),this.setState({editShowCondition:!1})}render(){var e,t,a;return y.jsxs("div",{children:[this.state.showFormNameComponent&&y.jsxs(Da,{show:this.state.showFormNameComponent,centered:!0,size:"md",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"Custom Event Form "}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{this.setState({showFormNameComponent:!1})}})]}),y.jsx(Da.Body,{children:y.jsx(ga,{children:y.jsxs(Ta,{children:["Form name",y.jsxs(ka,{md:4,children:[y.jsx(ba,{label:"Form name"})," "]}),y.jsx(ka,{md:8,children:y.jsx(ie,{required:!0,className:"required",placeholder:0===this.state.formName.length?"Enter Form name":"Form name",value:this.state.formName,handleOnchange:e=>{let t=0===e.length?Me:null;this.setState({formName:e,errFormName:t})},handleOnBlur:e=>{let t=0===e.length?Me:null;this.setState({formName:e,errFormName:t})}})})]})})}),y.jsxs("div",{className:"d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{this.setState({showFormNameComponent:!1})},children:"Cancel"}),y.jsx(fe,{className:(null==(e=this.state.formName)?void 0:e.length)>0?"":"click-off",onClick:()=>{let e={formName:this.state.formName,CustomEvent_period:{startDate:this.state.startDate,endDate:this.state.endDate},controls:this.state.deviceList};Wa(e,this.context,(e=>{this.props.history.push("form-generator")}))},children:"Save"})]})]}),1==this.state.isFieldTrack&&null!==this.state.fieldTrackData?y.jsxs(Da,{show:this.state.isFieldTrack,fullscreen:!0,className:"modal-top-fixed fluid-container-modal field-track-mobile-modal",children:[y.jsxs(Da.Header,{children:[y.jsxs("h2",{children:[null!=this.state.fieldTrack_AppName?"Custom Event":"Brand own form","  "]}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isFieldTrack:!1})}})]}),y.jsx(Da.Body,{children:y.jsx(Ba,{isWebFieldTrack:!1,isForm:!0,isFieldTrack:this.state.isFieldTrack,editFieldTrack:this.state.editFieldTrack,deviceList:this.state.deviceList,fieldTrackData:this.state.fieldTrackData,fieldTrackName:this.state.fieldTrack_AppName,controlsArray:this.state.controlsArray,saveBtnClicked:e=>{let t=[...this.state.deviceList];t[this.state.activationKey].fieldList=e,this.setState({deviceList:t}),this.setState({isFieldTrack:!1,fieldTrackData:null})},cancelBtnClicked:()=>{this.setState({isFieldTrack:!1,fieldTrackData:null})},getAllData:e=>{let t=[...this.state.deviceList];t[0].imageData=e.imageData,this.setState({getAllData:e,deviceList:t})}})})]}):null,y.jsxs("div",{className:"posr",children:[null==(t=this.state.deviceList)?void 0:t.map(((e,t)=>{var a,s,r,i,n,l,o,c,d;return y.jsxs("div",{className:"rs-accordin-panel",children:[y.jsxs(y.Fragment,{children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsxs(ka,{md:3,children:[y.jsx(ba,{label:"Friendly name "})," "]}),y.jsx(ka,{md:5,children:y.jsx(ie,{required:!0,className:"required",label:"friendlyName",placeholder:0===(null==(a=this.state.deviceList[t].friendlyName)?void 0:a.length)?"Enter Friendly name":"Friendly name",errorMessage:null!=(null==(s=e.error)?void 0:s.errfriendlyName)?null==(r=e.error)?void 0:r.errfriendlyName:null,val:null==(i=this.state.deviceList[t])?void 0:i.friendlyName,handleOnchange:e=>{let a=e.length>0?null:"Enter Friendly Name";this.getFriendlyName(t,"friendlyName",e,"errfriendlyName",a)}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Mobile app"})}),null!=this.state.fieldTrack_AppName?y.jsx(ka,{md:5,children:y.jsx(ie,{val:this.state.fieldTrack_AppName,disabled:!0})}):y.jsx(ka,{md:5,children:y.jsx(te,{required:!0,label:(this.state.deviceList[0].mobileApp,"Mobile app"),data:this.state.mobileAppList,errorMessage:null==(n=e.error)?void 0:n.errMobileApp,textField:"appName",dataItemKey:"appGuid",value:null===this.state.deviceList[0].mobileApp?{appName:"-- Select mobile app --",appGuid:0}:this.state.deviceList[0].mobileApp,onChange:e=>{this.setState({mobileApp:e.target.value});let a=[...this.state.deviceList];a[t].mobileApp=e.target.value,a[t].error.errMobileApp=null,this.setState({deviceList:[a[t]]})}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Device type"})}),y.jsx(ka,{md:5,children:y.jsx(te,{required:!0,label:"Device",data:this.getPlatformTypes(),errorMessage:null==(l=e.error)?void 0:l.errDeviceType,value:null===(null==(o=this.state.deviceList[t])?void 0:o.deviceType)?"-- Select device --":null==(c=this.state.deviceList[t])?void 0:c.deviceType,onChange:e=>{let a=0===e.target.value.length?"Select device":null;this.valueChange(t,"deviceType",e.target.value,"errDeviceType",a)}})}),y.jsx(ka,{md:1,children:y.jsx(Ka,{children:y.jsx(_e,{children:y.jsx(ke,{icon:Re,iconColor:"blue",iconSize:"md",tooltip:"Field tracking",color:"blue",onClick:()=>{var e,a;let s=[...this.state.deviceList],r={appName:null==(e=s[t].mobileApp)?void 0:e.appName,appId:null==(a=s[t].mobileApp)?void 0:a.appGuid,deviceType:s[t].deviceType,mode:"add"};if(this.setState({fieldTrackData:r}),null!==this.state.deviceList[0].deviceType&&null!==this.state.deviceList[0].mobileApp&&null!==this.state.deviceList[0].friendlyName)this.setState({isFieldTrack:!0});else{let e=null===this.state.deviceList[0].friendlyName?"Enter Frinedly Name":null,t=null===this.state.deviceList[0].deviceType?"Select device":null,a=null===this.state.deviceList[0].mobileApp?"Select mobile app":null,s=[...this.state.deviceList];s[0].error.errfriendlyName=e,s[0].error.errDeviceType=t,s[0].error.errMobileApp=a,this.setState({deviceList:s})}}})})})})]})}),(null==(d=this.state.deviceList[0])?void 0:d.fieldList.length)>0?y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom Event period"})}),y.jsx(ka,{md:7,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx($a,{required:!0,placeholder:"Start date",errorMessage:this.state.errStartDate,value:null!==this.state.startDate?this.state.startDate:null,min:$s,handleChange:e=>{var t=e.target.value,a=t.setDate(t.getDate()+3);let s=new Date(a);this.setState({endDateMinValue:s,startDate:e.target.value});let r=null!==e.target.value?null:Pe;this.setState({errStartDate:r})}})}),y.jsx(ka,{md:6,children:y.jsx($a,{required:!0,placeholder:"End date",value:null!==this.state.endDate?this.state.endDate:null,min:this.state.endDateMinValue,handleChange:e=>{this.setState({endDate:e.target.value});let t=null!==e.target.value?null:Pe;this.setState({errEndDate:t})}})})]})})]})}):null]}),(this.state.deviceList[t].fieldList.length>0||this.state.showFormFiels)&&y.jsxs(Ta,{children:[y.jsx(ka,{md:3}),y.jsx(ka,{md:6,children:y.jsx(this.AddFormEvents,{index:t})})]})]})})),this.state.deviceList.length<5?y.jsx("div",{className:"pos-icon-2 d-none",children:y.jsx(Ue,{text:"Add",position:"top",children:y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer icon-shadow "+(5===this.state.deviceList?"click-off":""),onClick:()=>{this.addBtnClick()}})})}):null]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end marginT30",children:[y.jsx(he,{onClick:()=>{const e=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:e},"",e),this.props.onChangeIndex(0)},children:"Cancel"}),y.jsx(fe,{className:(null==(a=this.state.deviceList[0])?void 0:a.fieldList.length)>0&&this.state.startDate&&this.state.endDate?"":"click-off",onClick:()=>{let e={CustomEvent_period:{startDate:this.state.startDate,endDate:this.state.endDate},controls:this.state.deviceList,getAllData:this.state.getAllData};Ha(e,this.context,(e=>{this.props.history.push("form-generator")}),(t=>{t&&(this.getEventDetails(e),this.setState({showFormFiels:!1}))}))},children:"Save"})]}),null!=this.state.getEventData?y.jsx("div",{children:y.jsx(Oa,{data:this.state.getEventData,column:[{title:"FriendlyName",field:"customEventName"},{title:"Device type",field:"deviceType"},{title:"Mobile app",field:"userFirstName"},{title:"Actions",field:"Actions",width:"240",cell:this.MyCustomCell}],settings:{total:2},pageable:!0,isDataStateRequired:!0})}):null]})}},x(e,"contextType",le),e));var Xs,Zs=null;const Qs=new Date,er=qa((e=>(w.useState([]),y.jsx(y.Fragment,{children:y.jsx("td",{children:y.jsxs(_e,{className:"float-end",children:[y.jsx(ke,{icon:"icon-rs-eye-medium",iconClass:"",size:"md",tooltip:"View",onClick:()=>{e.viewId(e.dataItem.id)}}),y.jsx(ke,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",onClick:()=>{e.editId(e.dataItem.id)}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",onClick:()=>{e.deleteId(e.dataItem.id)}})]})})})))),tr=qa((e=>{var t,a,s,r,i;return w.useState([]),w.useState((null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.markAsGoal)||!1),y.jsx(y.Fragment,{children:y.jsx("td",{children:y.jsxs(_e,{className:"float-end",children:[((null==(r=null==(s=null==e?void 0:e.dataItem)?void 0:s.eventTracking)?void 0:r.markAsGoal)||1==(null==(i=null==e?void 0:e.dataItem)?void 0:i.PageEngagementValue))&&y.jsx(ke,{tooltip:"Mark event as trigger",icon:"icon-rs-communication-calender-large icons-sm blue",size:"md",iconClass:"",mainClass:"",onClick:()=>{}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",onClick:()=>{e.deleteId(e.dataIndex)}})]})})})}));class ar extends w.Component{constructor(){super(...arguments),x(this,"state",{webUrl:"https://",errWebUrl:null,mandaroySetEvent:null,errMandatoryEvent:null,formName:"",formNameCopy:"",webUrlDisble:!1,fieldTrackData:(null==(a=null==(t=this.props)?void 0:t.fullData)?void 0:a.elementArray)||[],controlsArray:(null==(r=null==(s=this.props)?void 0:s.fullData)?void 0:r.controlsArray)||[],refreshBTNCondition:!1,fieldTrackIcon_Condiotion:!1,fullData:null,fieldTrackClose:null,fieldTrackWait:null,fieldTrackSuccess:null,showFormNameComponent:!1,showFieldTrackError:!1,errFormName:null,validateWebSite:!1,isLoading:!1,deviceList:[{friendlyName:null,deviceType:null,mobileApp:null,imageData:null,error:{errfriendlyName:null,errDeviceType:null,errMobileApp:null},fieldList:[]}],fieldData:(null==(i=this.props)?void 0:i.fullData)||{elementArray:[],controlArray:[],pageUrl:"",imageData:null},fieldData_ControlCopy:[],startDate:null,endDate:null,errStartDate:null,errEndDate:null,endDateMinValue:"",showDomainURL:!1,showKendoGrid:!1,hideKendoGrid:!0,showLoader:!1,loaderCondition:!0,showRefereshIcon:!1,editIcon:!1,editScenario:!1,getEventData:[],getEventDataCopy:[],endDataDisable:!0,deleteValueID:null,saveBTNCondition:!1,eventsData:(null==(l=null==(n=this.props)?void 0:n.fullData)?void 0:l.elementArray)||[],domainURL_List:[],viewClickOff:!1,eventNameLoading:!1,eventNameStatus:!1,Lifetime:!0,Customrange:!1,showAddBtn:!0,customEventNameData:[],customEventValue:null,markAsGoalElementDelete:null,markAsGoalElementDelete_Content:null,deletedItem_EventData:null,addCustomEventBTN:!1,eventFillterData:[],fieldTrackIconCheck_CustomName:!1,eventsData_Deletecopy:null,fieldData_Deletecopy:null,fieldTrackData_Deletecopy:null,isEnter:!1}),x(this,"getEventDetails",((e,t,a)=>{ce({path:je,params:{channel:"WP"},loading:!0===t&&this.context.globalStateData.setIsLoadingData,ok:t=>{var s;if("EditCancel"==e&&this.setState({showDomainURL:!1,showKendoGrid:!0,fieldTrackData:[],webUrl:"https://",formName:"",startDate:null,endDate:null,saveBTNCondition:!1,Lifetime:!1,Customrange:!1,eventNameStatus:!1,showAddBtn:!0,customEventValue:null,hideKendoGrid:!0,showKendoGrid:!0,webUrlDisble:!1,editScenario:!1}),"Update"==e&&this.setState({editScenario:!1,webUrlDisble:!1,fieldTrackData:[],formName:"",startDate:null,endDate:null,showKendoGrid:!0,showDomainURL:!1,webUrl:"https://",Lifetime:!1,Customrange:!1,eventNameStatus:!1,saveBTNCondition:!1,showAddBtn:!0,customEventValue:null}),1==t.status)if(t.data,this.setState({loaderCondition:!0,showLoader:!0,addCustomEventBTN:!0}),(null==(s=t.data)?void 0:s.length)>0){const e=t.data.filter((e=>"Web"==e.deviceType)),a=e.map((({id:e,customEventName:t})=>({id:e,customEventName:t})));let s=Oe();null==s||s.domainsList,this.setState({getEventData:e,getEventDataCopy:e,loaderCondition:!1,showLoader:!1,showAddBtn:!0,hideKendoGrid:!0,showKendoGrid:!0,customEventNameData:a})}else this.setState({getEventData:[],showLoader:!0,showKendoGrid:!1,hideKendoGrid:!0,loaderCondition:!1,showAddBtn:!0});else this.setState({addCustomEventBTN:!0,hideKendoGrid:!0,loaderCondition:!1,showKendoGrid:!0,getEventData:[]});a(t)},fail:e=>{this.setState({showLoader:!0}),a({status:!1,message:"Something went wrong"})}})})),x(this,"fieldTrackClicked",(()=>{O.parse(window.location.search);let e=Math.floor(100*Math.random());(Xs=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0})).on("connect",(()=>{Xs.emit("new_user",{userName:"platform",domainName:this.state.webUrl,appId:parseInt(e)})})),Xs.on("closed",(e=>{try{if(Zs.close(),e.status){if(this.setState({fieldTrackWait:!1}),localStorage.getItem("ea")){let e=Ee(localStorage.getItem("ea")),t={elementArray:e.elementArray,controlArray:e.controlsArray,pageUrl:e.currentActivity,imageData:null==e?void 0:e.imageData};this.setState({fieldTrackData:t.elementArray,eventsData:t.elementArray,showRefereshIcon:!0,socketEnabled:!0,fieldData:t}),this.props.socketChange(!1,!0,!1)}}else this.setState({socketEnabled:!1}),this.props.socketChange(!1,!1,!0)}catch(t){}})),this.props.socketChange(!0,!1,!1),localStorage.setItem("fdomain",this.state.webUrl);let t=window.location.pathname+`?cId=${e}&webft=true`,a=btoa(e);Zs=window.open(`${this.state.webUrl}?_sdxFormId=${a}&path=${t}`)})),x(this,"editFieldTrackDatavalue",(e=>{var t,a,s,r,i;this.context.globalStateData.setIsLoadingData(!1);let n=JSON.parse(e.viewJson),l=null;if(n&&(l={friendlyName:null==n?void 0:n.formName,deviceType:null==n?void 0:n.deviceType,imageData:n.fullData.imageData,mobileApp:{appName:null==n?void 0:n.domainName,appGuid:null==n?void 0:n.domainName,playstoreURL:null==(t=null==n?void 0:n.fullData)?void 0:t.playstoreURL},error:null==(a=n[0])?void 0:a.error,fieldList:null==(s=n[0])?void 0:s.controls.map((e=>{var t,a,s,r,i;return{field:null==e?void 0:e.field,screenTracking:null==e?void 0:e.screenTracking,eventTracking:{eventName:null==(t=null==e?void 0:e.eventTracking)?void 0:t.friendlyName,eventDescription:null==(a=null==e?void 0:e.eventTracking)?void 0:a.eventDescription,markAsGoal:null==(s=null==e?void 0:e.eventTracking)?void 0:s.markAsGoal,trackingType:null==(r=null==e?void 0:e.eventTracking)?void 0:r.trackingType,mandadory:null==(i=null==e?void 0:e.eventTracking)?void 0:i.mandadory}}}))}),"Customrange"==(null==n?void 0:n.customEventPeriod)){let t={startDate:(null==(r=null==n?void 0:n.dateRange)?void 0:r.startDate.includes("T"))?Ks(null==e?void 0:e.startDate).add(-1,"day").toDate():Ks(null==e?void 0:e.startDate).add(0,"day").toDate(),endDate:(null==(i=null==n?void 0:n.dateRange)?void 0:i.endDate.includes("T"))?Ks(null==e?void 0:e.endDate).add(-1,"day").toDate():Ks(null==e?void 0:e.endDate).add(0,"day").toDate()};"Customrange"==(null==n?void 0:n.customEventPeriod)&&this.setState({startDate:t.startDate,endDate:t.endDate,endDateMinValue:t.endDate,Lifetime:!1,Customrange:!0})}"Lifetime"==(null==n?void 0:n.customEventPeriod)&&this.setState({Lifetime:!0,Customrange:!1}),this.setState({hideKendoGrid:!1});let o=null==n?void 0:n.domainName,c=n.fullData;c.elementArray=n.controls,this.setState({showAddBtn:!1,deviceList:[l],showFormFiels:!0,controlsArray:n.fullData.controlArray,controlArray:n.fullData.controlArray,endDataDisable:!1,webUrl:o,formNameCopy:n.formName,validateWebSite:!0,webUrlDisble:!0,formName:n.formName,saveBTNCondition:!0,fieldTrackData:n.controls,eventsData:n.controls,showRefereshIcon:!0,fullData:c,fieldData:c,showKendoGrid:!1,loaderCondition:!1,editIcon:!0,editScenario:!0,errFormName:null,errWebUrl:null,errStartDate:null,errEndDate:null})})),x(this,"editFieldTrackDataget",(e=>{let t={id:e};this.context.globalStateData.setIsLoadingData(!0),ce({path:Le,params:t,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(1==e.status){let t=e.data;this.editFieldTrackDatavalue(t),Va.setcustomEventID(e.data.id)}},fail:e=>{}})})),x(this,"viewFieldTrackDataget",(e=>{let t={id:e};this.context.globalStateData.setIsLoadingData(!0),ce({path:Le,params:t,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(1==e.status){let t=e.data;this.editFieldTrackDatavalue(t),Va.setcustomEventID(e.data.id),this.setState({viewClickOff:!0})}},fail:e=>{}})})),x(this,"deleteCustomEvent",(()=>{if(null!=this.state.deleteValueID){let e={id:this.state.deleteValueID};this.context.globalStateData.setIsLoadingData(!0),ce({path:Fe,params:e,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{1==e.status?(this.setState({showFormNameComponent:!1,customEventValue:null}),this.getEventDetails("",!0,(e=>{this.context.globalStateData.setIsLoadingData(!1)}))):this.context.globalStateData.setIsLoadingData(!1)},fail:e=>{this.context.globalStateData.setIsLoadingData(!1)}})}})),x(this,"deleteCustomEventID",(e=>{this.setState({deleteValueID:e})})),x(this,"MyCustomCell",(e=>y.jsx(er,{editFieldTrackData:e=>{this.editFieldTrackData(e)},...e,editId:e=>{this.editFieldTrackDataget(e)},viewId:e=>{this.viewFieldTrackDataget(e)},deleteId:e=>{this.setState({showFormNameComponent:!0}),this.deleteCustomEventID(e)}}))),x(this,"CustomDateCell",(e=>{let t="";return t=null===e.dataItem.startDate&&null===e.dataItem.endDate?"Life time":`${Ge(e.dataItem.startDate,!1)} to ${Ge(e.dataItem.endDate,!1)}`,y.jsx("td",{children:t})})),x(this,"CaptureNameCell",(e=>{var t,a,s,r,i,n;let l=Array.isArray(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.captureType)?null==(r=null==(s=null==e?void 0:e.dataItem)?void 0:s.eventTracking)?void 0:r.captureType.join(", "):(null==(n=null==(i=null==e?void 0:e.dataItem)?void 0:i.eventTracking)?void 0:n.captureType)||"";return y.jsx("td",{children:l})})),x(this,"TrackingActionCell",(e=>{var t,a,s;let r=(null==(s=null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.trackingType)?void 0:s.displayName)||"";return y.jsx("td",{children:r})})),x(this,"ActionCell",(e=>y.jsx(tr,{editFieldTrackData:e=>{this.editFieldTrackData(e)},...e,editId:e=>{this.editFieldTrackDataget(e)},deleteId:e=>{var t;let a=[...this.state.eventsData],s=a[e];if(null!=s){let e="Do you want to delete the form field?";1!=(null==(t=null==s?void 0:s.eventTracking)?void 0:t.markAsGoal)&&1!=(null==s?void 0:s.PageEngagementValue)||(e="Cannot delete event trigger and trigger action"),this.setState({markAsGoalElementDelete_Content:e,markAsGoalElementDelete:!0})}const r=e;r>-1&&a.splice(r,1);let i={...this.state.fieldData};i.elementArray=a,this.setState({eventsData_Deletecopy:a,fieldData_Deletecopy:i,fieldTrackData_Deletecopy:a,deletedItem_EventData:s})}}))),x(this,"AddFormEventsData",(e=>{var t,a,s;const r=O.parse(null==(a=null==(t=this.props.history)?void 0:t.location)?void 0:a.search);return void 0!==r.isEdit&&r.isEdit,y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(Oa,{config:{take:10,skip:0},data:this.state.eventsData,settings:{total:null==(s=this.state.eventsData)?void 0:s.length},isDataStateRequired:!1,pageable:!1,column:[{field:"Capture type",title:"Capture type",cell:this.CaptureNameCell},{field:"Attribute",title:"Attribute",cell:this.TrackingActionCell},{field:"Action",title:"Action",cell:this.ActionCell}]})})})})),x(this,"FieldTrackDataError",(()=>y.jsx(y.Fragment,{children:this.state.showFieldTrackError&&y.jsxs(Da,{show:this.state.showFieldTrackError,centered:!0,size:"md",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"Brand owned form"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{this.setState({showFieldTrackError:!1})}})]}),y.jsx(Da.Body,{children:y.jsx("p",{children:"Add tracked field"})}),y.jsx("div",{className:"d-flex justify-content-end",children:y.jsx(he,{onClick:()=>{this.setState({showFieldTrackError:!1})},children:"Cancel"})})]})}))),x(this,"validDomainURLMatch",(e=>this.state.domainURL_List.some((t=>t.domainUrl===e)))),x(this,"validateDomain",(e=>{this.setState({isLoading:!0,validateWebSite:!1}),za(e,(t=>{if(t.status){if(!this.validDomainURLMatch(e))return void this.setState({errWebUrl:"Enter onboarded domain URL",isLoading:!1,validateWebSite:!1});this.setState({validateWebSite:!0,isLoading:!1,fieldTrackIcon_Condiotion:!0,isEnter:!1})}else this.setState({errWebUrl:t.message,isLoading:!1})}))})),x(this,"saveFormData",(async()=>{var e,t;let a=!0,s="";if(s=this.state.Customrange?"Customrange":"Lifetime",null!=this.state.errFormName)return window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"}),!1;if(this.state.editScenario&&(null==(e=this.state.formName)?void 0:e.trimEnd())!==(null==(t=this.state.formNameCopy)?void 0:t.trimEnd())&&await this.saveDuplicateCheckCustomName(this.state.formName,!1))return!1;if(!this.state.editScenario&&(null!=this.state.formName||""!=this.state.formName)&&await this.saveDuplicateCheckCustomName(this.state.formName,!1))return!1;if(null!=this.state.formName&&""!=this.state.formName||(this.setState({errFormName:"Enter Custom event name"}),a=!1),null!=this.state.errWebUrl&&(a=!1),(null==this.state.webUrl||""==this.state.webUrl||this.state.webUrl.length<10)&&(this.setState({errWebUrl:"Enter valid web url"}),a=!1),null==this.state.errWebUrl&&(this.validDomainURLMatch(this.state.webUrl)||(this.setState({errWebUrl:"Enter onboarded domain URL"}),a=!1)),!this.state.Customrange||""!=this.state.startDate&&null!=this.state.startDate)if(!this.state.Customrange||""!=this.state.endDate&&null!=this.state.endDate)if(0==this.state.saveBTNCondition&&Va.setcustomEventID(null),a){let e={formName:this.state.formName,customEventPeriod:s,controls:this.state.fieldTrackData,deviceType:"Web",domainName:this.state.webUrl,fullData:this.state.fieldData,dateRange:{startDate:this.state.startDate,endDate:this.state.endDate}};this.context.globalStateData.setIsLoadingData(!0),Ya(e,this.context,"Web",!1,(e=>{this.context.globalStateData.setIsLoadingData(!1),e.message.includes("Save successful")||e.message.includes("Update successful")?this.getEventDetails("Update",!0,(e=>{})):this.setState({errFormName:(null==e?void 0:e.message)??"An error occurred"})}))}else window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"});else this.setState({errEndDate:"Choose end date"});else this.setState({errStartDate:"Choose start date"})})),x(this,"unableViewOff",(()=>{this.setState({getEventData:this.state.getEventDataCopy,customEventValue:null,viewClickOff:!1,showKendoGrid:!0,fieldTrackData:[],formName:"",webUrl:"https://",startDate:null,endDate:null,saveBTNCondition:!1,hideKendoGrid:!0,showAddBtn:!0,webUrlDisble:!1,editScenario:!1})})),x(this,"saveDuplicateCheckCustomName",((e,t=!0)=>{let a=0===e.length?Ve:null,s=null==e?void 0:e.trimEnd();this.setState({formName:s,errFormName:a});let r={eventName:s,channel:"WP"};return new Promise(((e,a)=>{ce({path:We,params:r,sessionOut:this.context.globalStateData.setSessionOutData,loading:!!t&&this.context.globalStateData.setIsLoadingData,ok:t=>{!1===t.status?e(!1):(this.setState({errFormName:"Custom event name already exists"}),e(!0),window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"}))},fail:e=>{a(e)}})}))})),x(this,"duplicateCheckCustomName",(e=>{let t=0===e.length?Ve:null,a=null==e?void 0:e.trimEnd();this.setState({formName:a,errFormName:t,eventNameLoading:!0,eventNameStatus:!1});let s={eventName:this.state.formName,channel:"WP"};ce({path:We,params:s,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{0==e.status?this.setState({eventNameLoading:!1,eventNameStatus:!0,fieldTrackIconCheck_CustomName:!1}):this.setState({eventNameLoading:!1,eventNameStatus:!1,errFormName:"Custom event name already exists",fieldTrackIconCheck_CustomName:!0})},fail:e=>{}})}))}componentDidMount(){var e,t;let a=Oe();if((null==(e=null==a?void 0:a.domainsList)?void 0:e.length)>0){let e=null==a?void 0:a.domainsList;e.push({domainId:0,domainUrl:"Enter custom domainURL"}),this.setState({domainURL_List:e})}else 0!=(null==(t=null==a?void 0:a.domainsList)?void 0:t.length)&&Be(this.context,(e=>{if(!0===e.status){let e=Oe();if(null==e?void 0:e.domainsList){let e=null==a?void 0:a.domainsList;e.push({domainId:0,domainUrl:"Enter custom domainURL"}),this.setState({domainURL_List:e})}}}));this.props.webUrl&&this.setState({webUrl:this.props.webUrl}),this.getEventDetails("",!0,(e=>{}))}componentDidUpdate(e){var t,a;const{editedEvent:s}=this.props,{eventFillterData:r}=this.state;let i=null!=s?s.elementArray:[],n={...this.state.fullData};n.elementArray=i,null==(a=null==(t=this.props.fullData)?void 0:t.controlsArray)||a.filter((e=>!0===e.select)),s!=e.editedEvent&&this.setState({fieldTrackData:i,eventsData:s.elementArray,fullData:n}),e.eventFillterData}render(){var e,t,a,s,r,i;return this.state,y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:this.state.viewClickOff?"click-off":"click-on",children:[this.state.showFormNameComponent&&y.jsx(_a,{size:"md",para:"Do you want to delete this item?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{!0===e?this.deleteCustomEvent():this.setState({showFormNameComponent:!1})}}),y.jsxs(ga,{children:[this.state.showDomainURL||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?y.jsxs(Ta,{style:{marginBottom:"30px"},children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom event name",left:!0})}),y.jsx(ka,{md:5,children:y.jsx(ie,{name:"Custom event name",required:!0,placeholder:this.state.formName.length>0?"Custom event name":"Enter custom event name",val:this.state.formName,errorMessage:this.state.errFormName,max:50,isLoading:this.state.eventNameLoading,iconPlaceholder:!0,iconName:this.state.eventNameStatus?"icon-rs-circle-tick-medium icons-md green cursor-default paddingL15":"",handleOnchange:e=>{if(e.length<=50){let t=e.trimStart();if(t.includes("'"))return;if(!0===/^[' 'A-Za-z0-9_-]*$/.test(t)){let e=t.replace(/\s+/g," ");if(e.length>50)return void this.setState({errFormName:"Custom event name exceeded the limit",eventNameStatus:!1});let a=0===e.length?"Enter custom event name":null;return void this.setState({formName:e,errFormName:a,fieldTrackIconCheck_CustomName:!0,eventNameLoading:!1,eventNameStatus:!1})}}},ob:e=>{var t;let a=e.trimStart();if(1==/^[' 'A-Za-z0-9_-]*$/.test(a)){if(e.length>50)return void this.setState({errFormName:"Custom event name exceeded the limit"});let s=0===e.length?"Enter custom event name":null;if(this.setState({errFormName:s}),(null==a?void 0:a.trimEnd())===(null==(t=this.state.formNameCopy)?void 0:t.trimEnd()))return void this.setState({fieldTrackIconCheck_CustomName:!1});e.length>0&&this.duplicateCheckCustomName(e)}}})})]}):null,y.jsx(ga,{children:this.state.showDomainURL||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?y.jsxs(Ta,{style:{marginTop:"20px"},children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Domain URL",left:!0})}),y.jsx(ka,{md:5,children:!0===this.state.isEnter?y.jsx(ie,{className:this.state.webUrlDisble||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?"click-off":"click-on",required:!0,placeholder:this.state.webUrl.length>8?"Domain URL":"Enter domain URL",val:this.state.webUrl,errorMessage:this.state.errWebUrl,iconPlaceholder:!0,iconName:`${!0===this.state.isLoading||(this.state.validateWebSite?"icon-rs-circle-tick-medium icons-md green paddingL5 cursor-default":He)}`,iconColor:!0===this.state.isLoading||!0===this.state.validateWebSite?"":"red",isLoading:this.state.isLoading,handleOnchange:e=>{let t=e.trimStart();if(e.includes(" "))return;let a=t.length>0?null:"Enter domain URL";this.setState({webUrl:t,errWebUrl:a,validateWebSite:!1,fieldTrackIcon_Condiotion:!1})},handleOnBlur:e=>{let t=e.trimStart();if(e.includes(" "))return;let a=e.slice(0,8);a.includes("https://")||(t="https://"+e),a.includes("http://")&&(t=e.replace("http://","https://"));let s=t.length>8?null:"Enter domain URL";this.setState({webUrl:t,errWebUrl:s}),null===s&&this.validateDomain(t)},onFocus:()=>{let e=this.state.webUrl;e.startsWith("https://")&&(e=e.replace("https://","")),this.setState({webUrl:e})},iconOnClick:()=>{this.setState({isEnter:!1,webUrl:""})}}):y.jsx(te,{required:!0,className:this.state.webUrlDisble||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?"click-off":"click-on",data:this.state.domainURL_List,label:"Domain URL",dataItemKey:"domainId",textField:"domainUrl",value:(null==(e=this.state.webUrl)?void 0:e.length)>0?{domainId:10,domainUrl:this.state.webUrl}:{domainId:0,domainUrl:"Select domain"},errorMessage:this.state.errWebUrl,onChange:e=>{var t,a,s;0!==(null==(t=e.target.value)?void 0:t.domainId)?(this.setState({webUrl:null==(a=e.target.value)?void 0:a.domainUrl,errWebUrl:null,validateWebSite:!0}),this.validateDomain(null==(s=e.target.value)?void 0:s.domainUrl)):this.setState({isEnter:!0,validateWebSite:!1,webUrl:""})}})}),null!==this.state.fieldTrackData&&this.state.fieldTrackData.length>0&&(null==(t=this.state.eventsData)?void 0:t.length)>0?y.jsx(ka,{md:2,children:y.jsx(Ka,{children:y.jsxs(_e,{children:[y.jsx(ke,{icon:ze,iconColor:"blue",iconSize:"md",tooltip:"Edit",color:"blue",onClick:()=>{var e,t,a,s,r,i,n,l;null!=(null==(e=this.state.fieldData)?void 0:e.controlArray)&&(null==(a=null==(t=this.state.fieldData_ControlCopy)?void 0:t.controlArray)||a.filter((e=>!0===e.select)));const{history:o}=this.props;if(o.push({pathname:"/preferences/communication-settings",search:"isEdit=true"}),this.state.editIcon)null==(s=this.props)||s.editBtnClick(this.state.fullData);else{let e={...this.state.fieldData};e.elementArray=[...this.state.fieldTrackData],null==(r=null==e?void 0:e.controlArray)||r.filter((e=>!0===e.select)),null==(n=null==(i=this.props.fullData)?void 0:i.controlArray)||n.filter((e=>!0===e.select)),null==(l=this.props)||l.editBtnClick(e)}}}),y.jsx(ke,{icon:Ye,iconColor:"blue",iconSize:"md",tooltip:"Reset",color:"blue",onClick:()=>{this.setState({fieldTrackData:[],showDomainURL:!0,showKendoGrid:!1,getEventData:[],refreshBTNCondition:!0,fieldTrackIcon_Condiotion:!0,showRefereshIcon:!1,webUrlDisble:!1})}})]})})}):this.state.showRefereshIcon?y.jsx(y.Fragment,{children:y.jsx(ka,{md:2,children:y.jsx(Ka,{children:y.jsx(_e,{children:y.jsx(ke,{icon:Ye,iconColor:"blue",iconSize:"md",tooltip:"Reset",color:"blue",onClick:()=>{this.setState({fieldTrackData:[],showDomainURL:!0,showKendoGrid:!1,getEventData:[],refreshBTNCondition:!0,fieldTrackIcon_Condiotion:!0,showRefereshIcon:!1,webUrlDisble:!1})}})})})})}):y.jsx(y.Fragment,{children:!0===this.state.validateWebSite&&this.state.webUrl.length>0&&0==this.state.isLoading||this.state.fieldTrackIcon_Condiotion&&null==this.state.errWebUrl?y.jsx(ka,{md:2,children:y.jsx(Ka,{children:y.jsx(_e,{children:y.jsx(ke,{icon:Re,iconColor:"blue",iconSize:"md",tooltip:"Configure custom event",color:"blue",mainClass:0==(null==(a=this.state.formName)?void 0:a.length)||1==this.state.fieldTrackIconCheck_CustomName?"click-off":"click-on",onClick:()=>{var e;let t=0==(null==(e=this.state.formName)?void 0:e.length)?Ve:null;null==t?(this.setState({Lifetime:!0,Customrange:!1,startDate:null,endDate:null}),this.fieldTrackClicked()):this.setState({errFormName:t})}})})})}):null})]}):null}),y.jsx(ga,{children:null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom event period",left:!0})}),y.jsx(ka,{md:7,children:y.jsxs(Ta,{children:[y.jsxs(ka,{md:3,className:"d-flex",children:[y.jsx(ae,{lbl:"Life time",name:"matchtype",labelId:"all",checked:this.state.Lifetime,cb:e=>{this.setState({Lifetime:!0,Customrange:!1,startDate:null,endDate:null})}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a lifetime duration",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})]}),y.jsxs(ka,{md:2,className:"d-flex align-items-center",children:[y.jsx(ae,{lbl:"Custom range",name:"matchtype",labelId:"any",checked:this.state.Customrange,cb:e=>{this.setState({Lifetime:!1,Customrange:!0})}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a specific date range",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})]})]})})]}):null}),y.jsx(ga,{children:null!==this.state.fieldTrackData&&this.state.fieldTrackData.length&&this.state.Customrange?y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom range period",left:!0})}),y.jsx(ka,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:5,children:y.jsx($a,{required:!0,placeholder:"Start date",errorMessage:this.state.errStartDate,value:null!==this.state.startDate?this.state.startDate:null,min:Qs,handleChange:e=>{var t=e.target.value,a=t.setDate(t.getDate()+3);let s=new Date(a);this.setState({endDateMinValue:s,startDate:e.target.value,endDataDisable:!1,endDate:null});let r=null!==e.target.value?null:ConstStr.START_DATE;this.setState({errStartDate:r})}})}),y.jsx(ka,{md:5,className:null!=this.state.startDate?"click-on":"click-off",children:y.jsx($a,{required:!0,placeholder:"End date",errorMessage:this.state.errEndDate,disabled:!!this.state.endDataDisable,value:null!==this.state.endDate?this.state.endDate:null,min:this.state.endDateMinValue,handleChange:e=>{this.setState({endDate:e.target.value});let t=null!==e.target.value?null:ConstStr.START_DATE;this.setState({errEndDate:t})}})})]})})]}):null})]}),null!==this.state.fieldTrackData&&this.state.fieldTrackData.length>0&&y.jsxs(Ta,{md:12,children:[this.state.markAsGoalElementDelete&&y.jsx(_a,{size:"md",para:this.state.markAsGoalElementDelete_Content,pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{var t,a,s,r;if(!0===e){if("Do you want to delete the form field?"==this.state.markAsGoalElementDelete_Content){let e={...this.state.fullData};(null==e?void 0:e.elementArray)&&(null==(t=this.state.fieldData_Deletecopy)?void 0:t.elementArray)&&(e.elementArray=[...this.state.fieldData_Deletecopy.elementArray],(null==(a=null==e?void 0:e.controlArray)?void 0:a.length)>0&&(null==e||e.controlArray.map((e=>{var t,a;e.viewId===(null==(a=null==(t=this.state.deletedItem_EventData)?void 0:t.field)?void 0:a.viewId)&&(e.select=!1,e.click=!1)})))),null==(s=null==e?void 0:e.controlArray)||s.filter((e=>!0===e.select)),this.setState({fullData:e}),this.setState({eventsData:this.state.eventsData_Deletecopy,fieldData:this.state.fieldData_Deletecopy,fieldTrackData:null==(r=this.state.fieldData_Deletecopy)?void 0:r.elementArray})}this.setState({markAsGoalElementDelete:!1})}else this.setState({markAsGoalElementDelete:!1})}}),y.jsx(ka,{children:y.jsx(this.AddFormEventsData,{})})]}),this.state.showDomainURL||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?y.jsxs("div",{className:"btn-container d-flex justify-content-end marginT30 "+(this.state.viewClickOff?"d-none":"click-on"),children:[y.jsx(he,{onClick:()=>{this.getEventDetails("EditCancel",!0,(e=>{}))},children:"Cancel"}),y.jsx(fe,{className:null!==this.state.fieldTrackData&&this.state.fieldTrackData.length>0?"":"click-off",onClick:()=>{this.saveFormData()},children:this.state.saveBTNCondition?"Update":"Save"})]}):null,this.state.showAddBtn?y.jsx("div",{children:y.jsxs(Ta,{className:"d-flex align-items-center marginT-30 marginB20",children:[y.jsx(ka,{md:2,className:"marginL5",children:y.jsx("h3",{children:"Custom events"})}),y.jsx(ka,{md:(null==(s=this.state.getEventData)||s.length,9),className:"justify-content-end marginL81",children:y.jsx(xa,{className:(this.state.addCustomEventBTN?"":"click-off")+" justify-content-end",children:y.jsx(_e,{alignRight:!0,children:y.jsx(ke,{shadow:!0,tooltip:"Add custom event",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",iconClass:!0===me()?"click-off":"",onClick:()=>{this.setState({showDomainURL:!0,showKendoGrid:!1,loaderCondition:!1,validateWebSite:!1,showRefereshIcon:!1,fieldTrackIcon_Condiotion:!1,errFormName:null,errWebUrl:null,errStartDate:null,errEndDate:null,hideKendoGrid:!1,showAddBtn:!1,customEventValue:null})}})})})})]})}):null,this.state.hideKendoGrid?this.state.showKendoGrid&&(null==(r=this.state.getEventData)?void 0:r.length)>0?y.jsx(y.Fragment,{children:y.jsx("div",{children:y.jsx(Oa,{config:{take:5,skip:0},data:this.state.getEventData,settings:{total:null==(i=this.state.getEventData)?void 0:i.length},pageable:!0,column:[{title:"Event name",field:"customEventName",filter:"text",cell:e=>{var t;return y.jsx("td",{children:y.jsx("span",{children:null==(t=e.dataItem)?void 0:t.customEventName})})}},{title:"Domain name",field:"domainName"},{title:"Created by",field:"userFirstName"},{title:"Event range",field:"startDate",cell:this.CustomDateCell},{title:"Actions",field:"Actions",width:"200",cell:this.MyCustomCell}]})})}):this.state.loaderCondition?y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsx("div",{})})}):y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsxs("div",{className:"nodata-bar add-func",children:[y.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),y.jsx("p",{children:"No data available"})]})})}):null]}),this.state.viewClickOff?y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{this.unableViewOff()},children:"Back"})}):null]})}}x(ar,"contextType",le);const sr=S(ar);var rr,ir=!1;class nr extends w.Component{constructor(){super(...arguments),x(this,"state",{formName:"",platformName:this.props.web,webUrl:"",showWebCustomCOmponent:!1,formpageUrl:"",lSocket:null,isSocketConnect:!1,errorMessage:"",fieldTrackClose:null,fieldTrackWait:null,fieldTrackSuccess:null,fullData:null,isEdit:!1,editedEvent:null,closeIconCondition:null,socketClose:null,selectControllEmpty:!1,editCheck:!1,controlsArray_Copy:[],saveSuccessfully:!1}),x(this,"closeCheck",!1),x(this,"getWebURL",(()=>{let e={WebGuid:this.props.webGuid,OnboardingId:this.props.onboardingId};ce({path:de,params:e,ok:e=>{var t;(null==(t=e.data)?void 0:t.domainURL)?this.setState({webUrl:e.data.domainURL,showWebCustomCOmponent:!0}):e.message.includes("error")},fail:e=>{}})})),x(this,"editFormGenerator",(e=>{ce({path:Ke,params:{recipientFormID:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(null==e?void 0:e.status){let t=null==e?void 0:e.data,a=JSON.parse(t.jsondata),s=null==a?void 0:a.deviceType;return"web"!==s.toLowerCase()&&(s="Mobile"),void this.setState({webUrl:null==a?void 0:a.domainName,fullData:null==a?void 0:a.fullData,platformName:s,formName:null==a?void 0:a.formName})}},fail:e=>{}})})),x(this,"webSocketClosed",(()=>{var e,t;const a=O.parse(null==(t=null==(e=this.props.history)?void 0:e.location)?void 0:t.search);void 0!==a.cId&&a.cId,localStorage.getItem("fdomain"),setTimeout((()=>{window.close()}),1e3)})),x(this,"socketClosed",(()=>{var e,t,a,s,r={},i="iOS",n=null==(e=this.state.fullData)?void 0:e.appId,l="iPhone";(null==(a=null==(t=this.state.fullData)?void 0:t.deviceType)?void 0:a.toLowerCase().includes("an"))&&(i="Android",l=null==(s=this.state.fullData)?void 0:s.deviceType),r.appId=String(i+l+n).replace(/ /g,""),rr.emit("disconnect-receiver",JSON.stringify(r)),rr.off("receiver-handshake-response"),rr.off("client-information"),rr.off("message-from-client-image"),rr.off("message-from-client-data"),rr.off("receiver-handshake-response"),rr.off("show-auth-code"),rr.disconnect(),this.setState({socketClose:!0,isWebFieldTrack:!1})})),x(this,"socketInit",(e=>{const t=io("https://mobsoc.resu.io/");this.setState({lSocket:t},(()=>{this.state.lSocket.on("connect",(()=>{rr.emit("new_user",{userName:"platform",domainName:e,appId:14441}),this.socketClosed()}))}))})),x(this,"formNameCheck",(e=>{ce({path:$e,params:{formName:e},ok:e=>{e.status&&this.setState({errorMessage:null==e?void 0:e.message})},fail:e=>{}})})),x(this,"getContentData",(()=>{var e;const t=O.parse(null==(e=window.location)?void 0:e.search);if("true"===(void 0!==t.isEdit&&t.isEdit))return!1;let a="";return this.state.fieldTrackWait?a="Waiting for event set":this.state.fieldTrackData?a="Client closed unexpected":this.state.fieldTrackSuccess&&(a="Field tracking enabled successfully"),a}))}componentDidMount(){var e,t;const a=O.parse(null==(t=null==(e=this.props.history)?void 0:e.location)?void 0:t.search);let s=void 0!==a.webft&&a.webft,r=void 0!==a.isEdit&&a.isEdit,i=void 0!==a.cId?a.cId:0;r&&this.setState({closeIconCondition:!0}),"true"===s&&this.setState({isWebFieldTrack:!0,platformName:"Web"}),"true"===r&&this.editFormGenerator(parseInt(i)),null==this.props.webGuid&&null==this.props.onboardingId||this.getWebURL()}render(){var e,t,a;return null==(t=null==(e=this.state.fullData)?void 0:e.controlsArray)||t.filter((e=>!0===e.select)),y.jsx("div",{children:y.jsxs(y.Fragment,{children:[this.state.isWebFieldTrack&&y.jsx(y.Fragment,{children:y.jsxs(Da,{className:"web-field-tracking-fullscreen-wrapper",fullscreen:!0,show:this.state.isWebFieldTrack,children:[y.jsxs(Da.Header,{children:[y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{ir=!0,this.setState({selectControllEmpty:!0}),this.setState({socketClose:!0}),this.setState({isWebFieldTrack:!1}),this.webSocketClosed()}}),y.jsx(Ta,{style:{width:"80%"},children:y.jsx(ka,{md:4,children:y.jsx("h2",{children:"Custom event"})})})]}),y.jsx(Da.Body,{children:y.jsx(ts,{closeCheck:ir,selectControllEmpty:this.state.selectControllEmpty,isForm:!0,isEdit:this.state.isEdit,isWebFieldTrack:this.state.isWebFieldTrack,fieldTrackData:this.state.fullData,editCheck:this.state.editCheck,domainName:e=>{this.socketInit(e)},cancelBtnClicked:e=>{var t,a;null==(t=null==e?void 0:e.controlsArray)||t.filter((e=>!0===e.select)),null==(a=null==e?void 0:e.controlsArray_Copy)||a.filter((e=>!0===e.select)),this.setState({isWebFieldTrack:!1,isEdit:!1,fullData:e,fieldTrackData:e,editedEvent:e})},saveBtnClicked:e=>{var t,a;null==(t=null==e?void 0:e.controlsArray)||t.filter((e=>!0===e.select)),null==(a=null==e?void 0:e.controlsArray_Copy)||a.filter((e=>!0===e.select)),this.setState({fieldTrackData:e,isWebFieldTrack:!1,fullData:e,isEdit:!1,editedEvent:e,saveSuccessfully:!0})},controlsArray_Copy:this.state.controlsArray_Copy,controllsArrayChange:e=>{var t;null==(t=null==e?void 0:e.controlsArray_Copy)||t.filter((e=>!0===e.select)),e&&this.setState({editCheck:!0,controlsArray_Copy:null==e?void 0:e.controlsArray_Copy})},isSocketClose:this.state.socketClose})})]})}),y.jsx("div",{children:"web"==this.state.platformName.toLowerCase()?y.jsx(y.Fragment,{children:y.jsx(sr,{web:!0,webUrl:this.state.webUrl,formName:this.state.formName,fullData:(null==(a=this.state)?void 0:a.fullData)||[],editedEvent:this.state.editedEvent,editCheck:this.state.editCheck,onChange:e=>{},editBtnClick:e=>{var t,a,s;null==(t=this.state.controlsArray_Copy)||t.filter((e=>!0===e.select)),null==(a=null==e?void 0:e.controlArray)||a.filter((e=>!0===e.select));const r=new Set(e.elementArray.map((e=>e.field.viewId)));e.controlArray=e.controlArray.map((e=>({...e,select:r.has(e.viewId)}))),null==(s=e.controlArray)||s.filter((e=>!0===e.select)),this.setState({fullData:e}),this.setState({isEdit:!0,isWebFieldTrack:!0})},socketChange:(e,t,a)=>{this.setState({fieldTrackWait:e,fieldTrackSucess:t,fieldTrackClose:a})},cancelBtn:e=>{this.props.cb(e)}})}):null})]})})}}x(nr,"contextType",le);const lr=S(nr),or={true:"Enabled",false:"Not enabled",sdk:{true:"Active",false:"Inactive"},null:"No data"},cr={sdkStatus:"SDK Status",deepLinkStatus:"Deep Link",tokenUpdateStatus:"Token Update",sdkRegisterationStatus:"Identification Mapping",screenTrackingStatus:"Screen Tracking",locationUpdateStatus:"Location Update",customEventStatus:"Custom Events",sdkRuleStatus:"Immediate Trigger",notificationClickStatus:"Notification Click",conversionStatus:"Conversion",fieldTrackStatus:"Field Track / Codeless tracking",formStatus:"Form",brandFormStatus:"Brand Form"},dr=(e,t)=>null===t?"No data":"sdkStatus"===e?or.sdk[t]||"No data":or[t]??"No data",ur=e=>(null==e?void 0:e.modifiedDate)?Xe(null==e?void 0:e.modifiedDate):(null==e?void 0:e.lastUpdatedDate)?Xe(null==e?void 0:e.lastUpdatedDate):"-",hr=e=>{var t,a;const[s,r]=w.useState({}),[i,n]=w.useState(!0),[l,o]=w.useState(!1),[c,d]=w.useState(0);w.useState(!1),w.useContext(le),w.useEffect((()=>{u()}),[c]);const u=()=>{var t,a;o(!0);let s=e.domainUrl?{domainName:e.data.sdkDomain}:{appGuid:e.appId,deviceTypeId:0===c?1:3};!1===(null==e?void 0:e.isModal)&&(s=(null==(t=null==e?void 0:e.domainUrl)?void 0:t.length)>0?{domainName:null==(a=null==e?void 0:e.domainUrl)?void 0:a.replace(/^https?:\/\//,"").replace(/\/$/,"")}:{appGuid:null==e?void 0:e.appId,deviceTypeId:0===c?1:3}),ce({path:qe,params:s,ok:e=>{e.status&&void 0!==e.data&&(Je.info("setSdkHealthData",null==e?void 0:e.data),r((null==e?void 0:e.data)||{})),o(!1)},fail:e=>{o(!1)}})},h=()=>y.jsx(y.Fragment,{children:l?y.jsx(fr,{}):y.jsxs("div",{children:[!e.domainUrl&&y.jsx("div",{className:"p-nav-right paddingT15 paddingB15",children:y.jsx(Ua,{defaultSelectedItem:c,defaultClass:"",dynamicTab:"mini marginB0",activeClass:"active",tabData:[{id:1001,text:"Android"},{id:1002,text:"iOS"}],callBack:(e,t)=>{d(t)}})}),y.jsx("div",{className:"sdk-health-wrapper",children:y.jsx("div",{className:"sdk-grid",children:Object.entries(s).map((([e,t])=>{const a="object"==typeof t?null==t?void 0:t.status:null;return y.jsxs("div",{className:"sdk-card",children:[y.jsxs("div",{className:"sdk-card-header",children:[y.jsx("div",{className:"sdk-title",children:y.jsxs("h4",{children:[cr[e]," "]})}),y.jsx("span",{className:`sdk-status ${dr(e,a).toLowerCase().replace(" ","")}`,children:dr(e,a)})]}),y.jsxs("div",{className:"sdk-meta",children:[y.jsxs("div",{className:"sdk-meta-date",children:["Last updated: ",ur(t)]}),y.jsx("div",{onClick:()=>{alert("Coming soon")},children:y.jsx("span",{className:"sdk-info",children:y.jsx("i",{className:"icon-rs-circle-info-medium icon-md primary-color"})})})]})]},e)}))})})]})});return y.jsx("div",{children:!1===(null==e?void 0:e.isModal)?y.jsx(h,{}):y.jsxs(Da,{className:"dynamic-list-fill",show:i,onHide:()=>n(!1),size:"xlg",centered:!0,children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{className:"truncate330",children:e.domainUrl?(null==(t=e.data)?void 0:t.domainName)+" ":(null==(a=e.data)?void 0:a.appName)+" "||""}),y.jsxs("div",{className:"blue float-end mr30",children:[y.jsx("small",{children:y.jsx("span",{children:e.domainUrl?"":Xe(new Date,!1)})}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{n(!1)}})]})]}),y.jsx(Da.Body,{className:"p0 pb20",children:y.jsx(h,{})})]})})},fr=e=>y.jsx("div",{className:"sdk-health-wrapper",children:y.jsx("div",{className:"sdk-grid",children:Array.from({length:12}).map(((e,t)=>y.jsxs("div",{className:"sdk-card skeleton",children:[y.jsxs("div",{className:"sdk-card-header",children:[y.jsx("div",{className:"skeleton-title shimmer"}),y.jsx("div",{className:"skeleton-status shimmer"})]}),y.jsx("div",{className:"skeleton-meta shimmer"})]},t)))})}),mr=[{text:"Web"},{text:"Custom event"}],pr=e=>{const t=T();O.parse(t.location.search);const a=w.useContext(le),[s,r]=w.useState(!1);w.useState(!1);const[i,n]=w.useState(e.dataItem.isPriority),[l,o]=w.useState(!1),[c,d]=w.useState(!1),[u,h]=w.useState(!1),[f,m]=w.useState(!1),[p,v]=w.useState(!1);w.useEffect((()=>{g(),O.parse(t.location.search).webft&&e.onIndexChange(3)}),[]);const g=()=>{let e=!1,t=!1,a=!1;const s=Qe("Communication settings");1==(null==s?void 0:s.get_AddAccessData)&&(e=!0),t=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(a=!0),h(e),m(t),v(a)};return y.jsx(y.Fragment,{children:y.jsxs("td",{children:[y.jsxs(_e,{className:"float-end",children:[y.jsx(Ue,{text:"Field tracking",position:"top",children:y.jsx("i",{className:"icon-rs-event-tracking-medium color-primary-blue icons-md cp click-off "+(f?"click-on":"click-off"),onClick:()=>{e.updateOnboardId&&e.updateOnboardId(e.dataItem.onBoardingId),e.webfirebaseconfigID&&e.webfirebaseconfigID(e.dataItem.webfirebaseconfigID),e.webGuid(e.dataItem.webGuid),e.onModeChange("edit"),e.onIndexChange(3)}})}),y.jsx(ke,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",size:"md",iconClass:"",mainClass:f?"click-on":"click-off",onClick:()=>{e.updateOnboardId&&e.updateOnboardId(e.dataItem.onBoardingId),e.webfirebaseconfigID&&e.webfirebaseconfigID(e.dataItem.webfirebaseconfigID),e.webGuid(e.dataItem.webGuid),e.onIndexChange(1),e.onModeChange("edit");const t=`${window.location.origin}${window.location.pathname}?wa=${e.dataItem.onBoardingId}&webGuid=${e.dataItem.webGuid}`;window.history.pushState({path:t},"",t)}}),y.jsx(ke,{tooltip:"Goal",icon:"icon-rs-communication-target-medium",size:"lg",iconClass:"",mainClass:f?"click-on":"click-off",onClick:()=>{e.addGoal(!0),e.goalId(e.dataItem.onBoardingId),e.domName(e.dataItem.domainName)}}),y.jsx(ke,{tooltip:"Settings",icon:"icon-rs-settings-medium",size:"md",iconClass:"",mainClass:f?"click-on":"click-off",onClick:()=>{e.webGuid(e.dataItem.webGuid),e.updateOnboardId&&e.updateOnboardId(e.dataItem.onBoardingId);let t={webGuid:e.dataItem.webGuid,onBoardingId:e.dataItem.onBoardingId};e.cb(!0,t);const a=`${window.location.origin}${window.location.pathname}?wa=${e.dataItem.onBoardingId}&webGuid=${e.dataItem.webGuid}&isAppPermission=true`;window.history.pushState({path:a},"",a)}}),y.jsx(ke,{tooltip:"Health check",icon:"icon-rs-heart-medium",size:"md",iconClass:"",mainClass:f?"click-on":"click-off",onClick:()=>{e.healthCheck(e.dataItem)}}),y.jsx(ke,{tooltip:"Info",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:f?"click-on":"click-off",onClick:()=>{o(!0),e.viewButton(e.dataItem.domainURL)}}),l&&y.jsxs(Da,{backdrop:"static",show:!0,centered:!0,size:"lg",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"One line SDK"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{o(!1)}})]}),y.jsx(Da.Body,{children:(()=>{var e;let t=localStorage.getItem("lsUserData"),a=Ee(t),s=`<script fcm_service_path="/firebase-messaging-sw.js" src="https://sdk.smartdx.co/handlers/${null==(e=null==a?void 0:a.clientDetailsLocalization)?void 0:e.tenantId.replaceAll("_","")}.sdk" defer="defer"><\/script>`;return y.jsxs("div",{className:"",children:[y.jsx(Fa,{para:"",value:s}),c?y.jsx("div",{className:"copied-btn mt20",children:"Copied"}):null,y.jsx("div",{className:"editor-save-icon cp mt20",children:y.jsx(Ue,{text:"Copy",children:y.jsx("img",{src:Ra,alt:"copy",onClick:()=>{navigator.clipboard.writeText(s),d(!0),setTimeout((()=>{d(!1)}),1e3)}})})})]})})()})]}),y.jsx(ke,{tooltip:"Priority",icon:"icon-rs-crown-fill-medium",size:"md",iconClass:`${me()?"click-off":""} ${!0===i?"orange":"grey"} ${f?"click-on":"click-off"}`,mainClass:"",onClick:()=>{var t,s;(0===e.list.filter((e=>e.isPriority)).length||!0===e.dataItem.isPriority)&&(e.dataItem.isPriority=!e.dataItem.isPriority,n(!e.dataItem.isPriority),t=e.dataItem.webGuid,s=e.dataItem.isPriority,ce({path:lt,params:{webGuid:t,isPriority:s},loading:a.globalStateData.setIsLoadingData,sessionOut:a.globalStateData.setSessionOutData,ok:t=>{t.status?e.callback():r(!1)},fail:e=>{oe("Update Priority error",e.message)}}))}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",size:"md",iconClass:`${!0===me()?"click-off":""} ${p?"click-on":"click-off"}`,mainClass:"",onClick:()=>{e.deleteData(e.dataItem.webGuid)}})]}),!0===s&&y.jsx(ja,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{r(!1)}})]})})},vr=(e,t)=>({result:Z(t.slice(0),e),dataState:e}),gr=e=>{const t=w.useContext(le),a=w.useContext(Ze),s=T();O.parse(s.location.search);const[r,i]=k.useState(null),[n,l]=k.useState(vr({skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]},[]).dataState),[o,c]=w.useState(null),[d,u]=w.useState(!1),[h,f]=w.useState(""),[m,p]=w.useState(!1),[v,g]=w.useState(!1),[b,x]=w.useState(!1),[S,D]=w.useState({});w.useState(!1),w.useState(""),w.useState({});const[C,E]=w.useState(!1),[N,A]=w.useState(0),[I,j]=w.useState(!0),[_,L]=w.useState(!1),[F,M]=w.useState(!1),[R,P]=w.useState(0),[U,B]=w.useState(!1),[G,V]=w.useState(""),[W,H]=w.useState(""),[z,Y]=w.useState(""),[K,$]=w.useState(!1),[q,J]=w.useState(!1),[X,Z]=w.useState(!1);w.useEffect((()=>{a.apiStateData.setIsReloadData(!1),e.webList&&Q()}),[a.apiStateData.getIsReloadData]),w.useEffect((()=>{let e=!1,t=!1,a=!1;const s=Qe("Communication settings");1==(null==s?void 0:s.get_AddAccessData)&&(e=!0),t=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(a=!0),$(e),J(t),Z(a)}),[]);const Q=()=>{j(!0),ce({path:et,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{if(e.status){let t=vr({take:5,skip:0},null==e?void 0:e.data);l(t.dataState),c(e.data),i(t.result),u(!1),j(!1)}else{let e=vr({take:5,skip:0},[]);l(e.dataState),c(null),i(e.result),u(!0),j(!1)}},fail:e=>{oe("GET_WEB_PUSH",e.statusText),u(!0),j(!1)}})};return y.jsxs("div",{className:"box-design rs-box-min-height",children:[!0===m&&y.jsx(_a,{size:"md",headerTitle:"Web push notification",para:"Are you sure you want to delete this item?",pClass:"text-center mb0",primaryButtonText:"OK",secondaryButtonText:"Cancel",buttonClicked:e=>{p(!1),!0===e&&ce({path:it,params:{WebGuid:h},loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{if(e.status){let a=vr({take:5,skip:0},null==e?void 0:e.data);l(a.dataState),c(e.data),i(a.result),u(!0),Be(t,(e=>{}))}else{g(!0);let e=vr({take:5,skip:0},[]);l(e.dataState),c(null),i(e.result),u(!0)}},fail:e=>{oe("Get delete push edit error",e.message)}})}}),b&&y.jsx(hr,{title:"Web push",data:S,domainUrl:(null==S?void 0:S.sdkDomain)||"",close:()=>{x(!b)}}),!0===v&&y.jsx(ja,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{g(!1)}}),!0===C&&y.jsx(ja,{size:"md",headerTitle:"Web push",para:"Web push limit exceeded, please upgrade your plan.",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:e=>{E(!1),!0===e&&s.push("/subscription")}}),4===N&&y.jsx(Da,{show:!0,centered:!0,onHide:()=>A(0),children:y.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[y.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),y.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>A(0)})]})}),y.jsxs("div",{children:[y.jsx(Ua,{className:"",defaultSelectedItem:R,defaultClass:"",dynamicTab:"mini float-end mb10",activeClass:"active",tabData:mr,callBack:(e,t)=>{"Goal"===(null==e?void 0:e.text)?(L(!0),B(!0),V(null==e?void 0:e.text)):"Custom event"===(null==e?void 0:e.text)?(M(!0),L(!1),B(!0),V(null==e?void 0:e.text)):(L(!1),M(!1),B(!1)),P(t)}}),y.jsx("div",{className:"clearfix mb10",children:" "})]}),_?y.jsx(br,{setting:!!U,goalTab:U,domId:W,domName:z,onIndexChangeValue:e=>{P(e),L(!1)}}):F?y.jsx(y.Fragment,{children:y.jsx(lr,{web:"Web",onboardingId:"onboardId",webfirebaseconfigID:"webfirebaseconfigID",webGuid:"webGuid",mode:"mode",cb:e=>{setCurrentComponent(e),P(e),L(!1),M(!1)}})}):y.jsxs("div",{children:[y.jsxs("div",{className:"d-flex justify-content-between "+(!0===I?"click-":"click-on"),children:[y.jsx("h3",{className:"marginB20",children:null===o?"":(null==o?void 0:o.length)>1?"Websites":"Website"}),y.jsx(ke,{shadow:!0,tooltip:"Add website",iconClass:`${!0===me()?"click-off":""} ${K?"click-on":"click-off"}`,icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",onClick:()=>{if(!0===tt((null==o?void 0:o.length)||0)){e.onModeChange("add"),e.webGuid(0),e.updateCurrentComponent(1),e.updateOnboardId&&e.updateOnboardId(0);const t=`${window.location.origin}${window.location.pathname}?wa=1`;window.history.pushState({path:t},"",t)}else{let e=at();if(null!==e&&4===(null==e?void 0:e.planId))return void A(e.planId);E(!0)}}})]}),(null==o?void 0:o.length)?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:{take:5,skip:0},data:o,settings:{total:null==o?void 0:o.length},isDataStateRequired:!1,pageable:!0,onDataStateChange:e=>{let t=vr(e.dataState,o);i(t.result),l(t.dataState)},...n,column:[{field:"domainName",title:"Domain name"},{field:"userName",title:"Created by",cell:e=>{var t,a,s,r;let i=0===(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.userName)?void 0:a.length)?ss:(null==(s=null==e?void 0:e.dataItem)?void 0:s.userName)||(null==(r=nt())?void 0:r.clientName)||"";return y.jsx("td",{children:i})}},{field:"createdDate",title:"Created date",cell:e=>y.jsx("td",{children:Ge(e.dataItem.createdDate,!1)})},{field:"action",title:"Actions",cell:t=>y.jsx(pr,{list:o,...t,updateOnboardId:e.updateOnboardId,webfirebaseconfigID:e.webfirebaseconfigID,cb:e.cb,webGuid:e.webGuid,onModeChange:t=>{e.onModeChange(t)},onIndexChange:t=>{e.updateCurrentComponent(t)},callback:()=>{Q()},deleteData:e=>{f(e),p(!0)},viewButton:e.viewButton,healthCheck:e=>{x(!b),D(e)},addGoal:e=>{L(e)},goalId:e=>{H(e)},domName:e=>{Y(e)}})}]})}):y.jsx("div",{className:"p0 mt15",children:y.jsx(Ia,{count:5,isError:d,children:y.jsx("div",{className:`nodata-bar add-func ${me()&&"click-off"}`,onClick:()=>{if(!0===tt((null==o?void 0:o.length)||0)){e.onModeChange("add"),e.webGuid(0),e.updateCurrentComponent(1),e.updateOnboardId&&e.updateOnboardId(0);const t=`${window.location.origin}${window.location.pathname}?wa=1`;window.history.pushState({path:t},"",t)}else{let e=at();if(null!==e&&4===(null==e?void 0:e.planId))return void A(e.planId);E(!0)}},children:y.jsxs(y.Fragment,{children:[y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5"}),y.jsx("p",{children:"Create"})]})})})})]})]})},br=e=>{const t=w.useContext(le),[a,s]=w.useState(!1),[r,i]=w.useState(""),[n,l]=w.useState(""),[o,c]=w.useState([]),[d,u]=w.useState(""),[h,f]=w.useState(""),[m,p]=w.useState(null),[v,g]=w.useState(null),[b,x]=w.useState(null),[S,T]=w.useState(""),[k,D]=w.useState(0),[C,E]=w.useState(null),[N,A]=w.useState(""),[I,j]=w.useState(!1),[_,O]=w.useState(!1),[L,F]=w.useState([{friendlyName:"",goalType:"",goalTypeSpecific:"",errFriendlyNameData:"",errGoalType:"",errPageUrl:"",errCustEve:""}]),[M,R]=w.useState(!0),[P,U]=w.useState(!1);w.useEffect((()=>{var t;const a=Oe(),s=null==a?void 0:a.domainsList;g(s);const r=s.map((e=>null==e?void 0:e.domainUrl));r.length&&c(r);let i=s.filter((t=>t.domainName===(null==e?void 0:e.domName)));f(null==(t=i[0])?void 0:t.domainUrl)}),[]),w.useEffect((()=>{B()}),[b]);const B=()=>{let e=null;if((null==b?void 0:b.webGoalJSON)&&(e=JSON.parse(null==b?void 0:b.webGoalJSON),D(null==b?void 0:b.webNotifyGoalSettingID)),b){i(b.webNotifyGoalName);const t=Oe();null==t||t.domainsList,F(null==e?void 0:e.Tracking_Type.map((e=>({friendlyName:e.friendlyName,goalType:e.goalType,goalTypeSpecific:e.goalTypeSpecific,errFriendlyNameData:"",errGoalType:"",errPageUrl:"",errCustEve:""}))))}};w.useEffect((()=>{I&&G()}),[C]);const G=a=>{let i={StatusID:N||"1",WebGoalJSON:a,WebNotifYGoalName:r,WebNotifySettingID:(null==e?void 0:e.domId)||m,WebNotifyGoalSettingID:"edit"===S?k:0};ce({path:st,params:i,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{(null==e?void 0:e.status)&&(s(!1),O(!0),U(!0))},fail:e=>{}})},V=({index:e,friendlyName:a,goalType:s,goalTypeSpecific:r,onFriendlyNameChange:i,onErrFriendlyNameChange:n,errFriendName:l,onErrGoalType:o,errGoalTypeVal:c,errPageUrlVal:d,errCustEveVal:u,onErrPageUrl:f,onErrCustEve:m,onGoalTypeChange:p,onGoalTypeSpecificChange:v,onAddRow:g,onRemoveRow:b,isAddDisabled:x})=>{const[S,T]=w.useState(a),[k,D]=w.useState(r),[C,E]=w.useState(r),[N,A]=w.useState(""),[I,j]=w.useState(""),[_,O]=w.useState(""),[L,F]=w.useState(""),[M,R]=w.useState([]);return w.useEffect((()=>{T(a),D(r),E(r),A(l),j(c),O(d),F(u)}),[a,r]),y.jsxs("div",{className:"d-flex align-items-center mt-3",children:[y.jsx(ka,{md:3,className:"mt25",children:y.jsx(ie,{name:"Friendlyname",placeholder:"Friendly name",required:!0,val:S,max:150,handleOnchange:e=>{T(e),A("")},handleOnBlur:e=>{i(e),n(e),(null==e?void 0:e.length)||A("Enter friendly name")},errorMessage:N})}),y.jsx(ka,{md:3,className:"mt25 ml15",children:y.jsx(te,{required:!0,label:"Goal type",data:["Page URL","Custom events"],value:s,handleChange:e=>{p(e),o(e),j(""),"Custom events"===(null==e?void 0:e.value)&&ce({path:ot,isServiceWorker:!1,params:{domainName:h,listType:"CustomEvents"},sessionOut:t.globalStateData.setSessionOutData,ok:e=>{var t;(null==e?void 0:e.status)&&setCustList(null==(t=null==e?void 0:e.data)?void 0:t.appdataList)},fail:e=>{}})},errorMessage:I})}),"Page URL"===s?y.jsx(ka,{md:3,className:"mt25 ml15",children:y.jsx(ie,{name:"Goal tracking type",placeholder:"Page URL",required:!0,max:150,val:k,handleOnchange:e=>{D(e),O("")},handleOnBlur:e=>{f(e),v(e),(null==e?void 0:e.length)||O("Enter page URL")},errorMessage:_})}):y.jsx(ka,{md:3,className:"mt25 ml15",children:y.jsx(te,{required:!0,label:"Custom events",data:M,value:C,handleChange:e=>{E(null==e?void 0:e.value),m(e),v(e),F("")},errorMessage:L})}),0===e?y.jsx("div",{className:"ml15 mt25",children:y.jsx(ke,{shadow:!0,tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",onClick:()=>{g()},disabled:x})}):y.jsx("div",{className:"ml15 mt25",children:y.jsx(ke,{shadow:!0,tooltip:"Remove",icon:"icon-rs-circle-minus-fill-edge-medium icons-md red",size:"md",onClick:()=>b(e)})})]})},W=()=>{s(!1),i(""),l(""),c([]),u(""),f(""),p(null),g(null),x(null),T(""),D(0),E(null),A(""),j(!1),O(!1),F([{friendlyName:"",goalType:"",goalTypeSpecific:"",errFriendlyNameData:"",errGoalType:"",errPageUrl:"",errCustEve:""}]),R(!0),U(!1)},H=w.useCallback((()=>y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{children:"Goal settings"}),y.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[y.jsx(ke,{shadow:!0,tooltip:"Add Goal",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",onClick:()=>{s(!0),R(!1),U(!1)}}),y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",id:"dl_back_button",onClick:()=>{W(),null==e||e.onIndexChangeValue(0)},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})]})]}),y.jsx(xr,{domId:(null==e?void 0:e.domId)||m,webGoalApi:_,dataObj:e=>{x(e),s(!0),T("edit"),R(!1)},paramsObj:(e,t)=>{let a=JSON.stringify(t),s=JSON.parse(a);E(s),A(!0===e?"1":"0"),j(!0)}})]})),[_]);return y.jsx("div",{children:y.jsx(y.Fragment,{children:P?y.jsx(H,{}):a||(null==e?void 0:e.setting)?y.jsx(y.Fragment,{children:(()=>{const t=(e,t,a)=>{const s=[...L];s[e][t]=a,F(s)},a=(null==L?void 0:L.length)>=10;return y.jsxs("div",{className:"ml30",children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{children:"Goal settings"}),y.jsx("div",{style:{display:"flex",alignItems:"center"},children:y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",id:"dl_back_button",onClick:()=>{(null==e?void 0:e.goalTab)?null==e||e.onIndexChangeValue(0):U(!0)},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})})]}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Domain name"})}),y.jsx(ka,{md:6,children:y.jsx(te,{disabled:!0,required:!0,label:"Domain name",data:o,value:h,onChange:e=>{var t,a;(null==(t=null==e?void 0:e.value)?void 0:t.length)&&u(""),f(null==e?void 0:e.value);let s=v.filter((t=>t.domainUrl.toLowerCase()===(null==e?void 0:e.value.toLowerCase())));p(null==(a=s[0])?void 0:a.onBoardingId)},errorMessage:d})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Goal name"})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"goalname",placeholder:"Goal name",required:!0,val:r,max:150,handleOnchange:e=>{let t=0===e.length?"Enter goal name":"";l(t),i(e)},handleOnBlur:e=>{let t=0===e.length?"Enter goal name":"";l(t)},errorMessage:n})})]})}),y.jsxs(ga,{children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Goal tracking type"})}),null==L?void 0:L.map(((e,s)=>y.jsx(ka,{md:0===s?9:{span:9,offset:3},children:y.jsx(V,{index:s,friendlyName:e.friendlyName,goalType:e.goalType,goalTypeSpecific:e.goalTypeSpecific,errFriendName:e.errFriendlyNameData,errGoalTypeVal:e.errGoalType,errPageUrlVal:e.errPageUrl,errCustEveVal:e.errCustEve,onFriendlyNameChange:e=>t(s,"friendlyName",e),onErrFriendlyNameChange:e=>((e,t,a)=>{const s=[...L];s[e].errFriendlyNameData=0===a.length?"Enter friendly name":"",F(s)})(s,0,e),onErrGoalType:e=>(e=>{const t=[...L];t[e].errGoalType=""===L[e].goalType?"Enter goal type":"",F(t)})(s),onErrPageUrl:e=>((e,t,a)=>{const s=[...L];s[e].errPageUrl=0===a.length?"Enter page URL":"",F(s)})(s,0,e),onErrCustEve:e=>((e,t,a)=>{const s=[...L];s[e].errCustEve=0===a.length?"Select custom event":"",F(s)})(s,0,e),onGoalTypeChange:e=>{const a=e.value||e.target.value;t(s,"goalType",a)},onGoalTypeSpecificChange:e=>{var a;const r=e.value||(null==(a=e.target)?void 0:a.value)||e;t(s,"goalTypeSpecific",r)},onAddRow:()=>{if(L.every((e=>e.friendlyName.length>0&&e.goalType.length>0&&("Page URL"===e.goalType&&e.goalTypeSpecific.length>0||"Custom events"===e.goalType&&e.goalTypeSpecific.length>0))))L.length<10&&F([...L,{friendlyName:"",goalType:"",goalTypeSpecific:"",errFriendlyNameData:"",errGoalType:"",errPageUrl:"",errCustEve:""}]);else{let e=!1,t=[...L];t.map((t=>{if(!e)return(null==t?void 0:t.friendlyName.length)?t.goalType.length?"Page URL"!==t.goalType||t.goalTypeSpecific.length?"Custom events"!==t.goalType||t.goalTypeSpecific.length?void 0:(t.errCustEve="Select custom events",void(e=!0)):(t.errPageUrl="Enter page URL",void(e=!0)):(t.errGoalType="Select goal type",void(e=!0)):(t.errFriendlyNameData="Enter friendly name",void(e=!0))})),F(t)}},onRemoveRow:()=>(e=>{F(L.filter(((t,a)=>a!==e)))})(s),isAddDisabled:a},s)})))]}),y.jsxs("div",{className:"justify-content-end position-relative d-flex mt20 t40",children:[y.jsx(he,{onClick:()=>{W(),(null==e?void 0:e.goalTab)?null==e||e.onIndexChangeValue(0):U(!0)},children:"Cancel"}),y.jsx(fe,{onClick:()=>{let t=!1;if((null==e?void 0:e.setting)&&""===h)return u("Select domain name"),void(t=!0);if(""===r)return l("Enter goal name"),void(t=!0);let a=[...L];a.map(((e,s)=>{var r,i,n,l,o,c;if(!0!==t)return(null==(r=a[s])?void 0:r.friendlyName.length)?(null==(i=a[s])?void 0:i.goalType.length)?"Page URL"!==(null==(n=a[s])?void 0:n.goalType)||(null==(l=a[s])?void 0:l.goalTypeSpecific.length)?"Custom events"!==(null==(o=a[s])?void 0:o.goalType)||(null==(c=a[s])?void 0:c.goalTypeSpecific.length)?void 0:(a[s].errCustEve="Select custom events",void(t=!0)):(a[s].errPageUrl="Enter page URL",void(t=!0)):(a[s].errGoalType="Select goal type",void(t=!0)):(a[s].errFriendlyNameData="Enter friendly name",void(t=!0))})),F(a);let s={Tracking_Type:L},i=JSON.stringify(s);!1===t&&G(i)},children:"Save"})]})]})]})})()}):y.jsx(y.Fragment,{children:y.jsx(H,{})})})})},xr=e=>{const t=w.useContext(le),[a,s]=w.useState([]),[r,i]=w.useState(!1),[n,l]=w.useState(null==e?void 0:e.domId),o=w.useCallback((e=>{h(e)}),[]),c=w.useCallback((e=>y.jsx(Sr,{...e,changeStatusID:e=>{o(e)}}))),d=w.useCallback(((t,a)=>{null==e||e.dataObj(a)}),[]),u=w.useCallback((()=>{f()}),[]);w.useEffect((()=>{u(),l(null==e?void 0:e.domId)}),[]);const h=e=>{t.globalStateData.setIsLoadingData(!0),ce({path:st,params:e,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{(null==e?void 0:e.status)?f():t.globalStateData.setIsLoadingData(!1)},fail:e=>{t.globalStateData.setIsLoadingData(!1)}})},f=()=>{let a={WebNotifySettingID:(null==e?void 0:e.domId)||n};ce({path:rt,params:a,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{if((null==e?void 0:e.status)&&(null==e?void 0:e.data.length)){let t=null==e?void 0:e.data;s(t),i(!1)}else i(!0);t.globalStateData.setIsLoadingData(!1)},fail:e=>{i(!0),t.globalStateData.setIsLoadingData(!1)}})};return y.jsx("div",{children:(null==a?void 0:a.length)?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:{take:5,skip:0},data:a,pageable:(null==a?void 0:a.length)>5,settings:{total:null==a?void 0:a.length},isDataStateRequired:!1,column:[{field:"domainName",title:"Domain name"},{field:"webNotifyGoalName",title:"Goal name",cell:e=>y.jsx("td",{children:y.jsx("div",{style:{display:"table-cell"},className:"text-underline-h cp",onClick:t=>d(t,e.dataItem),children:e.dataItem.webNotifyGoalName})})},{field:"action",title:"Status",width:"200",cell:c}]})}):y.jsx("div",{children:y.jsx("div",{className:"p0 mt15",children:y.jsx(Ia,{count:5,isError:r})})})})},yr=S((e=>{const t=T(),[a,s]=w.useState(null),[r,i]=w.useState(null),[n,l]=w.useState(0),[o,c]=w.useState(0);w.useState(!1);const[d,u]=w.useState("add"),[h,f]=w.useState(!0);w.useEffect((()=>{var t,a;0===(null==(a=null==(t=null==e?void 0:e.location)?void 0:t.state)?void 0:a.selectIndex)&&c(1)}),[e]),w.useEffect((()=>{let e=O.parse(window.location.search);(null==e?void 0:e.wa)&&(null==e?void 0:e.webGuid)&&(null==e?void 0:e.isAppPermission)||(null==e?void 0:e.wa)&&c(1)}),[]);const m=[y.jsx(gr,{webList:h,updateOnboardId:e=>{s(e)},webfirebaseconfigID:e=>{l(e)},webGuid:e=>{i(e)},cb:e.cb,onModeChange:e=>{u(e)},updateCurrentComponent:e=>{2!=e?(f(!1),c(e)):t.push("web-sdk",{domainId:r})},viewButton:e=>{},onboardingId:a,webfirebaseconfigid:n,webGuID:r,mode:d,cb1:e=>{c(e)}}),y.jsx(hs,{onboardingId:a,webfirebaseconfigID:n,webGuid:r,mode:d,cb:e=>{f(!0),c(e);const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t)}}),y.jsx(Js,{onChangeIndex:e=>setIndex(e),updateOnboardId:e=>s(e)}),y.jsx(lr,{web:"Web",onboardingId:a,webfirebaseconfigID:n,webGuid:r,mode:d,cb:e=>{c(e)}})];return y.jsx(y.Fragment,{children:m[o]})})),Sr=e=>{var t,a;const[s,r]=w.useState("1"===(null==(t=null==e?void 0:e.dataItem)?void 0:t.statusID));return w.useEffect((()=>{var t;r("1"===(null==(t=null==e?void 0:e.dataItem)?void 0:t.statusID))}),[null==(a=null==e?void 0:e.dataItem)?void 0:a.statusID]),y.jsx("td",{children:y.jsx("div",{className:"text-end ",children:y.jsx(R,{className:"mt0",checked:s,onChange:t=>{r(t.value);let a={...null==e?void 0:e.dataItem};a.statusID=t.value?1:0,e.changeStatusID(a)}})})})},wr=e=>{const t=w.useContext(le);T();const[a,s]=w.useState(""),[r,i]=w.useState(!1),[n,l]=w.useState(null),[o,c]=w.useState(""),[d,u]=w.useState(null),[h,f]=w.useState(null),[m,p]=w.useState(null),[v,g]=w.useState(!1),[b,x]=w.useState(!1),[S,k]=w.useState(null);w.useEffect((()=>{let t=O.parse(window.location.search);if(null==t?void 0:t.ma)try{let e=window.atob(null==t?void 0:t.ma);e&&"0"!==e?D(e):g(!0)}catch{}else e.updateOnboardId&&e.updateOnboardId.length>0?D(e.updateOnboardId):g(!0)}),[]);const D=e=>{ce({path:ct,params:{appGuid:e},loading:t.globalStateData.setIsLoadingData,ok:e=>{var t;e.status&&e.data?(s(e.data.appName),l(!0),c(null==(t=null==e?void 0:e.data)?void 0:t.appIdendifier),p(e.data.mobilepushdeviceinfo),g(!0)):(x(!0),k((null==e?void 0:e.message)||Ce))},fail:e=>[]})};return y.jsxs("div",{className:`mr25 ${e.noPannel?"":"box-design rs-box-min-height p30"} `,children:[y.jsx("div",{className:"marginT10",children:y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:3,children:y.jsx("h4",{className:"font-regular",children:"App onboarding"})})})})}),y.jsxs("div",{className:"onboard-header-label",children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"App name"})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"appname",placeholder:"App name",isLoading:r,iconPlaceholder:!0,iconName:null!==n?!0===n?"icon-rs-circle-tick-medium icons-md green":"icon-rs-circle-close-edge-mini icons-md red":"",required:!0,val:a,max:150,handleOnchange:e=>{if(e.length<=150){let t=e.trimStart();if(e.includes("'"))return;if(!0===/^[' 'A-Za-z0-9_-]*$/.test(t)){let a=t.replace(/\s+/g," ");if(a.length>150)return void u("App name exceeded the limit");let r=a.length>0?null:dt;""===a?r=dt:/^[' 'A-Za-z0-9_-]*$/.test(a)?r=a.length>0?null:dt:(r="Special characters are not allowed",a=a.substring(0,e.length-1)),l(null),s(a),u(r)}}},handleOnBlur:e=>{let t=e.trim(),a=t.length>0?null:dt;a=""===t?dt:/[`!@#$%^&*()+\=\[\]{};':"\\|,.<>\/?~]/.test(t)?"Special characters are not allowed":t.length>0?null:dt,u(a),t.length>0&&(e=>{let t={isApp:!0,appName:e};i(!0),ce({path:Se,params:t,ok:e=>{i(!1),!1===e.status?(u(e.message),l(!1)):(u(null),l(!0))},fail:e=>{i(!1),l(!1),u(null==e?void 0:e.message)}})})(t)},errorMessage:d})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{className:"theme-space mb23",children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"User identifier"})}),y.jsx(ka,{md:6,children:y.jsx(te,{required:!0,label:"User identifier",errorMessage:h,data:["Email id","Mobile number","Brand id (brand defined unique id)"],className:"required",value:""!==o?o:"-- Select user identifier --",placeholder:""!==o?o:"-- Select user identifier --",onChange:e=>{let t=e.target.value.length>0?null:"Select user identifier";c(e.target.value),f(t)}})})]})})]}),v&&y.jsx(Tr,{appName:a,appNameErr:d,appIdendifier:o,appIdendifierErr:h,mode:e.mode,data:m&&m,onBoardingId:void 0!==e.updateOnboardId&&null!==e.updateOnboardId?e.updateOnboardId:0,onChangeIndex:e.onChangeIndex,onErrAppName:e=>{u(e)},onErrAppIdentifier:e=>{f(e)}}),!0===b&&y.jsx(ja,{headerTitle:"Sorry",subtitle:S,primaryButtonText:"OK",buttonClicked:e=>{x(!1)}})]})},Tr=e=>{const t=w.useContext(le),a=T(),[s,r]=w.useState(""),[i,n]=w.useState("");w.useState(!0);const[l,o]=w.useState(!1),[c,d]=w.useState(""),[u,h]=w.useState("");w.useState("");const[f,m]=w.useState(""),[p,v]=w.useState(!0),[g,b]=w.useState(!1),[x,S]=w.useState(""),[k,D]=w.useState(""),[C,E]=w.useState(0),[A,I]=w.useState([0]),[j,_]=w.useState(0),[F,M]=w.useState(null);w.useState(""),w.useState(""),w.useState("");const[P,U]=w.useState("0"),[B,G]=w.useState(null),[V,W]=w.useState(null),[H,z]=w.useState(null),[Y,K]=w.useState(null),[$,q]=w.useState(null),[J,X]=w.useState(null),[Z,Q]=w.useState(null);w.useState(null);const[ee,se]=w.useState("Native"),[re,ne]=w.useState("Hybrid"),[oe,de]=w.useState("lg"),[ue,ye]=w.useState([{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]),[Se,we]=w.useState([Ee()]),[Te,ke]=w.useState(!1),[De,Ce]=w.useState([]);function Ee(e){return{mpdevid:0,device:"",deviceId:"",storeurl:"",bundleIdentifier:"",uniqueId:"",fcm:!0,apns:!1,np:"fcm v1http",lg:"",matchType:"radio"+e+1,npMatchType:"npradio"+e+1,npFcmv1:"npFcm"+e+1,labelnativeId:"labeln"+e+1,labelhybirdId:"labelh"+e+1,labelFCMId:"labelFCM"+e+1,labelAPNSId:"labelAPNS"+e+1,labelId:"label",vapidKey:"",fcmsenderid:"",fcmserverkey:"",certpath:"",apnsTeamId:"",apnsKeyId:"",apnsIsProducation:"Producation",fcmServiceFileName:"",fcmServiceFileContent:"",certpassword:"",native:!0,hybrid:!1,lagunage:"",analytics:!1,analyticsDetails:[],errorMessage:{analyticsError:{},errPlatform:null,errStoreURL:null,errBundleIdentifier:null,errUniqueId:null,errFCMSenderID:null,errFCMServerKey:null,errLanguage:null,errHybridLanguage:null,errCertificate:null,errCertPassword:null,errApnsTeamId:null,errApnsKeyId:null,errVapidKey:null},errAnalytics:[{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]}}function Ne(){var t=!0;return Se.map(((a,s)=>{if(!1!==t){if(pe(a.device))return a.errorMessage.errPlatform=ft,G(ft),void(t=!1);if(pe(a.storeurl))return a.device.toLowerCase().includes("an")?(a.errorMessage.errStoreURL=mt,W(mt)):(W(pt),a.errorMessage.errStoreURL=pt),void(t=!1);if(pe(a.bundleIdentifier)){let e=[...Se];return e[s].errorMessage.errBundleIdentifier="Enter bundle identifier",we(e),void(t=!1)}if("fcm"===a.np.toLowerCase()){if(pe(a.fcmsenderid))return z(gt),a.errorMessage.errFCMSenderID=gt,void(t=!1);if(pe(a.fcmserverkey))return a.errorMessage.errFCMServerKey=bt,K(bt),void(t=!1)}else if("fcm v1http"===a.np.toLowerCase()){if("edit"===e.mode){if(pe(a.fcmServiceFileName)){let e=[...Se];return e[s].errorMessage.errFcmv1Path="Upload fcm v1 json",we(e),void(t=!1)}}else if(pe(a.fcmServiceFileName)||null===a.fcmServiceFileContent||pe(a.fcmServiceFileContent)){let e=[...Se];return e[s].errorMessage.errFcmv1Path="Upload fcm v1 json",we(e),void(t=!1)}}else if("apns"===a.np.toLowerCase()){if(pe(a.certpath))return Q(xt),a.errorMessage.errCertificate=xt,void(t=!1);if(pe(a.apnsTeamId)){let e=[...Se];return e[s].errorMessage.errApnsTeamId="Enter team id",we(e),void(t=!1)}if(pe(a.apnsKeyId)){let e=[...Se];return e[s].errorMessage.errApnsKeyId="Enter key id",we(e),void(t=!1)}}if(!a.native&&!a.hybrid)return q(St),a.errorMessage.errLanguage=St,void(t=!1);if(a.hybrid&&pe(a.lagunage))return X(yt),a.errorMessage.errHybridLanguage=yt,void(t=!1);if(a.analyticsDetails.length>0){if(t){var r=!0,i=0;a.analyticsDetails.forEach((e=>{if(pe(e.analyticsPlatform)){let e={...ue};return e[i].errAnalyticPlatform=ve,a.errAnalytics[i].errAnalyticPlatform=ve,ye(e),void(r=!1)}if(pe(e.serviceAccountMail)){let e={...ue};return e[i].errAccountMail=ge,a.errAnalytics[i].errAccountMail=ge,ye(e),void(r=!1)}if(pe(e.appKey)){let e={...ue};return e[i].errAppKey=be,a.errAnalytics[i].errAppKey=be,ye(e),void(r=!1)}if(pe(e.appSecretId)){let e={...ue};return e[i].errAppSecretID=xe,a.errAnalytics[i].errAppSecretID=xe,ye(e),void(r=!1)}i++})),t=r}}else if(a.analytics){let e={...ue};e.errAnalyticPlatform=ve,a.errAnalytics[0].errAnalyticPlatform=ve,ye(e),t=!1}}})),t}w.useEffect((()=>{var t;const a=O.parse(null==(t=window.location)?void 0:t.search);if((null==a?void 0:a.length)>5&&ke(!0),"edit"===e.mode&&e.data.length>0){let t=[],a=[],s=0;e.data&&e.data.forEach((e=>{ye([{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]),t.push(Ee(s)),a.push(s),s++})),e.data&&e.data.map(((e,a)=>{t[a].mpdevid=e.mpdevId,t[a].device=ut(e.mobplatformId),t[a].deviceId=e.deviceId,t[a].storeurl=e.appStoreUrl,t[a].fcm=""===(null==e?void 0:e.notificationProvider)||"FCM"===(null==e?void 0:e.notificationProvider)&&"fcm v1http"!==(null==e?void 0:e.notificationProvider.toLowerCase()),t[a].apns=""!==(null==e?void 0:e.notificationProvider)&&"APNS"===(null==e?void 0:e.notificationProvider),t[a].np=""===(null==e?void 0:e.notificationProvider)||"FCM"===(null==e?void 0:e.notificationProvider)||"fcm v1http"===(null==e?void 0:e.notificationProvider.toLowerCase())?"FCM V1HTTP":"APNS",t[a].lg=void 0!==e.lg&&e.lg,t[a].matchType="radio"+a+1,t[a].npMatchType="npradio"+a+1,t[a].npFcmv1="npFcm"+a+1,t[a].labelnativeId="labeln"+a+1,t[a].labelhybirdId="labelh"+a+1,t[a].labelFCMId="labelFCM"+a+1,t[a].labelAPNSId="labelAPNS"+a+1,t[a].labelId="label",t[a].fcmsenderid=e.fcmSenderId,t[a].fcmserverkey=e.fcmServerkey,t[a].certpath=void 0!==e.apnsCertificateFilePath?e.apnsCertificateFilePath:"",t[a].apnsTeamId=void 0!==e.teamId?e.teamId:"",t[a].apnsKeyId=void 0!==e.keyId?e.keyId:"",t[a].apnsIsProducation=!1===e.isProduction?"Sandbox":"Production",t[a].certpath=(null==e?void 0:e.apnsFileName)||"",t[a].bundleIdentifier=(null==e?void 0:e.bundleId)||"",t[a].fcmServiceFileName=e.fcmServiceFileName,t[a].vapidKey=(null==e?void 0:e.vapidKey)||"",t[a].certpassword=void 0!==e.apnsPassword?e.apnsPassword:"",t[a].native=0===parseInt(e.languageId),t[a].hybrid=parseInt(e.languageId)>0,t[a].lagunage=0===parseInt(e.languageId)?"":ht(parseInt(e.languageId)),t[a].analytics=void 0!==e.mobileanalyticssetting&&e.mobileanalyticssetting.length>0,e.mobileanalyticssetting&&e.mobileanalyticssetting.map(((e,s)=>{t[a].errAnalytics[s].serviceAccountEmail=e.serviceAccountEmail,t[a].errAnalytics[s].appKey=e.appKey,t[a].errAnalytics[s].appSecretId=e.appSecret,t[a].errAnalytics[s].analyticsName=Dr.filter((t=>t.id===e.analyticsId))[0].name,t[a].errAnalytics[s].analyticsId=e.analyticsId,t[a].errAnalytics[s].mobileDeviceId=e.mobileDeviceId})),t[a].analyticsDetails=void 0!==e.mobileanalyticssetting?e.mobileanalyticssetting:[],t[a].analyticsDetails.length>0&&t[a].analyticsDetails.map((e=>{e.appSecretId=e.appSecret}))})),we(t),I(a)}}),[]);const Ae=e=>e.toLowerCase().includes("iphone")?3:e.toLowerCase().includes("ipad")?4:"android phone"===e.toLowerCase()?1:"android tablet"===e.toLowerCase()?2:0;return y.jsxs("div",{className:"rs-accordin-container",children:[y.jsxs(Ca,{className:"rs-accordin",activeKey:P,children:[A.map(((t,a)=>{var s,i,l,c;let u=a;return y.jsxs(Ea,{eventKey:u.toString(),children:[y.jsx(Ea.Header,{onClick:()=>{P===u.toString()?U("-1"):U(u.toString())},children:y.jsxs("div",{className:"rs-accordin-header",children:[y.jsxs("div",{className:"d-flex align-items-center",children:[y.jsx("i",{className:`icons-md ${P===u.toString()?"icon-rs-square-minus-fill-medium grey-medium":"icon-rs-square-plus-fill-medium blue"} marginR8`}),y.jsxs("h3",{className:"marginB0",children:[" ",""!==Se[a].device?Se[a].device:"Device types"," "]})]}),0!==a?y.jsx(Ue,{text:"Remove",position:"top",children:y.jsx("i",{className:"icon-rs-circle-minus-fill-edge-medium icons-md red cursor-pointer",onClick:()=>{const e=A.indexOf(t);let a=[...A];a.splice(e,1);let s=[...De];s.push(Se[e]),Ce(s),Se.splice(e,1),E(C+1),e>-1&&I(a)}})}):null]})}),y.jsx(Ca.Collapse,{eventKey:u.toString(),children:y.jsx(Ea.Body,{children:y.jsx("div",{className:"rs-accordin-panel",children:y.jsx("div",{className:"rs-accordin-body align-space-left",id:"collapseOne","aria-labelledby":"headingOne",children:y.jsxs(y.Fragment,{children:[y.jsx(ga,{children:y.jsxs(Ta,{className:"mt10",children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Mobile platform"})}),y.jsx(ka,{md:9,children:y.jsx(te,{required:!0,label:"Platform",data:(f=[],kr.map((e=>{0===Se.filter((t=>t.device===e)).length&&f.push(e)})),f),value:""!==Se[a].device?Se[a].device:"-- Select platform --",placeholder:Se[a].device,errorMessage:null==(i=null==(s=Se[a])?void 0:s.errorMessage)?void 0:i.errPlatform,onChange:e=>{Se[a].device=e.target.value,r(e.target.value),E(C+1);let t=e.target.value.length>0?null:ft;Se[a].errorMessage.errPlatform=t,Se[a].np="fcm v1http",Se[a].errorMessage.errStoreURL=null,W(null),G(t)}})})]})}),""!==Se[a].device?y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:Se[a].device.toLowerCase().includes("an")?"Playstore URL":"App store URL"})}),y.jsx(ka,{md:9,children:y.jsx(ie,{name:"url",required:!0,placeholder:Se[a].device.toLowerCase().includes("an")?"Playstore URL":"App store URL",val:Se[a].storeurl,errorMessage:Se[a].errorMessage.errStoreURL&&Se[a].errorMessage.errStoreURL,cb:e=>{let t=e.length>0?null:Se[a].device.includes("Android")?mt:pt;W(t),Se[a].storeurl=e,n(e),Se[a].errorMessage.errStoreURL=t},ob:e=>{if(0==e.length){let e=Se[a].device.includes("Android")?mt:pt;return W(e),void(Se[a].errorMessage.errStoreURL=e)}if(vt(e))if(e.includes("https://"))Se[a].storeurl=e,n(e);else{let e=Se[a].device.includes("Android")?"Your play store url is not secured":"Your app store url is not secured";W(e),Se[a].errorMessage.errStoreURL=e}else{let e=Se[a].device.includes("Android")?"Enter valid play store URL":"Enter valid app store URL";W(e),Se[a].errorMessage.errStoreURL=e}}})})]})}):null,""!==Se[a].device?y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:" Bundle identifier"})}),y.jsx(ka,{md:9,children:y.jsx(ie,{name:"com.example.myapp",required:!0,placeholder:"com.example.myapp",val:Se[a].bundleIdentifier,cb:e=>{if(e.length<=150){let t=e.trimStart();if(e.includes("'"))return;{let e=t.replace(/\s+/g," "),s=e.length>0?null:"Enter bundle identifier",r=[...Se];r[a].bundleIdentifier=e,r[a].errorMessage.errBundleIdentifier=s,we(r)}}},errorMessage:Se[a].errorMessage.errBundleIdentifier&&Se[a].errorMessage.errBundleIdentifier})})]})}):null,y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:" Notification provider"})}),y.jsx(ka,{md:9,children:y.jsxs(ya,{label:"Provider",children:[y.jsx("li",{children:y.jsx(ae,{lbl:"FCM project details",name:Se[a].npFcmv1,labelId:Se[a].npFcmv1,className:"",checked:"fcm v1http"===Se[a].np.toLowerCase(),cb:e=>{let t="FCM project details"==e.target.value?"FCM V1HTTP":e.target.value,s=[...Se];s[a].npFcmv1=t,s[a].apns=!t,s[a].np=t,we(s)}})}),Se[a].device.includes("iPhone")||Se[a].device.includes("iPad")?y.jsx("li",{children:y.jsx(ae,{lbl:"APNS",name:Se[a].npMatchType,labelId:Se[a].labelAPNSId,checked:"apns"===Se[a].np.toLowerCase(),cb:e=>{Se[a].apns=e.target.value,Se[a].fcm=!e.target.value,Se[a].np=e.target.value,o(e.target.value),E(C+1)}})}):null]})})]})}),"fcm"===Se[a].np.toLowerCase()?y.jsxs(y.Fragment,{children:[y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx(ie,{name:"senderid",placeholder:"FCM sender id",required:!0,val:Se[a].fcmsenderid,cb:e=>{let t=e.length>0?null:gt;z(t),Se[a].fcmsenderid=e,Se[a].errorMessage.errFCMSenderID=t,d(e),E(C+1)},errorMessage:Se[a].errorMessage.errFCMSenderID&&Se[a].errorMessage.errFCMSenderID})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"serverkey",placeholder:"FCM server key",required:!0,val:Se[a].fcmserverkey,cb:e=>{let t=e.length>0?null:bt;K(t),Se[a].fcmserverkey=e,Se[a].errorMessage.errFCMServerKey=t,h(e),E(C+1)},errorMessage:Se[a].errorMessage.errFCMServerKey&&Se[a].errorMessage.errFCMServerKey})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs("div",{className:"alert-note",children:[y.jsxs("label",{children:["Provide your FCM details to trigger communications on your mobile app."," "]}),y.jsx(N,{to:{pathname:"https://firebase.google.com/"},target:"_blank",className:"text-white",children:"Copy from firebase console"})]})})})})]}):null,"fcm v1http"===Se[a].np.toLowerCase()?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:5,children:y.jsx(ie,{name:"fcmv1",placeholder:"Upload service account JSON file",required:!0,val:Se[a].fcmServiceFileName,cb:e=>{let t=e.length>0?null:"Upload service account JSON file",s=[...Se];s[a].fcmServiceFileName=e,s[a].errorMessage.errFcmv1Path=t,we(s)},errorMessage:Se[a].errorMessage.errFcmv1Path&&Se[a].errorMessage.errFcmv1Path})}),y.jsx(ka,{md:2,children:y.jsx(ma,{type:".json",onChange:e=>{const t=e[0].split(".").at(0);let s=e[0].length>0?null:"Upload json file",r=[...Se];r[a].fcmServiceFileName=t+L(new Date).format("YYYY-MM-DD")+".json",r[a].fcmServiceFileContent=e[1],r[a].errorMessage.errFcmv1Path=s,we(r)},error:e=>{let t=[...Se];t[a].errorMessage.errCertificate=e,we(t)}})}),y.jsx(ka,{md:5,children:y.jsx(ie,{name:"fcmv1",placeholder:"Vapid key",required:!0,val:Se[a].vapidKey,cb:e=>{let t=e.length>0?null:"Enter vapid key",s=[...Se];s[a].vapidKey=e,s[a].errorMessage.errVapidKey=t,we(s)},errorMessage:Se[a].errorMessage.errVapidKey&&Se[a].errorMessage.errVapidKey})})]})})})}):null,"apns"===Se[a].np.toLowerCase()?y.jsxs(y.Fragment,{children:[y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:9,offset:3},children:y.jsxs(Ta,{children:[y.jsx(ka,{md:4,children:y.jsx(ie,{name:"certificate",disabled:!0,placeholder:"Certificate p8 path",required:!0,val:Se[a].certpath,cb:e=>{let t=e.length>0?null:xt;Q(t),Se[a].certpath=e,Se[a].errorMessage.errCertificate=t,m(e)},errorMessage:Se[a].errorMessage.errCertificate&&Se[a].errorMessage.errCertificate})}),y.jsx(ka,{md:2,children:y.jsx(ma,{type:".p8",onChange:e=>{const t=e[0].split(".").at(0);let s=e[0].length>0?null:xt;Q(s),Se[a].certpath=e[0],Se[a].apnsFileName=t+L(new Date).format("YYYY-MM-DD")+".p8",Se[a].apnsFileContent=e[1],Se[a].errorMessage.errCertificate=s,m(e[0])},error:e=>{Q(e),Se[a].errorMessage.errCertificate=e}})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"certpassword",placeholder:"Enter team id",required:!0,val:Se[a].apnsTeamId,cb:e=>{let t=e.length>0?null:"Enter team id",s=[...Se];s[a].apnsTeamId=e,s[a].errorMessage.errApnsTeamId=t,we(s)},errorMessage:Se[a].errorMessage.errApnsTeamId})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsxs(ka,{md:{span:9,offset:3},children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:4,children:y.jsx(ie,{name:"certificate",placeholder:"Enter key id",required:!0,val:Se[a].apnsKeyId,cb:e=>{let t=e.length>0?null:"Enter key id";Q(t);let s=[...Se];s[a].apnsKeyId=e,s[a].errorMessage.errApnsKeyId=t,we(s)},errorMessage:Se[a].errorMessage.errApnsKeyId&&Se[a].errorMessage.errApnsKeyId})}),y.jsx(ka,{md:8,children:y.jsxs(ya,{children:[y.jsx("li",{children:y.jsx(ae,{lbl:"Sandbox",name:Se[a].apnsIsProducation,labelId:"sanbox",checked:"sandbox"===Se[a].apnsIsProducation.toLowerCase(),cb:e=>{let t=[...Se];t[a].apnsIsProducation=e.target.value,we(t)}})}),y.jsx("li",{children:y.jsx(ae,{lbl:"Production",name:Se[a].apnsIsProducation,labelId:"producation",checked:"production"===Se[a].apnsIsProducation.toLowerCase(),cb:e=>{let t=[...Se];t[a].apnsIsProducation=e.target.value,we(t)}})})]})})]}),y.jsx(Ta,{className:"theme-space-mb mt40",children:y.jsx(ka,{md:12,children:y.jsxs("div",{style:{display:"flex",flexDirection:"row",backgroundColor:"#00246d",borderRadius:5,borderColor:"black",borderWidth:2},children:[y.jsx(y.Fragment,{children:y.jsx("label",{style:{color:"white",margin:10},children:"The APNS .p8 is used for delivery the notification for iOS device provide valid p8 file and password"})}),y.jsx(y.Fragment,{children:y.jsx(N,{style:{color:"white",margin:10},to:{pathname:"https://idmsa.apple.com/IDMSWebAuth/signin?appIdKey=891bd3417a7776362562d2197f89480a8547b108fd934911bcbea0110d07f757&path=%2Faccount%2F&rv=1"},target:"_blank",className:"text-white",children:"Download .p8 file form apple developer account."})})]})})})]})})})]}):null,y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Language"})}),y.jsx(ka,{md:9,children:y.jsxs(ya,{label:"Language",children:[y.jsx("li",{children:y.jsx(ae,{lbl:"Native",name:Se[a].matchType,labelId:Se[a].labelnativeId,checked:Se[a].native,cb:e=>{Se[a].lg=e.target.value,S(e.target.value),Se[a].native=!0,Se[a].hybrid=!1,q(null),v(e.target.value),b(!e.target.value),E(C+1)}})}),y.jsx("li",{children:y.jsx(ae,{lbl:"Hybrid",name:Se[a].matchType,labelId:Se[a].labelhybirdId,checked:Se[a].hybrid,cb:e=>{Se[a].lg=e.target.value,S(e.target.value),Se[a].hybrid=!0,Se[a].native=!1,b(e.target.value),v(!e.target.value),E(C+1)}})}),!0===Se[a].hybrid&&y.jsx("li",{className:"mt20",style:{width:"77%"},children:y.jsx(te,{required:!0,label:"Language",data:["Cordova","Ionic","React Native","Flutter","MAUI"],errorMessage:null==(c=null==(l=Se[a])?void 0:l.errorMessage)?void 0:c.errHybridLanguage,value:""!==Se[a].lagunage?Se[a].lagunage:"-- Select language --",onChange:e=>{Se[a].lagunage=e.target.value,D(e.target.value);let t=e.target.value.length>0?null:yt;Se[a].errorMessage.errHybridLanguage=t,X(t),q(null)}})})]})})]})}),y.jsxs(Ta,{className:"d-none",children:[y.jsx(ka,{md:3,className:"p0",children:y.jsx("label",{className:"label-row ml28",children:"App analytics"})}),y.jsx(ka,{md:4,className:"click-off",children:y.jsx(R,{className:"marginT10 marginB25",checked:Se[a].analytics,onChange:e=>{let t=[...Se];t[a].analytics=e.target.value,t[a].errAnalytics=[{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountEmail:"",appKey:"",appSecretId:"",analyticsName:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}],t[a].deleteArray=t[a].analyticsDetails,t[a].analyticsDetails=[],we(t),M(e.target.value)}})})]}),Se[a].analytics&&y.jsx(Ta,{children:y.jsx(ka,{children:y.jsx(fs,{analyticsError:Se[a].errAnalytics,mode:e.mode,analyticsDetails:Se[a].analyticsDetails,callBack:e=>{let t=[...Se];t[a].analyticsDetails=e,we(t)},onErrorChange:e=>{Se[a].errAnalytics=e},deleteValue:e=>{let t=[...Se],s=t[a].analyticsDetails;t[a].deleteArray=[],t[a].deleteArray.push(s[e]),s.pop(),we(t)}})})})]})})})})})]});var f})),y.jsx("div",{className:"pos-icon-2",children:Se.length<4&&y.jsx(y.Fragment,{children:y.jsx(Ue,{text:"Add",position:"top",children:y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer icon-shadow",onClick:()=>{if(Ne()&&Se.length<4){var e=[...Se];ye([{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null},{serviceAccountMail:"",appKey:"",appSecretId:"",analyticsPlatform:"",errAnalyticPlatform:null,errAccountMail:null,errAppKey:null,errAppSecretID:null}]),e.push(Ee(Se.length+1)),we(e),_(Se.length-1),v(!1),b(!1),S(""),se(ee+(Se.length-1).toString()),ne(re+(Se.length-1).toString()),de(oe+(Se.length-1).toString()),I(A.concat(A.length)),M(!1);let t=Se.length;U(t.toString())}}})})})})]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end marginT15",children:[y.jsx(he,{onClick:()=>{var t,s,r,i,n,l,o,c,d;if(!0===(null==(s=null==(t=null==a?void 0:a.location)?void 0:t.state)?void 0:s.isCampaign)){let e=`cId=${null==(i=null==(r=null==a?void 0:a.location)?void 0:r.state)?void 0:i.campaignId}`,t=null==(o=null==(l=null==(n=null==window?void 0:window.location)?void 0:n.search)?void 0:l.slice(1))?void 0:o.replace(e,"");return void a.push({pathname:"/campaign/creation-notification",search:`cId=${null==(d=null==(c=null==a?void 0:a.location)?void 0:c.state)?void 0:d.campaignId}&${t}`})}const u=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:u},"",u),e.onChangeIndex(0)},children:"Cancel"}),y.jsx(fe,{onClick:()=>{if(!0===me()){const t=`${window.location.origin}${window.location.pathname}`;return window.history.pushState({path:t},"",t),void e.onChangeIndex(0)}if(t.globalStateData.getIsPrototype)return void e.onChangeIndex(0);let a;return pe(e.appName)?(e.onErrAppName(dt),a=!1):("App name already exists"===e.appNameErr&&(a=!1),""===e.appName||/[`!@#$%^&*()+\=\[\]{};':"\\|,.<>\/?~]/.test(e.appName)?(e.onErrAppName("Special characters are not allowed"),a=!1):e.onErrAppName(null)),0==a?(window.scrollTo({top:0,behavior:"smooth"}),!1):(pe(e.appIdendifier)&&(e.onErrAppIdentifier("Select app user identifier"),a=!1),0==a?(window.scrollTo({top:0,behavior:"smooth"}),!1):Ne()?void(a=>{let s=[];a.data.map((e=>{var t;let a=Ae(e.device);(null==(t=e.analyticsDetails)?void 0:t.length)>0&&e.analyticsDetails.map((t=>{t.mobplatformId=a,t.appSecret=t.appSecretId,t.maSettingId=void 0!==t.maSettingId?t.maSettingId:0,t.mobileDeviceId=void 0!==t.mobileDeviceId?t.mobileDeviceId:e.mpdevid}));let r={mpDevId:e.mpdevid,mobplatformId:Ae(e.device),pushNotifyAppStoreId:e.device.toLowerCase().includes("iphone")||e.device.toLowerCase().includes("ipad")?"1":"2",appStoreName:e.device.toLowerCase().includes("iphone")||e.device.toLowerCase().includes("ipad")?"App store":"Play store",appStoreUrl:e.storeurl,deviceId:Ae(e.device),passwordKey:e.certpassword,filePath:e.certpath,fcmServiceFileName:e.fcmServiceFileName,fcmServiceFileContent:e.fcmServiceFileContent,apnsFileName:e.apnsFileName,apnsFileContent:e.apnsFileContent,keyId:e.apnsKeyId,teamId:e.apnsTeamId,isV1:"fcm"!==e.np.toLowerCase(),vapidKey:e.vapidKey,bundleId:e.bundleIdentifier,notificationProvider:e.np,fcmSenderId:e.fcmsenderid,fcmServerKey:e.fcmserverkey,languageId:void 0!==e.native&&null!==e.native&&!0===e.native?0:wt(e.lagunage),languageType:void 0!==e.native&&null!==e.native&&!0===e.native?"N":"H",isAppAnalyics:e.analytics,hybridLanguageId:"",isProduction:"production"===e.apnsIsProducation.toLowerCase(),mobileanalyticssetting:e.analyticsDetails,deleteMobAnalytic:e.deleteArray};s.push(r)}));const r={appName:a.appName,appIdendifier:e.appIdendifier,appGuid:void 0!==e.onBoardingId&&null!==e.onBoardingId?e.onBoardingId:0,createdBy:Tt(),mobilepushdeviceinfo:s,mobilepushdeviceDelete:De};let i="";i="edit"===e.mode?kt:Dt,ce({path:i,params:r,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:a=>{if(a.status){const a=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:a},"",a),e.mode,t.globalStateData.setIsLoadingData(!0),Be(t,(a=>{t.globalStateData.setIsLoadingData(!1),e.onChangeIndex(0)}))}else e.onErrAppName(a.message)},fail:e=>{}})})({appName:e.appName,appIdendifier:e.appIdendifier,data:Se,analytics:window.ganalytics}):(window.scrollTo({top:document.documentElement.scrollHeight/4,behavior:"smooth"}),!1))},children:Te?"Update":"Save"})]})]})},kr=["Android phone","Android tablet","iPhone","iPad"],Dr=[{name:"Resulticks analytics",id:3},{name:"Flurry analytics",id:9},{name:"Google analytics",id:1}],Cr=e=>{const t=w.useContext(le),[a,s]=w.useState(""),[r,i]=w.useState(""),[n,l]=w.useState(0),[o,c]=w.useState(""),[d,u]=w.useState(""),[h,f]=w.useState("Mobile"),[m,p]=w.useState("SmartDX"),[v,g]=w.useState(""),[b,x]=w.useState(!1),[S,T]=w.useState([]),[k,D]=w.useState([]),[C,E]=w.useState(""),[N,A]=w.useState(null),[I,j]=w.useState(null),[_,O]=w.useState(null);w.useState(null);const[L,F]=w.useState(null),[M,R]=w.useState(!1),[P,U]=w.useState(null);w.useEffect((()=>{!function(e){const a={clientId:Ct()};t.globalStateData.setIsLoadingData(!0),ce({path:Et,params:a,ok:t=>{t.status?(D(t.data),e(!0,t.data)):e(!1,[])},fail:t=>{e(!1)}})}(((a,r)=>{var n;if(t.globalStateData.setIsLoadingData(!1),a){let t=Oe();T((null==t?void 0:t.mobileAppsList)||[]),0!==e.userDeviceId?B(r):(null==(n=null==t?void 0:t.mobileAppsList)?void 0:n.length)>0&&(s(t.mobileAppsList[0].appName),i(t.mobileAppsList[0].appGuid),l(t.mobileAppsList[0].mpId))}}))}),[]);const B=a=>{let r={UserDeviceID:e.userDeviceId};t.globalStateData.setIsLoadingData(!0),ce({path:Nt,params:r,ok:e=>{var r;if(t.globalStateData.setIsLoadingData(!1),e.status&&e.data){R(!1);let t=a.filter((t=>t.userId===e.data.userId))[0];c(t.firstName),u(e.data.userId);let n=Oe().mobileAppsList.filter((t=>t.appGuid===e.data.appGuid))[0];s(n.appName),i(n.appGuid),l(n.mpId),E(e.data.sendLink),f((null==(r=e.data)?void 0:r.deviceModel)||""),p(e.data.friendlyName),g(e.data.description)}else t.globalStateData.setIsLoadingData(!1),R(!0)},fail:e=>{t.globalStateData.setIsLoadingData(!1),R(!0)}})};function G(){var e=!0;return pe(a)&&(e=!1,A("Select app name")),pe(o)&&(e=!1,j("Select username")),e}return y.jsxs("div",{children:[y.jsx("h4",{children:"User device setup"}),y.jsxs("div",{className:"mt30",children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"App name"})}),y.jsx(ka,{md:4,children:y.jsx(te,{required:!0,label:"App name",errorMessage:N,value:""!==a&&""!==r?{appGuid:r,appName:a}:{appGuid:-1,appName:"-- Select mobile app --"},textField:"appName",dataItemKey:"appGuid",data:S,onChange:e=>{s(e.target.value.appName),i(e.target.value.appGuid),c(""),x(!1);let t=e.target.value.appName.length>0?null:"Select app name";A(t)}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"User"})}),y.jsx(ka,{md:4,children:y.jsx(te,{required:!0,label:"User",data:k,errorMessage:I,value:""!==o?{firstName:o,userId:d}:{firstName:"-- Select user --",userId:0},textField:"firstName",dataItemKey:"userId",onChange:e=>{u(e.target.value.userId);let s=e.target.value.firstName.length>0?null:"Select username";j(s),x(!1),c(e.target.value.firstName);var i,n=!1;if(pe(a))return n=!0,void A("Select app name");!1===n&&(i=e.target.value.userId,ce({path:At,params:{userId:i,appGuid:r},loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{g((null==e?void 0:e.message)||"")},fail:e=>{}}))}})})]})}),v.length>0&&y.jsxs(ga,{children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Description"})}),y.jsxs(ka,{md:4,children:[v.length>0&&y.jsx("textarea",{name:"",rows:"3",cols:"50",placeholder:"Enter message",className:"click-off",children:v}),y.jsx("div",{})]})]}),null!==P&&y.jsx(Ta,{children:y.jsx(ka,{md:{span:4,offset:3},className:"d-flex align-items-center",children:y.jsx("div",{className:"label-success",children:P})})})]}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{span:4,offset:3},children:y.jsx(fe,{onClick:()=>{G()&&((()=>{const e={userId:d,description:v};ce({path:It,params:e,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{t.status&&(U("Message sent successfully"),g((null==e?void 0:e.description)||""),E(null==e?void 0:e.description),setTimeout((()=>{U(null)}),3e3))},fail:e=>{}})})(),x(!0))},children:"Send"})})})})]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{e.cb()},children:"Cancel"}),y.jsx(fe,{onClick:()=>{var a;G()&&(a=!0,pe(m)&&(a=!1,O("Enter friendly name")),pe(C)&&(a=!1,F("Enter description")),a&&(()=>{let a=jt;0!==e.userDeviceId&&(a=_t);const s={appGuid:r,userId:d,sendlink:C,appId:n,friendlyname:m,devicemodel:h,description:v,userdeviceId:e.userDeviceId,clientId:Ct()};ce({path:a,params:s,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{t.status&&e.cb()},fail:e=>{alert(e)}})})())},children:"Save"})]})]})};class Er extends k.Component{constructor(){super(...arguments),x(this,"state",{saveError:!1,errMsg:null,isDelete:!1,index:0,item:null}),x(this,"componentDidMount",(()=>{})),x(this,"deletePlatform",((e,t)=>{let a={appGuid:this.props.appGuid,mobplatformID:e};ce({path:Ot,params:a,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOut,ok:e=>{e.status?this.props.data.splice(t,1):this.setState({saveError:!0,errMsg:(null==e?void 0:e.message)||Ce})},fail:e=>{}})}))}render(){return y.jsx(y.Fragment,{children:y.jsxs("div",{className:"rs-grid-detail-view",children:[y.jsxs("table",{width:"100%",role:"grid",className:"grid-detail-content",children:[y.jsx("thead",{className:"detail-component-header",children:y.jsxs("tr",{children:[y.jsx("th",{width:"25%",children:"Mobile platform"}),y.jsx("th",{width:"25%",children:"Language"}),y.jsx("th",{width:"35%",children:"Analytics platform"}),y.jsxs("th",{width:"18%",children:[" ",y.jsx("div",{style:{textAlign:"right"},children:"Actions"})]})]})}),y.jsx("tbody",{children:void 0!==this.props.data&&this.props.data.length>0&&this.props.data.map(((e,t)=>y.jsxs("tr",{children:[y.jsxs("td",{children:[" ",y.jsx("p",{children:ut(e.mobplatformId)})," "]}),y.jsxs("td",{children:[" ",y.jsx("p",{children:ht(e.languageId)})," "]}),y.jsx("td",{children:y.jsx("p",{children:"NA"})}),y.jsx("td",{children:y.jsx("div",{className:"camp-icon float-end",children:y.jsx("ul",{className:"camp-icon-pannel",children:y.jsx("li",{className:me()?"click-off":"",children:y.jsx(Ue,{text:"Delete",position:"top",children:y.jsx("i",{className:"icon-rs-delete-medium icons-md blue",onClick:()=>{this.setState({isDelete:!0,index:t,item:e})}})})})})})})]})))})]}),!0===this.state.saveError&&y.jsx(ja,{headerTitle:"Sorry",subtitle:this.state.errMsg,primaryButtonText:"OK",buttonClicked:e=>{this.setState({saveError:!1})}}),!0===this.state.isDelete&&y.jsx(_a,{size:"md",headerTitle:"Mobile push notification ",para:"Are you sure you want to delete this item?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{this.setState({isDelete:!1}),!0===e&&this.deletePlatform(this.state.item.mobplatformId,this.state.index)}})]})})}}var Nr;x(Er,"contextType",le);var Ar=!1;class Ir extends w.Component{constructor(){super(...arguments),x(this,"state",{formName:"",platformName:"",formpageUrl:"",authCode:"",showAuthCode:!1,currentActivity:"",currentImg:null,imageData:null,clientData:null,controlsArray:[],selectElement:null,selectElementVal:null,elementArray:[],elementArray_copy:null,elementArray_copy_condition:!0,screenTracking:{minDuration:"",screenTrackCond:"And",minLength:""},errScreenTracking:{errMinDuration:null,errMinLength:null},event:{eventName:"",eventType:"",eventDescription:""},eventData:null,selectControls:[],markAsGoal:!1,deviceInformation:null,editModeOn:!1,editIndex:0,saveBTNCondition:!0,showFormNameComponent:!1,socketDisconnect_Popup:!1,socketDisconnect:null,socketDisconnectData:null,clientSocketDisconnect:null,storedDelete_FormFiels:null,mandatoryOneEvent:null,fieldTrackData_props:null,originalCloneEmentArrayData:[],originalCloneFieldTrackData:[],attributeValue:null,errAttribute:null,newAttributte:null,attributeNameList:[],attributeNameList_Copy:[],markAsGoalClickOff:!1,chooseElementCondition:!1,elementDelete_Popup:!1,deleteElement_Index:null,chooseMarkOrEngagement:null,showEnagagementDropdown:null,PageEngagementList:[{dataAttributeID:1,attributeName:"Page load",displayName:"Page load"},{dataAttributeID:2,attributeName:"Page time limit",displayName:"Page time limit"}],timeSpentData:[{id:1,timeLimitName:"Less than 10 secs"},{id:2,timeLimitName:"11 secs to 30 secs"},{id:3,timeLimitName:"31 secs to 60 secs"},{id:4,timeLimitName:"More than 60 secs"}],timeSpentValue:null,errMsgTimeSpentValue:null,PageEngagementValue:null,errPageEngagement:null,engagementAddBtn:!1,elementChoosePopUp:null,already_elementChoosePopUp:null,categoryTypeId:0,videoDropdownList:["Duration","Click"],videoElementVal:null,errvideoElementVal:null,choosePageScenrio:!1,socketConnectCheck:!1,ElementList:[{elementID:3,attributeName:"Local storage",displayName:"Local storage"}],chooseElementList:null,elementKey:"",preferenceName:"",errMsgPreferenceName:null,preferenceNameCondition:"Android phone"==(null==(c=null==(o=this.props)?void 0:o.fieldTrackData)?void 0:c.deviceType),deviceType:"Andriod",screenName:"",errElementType:null,errelementKey:null,tenElement:null,errEventCondition:!1,editPageEngagement:!1,PageEngagementIndex:null,removeChooseElement:null,localStoreScreenName:null,newAttributte:!1,newAttributeError:null,addElementCliCkOff:!1,controlsArray_Copy:[]}),x(this,"selfClose",!1),x(this,"saveBtnCheck",!1),x(this,"getAttributeDataNew",(e=>{!1===e&&this.state.attributeNameList.length>0||ce({path:Ft,sessionOut:this.context.globalStateData.setSessionOutData,loading:this.context.globalStateData.setIsLoadingData,ok:e=>{var t,a,s,r,i,n,l;if(e.status){const o=e.data;if(null!=(null==(a=null==(t=this.props)?void 0:t.fieldTrackData)?void 0:a.elementArray)&&(null==(i=null==(r=null==(s=this.props)?void 0:s.fieldTrackData)?void 0:r.elementArray)?void 0:i.length)>0){const e=null==(l=null==(n=this.props)?void 0:n.fieldTrackData)?void 0:l.elementArray.map((e=>{var t;return null==(t=e.eventTracking)?void 0:t.trackingType})),t=o.filter((t=>!e.some((e=>e.dataAttributeID===t.dataAttributeID&&e.attributeName===t.attributeName)))),a=null==t?void 0:t.filter((e=>(null==e?void 0:e.dataAttributeID)>0));(null==a?void 0:a.length)>0&&this.setState({attributeNameList:a,attributeNameList_Copy:o})}else this.setState({attributeNameList:o})}},fail:e=>{}})})),x(this,"componentDidUpdate",(e=>{null==e||e.attributeNameList,this.state.attributeNameList})),x(this,"getFieldTrackData",(()=>{var e,t,a,s,r,i,n="iOS";null==(e=this.props.fieldTrackData)||e.appId;var l="iPhone";(null==(a=null==(t=this.props.fieldTrackData)?void 0:t.deviceType)?void 0:a.toLowerCase().includes("an"))&&(n="Android",l=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),O.parse(null==(i=null==(r=this.props.history)?void 0:r.location)?void 0:i.search);let o={campaignId:Lt(),deviceOs:n,deviceType:l,goalType:"P"};this.getDataFromServer(o)})),x(this,"getDataFromServer",(e=>{ce({path:Mt,params:e,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{var t,a,s,r;(null==e?void 0:e.status)&&(null==(a=null==(t=null==e?void 0:e.data)?void 0:t.capturedFields)?void 0:a.length)>0&&(null==(r=null==(s=null==e?void 0:e.data)?void 0:s.capturedFields)||r.map((e=>{var t,a;let s=JSON.parse(e.formFieldsToCapture),r=s.imageData;null!=r&&this.setState({currentImg:r.imageData,imageData:r});let i=null==(t=s.fieldsInfo)?void 0:t.pageContent.controls;if(null!=i){this.setState({showAuthCode:!1,clientData:i,controlsArray:i});let e=null==(a=null==s?void 0:s.fieldsInfo)?void 0:a.fieldCaptureList,t=[],r={minDuration:"",screenTrackCond:"And",minLength:""},n={};e.length>0&&e.map((e=>{r.minDuration=e.minDuration,r.screenTrackCond=null==e?void 0:e.screenfilter,r.minLength=e.minLength,n={eventName:e.eventName,eventType:e.captureType,eventDescription:e.description,markAsGoal:e.markAsGoal,trackingType:e.captureType},e.screenName,e.viewType;let a={field:e,screenTracking:r,eventTracking:n};t.push(a)})),!0===(null==n?void 0:n.markAsGoal)&&this.setState({markAsGoal:!0}),this.setState({elementArray:t,screenTracking:r})}})))},fail:e=>{}})})),x(this,"socketInit",(()=>{var e,t,a,s,r={userName:"Browser"},i="iOS",n=null==(e=this.props.fieldTrackData)?void 0:e.appId,l="iPhone";(null==(a=null==(t=this.props.fieldTrackData)?void 0:t.deviceType)?void 0:a.toLowerCase().includes("an"))&&(i="Android",l=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),r.appId=String(i+l+n).replace(/ /g,""),"Android"==i&&this.setState({preferenceNameCondition:!0}),this.setState({deviceType:l}),Nr=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0}),JSON.stringify(r),Nr.on("connect",(()=>{Nr.emit("receiver-handshake-request",r)})),Nr.on("receiver-handshake-response",(e=>{})),Nr.on("client-handshake-response",(e=>{})),Nr.on("client-handshake-request",(e=>{})),Nr.on("client-information",(e=>{})),Nr.on("disconnect",(e=>{})),Nr.on("message-client-disconnect",(e=>{})),Nr.on("message-from-client-image",(e=>{if(this.state.elementArray.length>0)return;Nr.off("show-auth-code"),this.setState({showAuthCode:!1});let t=JSON.parse(e);this.setState({currentActivity:t.screenName,currentImg:t.imageData,imageData:t}),this.state.currentActivity!==t.screenName&&this.setState({currentActivity:t.screenName,currentImg:t.imageData,imageData:t})})),Nr.on("message-from-client-data",(e=>{var t,a,s,r,i;Nr.off("show-auth-code");let n=JSON.parse(e);null!=(null==n?void 0:n.mainScreenName)&&this.setState({localStoreScreenName:null==n?void 0:n.mainScreenName});let l=JSON.parse(n.controls);const o=null==(t=l[0])?void 0:t.screenName;this.setState({screenName:o});const c=this.state.selectControls.filter((e=>{var t;return(null==e?void 0:e.viewId)!==(null==(t=this.state.selectElementVal)?void 0:t.viewId)}));null!=this.state.selectElement?this.state.selectControls.map((e=>{l.map((t=>{e.viewId===t.viewId&&(t.click=!0,t.select=(null==e?void 0:e.select)||!1)}))})):c.map((e=>{l.map((t=>{e.viewId===t.viewId&&(t.click=!0,t.select=(null==e?void 0:e.select)||!1)}))}));{l.map((e=>{var t;let a=[];(null==(t=e.subviews)?void 0:t.length)>0&&JSON.parse(e.subviews).length>0&&(a=JSON.parse(e.subviews)),e.subviews=a})),null!=(null==(a=this.state)?void 0:a.removeChooseElement)&&(null==(s=this.state)||s.removeChooseElement.map((e=>{var t,a;e.viewId===(null==(a=null==(t=this.state)?void 0:t.selectElement)?void 0:a.viewId)&&(e.select=!1,e.click=!1)})));let e=null!=(null==(r=this.state)?void 0:r.removeChooseElement)?null==(i=this.state)?void 0:i.removeChooseElement:l;this.setState({showAuthCode:!1,clientData:n,controlsArray:e,removeChooseElement:null})}})),Nr.on("show-auth-code",(e=>{let t=JSON.parse(e);this.setState({authCode:t.oAuthCode,showAuthCode:!1,deviceInformation:t}),Nr.off("show-auth-code")})),Nr.on("client-auth-code",(e=>{let t=JSON.parse(e);this.setState({authCode:t.oAuthCode,showAuthCode:!0});var a=new Object;a.appId=String(i+l+n).replace(/ /g,"");var s=JSON.stringify(a);Nr.emit("marketer-acceptance-message",s),setTimeout((()=>{this.setState({authCode:"",showAuthCode:!1})}),12e4)}))})),x(this,"checkLocalStorage",(()=>{let e=es;if(null!==e&&this.setState({currentImg:e.imageData,imageData:e}),null!==Ja){let e=JSON.parse(Ja.controls);this.state.selectControls.map((t=>{e.map((e=>{t.viewId===e.viewId&&(e.click=!0,e.select=(null==t?void 0:t.select)||!1)}))})),0===this.state.controlsArray.length&&(e.map((e=>{var t;let a=[];(null==(t=e.subviews)?void 0:t.length)>0&&JSON.parse(e.subviews).length>0&&(a=JSON.parse(e.subviews)),e.subviews=a})),this.setState({showAuthCode:!1,clientData:Ja,controlsArray:e}))}})),x(this,"createField",(e=>e.map(((e,t)=>this.createSingleWebField(e,t))))),x(this,"createSingleMobileField",((e,t,a=!1)=>{var s,r,i=e.top+e.translationY-e.scrollY,n=e.left+e.translationX-e.scrollX,l=e.width,o=e.height,c="array"+e.id;if(null!==document.getElementById(c)){var d=document.getElementById(c);d.setAttribute("data-viewId",e.viewId),d.setAttribute("data-viewType",e.viewType)}return y.jsx("div",{className:`C ${!0===e.isShow&&"fieldTracking"} ${null==e?void 0:e.viewId} ${!0===(null==e?void 0:e.click)&&"fieldTrackingClick"} ${!0===(null==e?void 0:e.select)&&"fieldTrackingSelect"}`,id:e.id,data:e,style:{position:"absolute",top:i,left:n,width:l,height:o},onClick:t=>{if(!0===e.select)return;let a=[...this.state.controlsArray],s=t.target,r=null;a.map((e=>{e.click=!1}));let i=a.filter((e=>String(e.id)===s.id));if(!1===i[0].isShow)return;i[0].click=!0,r=i[0];let n=[...this.state.selectControls];n=n.filter((e=>!0===e.select)),n.push(i[0]),n=n.filter(((e,t,a)=>t===a.findIndex((t=>t.viewId===e.viewId&&t.viewId===e.viewId)))),this.setState({selectControls:n,controlsArray:a,selectElement:r,event:{eventName:"",eventType:"",eventDescription:""}}),this.check_categoryType(r),window.scrollTo(0,0),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:130,behavior:"smooth"}),document.querySelector(".modal-body").scrollTo({top:0,behavior:"smooth"})},children:!1===e.isShow&&(null==(s=e.subviews)?void 0:s.length)>0&&(null==(r=null==e?void 0:e.subviews)?void 0:r.map((e=>{let t=this.state.controlsArray.filter((t=>t.id.toString()===e.toString()));return t.length>0?t.map(((e,t)=>this.createSingleMobileField(e,t,a))):y.jsx("div",{id:`array${e.toString()}`,viewId:e.toString()})})))})})),x(this,"check_categoryType",(e=>{var t;if(e){let a=null==e?void 0:e.categoryType,s=Xa(a);if(this.setState({categoryTypeId:s}),!(null==(t=this.state.eventData)?void 0:t.captureType)){const e={1:"Input",2:"Click",3:"Duration",4:"No over",5:"Url path"}[s]||null;this.setState((t=>({eventData:{...t.eventData,captureType:e}})))}}})),x(this,"createSingleWebField",((e,t)=>{var a,s=e.top,r=e.left,i=e.width,n=e.height,l="array"+t;if(null!==document.getElementById(l)){var o=document.getElementById(l);o.setAttribute("data-viewId",e.viewId),o.setAttribute("data-viewType",e.viewType)}return y.jsx("div",{className:`C ${!0===e.isShow&&"fieldTracking"} ${null==e?void 0:e.viewId} ${!0===(null==e?void 0:e.click)&&"fieldTrackingClick"} ${!0===(null==e?void 0:e.select)&&"fieldTrackingSelect"}`,id:e.id,style:{position:"absolute",top:s,left:r,width:i,height:n},onClick:t=>{if(!0===(null==e?void 0:e.select))return;let a=[...this.state.controlsArray],s=t.target,r=null;a.map((e=>{e.click=!1}));let i=a.filter((e=>String(e.id)===s.id));i[0].click=!0,r=i[0];let n=[...this.state.selectControls];n=n.filter((e=>!0===e.select)),n.push(i[0]),n=n.filter(((e,t,a)=>t===a.findIndex((t=>t.viewId===e.viewId&&t.viewId===e.viewId)))),this.setState({selectControls:n,controlsArray:a,selectElement:r,event:{eventName:"",eventType:"",eventDescription:""}}),window.scrollTo(0,0),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:0,behavior:"smooth"}),document.querySelector(".modal-body").scrollTo({top:0,behavior:"smooth"})},children:(null==(a=e.subviews)?void 0:a.length)>0&&JSON.parse(e.subviews).length>0&&JSON.parse(e.subviews).map((e=>{let t=this.state.controlsArray.filter((t=>t.id.toString()===e.toString()));return t.length>0?t.map(((e,t)=>this.createSingleWebField(e,e.id))):y.jsx("div",{id:`array${e.toString()}`,viewId:e.toString()})}))})})),x(this,"createWebField",(e=>e.map(((e,t)=>this.createSingleWebField(e,t))))),x(this,"validateEvents",(()=>{if(pe(this.state.event.eventName)){let e={...this.state.errEvent};return e.errEventName="Enter event name",this.setState({errEvent:e}),!1}if(pe(this.state.event.eventType)){let e={...this.state.errEvent};return e.eventType="Select Event",this.setState({errEvent:e}),!1}return!0})),x(this,"addFormData",(e=>{var t,a,s,r,i,n,l,o;let c=Xa(null==e?void 0:e.captureType)||0;if(null==this.state.imageData)return void this.setState({socketConnectCheck:!0});let d=null==(t=this.state.elementArray)?void 0:t.filter((e=>!(null==e?void 0:e.PageEngagementValue)));if((null==d?void 0:d.length)>4)this.setState({tenElement:!0});else if(null!=this.state.selectElement||null!=this.state.chooseElementList||""!=this.state.elementKey)if(null!=this.state.attributeValue)if(null==(a=this.state.selectElement)?void 0:a.select)this.setState({already_elementChoosePopUp:!0});else{const e=O.parse(null==(s=window.location)?void 0:s.search);null==e||e.webft;let t=[],a=[],d=null==(r=this.state.elementArray)?void 0:r.filter((e=>!(null==e?void 0:e.PageEngagementValue))),u=null==d?void 0:d.filter((e=>{var t;return 1!=(null==(t=null==e?void 0:e.eventTracking)?void 0:t.elementKey)}));if((null==u?void 0:u.length)>0&&u.map((e=>{var s;let r=Xa(null==(s=null==e?void 0:e.field)?void 0:s.captureType);2===r?t.push(r):a.push(r)})),2===c&&"Local storage"!=(null==(n=null==(i=this.state.eventData)?void 0:i.captureElement)?void 0:n.attributeName)){if(t.length>1){let e={...this.state.errEvent};return e.errEventName="Cannot add more than 2 click events",void this.setState({errEvent:e,errEventCondition:!0})}}else if(a.length>2&&"Local storage"!=(null==(o=null==(l=this.state.eventData)?void 0:l.captureElement)?void 0:o.attributeName)){let e={...this.state.errEvent};return e.errEventName="Cannot add more than 3 text field",void this.setState({errEvent:e,errEventCondition:!0})}let h={...this.state.eventData};h.hasOwnProperty("markAsGoal")&&(h.markAsGoal=this.state.markAsGoal),h.hasOwnProperty("preferenceName")&&(h.preferenceName=this.state.preferenceName),""!=this.state.elementKey&&(h.elementKey=!0);let f=[...this.state.controlsArray],m={};f.map((e=>{var t;e.viewId===(null==(t=this.state.selectElement)?void 0:t.viewId)&&(e.select=!0,m=e,m.captureType=h.captureType)}));let p=[...this.state.selectControls];p.map((e=>{var t;e.viewId===(null==(t=this.state.selectElement)?void 0:t.viewId)&&(e.select=!0,e.click=!0,m=e,m.captureType=h.captureType)}));let v=[...this.state.elementArray],g={field:m,screenTracking:this.state.screenTracking,eventTracking:h,screenName:this.state.localStoreScreenName};v.push(g);let b=!1;v.map((e=>{!0===e.eventTracking.markAsGoal&&(b=!0)})),1==b&&this.setState({engagementAddBtn:!0});const x=this.state.attributeNameList.filter((e=>!(this.state.attributeValue.dataAttributeID===e.dataAttributeID&&this.state.attributeValue.attributeName===e.attributeName)));this.setState({errMsgPreferenceName:null,errelementKey:null,attributeNameList:x,selectControls:p,elementArray:v,preferenceName:"",selectElement:null,markAsGoal:!1,markAsGoalClickOff:b,attributeValue:null,videoElementVal:null,elementKey:"",preferenceNameCondition:!1,chooseElementList:null,chooseElementCondition:!0,categoryTypeId:0,controlArray:f})}else this.setState({errAttribute:"Select attribute"});else this.setState({elementChoosePopUp:!0,attributeValue:null})})),x(this,"editField",(e=>{let t=[...this.state.elementArray];t[this.state.editIndex].eventTracking.captureElement=e.captureElement,t[this.state.editIndex].eventTracking.preferenceName=e.preferenceName,t[this.state.editIndex].eventTracking.captureType=e.captureType,t[this.state.editIndex].eventTracking.eventName=e.eventName,t[this.state.editIndex].eventTracking.eventDescription=e.eventDescription,t[this.state.editIndex].eventTracking.selectInputType=e.selectInputType,t[this.state.editIndex].eventTracking.trackingType=e.trackingType,t[this.state.editIndex].eventTracking.markAsGoal=e.markAsGoal,t[this.state.editIndex].eventTracking.friendlyName=e.friendlyName,t[this.state.editIndex].eventTracking.mandadory=e.mandadory,this.setState({errMsgPreferenceName:null,errelementKey:null,elementArray:t,editModeOn:!1,eventData:null,markAsGoal:!1,attributeValue:null,videoElementVal:null,elementKey:"",preferenceName:"",chooseElementList:null,chooseElementCondition:!0,categoryTypeId:0,selectElement:null});let a=this.state.attributeNameList.filter((e=>!(this.state.attributeValue.dataAttributeID===e.dataAttributeID&&this.state.attributeValue.attributeName===e.attributeName)));const s=a.findIndex((e=>-10===e.dataAttributeID));let r=null;-1!==s&&(r=a.splice(s,1)[0]),r&&a.push(r),this.setState({attributeNameList:a});const i=t.some((e=>{var t;return!0===(null==(t=null==e?void 0:e.eventTracking)?void 0:t.markAsGoal)})),n=null==t?void 0:t.some((e=>{var t,a;return"Trigger action"==(null==(t=null==e?void 0:e.eventTracking)?void 0:t.captureType)||"page time limit"===(null==(a=null==e?void 0:e.eventTracking)?void 0:a.captureType)}));(null==e?void 0:e.markAsGoal)&&this.setState({markAsGoalClickOff:!0,engagementAddBtn:!0}),i||n?this.setState({markAsGoalClickOff:!0,engagementAddBtn:!0}):this.setState({markAsGoalClickOff:!1,engagementAddBtn:!1})})),x(this,"getDeviceType",(e=>{switch(e){case"Android phone":return y.jsx("div",{className:"andriod-wrapper",children:y.jsxs("div",{class:"andriod-mobile",children:[y.jsx("div",{class:"inner"}),y.jsx("div",{class:"overflow",children:y.jsx("div",{class:"shadow"})}),y.jsx("div",{class:"speaker"}),y.jsx("div",{class:"sensors"}),y.jsx("div",{class:"more-sensors"}),y.jsx("div",{class:"camera"})]})});case"iPhone":return y.jsxs("div",{class:"iphone-mobile",children:[y.jsx("div",{class:"top-bar"}),y.jsx("div",{class:"camera"}),y.jsx("div",{class:"sensor"}),y.jsx("div",{class:"speaker"}),y.jsx("div",{class:"screen"}),y.jsx("div",{class:"home"}),y.jsx("div",{class:"bottom-bar"})]})}})),x(this,"saveMobileFieldTracking",(()=>{var e,t,a;let s=!1;if(this.state.elementArray.map((e=>{var t;(null==(t=null==e?void 0:e.eventTracking)?void 0:t.markAsGoal)&&(s=!0),(null==e?void 0:e.PageEngagementValue)&&(s=!0)})),!1!==s)if(!0===(null==(e=this.props)?void 0:e.isForm)){const e=O.parse(null==(a=null==(t=this.props.history)?void 0:t.location)?void 0:a.search);let s=void 0!==e.cId?e.cId:0;if(this.props.isEdit&&this.state.elementArray.length<1)return void this.setState({showFormNameComponent:!0,mandatoryOneEvent:!0});if(this.props.isEdit){Ar=!0;var r=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;return window.history.pushState({path:r},"",r),localStorage.setItem("ea",Ne(this.state)),void this.props.saveBtnClicked(this.state)}if(this.props.isWebFieldTrack){r=window.location.protocol+"//"+window.location.host+window.location.pathname+"?cId="+s,window.history.pushState({path:r},"",r);let e=localStorage.getItem("fdomain")||"";this.selfClose=!0,Nr.emit("close",{userName:"fieldtrack",domainName:e,appId:parseInt(s),status:!0}),window.close()}if(this.state.elementArray.length<1)return void this.setState({showFormNameComponent:!0,mandatoryOneEvent:!0});localStorage.setItem("ea",Ne(this.state)),Ar=!0,this.props.saveBtnClicked(this.state),this.disconnectSocket()}else Za(this.props,this.state,Nr,this.context,(()=>{var e,t,a;const s=O.parse(null==(t=null==(e=this.props.history)?void 0:e.location)?void 0:t.search);let r=void 0!==s.cId?s.cId:0;var i=window.location.protocol+"//"+window.location.host+window.location.pathname+"?cId="+r;if(window.history.pushState({path:i},"",i),this.props.isWebFieldTrack){if(this.props.isEdit){const e=new CustomEvent("ftracksuccess",{detail:{message:"Hello from custom event!"}});return window.dispatchEvent(e),void this.props.saveBtnClicked()}let e=localStorage.getItem("fdomain")||"";this.selfClose=!0,Nr&&(Nr.emit("close",{userName:"fieldtrack",domainName:e,appId:parseInt(r),status:!0}),Nr.emit("closed",{userName:"fieldtrack",domainName:e,appId:parseInt(r),status:!1}),Nr.emit("close",{userName:"fieldtrack",domainName:e,appId:parseInt(r),status:!1})),setTimeout((()=>{window.close()}),3e3);const t=new CustomEvent("ftracksuccess",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)}"add"===(null==(a=this.props.fieldTrackData)?void 0:a.mode)&&this.disconnectSocket(),this.props.saveBtnClicked()}));else this.setState({chooseMarkOrEngagement:!0,showEnagagementDropdown:!0})})),x(this,"AddMobileEvents",(()=>y.jsxs(Ta,{children:[y.jsxs("div",{className:"align-items-center d-flex mb10",children:[y.jsx("i",{className:"icon-rs-events-medium icons-md color-primary-blue"}),y.jsx("h4",{className:"mb-0 ml10",children:"Events"})]}),this.state.elementArray.length>0&&this.state.elementArray.map(((e,t)=>{var a,s;return y.jsxs("div",{className:"event-tracking-list",children:[y.jsxs("div",{className:"event-actions mr10",children:[y.jsx("span",{children:y.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{var a,s;let r=this.state.controlsArray.filter((t=>t.viewId===e.field.viewId));r.length>0&&(r[0].eventName=e.eventTracking.eventName,r[0].selectInputType=e.eventTracking.selectInputType,r[0].eventDescription=null==(a=e.eventTracking)?void 0:a.eventDescription,r[0].trackingType=e.eventTracking.trackingType,r[0].markAsGoal=e.eventTracking.markAsGoal,(null==(s=null==e?void 0:e.eventTracking)?void 0:s.markAsGoal)&&this.setState({markAsGoal:!0}),this.setState({selectElement:r[0],editModeOn:!0,editIndex:t}))}})}),!0===e.eventTracking.markAsGoal&&y.jsx("span",{children:y.jsx("i",{className:"icon-rs-goal-achieved-medium icons-md blue"})}),y.jsx("span",{children:y.jsx("i",{className:"color-primary-blue cursor-pointer icon-rs-delete-medium icons-md",onClick:()=>{!0===e.eventTracking.markAsGoal&&this.setState({markAsGoal:!1});let t=[...this.state.elementArray];const a=t.indexOf(e);a>-1&&t.splice(a,1);let s=[...this.state.controlsArray];s.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)}));let r=[...this.state.selectControls];r.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)})),this.setState({elementArray:t,selectControls:r,controlsArray:s})}})})]}),y.jsxs("div",{className:"event-section",children:[y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Name:"}),y.jsx("span",{className:"label-value truncate",children:e.eventTracking.eventName})]}),y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Action:"}),y.jsx("span",{className:"label-value truncate",children:e.eventTracking.trackingType})]}),y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Input type:"}),y.jsx("span",{className:"label-value truncate",children:"Click"!==e.eventTracking.trackingType?e.eventTracking.selectInputType:"Yes / No"})]}),(null==(s=null==(a=e.eventTracking)?void 0:a.eventDescription)?void 0:s.length)>0&&y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Description:"}),y.jsx("span",{className:"label-value truncate",children:e.eventTracking.eventDescription})]})]})]})}))]}))),x(this,"AddFormEvents",(()=>y.jsxs(Ta,{children:[y.jsxs("div",{className:"align-items-center d-flex mb10",children:[y.jsx("i",{className:"icon-rs-events-mini icon-sm color-primary-blue padding-R5",style:{paddingRight:5}}),y.jsx("h4",{className:"mb-0",children:"Configured event(s) element"})]}),this.state.elementArray.length>0&&this.state.elementArray.map(((e,t)=>{var a,s,r,i,n,l;return y.jsxs("div",{className:(null!=this.state.selectElement||null!=(null==(a=this.state.PageEngagementValue)?void 0:a.attributeName)?"click-off":"")+" event-tracking-list",children:[y.jsx(ka,{children:y.jsxs("div",{className:"event-actions mr15",children:[y.jsx("span",{children:y.jsx(Ue,{text:"Edit",children:y.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{var a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b,x,y,S,w,T,k,D,C,E,N,A,I,j,_,O,L,F;"Input"==e.field.categoryType||"Click"==e.field.categoryType||"Duration"==e.field.categoryType||"No over"==e.field.categoryType||e.field.categoryType;let M=Xa(e.field.categoryType);if(this.setState({categoryTypeId:M}),null==e?void 0:e.PageEngagementValue){let i={captureType:null==(a=null==e?void 0:e.eventTracking)?void 0:a.captureType,captureElement:null,markAsGoal:!1,trackingType:null==(s=null==e?void 0:e.eventTracking)?void 0:s.trackingType};this.setState({eventData:i,showEnagagementDropdown:!0,PageEngagementValue:null==(r=null==e?void 0:e.eventTracking)?void 0:r.trackingType,editPageEngagement:!0,PageEngagementIndex:t,engagementAddBtn:!1,addElementCliCkOff:!0}),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:450,behavior:"smooth"})}if(null!=(null==(i=null==e?void 0:e.eventTracking)?void 0:i.trackingType)){let t=null==(n=null==e?void 0:e.eventTracking)?void 0:n.trackingType;const a=[...this.state.attributeNameList,t].filter(((e,t,a)=>t===a.findIndex((t=>t.dataAttributeID===e.dataAttributeID)))).sort(((e,t)=>e.attributeName.localeCompare(t.attributeName))),s=a.findIndex((e=>-10===e.dataAttributeID));let r=null;-1!==s&&(r=a.splice(s,1)[0]),r&&a.push(r),this.setState({attributeNameList:a})}if(1==(null==(l=null==e?void 0:e.eventTracking)?void 0:l.elementKey)){let a={captureType:null==(o=null==e?void 0:e.eventTracking)?void 0:o.captureType,captureElement:null==(c=null==e?void 0:e.eventTracking)?void 0:c.captureElement,preferenceName:null==(d=null==e?void 0:e.eventTracking)?void 0:d.preferenceName,markAsGoal:!1,trackingType:null==(u=null==e?void 0:e.eventTracking)?void 0:u.trackingType};this.setState({eventData:a,preferenceName:null==(h=null==e?void 0:e.eventTracking)?void 0:h.preferenceName,preferenceNameCondition:!0,elementKey:null==(f=null==e?void 0:e.eventTracking)?void 0:f.captureType,captureElement:null==(m=null==e?void 0:e.eventTracking)?void 0:m.captureElement,chooseElementList:null==(p=null==e?void 0:e.eventTracking)?void 0:p.captureElement,attributeValue:null==(v=null==e?void 0:e.eventTracking)?void 0:v.trackingType,chooseElementCondition:!1,editModeOn:!0,editIndex:t}),window.scrollTo(0,0),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:0,behavior:"smooth"})}let R=this.state.controlsArray.filter((t=>t.viewId===e.field.viewId));if(R.length>0){if(R[0].friendlyName=e.eventTracking.friendlyName,R[0].eventName=e.eventTracking.eventName,R[0].selectInputType=e.eventTracking.selectInputType,R[0].eventDescription=null==(g=e.eventTracking)?void 0:g.eventDescription,R[0].trackingType=e.eventTracking.trackingType,R[0].markAsGoal=e.eventTracking.markAsGoal,R[0].mandadory=e.eventTracking.mandadory,R[0].captureElement=e.eventTracking.captureElement,R[0].captureType=e.eventTracking.captureType,(null==(b=null==e?void 0:e.eventTracking)?void 0:b.markAsGoal)&&this.setState({markAsGoal:!0}),this.setState({selectElement:R[0],editModeOn:!0,editIndex:t}),R[0]&&this.setState({attributeValue:null==(x=R[0])?void 0:x.trackingType}),null==(y=R[0])?void 0:y.captureType){let e={captureType:null==(S=R[0])?void 0:S.captureType,captureElement:null==(w=R[0])?void 0:w.captureElement,chooseElementList:null==(T=R[0])?void 0:T.captureElement,chooseElementCondition:null==(null==(k=R[0])?void 0:k.captureElement),elementKey:null==(D=R[0])?void 0:D.captureType,markAsGoal:null==(C=R[0])?void 0:C.markAsGoal,trackingType:null==(E=R[0])?void 0:E.trackingType};this.setState({eventData:e}),null!=(null==(N=R[0])?void 0:N.captureElement)?this.setState({chooseElementList:null==(A=R[0])?void 0:A.captureElement,chooseElementCondition:!1,elementKey:null==(I=R[0])?void 0:I.captureType}):0==this.state.chooseElementCondition&&this.setState({chooseElementCondition:!0})}if("Video"==(null==(j=R[0])?void 0:j.categoryType)){let e=Array.isArray(null==(_=R[0])?void 0:_.captureType)?null==(O=R[0])?void 0:O.captureType:[null==(L=R[0])?void 0:L.captureType];this.setState({videoElementVal:e})}if(null==(F=R[0])?void 0:F.markAsGoal)return void this.setState({markAsGoalClickOff:!1});let a=[...this.state.elementArray];const s=a.some((e=>{var t;return!0===(null==(t=null==e?void 0:e.eventTracking)?void 0:t.markAsGoal)})),r=a.some((e=>1==(null==e?void 0:e.PageEngagementValue)));1==s||1==r?this.setState({markAsGoalClickOff:!0}):this.setState({markAsGoalClickOff:!1})}}})})}),(1==(null==(s=null==e?void 0:e.eventTracking)?void 0:s.markAsGoal)||1==(null==e?void 0:e.PageEngagementValue))&&y.jsx("span",{children:y.jsx(ke,{tooltip:"Mark event as trigger",icon:"icon-rs-communication-calender-large blue",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})}),y.jsx("span",{children:y.jsx(Ue,{text:"Delete",children:y.jsx("i",{className:"icon-rs-delete-medium icons-md color-primary-blue cursor-pointer mr10",onClick:()=>{this.deleteFormFields(e,t)}})})})]})}),y.jsx(ka,{children:y.jsxs("div",{className:"event-section",children:[y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Capture type: 123"}),y.jsx("span",{className:"label-value truncate",children:Array.isArray(null==(r=e.eventTracking)?void 0:r.captureType)?null==(i=e.eventTracking)?void 0:i.captureType.join(", "):null==(n=e.eventTracking)?void 0:n.captureType})]}),y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Tracking action:"}),y.jsx("span",{className:"label-value truncate",children:null==(l=e.eventTracking.trackingType)?void 0:l.displayName})]})]})})]})}))]}))),x(this,"disconnectSocket",(()=>{var e,t,a,s,r={},i="iOS",n=null==(e=this.props.fieldTrackData)?void 0:e.appId,l="iPhone";(null==(a=null==(t=this.props.fieldTrackData)?void 0:t.deviceType)?void 0:a.toLowerCase().includes("an"))&&(i="Android",l=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),r.appId=String(i+l+n).replace(/ /g,""),Nr.emit("disconnect-receiver",JSON.stringify(r)),Nr.off("receiver-handshake-response"),Nr.off("client-information"),Nr.off("message-from-client-image"),Nr.off("message-from-client-data"),Nr.off("receiver-handshake-response"),Nr.off("show-auth-code"),Nr.disconnect()})),x(this,"marketerAcceptance",(()=>{var e,t,a,s;this.setState({deviceInformation:null,showAuthCode:!0});var r=new Object,i="iOS",n=null==(e=this.props.fieldTrackData)?void 0:e.appId,l="iPhone";(null==(a=null==(t=this.props.fieldTrackData)?void 0:t.deviceType)?void 0:a.toLowerCase().includes("an"))&&(i="Android",l=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),r.appId=String(i+l+n).replace(/ /g,"");var o=JSON.stringify(r);Nr.emit("marketer-acceptance-message",o),setTimeout((()=>{this.setState({authCode:"",showAuthCode:!1})}),12e4)})),x(this,"conformationDelete_FormField",(e=>{if(e){let e=[...this.state.elementArray];const t=e.indexOf(this.state.storedDelete_FormFiels);t>-1&&e.splice(t,1),[...this.state.controlsArray].map((e=>{e.viewId===this.state.storedDelete_FormFiels.field.viewId&&(e.select=!1,e.click=!1)})),[...this.state.selectControls].map((e=>{e.viewId===this.state.storedDelete_FormFiels.field.viewId&&(e.select=!1,e.click=!1)}))}})),x(this,"deleteFormFieldsValue",(e=>{var t,a;let s=[...this.state.elementArray];s.splice(this.state.deleteElement_Index,1);const r=s.some((e=>{var t;return!0===(null==(t=null==e?void 0:e.eventTracking)?void 0:t.markAsGoal)})),i=s.some((e=>!0===(null==e?void 0:e.PageEngagementValue)));r?this.setState({markAsGoalClickOff:!0}):this.setState({markAsGoalClickOff:!1}),i?this.setState({PageEngagementValue:!0}):this.setState({PageEngagementValue:null,engagementAddBtn:!1});let n=[...this.state.controlsArray];n.map((e=>{e.viewId===this.state.storedDelete_FormFiels.field.viewId&&(e.select=!1,e.click=!1)}));let l=[...this.state.selectControls];l.map((e=>{e.viewId===this.state.storedDelete_FormFiels.field.viewId&&(e.select=!1,e.click=!1)}));let o=null==(a=null==(t=this.state.storedDelete_FormFiels)?void 0:t.eventTracking)?void 0:a.trackingType;this.addAttributeList(o),this.setState({elementDelete_Popup:!1,elementArray:s,deleteElement_Index:null,selectControls:l,controlsArray:n})})),x(this,"addAttributeList",(e=>{if(null!=e){const t=e,a=[...this.state.attributeNameList,t].filter(((e,t,a)=>t===a.findIndex((t=>t.dataAttributeID===e.dataAttributeID)))).sort(((e,t)=>e.attributeName.localeCompare(t.attributeName))),s=a.find((e=>-10===e.dataAttributeID)),r=a.filter((e=>-10!==e.dataAttributeID));s&&r.push(s),this.setState({attributeNameList:r})}})),x(this,"deleteFormFields",((e,t)=>{null!=e&&null!=t&&this.setState({storedDelete_FormFiels:e,elementDelete_Popup:!0,deleteElement_Index:t});const a=updatedList.filter(((e,t,a)=>t===a.findIndex((t=>t.dataAttributeID===e.dataAttributeID)))).sort(((e,t)=>e.attributeName.localeCompare(t.attributeName))),s=a.find((e=>-10===e.dataAttributeID)),r=a.filter((e=>-10!==e.dataAttributeID));s&&r.push(s),this.setState({attributeNameList:r})})),x(this,"socketDisconnectManually",(()=>{var e,t;"add"===(null==(e=this.props.fieldTrackData)?void 0:e.mode)&&this.disconnectSocket(),(null==(t=this.props)?void 0:t.isWebFieldTrack)&&this.webSocketClosed(),this.context.globalStateData.setIsLoadingData(!0),setTimeout((()=>{this.context.globalStateData.setIsLoadingData(!1);let e={elementArrayData:this.state.originalCloneEmentArrayData,FieldTrackData:this.state.originalCloneFieldTrackData};this.props.cancelBtnClicked(e)}),2e3)})),x(this,"chooseAttribute",(e=>{var t,a=1==this.state.categoryTypeId?"Input":2==this.state.categoryTypeId?"Click":3==this.state.categoryTypeId?"Duration":4==this.state.categoryTypeId?"No over":5==this.state.categoryTypeId?"Url path":null;"Duration"==a&&null!=this.state.videoElementVal&&(a=(null==(t=this.state.videoElementVal)?void 0:t.length)>1?this.state.videoElementVal:this.state.videoElementVal.toString()),""!=this.state.elementKey&&(a=""!=this.state.elementKey?this.state.elementKey:a);let s={captureType:a,captureElement:null!=this.state.chooseElementList?this.state.chooseElementList:"Element",preferenceName:this.state.preferenceName,markAsGoal:this.state.markAsGoal,trackingType:e.target.value};this.setState({eventData:s}),e.target.value.dataAttributeID>0?this.setState({attributeValue:e.target.value,errAttribute:null}):this.setState({newAttributte:!0})})),x(this,"cancelPageScenario",(()=>{var e;1==(null==(e=this.state.elementArray)?void 0:e.some((e=>1==e.PageEngagementValue)))&&this.setState({engagementAddBtn:!0}),this.setState({elementKey:"",eventDescription:"",markAsGoal:!1,mandadory:!1,PageTimeListValue:null,PageEngagementValue:null,editPageEngagement:!1,addElementCliCkOff:!1})})),x(this,"cancelElement",(()=>{if(this.state.selectControls.filter((e=>{var t,a;return e.id!==(null==(a=null==(t=this.state)?void 0:t.selectElement)?void 0:a.id)})),this.state.controlsArray.map((e=>{var t,a;return e.id===(null==(a=null==(t=this.state)?void 0:t.selectElement)?void 0:a.id)?{...e,click:!1}:e})),null==this.state.imageData)return void this.setState({chooseElementList:null,preferenceName:"",elementKey:"",attributeValue:null,markAsGoal:!1});if(0==this.state.editModeOn){let e=[...this.state.controlsArray];e.map((e=>{var t,a;e.viewId===(null==(a=null==(t=this.state)?void 0:t.selectElement)?void 0:a.viewId)&&(e.select=!1,e.click=!1)})),this.setState({controlArray:e,removeChooseElement:e});let t=[...this.state.selectControls];t.map((e=>{var t,a;e.viewId===(null==(a=null==(t=this.state)?void 0:t.selectElement)?void 0:a.viewId)&&(e.select=!1,e.click=!1)}));let a={...this.state.selectElement};this.setState({selectControls:t,selectElementVal:a,selectElement:null})}let e=this.state.attributeNameList.filter((e=>{var t,a;return!((null==(t=this.state.attributeValue)?void 0:t.dataAttributeID)===e.dataAttributeID&&(null==(a=this.state.attributeValue)?void 0:a.attributeName)===e.attributeName)}));const t=null==e?void 0:e.findIndex((e=>-10===e.dataAttributeID));let a=null;-1!==t&&(a=e.splice(t,1)[0]),a&&e.push(a),this.setState({attributeNameList:e}),this.setState({elementKey:"",eventDescription:"",preferenceName:"",markAsGoal:!1,mandadory:!1,editModeOn:!1,chooseElementCondition:!0,categoryTypeId:0,attributeValue:null,selectElement:null,videoElementVal:null,chooseElementList:null,errelementKey:null,errMsgPreferenceName:null,errElementType:null,errAttribute:null})})),x(this,"addElement",(()=>{var e,t,a,s;if(null!=this.state.imageData)if("Video"!=(null==(e=this.state.selectElement)?void 0:e.categoryType)||null!=this.state.videoElementVal&&0!=(null==(t=this.state.videoElementVal)?void 0:t.length)){if(null==this.state.selectElement){if(null==this.state.chooseElementList)return void this.setState({errElementType:"Select form data"});if(!((null==(a=this.state.preferenceName)?void 0:a.length)>0&&"Exceeded the limit"==this.state.errMsgPreferenceName)&&1==this.state.preferenceNameCondition&&null!=this.state.errMsgPreferenceName&&""!=this.state.errMsgPreferenceName)return;if(!(this.state.elementKey.length>0&&"Exceeded the limit"==this.state.errelementKey)&&null!=this.state.errelementKey&&""!=this.state.errelementKey)return;if(1==this.state.preferenceNameCondition&&(null==this.state.preferenceName||0==(null==(s=this.state.preferenceName)?void 0:s.length)||""==this.state.preferenceName))return void this.setState({errMsgPreferenceName:"Enter preference name"});if(""==this.state.elementKey)return void this.setState({errelementKey:"Enter key"})}null!=this.state.attributeValue?this.state.editModeOn?this.editField(this.state.eventData):this.addFormData(this.state.eventData):this.setState({errAttribute:"Select attribute"})}else this.setState({errvideoElementVal:"Select video capture"});else this.setState({socketConnectCheck:!0})})),x(this,"setMarkEventTrigger",(e=>{let t={...this.state.eventData};t.hasOwnProperty("markAsGoal")&&(t.markAsGoal=e),this.setState({eventData:t}),this.setState({markAsGoal:e})})),x(this,"selectVideoElementValue",(e=>{let t={...this.state.eventData},a=e.value.length>1?e.value:e.value.toString();t.hasOwnProperty("captureType")&&(t.captureType=a),this.setState({eventData:t}),this.setState({videoElementVal:e.value,errvideoElementVal:null})})),x(this,"addSelectPageBtn",(()=>{var e,t;if(null==this.state.imageData)return void this.setState({socketConnectCheck:!0});if(null==this.state.PageEngagementValue)return void this.setState({errPageEngagement:"Select page engagement type"});let a=this.state.timeSpentValue;if(2==(null==(e=this.state.PageEngagementValue)?void 0:e.dataAttributeID)&&null==this.state.timeSpentValue)return void this.setState({errMsgTimeSpentValue:"Choose time limit"});2!=(null==(t=this.state.PageEngagementValue)?void 0:t.dataAttributeID)&&(this.setState({timeSpentValue:null}),a=null);let s={field:{},screenTracking:{},eventTracking:{trackingType:this.state.PageEngagementValue,captureType:"Trigger action",timeLimit:a},PageEngagementValue:!0},r=[...this.state.elementArray];null!=this.state.PageEngagementIndex?(r[this.state.PageEngagementIndex]=s,this.setState({elementArray:r,PageEngagementValue:"",engagementAddBtn:!0,editPageEngagement:!1,PageEngagementIndex:null,markAsGoal:!1,addElementCliCkOff:!1}),window.scrollTo({top:document.body.scrollHeight/4,behavior:"smooth"})):this.setState((e=>({elementArray:[...e.elementArray,s],PageEngagementValue:"",engagementAddBtn:!0,editPageEngagement:!1,PageEngagementIndex:null,markAsGoal:!1,addElementCliCkOff:!1})))})),x(this,"chooseElement",(e=>{let t={...this.state.eventData};t.hasOwnProperty("captureElement")&&(t.captureElement=e.value),this.setState({eventData:t}),null!=e.value.attributeName?this.setState({chooseElementList:e.value,errElementType:null,preferenceNameCondition:!0}):this.setState({newAttributte:!0})})),x(this,"saveAttributeData",(e=>{const t={...e,attributeTypeId:"1",personalizationCallbackName:"",kPIType:"",kPICondition:"",databaseName:"",isMaked:!1};ce({path:Rt,params:t,sessionOut:this.context.globalStateData.setSessionOutData,loading:this.context.globalStateData.setIsLoadingData,ok:e=>{e.status&&this.getAttributeDataNew(!0)},fail:e=>{}})}))}componentWillUnmount(){if(0==Ar){const e={...this.state,controlsArray:[...this.state.controlsArray_Copy],selectElement:null};let t={elementArrayData:this.state.originalCloneEmentArrayData,FieldTrackData:this.state.originalCloneFieldTrackData};this.props.controllsArrayChange(t,e)}}componentDidMount(){var e,t,a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b,x,y,S,w,T,D,C,E,N,A,I,j,_,O,L,F,M,R,P;if(null==(e=this.props.fieldTrackData)?void 0:e.elementArray){const e=JSON.parse(JSON.stringify(null==(t=this.props.fieldTrackData)?void 0:t.elementArray)),a=JSON.parse(JSON.stringify(this.props.fieldTrackData));this.setState({originalCloneEmentArrayData:e,originalCloneFieldTrackData:a})}if(null==(a=this.props.fieldTrackData)?void 0:a.controlArray){let e=[];e=1==this.props.editCheck?JSON.parse(JSON.stringify(null==(s=this.props)?void 0:s.controlsArray_Copy)):JSON.parse(JSON.stringify(null==(r=this.props.fieldTrackData)?void 0:r.controlArray)),this.setState({controlsArray_Copy:e})}if(this.getAttributeDataNew(!1),this.contentRef=k.createRef(),!0===this.props.isWebFieldTrack){if(!0===this.props.isForm&&this.props.isEdit){this.setState({currentImg:null==(n=null==(i=this.props.fieldTrackData)?void 0:i.imageData)?void 0:n.imageData,imageData:null==(l=this.props.fieldTrackData)?void 0:l.imageData});let e=[];return(null==(o=this.props.fieldTrackData)?void 0:o.controlArray)?e=null==(c=this.props.fieldTrackData)?void 0:c.controlArray:(null==(d=this.props.fieldTrackData)?void 0:d.controlsArray)&&(e=null==(u=this.props.fieldTrackData)?void 0:u.controlsArray),this.setState({showAuthCode:!1,clientData:e,controlsArray:e}),void this.getFieldTrackData()}if(this.props.isEdit){let e={campaignId:Lt(),deviceOs:"",deviceType:"Web",goalType:"P"};this.getDataFromServer(e)}else this.context.globalStateData.setIsLoadingData(!0),this.webSocketInit()}else{if(!0===this.props.isForm&&this.props.isEdit){this.setState({currentImg:null==(f=null==(h=this.props.fieldTrackData)?void 0:h.imageData)?void 0:f.imageData,imageData:null==(m=this.props.fieldTrackData)?void 0:m.imageData}),null==(v=null==(p=this.props.fieldTrackData)?void 0:p.controlsArray)||v.filter((e=>!0===e.select));const e=null==(g=this.props.controlsArray_Copy)?void 0:g.map((e=>{var t,a;const s=null==(a=null==(t=this.props.fieldTrackData)?void 0:t.elementArray)?void 0:a.some((t=>(null==t?void 0:t.field.viewId)===e.viewId));return{...e,select:s,click:!1}}));null==e||e.filter((e=>!0===e.select));const t=null==(x=null==(b=this.props.fieldTrackData)?void 0:b.controlsArray)?void 0:x.map((e=>{var t,a;const s=null==(a=null==(t=this.props.fieldTrackData)?void 0:t.elementArray)?void 0:a.some((t=>(null==t?void 0:t.field.viewId)==e.viewId));return{...e,select:s,click:!1}}));if(null==t||t.filter((e=>!0===e.select)),1==this.props.editCheck?this.setState({controlsArray:null==(y=this.props)?void 0:y.controlsArray_Copy}):this.setState({controlsArray:t}),this.setState({showAuthCode:!1,clientData:null==(S=this.props.fieldTrackData)?void 0:S.controlsArray}),this.setState({elementArray:null==(w=this.props.fieldTrackData)?void 0:w.elementArray}),"Andriod"==(null==(T=this.props.fieldTrackData)?void 0:T.deviceType)&&this.setState({preferenceNameCondition:!0}),null!=(null==(C=null==(D=this.props)?void 0:D.element)?void 0:C.trackingType)){const e=null==(N=null==(E=this.props)?void 0:E.element)?void 0:N.trackingType,t=[...this.state.attributeNameList,e].filter(((e,t,a)=>t===a.findIndex((t=>t.dataAttributeID===e.dataAttributeID)))).sort(((e,t)=>e.attributeName.localeCompare(t.attributeName)));this.setState({attributeNameList:t})}const a=null==(I=null==(A=this.props.fieldTrackData)?void 0:A.elementArray)?void 0:I.some((e=>{var t;return!0===(null==(t=null==e?void 0:e.eventTracking)?void 0:t.markAsGoal)})),s=null==(_=null==(j=this.props.fieldTrackData)?void 0:j.elementArray)?void 0:_.some((e=>!0===(null==e?void 0:e.PageEngagementValue))),r=null==(L=null==(O=this.props.fieldTrackData)?void 0:O.elementArray)?void 0:L.some((e=>{var t,a,s,r;return"Page load"==(null==(a=null==(t=null==e?void 0:e.eventTracking)?void 0:t.trackingType)?void 0:a.attributeName)||"page time limit"==(null==(r=null==(s=null==e?void 0:e.eventTracking)?void 0:s.trackingType)?void 0:r.attributeName)})),i=null==(M=null==(F=this.props.fieldTrackData)?void 0:F.elementArray)?void 0:M.filter(((e,t)=>{var a;return null==(a=null==e?void 0:e.eventTracking)?void 0:a.timeLimit}));if((null==i?void 0:i.length)>0){let e=null==i?void 0:i.map(((e,t)=>{var a;return null==(a=null==e?void 0:e.eventTracking)?void 0:a.timeLimit}));this.setState({timeSpentValue:e[0]})}return s&&this.setState({engagementAddBtn:!0,PageEngagementValue:!0}),a&&this.setState({markAsGoalClickOff:!0,engagementAddBtn:!0}),void(r&&this.setState({engagementAddBtn:!0}))}"add"===(null==(R=this.props.fieldTrackData)?void 0:R.mode)?this.socketInit():"edit"===(null==(P=this.props.fieldTrackData)?void 0:P.mode)&&this.getFieldTrackData()}window.addEventListener("socketClosed",(()=>{this.disconnectSocket()})),window.addEventListener("webclosed",(()=>{this.webSocketClosed()}))}render(){var e,t,a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b,x,S,w,T,k,D,C,E,N,A,I,j,_,O,L,F,M,R,P,U,B,G,V,W,H,z;return y.jsxs("div",{ref:this.contentRef,children:[null!==this.state.deviceInformation&&y.jsx(_a,{headerTitle:"Confirmation",para:"Device is : "+this.state.deviceInformation.deviceModel,primaryButtonText:"Accept",secondaryButtonText:"Reject",buttonClicked:e=>{!0===e?this.marketerAcceptance():(this.disconnectSocket(),this.socketInit())}}),this.state.showFormNameComponent&&y.jsx(_a,{headerTitle:"Sorry",para:"Do you want to delete the form field?",buttonClicked:e=>{this.setState({showFormNameComponent:!1})}}),this.state.elementDelete_Popup&&y.jsx(_a,{size:"md",para:"Do you want to delete the form field?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{!0===e?this.deleteFormFieldsValue():this.setState({elementDelete_Popup:!1,deleteElement_Index:null})}}),this.state.socketDisconnect_Popup&&y.jsxs(Da,{show:this.state.socketDisconnect_Popup,centered:!0,size:"md",children:[y.jsx(Da.Body,{children:y.jsx(ga,{children:y.jsx(Ta,{children:this.state.clientSocketDisconnect?y.jsxs("h2",{children:[this.state.clientSocketDisconnect," Please reload it."]}):this.state.socketDisconnectData?y.jsxs("h2",{children:[this.state.socketDisconnectData," Please reload it . "]}):null})})}),y.jsx("div",{className:"d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{this.socketDisconnectManually()},children:"OK"})})]}),!0===this.state.showAuthCode&&y.jsx(_a,{headerTitle:"One-time password",otp:this.state.authCode,otpClass:"bg-tertiary-blue color-primary-blue",buttonClicked:e=>{this.setState({authCode:"",showAuthCode:!1})}}),y.jsx("div",{className:"",children:y.jsxs(Ta,{className:"field-tracking-container mobile-field",style:{height:this.props.isWebFieldTrack?"100%":(null==(t=null==(e=this.state)?void 0:e.imageData)?void 0:t.width)>0?580:500},children:[y.jsx(ka,{className:!0===this.state.editModeOn?"click-":"on",md:(this.props.isWebFieldTrack,8),children:y.jsx("div",{className:"field-tracking-content-wrapper d-flex align-items-center "+(!1===this.props.isWebFieldTrack&&this.state.imageData,""),children:null==this.state.imageData&&!1===this.props.isWebFieldTrack?y.jsx("div",{className:"text-center",children:y.jsxs(Ta,{children:[y.jsxs("h3",{className:"mb15 font-medium blue",children:[this.props.fieldTrackData.deviceType," app event tracking setup"]}),y.jsx("img",{className:"mb15 mobile-flip",src:Pa}),y.jsx("h3",{className:"mb15 font-medium blue",children:"Establishing connection"}),y.jsxs("h4",{className:"mb15",children:["Open ",y.jsx("span",{children:y.jsx("strong",{children:this.props.fieldTrackData.appName})})," app and flip your mobile phone 6 times as shown above"]}),y.jsx("small",{children:"Note - The connection will not be established if the SDK is missing/broken in the mobile app"})]})}):y.jsx("div",{className:"mb25",children:!0===this.props.isWebFieldTrack?y.jsxs(y.Fragment,{children:[!1===this.props.isWebFieldTrack&&y.jsxs("h3",{className:"mb15 font-medium color-primary-blue text-center",style:{position:"absolute",top:0,width:"100%"},children:[!0===this.props.isWebFieldTrack?"Web":(null==(s=null==(a=this.props)?void 0:a.fieldTrackData)?void 0:s.deviceType)+" app"," event tracking setup"]}),y.jsx("div",{className:"css-scrollbar",style:{height:"calc(100% - 20px)",position:"absolute",width:"100%",top:0,paddingRight:25},children:null==this.state.imageData?y.jsx("div",{className:"css-scrollbar",style:{height:"calc(100% - 20px)",position:"absolute",width:"100%",top:0,paddingRight:25},children:y.jsx("div",{className:"segment_loader",children:" "})}):y.jsx("div",{className:"P mx-auto",style:{width:"100%",height:(null==(i=null==(r=this.state)?void 0:r.imageData)?void 0:i.height)||0,backgroundImage:`url(${null==(l=null==(n=this.state)?void 0:n.imageData)?void 0:l.imageData})`,backgroundSize:"cover",position:"relative",zoom:(this.props.isWebFieldTrack,.7)},children:(null==(o=this.state.controlsArray)?void 0:o.length)>0&&this.createWebField(this.state.controlsArray)})})]}):y.jsx("div",{className:(this.state.editModeOn||null!=(null==(c=this.state.PageEngagementValue)?void 0:c.attributeName)?"click-off":"")+" css-scrollbar",style:{height:"calc(100% - 90px)",position:"absolute",width:"100%",top:0,paddingRight:25},children:y.jsx("div",{className:"device-screen "+("iPhone"===(null==(d=this.props.fieldTrackData)?void 0:d.deviceType)?"iphone-container":"andriod-container"),style:{width:(null==(h=null==(u=this.state)?void 0:u.imageData)?void 0:h.width)+10||380},children:y.jsxs("div",{className:"iPhone"===(null==(f=this.props.fieldTrackData)?void 0:f.deviceType)?"iphone-wrapper":"",children:[this.getDeviceType(null==(m=this.props.fieldTrackData)?void 0:m.deviceType),y.jsx("div",{className:"device-image-render",style:{width:(null==(v=null==(p=this.state)?void 0:p.imageData)?void 0:v.width)+10||380,maxHeight:(null==(b=null==(g=this.state)?void 0:g.imageData)?void 0:b.height)||600},children:y.jsx("div",{className:"device-image-inner css-scrollbar",style:{width:(null==(S=null==(x=this.state)?void 0:x.imageData)?void 0:S.width)||380,maxHeight:(null==(T=null==(w=this.state)?void 0:w.imageData)?void 0:T.height)||600},children:y.jsx("div",{className:"P mx-auto",style:{width:(null==(D=null==(k=this.state)?void 0:k.imageData)?void 0:D.width)||0,height:(null==(E=null==(C=this.state)?void 0:C.imageData)?void 0:E.height)||0,backgroundImage:`url(${null==(A=null==(N=this.state)?void 0:N.imageData)?void 0:A.imageData})`},children:y.jsx("div",{style:{width:(null==(j=null==(I=this.state)?void 0:I.imageData)?void 0:j.width)||0,height:(null==(O=null==(_=this.state)?void 0:_.imageData)?void 0:O.height)||0,position:"relative"},children:(null==(L=this.state.controlsArray)?void 0:L.length)>0&&this.createSingleMobileField(this.state.controlsArray[0],null==(F=this.state.controlsArray[0])?void 0:F.id)})})})})]})})})})})}),y.jsxs(ka,{md:(this.props.isWebFieldTrack,4),children:[y.jsxs("div",{className:"field-tracking-cost-wrapper mb30 css-scrollbar",style:{top:0,right:0,height:this.props.isWebFieldTrack?"auto":(null==(R=null==(M=this.state)?void 0:M.imageData)?void 0:R.width)>0?550:570},children:[!0===(null==(P=this.props)?void 0:P.isForm)?null:y.jsx(Qa,{data:this.state.screenTracking,error:this.state.errScreenTracking,onChange:e=>{this.setState({screenTracking:e});let t={...this.state.errScreenTracking};""!==e.minDuration&&(t.errMinDuration=null),""!==e.minLength&&(t.errMinLength=null),this.setState({errScreenTracking:t})}}),!0===(null==(U=this.props)?void 0:U.isForm)?y.jsxs("div",{className:"marginT10",children:[y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsxs("div",{className:"d-flex align-items-center",children:[y.jsx("i",{className:"icon-rs-add-events-large icon-lg  color-primary-blue"}),y.jsx("h4",{className:"mb0 ml10 color-primary-blue",children:"Add attribute"})]})})})}),y.jsxs("div",{className:this.state.addElementCliCkOff?"boxed click-off":"boxed",children:[null!=this.state.selectElement?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsxs("div",{style:{display:"flex"},children:[y.jsx(ie,{required:!0,className:"",disabled:!0,placeholder:"Select element",val:"Element"}),(null==(B=this.state)?void 0:B.editModeOn)?null:null!==this.state.selectElement&&y.jsx(Ta,{children:y.jsx(ke,{tooltip:"Reset",icon:"icon-rs-refresh-medium",size:"md",onClick:()=>{this.cancelElement()}})})]})})}):null,null==this.state.selectElement?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(te,{required:!0,label:null!==this.state.chooseElementList?"Data source":"Select data source",data:this.state.ElementList,textField:"attributeName",dataItemKey:"elementID",errorMessage:this.state.errElementType,value:null!==this.state.chooseElementList?this.state.chooseElementList:{attributeName:"",elementID:-1},onChange:e=>{this.chooseElement(e)}})})})}):null,null!=this.state.selectElement?2==this.state.categoryTypeId||0==this.state.categoryTypeId?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{required:!0,className:"",disabled:!0,placeholder:"Capture type",val:"Click"})})})}):1==this.state.categoryTypeId?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{required:!0,className:"",disabled:!0,placeholder:"Capture type",val:"Input"})})})}):3==this.state.categoryTypeId?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(se,{required:!0,placeholder:"-- Select video capture--",data:this.state.videoDropdownList,value:this.state.videoElementVal,errorMessage:this.state.errvideoElementVal,allowCustom:!0,onChange:e=>{this.selectVideoElementValue(e)},filterable:!0,onFilterChange:e=>{}})})})}):4==this.state.categoryTypeId?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{required:!0,className:"",disabled:!0,placeholder:"Capture type",val:"No over"})})})}):y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{required:!0,className:"",disabled:!0,placeholder:"Capture type",val:"Url path"})})})}):null,1==this.state.preferenceNameCondition&&null==this.state.selectElement?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{id:"sdx_addFrom",placeholder:"Preference name",required:!0,label:(null==(G=this.state.preferenceName)?void 0:G.length)>0?"preference Name":"Select preference Name",val:this.state.preferenceName,max:51,onChange:e=>{if(e.target.value.trimStart().length<=51){if(/\s/.test(e.target.value))return;let t=e.target.value.length>0?null:"Enter preference name";this.setState({errMsgPreferenceName:t}),e.target.value.length<51&&this.setState({preferenceName:e.target.value});let a={...this.state.eventData};if(a.hasOwnProperty("preferenceName")&&(a.preferenceName=e.target.value),this.setState({eventData:a}),e.target.value.length>50)return void this.setState({errMsgPreferenceName:"Exceeded the limit"})}},handleOnBlur:e=>{0!==e.length?this.setState({preferenceName:e}):this.setState({errMsgPreferenceName:"Enter preference name"})},errorMessage:this.state.errMsgPreferenceName})})})}):null,null==this.state.selectElement?y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(ie,{id:"sdx_addFrom",placeholder:"Enter key",val:this.state.elementKey,max:51,required:!0,onChange:e=>{if(e.target.value.trimStart().length<=51){if(/\s/.test(e.target.value))return;let t=e.target.value.length>0?null:"Enter Key";this.setState({errelementKey:t}),e.target.value.length<51&&this.setState({elementKey:e.target.value});let a={...this.state.eventData};if(a.hasOwnProperty("captureType")&&(a.captureType=e.target.value),a.hasOwnProperty("dataSource")&&(a.dataSource="Local"),this.setState({eventData:a}),e.target.value.length>50)return void this.setState({errelementKey:"Exceeded the limit"})}},handleOnBlur:e=>{0!==e.length?this.setState({elementKey:e}):this.setState({errelementKey:"Enter key"})},errorMessage:this.state.errelementKey})})})}):null,this.state.newAttributte&&y.jsx(is,{newAttributeError:this.state.newAttributeError,show:this.state.newAttributte,cancelBtnClick:e=>{this.setState({newAttributte:!1,newAttributeError:null})},callBack:(e,t)=>{null==this.state.newAttributeError&&(this.setState({newAttributte:!1}),null!==t&&this.saveAttributeData(t))},onChange:e=>{null!=e&&this.setState({newAttributeError:null})},onBlur:e=>{var t;if(0==(null==e?void 0:e.length))return void this.setState({newAttributeError:"Enter attribute name"});let a=e.trimEnd();(null==(t=this.state.attributeNameList_Copy)?void 0:t.some((e=>{var t;return(null==(t=null==e?void 0:e.displayName)?void 0:t.toLowerCase())===a.toLowerCase()})))&&this.setState({newAttributeError:"Attribute name already exists"})}}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsx(te,{required:!0,label:null!==this.state.attributeValue?"Attribute":"Select attribute",data:this.state.attributeNameList,textField:"attributeName",dataItemKey:"dataAttributeID",errorMessage:this.state.errAttribute,value:null!==this.state.attributeValue?this.state.attributeValue:{attributeName:"",dataAttributeID:-1},onChange:e=>{e.target.value.dataAttributeID>0?this.chooseAttribute(e):this.setState({newAttributte:!0})},footer:y.jsxs("span",{className:"new-attribute-kendo-grid",children:[y.jsx("span",{children:"New attribute"}),y.jsx(ke,{icon:Pt,position:"bottom",size:"md",color:"primary-color",onClick:()=>{this.setState({newAttributte:!0})}})]})})})})}),y.jsx(Ta,{children:y.jsx(ka,{sm:3,children:y.jsx("div",{className:null==this.state.selectElement||!0===this.state.markAsGoalClickOff||null!=this.state.PageEngagementValue?"click-off mt15":"click-on d-flex justify-content-between align-items-center marginT15",children:y.jsx(ne,{className:"font-sm pad-top-checkbox",checked:this.state.markAsGoal,lbl:"Mark event as trigger",cb:e=>{this.setMarkEventTrigger(e)}})})})}),y.jsx(Ta,{children:y.jsx(ka,{sm:12,children:y.jsxs("div",{className:"d-flex justify-content-end mb30",children:[y.jsx(he,{className:!0===this.props.editModeOn?"mr15":"",onClick:()=>{this.cancelElement()},children:"Cancel"}),y.jsx(fe,{onClick:()=>this.addElement(),children:!0===this.state.editModeOn?"Update":"Add"})]})})})]})]}):null,(null==(V=this.state)?void 0:V.chooseMarkOrEngagement)?y.jsx(_a,{para:"Choose at least one event to serve as a trigger or select a trigger action",pClass:"text-center mb0",primaryButtonText:"OK",buttonClicked:e=>{this.setState({chooseMarkOrEngagement:!1})}}):null,this.state.errEventCondition?y.jsx(_a,{headerTitle:"Alert",para:null==(W=this.state.errEvent)?void 0:W.errEventName,buttonClicked:e=>{let t={...this.state.errEvent};t.errEventName=null,this.setState({errEvent:t}),this.setState({errEventCondition:!1,attributeValue:null}),this.cancelElement()}}):null,this.state.tenElement?y.jsx(_a,{headerTitle:"Alert",para:"Can not add more than 5 element",buttonClicked:e=>{this.setState({chooseMarkOrEngagement:!1,tenElement:null,attributeValue:null}),this.cancelElement()}}):null,this.state.choosePageScenrio?y.jsx(_a,{headerTitle:"Alert",para:"select a trigger action",buttonClicked:e=>{this.setState({choosePageScenrio:!1})}}):null,this.state.socketConnectCheck?y.jsx(_a,{headerTitle:"Alert",para:"Connect App",primaryButtonText:"OK",buttonClicked:e=>{this.setState({socketConnectCheck:!1,chooseElementList:null,preferenceName:"",elementKey:"",attributeValue:null,PageEngagementValue:null,errElementType:null,errelementKey:null,errMsgPreferenceName:null,errelementKey:null,errAttribute:null})}}):null,1==this.state.elementChoosePopUp?y.jsx(_a,{headerTitle:"Alert",para:"Please choose an element",primaryButtonText:"OK",buttonClicked:e=>{this.setState({elementChoosePopUp:!1})}}):null,1==this.state.already_elementChoosePopUp?y.jsx(_a,{headerTitle:"Alert",para:"Already event added for this element",primaryButtonText:"OK",buttonClicked:e=>{this.setState({already_elementChoosePopUp:!1})}}):null,y.jsxs(y.Fragment,{children:[y.jsx(ga,{className:this.state.engagementAddBtn?"click-off":"",children:y.jsx(Ta,{children:y.jsx(ka,{md:12,children:y.jsxs("div",{className:"d-flex align-items-center",children:[y.jsx("i",{className:"icon-rs-communication-calender-large blue icons-md color-primary-blue"}),y.jsx("h4",{className:"mb0 ml10 color-primary-blue",children:"Trigger action"})]})})})}),y.jsxs("div",{className:(null!==this.state.selectElement||this.state.engagementAddBtn?"click-off":"")+" boxed",children:[y.jsxs(ga,{children:[y.jsx(Ta,{children:y.jsx(ka,{md:16,children:y.jsx(te,{required:!0,label:null!==this.state.PageEngagementValue?"Page engagement type":"Select page engagement type",data:this.state.PageEngagementList,textField:"attributeName",dataItemKey:"dataAttributeID",errorMessage:this.state.errPageEngagement,value:null!==this.state.PageEngagementValue?this.state.PageEngagementValue:{attributeName:null,dataAttributeID:0},onChange:e=>{e.target.value.dataAttributeID>0&&this.setState({PageEngagementValue:e.target.value,errPageEngagement:null})}})})}),2==(null==(H=this.state.PageEngagementValue)?void 0:H.dataAttributeID)?y.jsxs(ga,{children:[y.jsx(Ta,{className:"mt20",children:y.jsx(ka,{md:16,children:y.jsx(te,{required:!0,label:null!==this.state.timeSpentValue?"Time limit":"Select time limit",data:this.state.timeSpentData,textField:"timeLimitName",dataItemKey:"id",errorMessage:this.state.errMsgTimeSpentValue,value:null!==this.state.timeSpentValue?this.state.timeSpentValue:{timeLimitName:"",id:-1},onChange:e=>{e.target.value.id>0&&this.setState({timeSpentValue:e.target.value,errMsgTimeSpentValue:null})}})})}),y.jsx(Ta,{})]}):null]}),y.jsx(Ta,{children:y.jsx(ka,{sm:12,children:y.jsxs("div",{className:"d-flex justify-content-end mb30",children:[y.jsx(he,{className:!0===this.props.editModeOn?"click-off":"",onClick:()=>{this.cancelPageScenario(),!0===this.props.editModeOn&&this.props.cancelButtonClick()},children:"Cancel"}),y.jsxs(fe,{className:this.state.engagementAddBtn?"click-off":"",onClick:()=>this.addSelectPageBtn(),children:[" ",this.state.editPageEngagement?"Update":"Add"]})]})})})]})]}),(null==(z=this.state.elementArray)?void 0:z.length)>0&&y.jsx("div",{className:!0===this.state.editModeOn?"click":"click-on",children:!0===this.props.isForm?y.jsx(this.AddFormEvents,{}):y.jsx(this.AddMobileEvents,{})})]}),y.jsxs("div",{className:"d-flex justify-content-end mb30 ",children:[y.jsx(he,{onClick:()=>{this.socketDisconnectManually()},children:"Cancel"}),y.jsx(fe,{className:this.state.saveBTNCondition?"click":"click-on",onClick:()=>{if(!1===this.props.isForm){if(pe(this.state.screenTracking.minDuration)){let e={...this.state.errScreenTracking};return e.errMinDuration="Select min duration",void this.setState({errScreenTracking:e})}if(pe(this.state.screenTracking.minLength)){let e={...this.state.errScreenTracking};return e.minLength="Select min length",void this.setState({errScreenTracking:e})}}this.saveMobileFieldTracking()},children:"Save"})]})]})]})})]})}}x(Ir,"contextType",le);const jr=S(Ir),_r=new Date,Or=qa((e=>(w.useState([]),y.jsx(y.Fragment,{children:y.jsx("td",{children:y.jsxs(_e,{className:"float-end",children:[y.jsx(ke,{icon:"icon-rs-eye-medium",iconClass:"",size:"md",tooltip:"View",onClick:()=>{e.viewId(e.dataItem.id)}}),y.jsx(ke,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",onClick:()=>{e.editId(e.dataItem.id)}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",onClick:()=>{e.deleteId(e.dataItem.id)}})]})})})))),Lr=qa((e=>{var t,a,s,r,i;return w.useState([]),w.useState((null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.markAsGoal)||!1),y.jsx(y.Fragment,{children:y.jsx("td",{children:y.jsxs(_e,{className:"float-end",children:[((null==(r=null==(s=null==e?void 0:e.dataItem)?void 0:s.eventTracking)?void 0:r.markAsGoal)||(null==(i=null==e?void 0:e.dataItem)?void 0:i.PageEngagementValue))&&y.jsx(ke,{tooltip:"Mark event as trigger",icon:"icon-rs-communication-calender-large blue",size:"md",iconClass:"",mainClass:"",onClick:()=>{}}),y.jsx(ke,{tooltip:"Delete",icon:"icon-rs-delete-medium",onClick:()=>{e.deleteId(e.dataIndex)}})]})})})}));class Fr extends w.Component{constructor(){super(...arguments),x(this,"state",{platFormTypes:["Android phone","Android tablet","iPhone","iPad"],isFieldTrack:!1,commonMsg:null,deviceList:(null==(u=null==(d=null==this?void 0:this.props)?void 0:d.fullData)?void 0:u.length)>0?null==(h=this.props)?void 0:h.fullData:[{deviceType:null,mobileApp:null,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}],rrElementArray:(null==(m=null==(f=null==this?void 0:this.props)?void 0:f.fullData)?void 0:m.length)>0?null==(g=null==(v=null==(p=this.props)?void 0:p.fullData[0])?void 0:v.fieldList)?void 0:g.elementArray:[],fieldTrackData:null,fieldTrackData_copy:null,getEventData_copy:null,appName:null,appId:null,appNameList:null,allAppNameList:null,errMobileApp:null,deviceType:null,mobileApp:null,mobileAppList:[],activationKey:0,showFormNameComponent:!1,formName:"",formNameCopy:"",mobileAppDisable:!1,errFormName:null,isEdit:!1,startDate:null,endDate:null,errStartDate:null,errEndDate:null,endDateMinValue:"",getEventData:[],getEventData_Duplicate:[],getEventDataCopy:[],customEventNameData:[],showLoader:!1,loaderCondition:!1,showLoaderKendo:!0,showKendoGrid:!1,androidCondition:!0,showDateCondition:!1,editFieldTrackIcon:!0,editScenario:!1,saveBTNCondition:!1,showSaveBTN:!1,kendoGridShow:!1,getEventsData:[],showForm:!1,endDataDisable:!0,deleteValueID:null,saveBTNToggle:null,viewClickOff:!1,eventForm:!0,imageSetCondition:!1,dataFieldTrack:null,editedID:null,newFieldTrackIcon:!0,socketDisconnect:!1,eventNameLoading:!1,eventNameStatus:!1,Lifetime:!0,Customrange:!1,markAsGoalElementDelete:null,markAsGoalElementDelete_Content:null,AddBtnShow:!1,fieldTrackIconCheck_CustomName:!1,getEventsData_Deletecopy:null,fieldTrackData_Deletecopy:null,deviceList_Deletecopy:null,fieldData_Deletecopy:null,deletedItem_EventData:null,rrElementArray_Deletecopy:null,controlsArray_Copy:[],editCheck:!1}),x(this,"componentDidUpdate",(e=>{})),x(this,"getEventDetails",(()=>{ce({path:je,params:{channel:"MP"},ok:e=>{var t;if(1==e.status)if(e.data,(null==(t=e.data)?void 0:t.length)>0){const t=e.data.filter((e=>"Web"!=e.deviceType)),a=t.map((({id:e,customEventName:t})=>({id:e,customEventName:t})));this.setState({getEventData:t,getEventDataCopy:t,customEventValue:null,showKendoGrid:!0,AddBtnShow:!0,showLoader:!1,loaderCondition:!1,showLoaderKendo:!1,customEventNameData:a})}else this.setState({showLoader:!1,loaderCondition:!0,showLoaderKendo:!1,AddBtnShow:!0,customEventNameData:[]});else this.setState({showKendoGrid:!1,loaderCondition:!0,AddBtnShow:!0})},fail:e=>{this.setState({showLoader:!0})}})})),x(this,"getDataFromServer",(()=>{ce({path:Ut,ok:e=>{if(e.status){e.data;let t=null==e?void 0:e.data.map((e=>({appName:e.appName,appGuid:e.appGuid}))),a=null==e?void 0:e.data.map((e=>e.appName));this.setState({appNameList:a,allAppNameList:t})}},fail:e=>{}})})),x(this,"createDeviceList",(()=>({deviceType:null,mobileApp:this.state.mobileApp,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}))),x(this,"createError",(()=>({errPlayStoreUrl:null,errLanguage:null,errWebUrl:null,errDeviceType:null}))),x(this,"getPlatformTypes",(()=>{let e=this.state.platFormTypes,t=[];return e.map((e=>{0===this.state.deviceList.filter((t=>e===t.deviceType)).length&&t.push(e)})),t})),x(this,"addBtnClick",(()=>{let e=Ga(this.state.deviceList);if(e.error){let t=[...this.state.deviceList];1===e.errType?t[e.errIndex].error.errDeviceType=e.errMsg:2===e.errType?t[e.errIndex].error.errMobileApp=e.errMsg:3===e.errType&&(this.setState({commonMsg:e.errMsg}),setTimeout((()=>{this.setState({commonMsg:null})}),2e3)),this.setState({deviceList:t})}else{let e=[...this.state.deviceList];e.push(this.createDeviceList()),this.accordinChanges(e.length-1),this.setState({deviceList:e})}})),x(this,"removeBtnClick",(e=>{let t=[...this.state.deviceList];t.splice(e,1),this.setState({deviceList:t})})),x(this,"valueChange",((e,t,a,s,r)=>{let i=[...this.state.deviceList];i[e][t]=a,i[e].error[s]=r,this.setState({deviceList:i})})),x(this,"accordinChanges",(e=>{this.state.activationKey===e?this.setState({activationKey:"-1"}):this.setState({activationKey:e})})),x(this,"AddFormEvents",(e=>{var t,a,s,r,i,n,l,o;const c=O.parse(null==(a=null==(t=this.props.history)?void 0:t.location)?void 0:a.search);let d=void 0!==c.isEdit&&c.isEdit;return y.jsxs(Ta,{children:[(null==e?void 0:e.head)?y.jsxs("div",{className:"align-items-center d-flex mb10 mt40",children:[y.jsx("i",{className:"icon-rs-events-mini icon-sm color-primary-blue padding-R5"}),y.jsx("h4",{className:"mb-0 padding-L5",style:{paddingLeft:5},children:"Form fields"}),"true"===d&&y.jsx(Ue,{text:"Edit",children:y.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md color-primary-blue cursor-pointer ml15",onClick:()=>{var e,t;null==(e=this.state.deviceList[0].mobileApp)||e.appName,null==(t=this.state.deviceList[0].mobileApp)||t.appGuid,this.state.deviceList[0].deviceType,this.setState({isEdit:!0,isFieldTrack:!0,fieldTrackData:this.state.deviceList})}})})]}):"",(null==e?void 0:e.head)?"":y.jsx(y.Fragment,{children:(null==(i=null==(r=null==(s=this.state.deviceList[(null==e?void 0:e.index)||0])?void 0:s.fieldList)?void 0:r.elementArray)?void 0:i.length)>0&&(null==(o=null==(l=null==(n=this.state.deviceList[(null==e?void 0:e.index)||0])?void 0:n.fieldList)?void 0:l.elementArray)?void 0:o.map(((e,t)=>y.jsxs("div",{className:"event-tracking-list",children:[y.jsxs("div",{className:"event-actions mr15",children:[!0===e.eventTracking.markAsGoal&&y.jsx("span",{children:y.jsx(Ue,{text:"Mark event as trigger",children:y.jsx("i",{className:"icon-rs-goal-achieved-medium icons-md blue"})})}),y.jsx("span",{children:y.jsx(Ue,{text:"Mandatory",children:y.jsx("i",{className:!0===e.eventTracking.mandadory?"icon-rs-asterisk-mini red icons-sm mand-field cursor-pointer":"icon-rs-asterisk-mini icons-sm mand-field cursor-pointer",onClick:()=>{let e=[...this.state.elementArray];e[t].eventTracking.mandadory=!e[t].eventTracking.mandadory,this.setState({elementArray:e})}})})}),y.jsx("span",{children:y.jsx(Ue,{text:"Delete",children:y.jsx("i",{className:"icon-rs-delete-medium icons-md color-primary-blue cursor-pointer",onClick:()=>{let t=[...this.state.elementArray];const a=t.indexOf(e);a>-1&&t.splice(a,1);let s=[...this.state.controlsArray];s.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)}));let r=[...this.state.selectControls];r.map((t=>{t.viewId===e.field.viewId&&(t.select=!1,t.click=!1)})),this.setState({elementArray:t,selectControls:r,controlsArray:s})}})})})]}),y.jsxs("div",{className:"event-section",children:[y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Friendly name"}),y.jsx("span",{className:"label-value",children:e.eventTracking.friendlyName})]}),y.jsxs("div",{className:"event-row",children:[y.jsx("span",{className:"label-field",children:"Tracking action"}),y.jsx("span",{className:"label-value",children:e.eventTracking.trackingType.displayName})]})]})]}))))})]})})),x(this,"CaptureNameCell",(e=>{var t,a;let s=(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.captureType)||"";return y.jsx("td",{children:s})})),x(this,"TrackingActionCell",(e=>{var t,a,s;let r=(null==(s=null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.eventTracking)?void 0:a.trackingType)?void 0:s.displayName)||"";return y.jsx("td",{children:r})})),x(this,"editFieldTrackDatavalue",(e=>{var t,a,s,r,i,n,l,o,c,d,u,h,f;let m=JSON.parse(e.viewJson),p=null;if(m&&(p={deviceType:m[0].deviceType,mobileApp:m[0].mobileApp,error:{errDeviceType:null,errMobileApp:null},fieldList:m[0].fieldList}),"Customrange"==(null==(a=null==(t=m[0])?void 0:t.fieldList)?void 0:a.customEventPeriod)){let t={startDate:(null==(i=null==(r=null==(s=m[0])?void 0:s.fieldList)?void 0:r.dateRange)||i.startDate.includes("T"),L(null==e?void 0:e.startDate).add(0,"day").toDate()),endDate:(null==(o=null==(l=null==(n=m[0])?void 0:n.fieldList)?void 0:l.dateRange)||o.endDate.includes("T"),L(null==e?void 0:e.endDate).add(0,"day").toDate())};"Customrange"==(null==(d=null==(c=m[0])?void 0:c.fieldList)?void 0:d.customEventPeriod)&&this.setState({startDate:t.startDate,endDate:t.endDate,endDateMinValue:t.endDate,Lifetime:!1,Customrange:!0,showDateCondition:!0})}"Lifetime"==(null==(h=null==(u=m[0])?void 0:u.fieldList)?void 0:h.customEventPeriod)&&this.setState({Lifetime:!0,Customrange:!1,showDateCondition:!1});let v=null==(f=this.state.allAppNameList.find((e=>e.appName==m[0].mobileApp)))?void 0:f.appGuid;null!=this.state.formName&&""!=this.state.formName||this.setState({formName:m[0].fieldList.formName,formNameCopy:m[0].fieldList.formName}),this.setState({deviceList:[p],showFormFiels:!0,mobileAppDisable:!0,showForm:!0,saveBTNCondition:!0,kendoGridShow:!0,endDataDisable:!1,showSaveBTN:!0,getEventsData:m[0].fieldList.elementArray,getEventData_copy:m[0].fieldList.elementArray,fieldTrackData_copy:JSON.parse(JSON.stringify(m[0].fieldList)),fieldTrackData:m[0].fieldList,editFieldTrackIcon:!1,fullData:null==m?void 0:m.fullData,showKendoGrid:!1,appName:m[0].mobileApp,loaderCondition:!1,eventForm:!1,errFormName:null,appId:v,newFieldTrackIcon:!0,editScenario:!0})})),x(this,"editFieldTrackDatavalueId",(e=>{var t,a,s,r,i,n,l,o,c,d,u,h,f;let m=JSON.parse(e.viewJson),p=null;if(m&&(p={deviceType:m[0].deviceType,mobileApp:m[0].mobileApp,error:{errDeviceType:null,errMobileApp:null},fieldList:m[0].fieldList}),"Customrange"==(null==(a=null==(t=m[0])?void 0:t.fieldList)?void 0:a.customEventPeriod)){let t={startDate:(null==(i=null==(r=null==(s=m[0])?void 0:s.fieldList)?void 0:r.dateRange)||i.startDate.includes("T"),L(null==e?void 0:e.startDate).add(0,"day").toDate()),endDate:(null==(o=null==(l=null==(n=m[0])?void 0:n.fieldList)?void 0:l.dateRange)||o.endDate.includes("T"),L(null==e?void 0:e.endDate).add(0,"day").toDate())};"Customrange"==(null==(d=null==(c=m[0])?void 0:c.fieldList)?void 0:d.customEventPeriod)&&this.setState({startDate:t.startDate,endDate:t.endDate,endDateMinValue:t.endDate,Lifetime:!1,Customrange:!0,showDateCondition:!0})}"Lifetime"==(null==(h=null==(u=m[0])?void 0:u.fieldList)?void 0:h.customEventPeriod)&&this.setState({Lifetime:!0,Customrange:!1,showDateCondition:!1});let v=null==(f=this.state.allAppNameList.find((e=>e.appName==m[0].mobileApp)))?void 0:f.appGuid;null!=this.state.formName&&""!=this.state.formName||this.setState({formName:m[0].fieldList.formName,formNameCopy:m[0].fieldList.formName}),this.setState({deviceList:[p],showFormFiels:!0,mobileAppDisable:!0,showForm:!0,saveBTNCondition:!0,kendoGridShow:!0,endDataDisable:!1,showSaveBTN:!0,getEventsData:m[0].fieldList.elementArray,getEventData_copy:m[0].fieldList.elementArray,fieldTrackData_copy:JSON.parse(JSON.stringify(m[0].fieldList)),fieldTrackData:m[0].fieldList,editFieldTrackIcon:!1,fullData:null==m?void 0:m.fullData,showKendoGrid:!1,appName:m[0].mobileApp,loaderCondition:!1,eventForm:!1,errFormName:null,appId:v,newFieldTrackIcon:!0,editScenario:!0})})),x(this,"editFieldTrackDataget",(e=>{ce({path:Le,params:{id:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(1==e.status){let t=e.data;this.editFieldTrackDatavalue(t),Va.setcustomEventID(e.data.id)}},fail:e=>{}})})),x(this,"viewFieldTrackDataget",(e=>{ce({path:Le,params:{id:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(1==e.status){let t=e.data;this.editFieldTrackDatavalueId(t),Va.setcustomEventID(e.data.id),this.setState({viewClickOff:!0})}},fail:e=>{}})})),x(this,"deleteCustomEvent",(()=>{if(null!=this.state.deleteValueID){let e={id:this.state.deleteValueID};ce({path:Fe,params:e,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{1==e.status&&(this.setState({showFormNameComponent:!1}),this.getEventDetails())},fail:e=>{}})}})),x(this,"deleteCustomEventID",(e=>{this.setState({deleteValueID:e})})),x(this,"MyCustomCell",(e=>y.jsx(Or,{editFieldTrackData:e=>{this.editFieldTrackData(e)},...e,editId:e=>{this.editFieldTrackDataget(e),this.setState({editedID:e})},viewId:e=>{this.viewFieldTrackDataget(e)},deleteId:e=>{this.setState({showFormNameComponent:!0}),this.deleteCustomEventID(e)}}))),x(this,"ActionCell",(e=>y.jsx(Lr,{editFieldTrackData:e=>{this.editFieldTrackData(e)},...e,editId:e=>{this.editFieldTrackDataget(e)},deleteId:e=>{var t;let a=[...this.state.getEventsData],s=this.state.deviceList,r=a[e];if(null!=r){let e="Do you want to delete the form field?";1!=(null==(t=null==r?void 0:r.eventTracking)?void 0:t.markAsGoal)&&1!=(null==r?void 0:r.PageEngagementValue)||(e="Cannot delete event trigger and trigger action"),this.setState({markAsGoalElementDelete_Content:e,markAsGoalElementDelete:!0})}const i=e;i>-1&&a.splice(i,1);let n={...this.state.fieldTrackData};s[0].fieldList.elementArray=a,n.elementArray=a,this.setState({getEventsData_Deletecopy:a,deviceList_Deletecopy:s,fieldTrackData_Deletecopy:a,fieldData_Deletecopy:n,deletedItem_EventData:r})}}))),x(this,"getFormattedDate",(()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`})),x(this,"CustomDateCell",(e=>{let t="";return t=null===e.dataItem.startDate&&null===e.dataItem.endDate?"Life time":`${Ge(e.dataItem.startDate,!1)} to ${Ge(e.dataItem.endDate,!1)}`,y.jsx("td",{children:t})})),x(this,"AddFormEventsData",(e=>{var t;return y.jsx(Ta,{children:y.jsx(Oa,{config:{take:10,skip:0},data:this.state.getEventsData,settings:{total:null==(t=this.state.getEventsData)?void 0:t.length},isDataStateRequired:!1,pageable:!1,column:[{field:"Capture type",title:"Capture type",cell:this.CaptureNameCell},{field:"Attribute",title:"Attribute",cell:this.TrackingActionCell},{field:"Action",title:"Action",cell:this.ActionCell}]})})})),x(this,"saveFormData",(async()=>{var e,t;let a=!0,s="";if(s=this.state.Customrange?"Customrange":"Lifetime",null!=this.state.errFormName)return window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"}),!1;if(this.state.editScenario&&(null==(e=this.state.formName)?void 0:e.trimEnd())!==(null==(t=this.state.formNameCopy)?void 0:t.trimEnd())&&await this.saveDuplicateCheckCustomName(this.state.formName))return!1;if(!this.state.editScenario&&(null!=this.state.formName||""!=this.state.formName)&&await this.saveDuplicateCheckCustomName(this.state.formName))return!1;if(null!=this.state.formName&&""!=this.state.formName||(this.setState({errFormName:"Enter custom event name "}),a=!1),!this.state.Customrange||""!=this.state.startDate&&null!=this.state.startDate)if(!this.state.Customrange||""!=this.state.endDate&&null!=this.state.endDate){if(null!=this.state.formName||""!=this.state.formName){var r=[...this.state.deviceList];r[0].fieldList.formName=this.state.formName,r[0].fieldList.dateRange={startDate:this.state.startDate,endDate:this.state.endDate},r[0].fieldList.customEventPeriod=s}if(0==this.state.saveBTNCondition&&Va.setcustomEventID(null),a){let e={formName:this.state.formName,customEventPeriod:s,controls:this.state.fieldTrackData,deviceType:this.state.deviceList[0].deviceType,appId:this.state.appId,fullData:r,dateRange:{startDate:this.state.startDate,endDate:this.state.endDate}};Ha(e,this.context,"mobile",(e=>{if(e.message.includes("Save successful")||e.message.includes("Update successful")){this.setState({customEventValue:null}),this.getEventDetails();const e=[{deviceType:null,mobileApp:this.state.appName,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}];this.setState({editScenario:!1,deviceList:e,fieldTrackData:null,formName:"",startDate:null,endDate:null,showKendoGrid:!0,showForm:!1,showSaveBTN:!1,kendoGridShow:!1,showDateCondition:!1,getEventsData:[],eventForm:!0,editFieldTrackIcon:!0,eventNameStatus:!1,mobileAppDisable:!1})}else this.setState({errFormName:(null==e?void 0:e.message)??"An error occurred"})}))}else window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"})}else this.setState({errEndDate:"Choose end date"});else this.setState({errStartDate:"Choose start date"})})),x(this,"saveDuplicateCheckCustomName",(e=>{let t=0===e.length?Ve:null,a=null==e?void 0:e.trimEnd();this.setState({formName:a,errFormName:t});let s={eventName:a,channel:"MP"};return new Promise(((e,t)=>{ce({path:We,params:s,sessionOut:this.context.globalStateData.setSessionOutData,loading:this.context.globalStateData.setIsLoadingData,ok:t=>{!1===t.status?e(!1):(this.setState({errFormName:"Custom event name already exists"}),e(!0),window.scrollTo({top:document.body.scrollHeight/0,behavior:"smooth"}))},fail:e=>{t(e)}})}))})),x(this,"mobileAppChoose",(e=>{var t;let a=0===e.length?"Select mobile app":null;this.setState({errMobileApp:a});let s=null==(t=this.state.allAppNameList.find((t=>t.appName==e)))?void 0:t.appGuid;e&&s&&this.setState({appName:e,appId:s})})),x(this,"chooseMobileApp",((e,t,a,s,r)=>{var i;let n=[...this.state.deviceList];n[e][t]=a,n[e].error[s]=r,this.setState({deviceList:n});let l=null==(i=this.state.allAppNameList.find((e=>e.appName==a)))?void 0:i.appGuid;a&&l&&this.setState({appName:a,appId:l})})),x(this,"unableViewOff",(()=>{this.setState({getEventData:this.state.getEventDataCopy,viewClickOff:!1,showKendoGrid:!0,showForm:!1,fieldTrackData:[],formName:"",webUrl:"https://",startDate:null,endDate:null,saveBTNCondition:!1,showSaveBTN:!1,getEventsData:[],eventForm:!0,customEventValue:null,editScenario:!1,mobileAppDisable:!1})})),x(this,"addCustomEvent",(()=>{const e=[{deviceType:null,mobileApp:this.state.appName,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}];this.setState({deviceList:e}),this.setState({showForm:!0,showSaveBTN:!0,showKendoGrid:!1,loaderCondition:!1,showDomainURL:!0,eventForm:!1,editFieldTrackIcon:!0,appName:null,formName:"",showDateCondition:!1,errFormName:null,saveBTNCondition:!1,showLoaderKendo:!1,customEventValue:null})})),x(this,"propsDataPass",(()=>{this.props.editBtnClick({getEventsData:this.state.getEventsData,fieldTrack:this.state.fieldTrackData})})),x(this,"duplicateCheckCustomName",(e=>{let t=0===e.length?Bt:null;this.setState({formName:e,errFormName:t}),this.setState({formName:e,errFormName:t,eventNameLoading:!0,eventNameStatus:!1});let a={eventName:this.state.formName,channel:"MP"};ce({path:We,params:a,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{0==e.status?this.setState({eventNameLoading:!1,eventNameStatus:!0,fieldTrackIconCheck_CustomName:!1}):this.setState({eventNameLoading:!1,eventNameStatus:!1,errFormName:"Custom event name already exists",fieldTrackIconCheck_CustomName:!0})},fail:e=>{}})}))}componentDidMount(){var e,t;let a=Oe();if(null!==a&&null!==a.mobileAppsList&&this.setState({mobileAppList:a.mobileAppsList}),0===(null==(t=null==(e=null==this?void 0:this.props)?void 0:e.fullData)?void 0:t.length)){const e=[{deviceType:null,mobileApp:this.state.appName,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}];this.setState({deviceList:e}),this.getDataFromServer()}this.getEventDetails()}render(){var e,t,a,s,r,i,n;return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:this.state.viewClickOff?"click-off":"click-on",children:[this.state.showFormNameComponent&&y.jsx(_a,{size:"md",para:"Do you want to delete this item?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{!0===e?this.deleteCustomEvent():this.setState({showFormNameComponent:!1})}}),1==this.state.isFieldTrack&&null!==this.state.fieldTrackData?y.jsx("div",{className:"web-field-tracking-fullscreen-wrapper",children:y.jsxs(Da,{show:this.state.isFieldTrack,fullscreen:!0,className:"web-field-tracking-fullscreen-wrapper",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"Custom event"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{const e=new CustomEvent("socketClosed",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(e),Va.setSocketDisconnect(!0),this.setState({isFieldTrack:!1})}})]}),y.jsx(Da.Body,{children:y.jsx(jr,{isWebFieldTrack:!1,isForm:!0,isEdit:this.state.isEdit,socketDisconnect:this.state.socketDisconnect,fieldTrackData:null!=this.state.dataFieldTrack?this.state.dataFieldTrack:this.state.fieldTrackData,imageSetCondition:this.state.imageSetCondition,saveBtnClicked:e=>{let t=[...this.state.deviceList];t[0].fieldList=e,this.setState({deviceList:t,getEventsData:null==e?void 0:e.elementArray,showDateCondition:!0,fieldTrackData:e}),this.setState({isFieldTrack:!1,kendoGridShow:!0,showSaveBTN:!0,dataFieldTrack:null,editFieldTrackIcon:!1,newFieldTrackIcon:!0})},cancelBtnClicked:e=>{var t,a;((null==(t=e.elementArrayData)?void 0:t.length)>1||(null==(a=e.FieldTrackData)?void 0:a.length)>1)&&this.setState({getEventsData:e.elementArrayData,fieldTrackData:e.FieldTrackData}),this.setState({isFieldTrack:!1,dataFieldTrack:null}),this.state.editedID},editCheck:this.state.editCheck,controlsArray_Copy:this.state.controlsArray_Copy,controllsArrayChange:(e,t)=>{var a,s,r,i;((null==(a=e.elementArrayData)?void 0:a.length)>1||(null==(s=e.FieldTrackData)?void 0:s.length)>1)&&this.setState({getEventsData:e.elementArrayData,fieldTrackData:e.FieldTrackData}),this.setState({isFieldTrack:!1,dataFieldTrack:null}),this.state.editedID,null==(r=null==e?void 0:e.controlsArray_Copy)||r.filter((e=>!0===e.select)),(null==(i=null==e?void 0:e.controlsArray_Copy)?void 0:i.length)>0&&this.setState({editCheck:!0,controlsArray_Copy:null==e?void 0:e.controlsArray_Copy,dataFieldTrack:null})}})})]})}):null,y.jsxs("div",{className:"posr",children:[null==(e=this.state.deviceList)?void 0:e.map(((e,t)=>{var a,s,r,i;return y.jsxs("div",{className:"",children:[this.state.showForm?y.jsxs(y.Fragment,{children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom event name"})}),y.jsx(ka,{md:5,children:y.jsx(ie,{id:"sdx_addFrom",required:!0,placeholder:this.state.formName.length>0?"Custom event name":"Enter custom event name",errorMessage:this.state.errFormName,val:this.state.formName,max:50,isLoading:this.state.eventNameLoading,iconPlaceholder:!0,iconName:this.state.eventNameStatus?"icon-rs-circle-tick-medium icons-md green paddingL15":"",handleOnchange:e=>{if(e.length<=50){let t=e.trimStart();if(t.includes("'"))return;if(!0===/^[' 'A-Za-z0-9_-]*$/.test(t)){let e=t.replace(/\s+/g," ");if(e.length>50)return void this.setState({errFormName:"Custom event name exceeded the limit",eventNameStatus:!1});let a=0===e.length?"Enter custom event name":null;return void this.setState({formName:e,errFormName:a,fieldTrackIconCheck_CustomName:!0,eventNameLoading:!1,eventNameStatus:!1})}}},handleOnBlur:e=>{var t;let a=0===e.length?"Enter custom event name":null;this.setState({errFormName:a}),(null==e?void 0:e.trimEnd())!=(null==(t=this.state.formNameCopy)?void 0:t.trimEnd())?e.length>0&&this.duplicateCheckCustomName(e):this.setState({fieldTrackIconCheck_CustomName:!1})}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{style:{marginTop:"20px"},children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Device type"})}),y.jsx(ka,{md:5,children:y.jsx(te,{required:!0,label:null!=this.state.deviceList[t].deviceType?"Device":"",data:this.getPlatformTypes(),errorMessage:e.error.errDeviceType,value:null===this.state.deviceList[t].deviceType?"-- Select device --":this.state.deviceList[t].deviceType,onChange:e=>{let a=0===e.target.value.length?"Select device":null;this.valueChange(t,"deviceType",e.target.value,"errDeviceType",a)}})})]})}),""!==(null==(a=null==e?void 0:e.deviceType)?void 0:a.toLowerCase())&&"web"!==(null==(s=null==e?void 0:e.deviceType)?void 0:s.toLowerCase())&&y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Mobile app"})}),y.jsx(ka,{md:5,children:y.jsx(te,{required:!0,label:null!=this.state.appName?"Mobile app":"",className:this.state.mobileAppDisable||null!==this.state.getEventsData&&this.state.getEventsData.length?"click-off":"click-on",data:this.state.appNameList,errorMessage:e.error.errMobileApp,value:null===this.state.appName?"-- Select app name --":this.state.appName,onChange:e=>{let a=0===e.target.value.length?"Select mobile app":null;this.chooseMobileApp(t,"mobileApp",e.target.value,"errMobileApp",a)}})}),y.jsx(ka,{md:1,children:this.state.editFieldTrackIcon?y.jsx(Ka,{children:y.jsx(_e,{children:y.jsx(ke,{icon:Re,mainClass:null==this.state.appName||0==(null==(r=this.state.formName)?void 0:r.length)||1==this.state.fieldTrackIconCheck_CustomName?"click-off":"",iconColor:"blue",iconSize:"md",tooltip:"Configure custom event",color:"blue",onClick:()=>{let e=[...this.state.deviceList],a={appName:this.state.appName,appId:this.state.appId,deviceType:e[t].deviceType,mode:"add"};if(this.setState({fieldTrackData:a,socketDisconnect:!1}),null!==this.state.deviceList[0].deviceType&&null!==this.state.deviceList[0].mobileApp&&null!==this.state.appName)this.setState({isFieldTrack:!0,isEdit:!1}),this.state.isEdit,this.state.socketDisconnect,this.state.fieldTrackData,this.state.dataFieldTrack,this.state.imageSetCondition;else{let e=null===this.state.deviceList[0].deviceType?"Select device":null,t=null===this.state.formName?"Enter Form Name":null,a=null===this.state.appName?"Select mobile app":null,s=[...this.state.deviceList];s[0].error.errDeviceType=e,s[0].error.errMobileApp=a,this.setState({deviceList:s,errFormName:t,errMobileApp:a})}}})})}):y.jsx(Ka,{children:y.jsxs(_e,{children:[this.state.newFieldTrackIcon?y.jsxs(y.Fragment,{children:[y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",iconColor:"blue",iconSize:"md",tooltip:"Edit",color:"blue",onClick:()=>{let e=[...this.state.deviceList];if(e[t].mobileApp,this.state.appId,e[t].deviceType,this.setState({isFieldTrack:!0,isEdit:!0}),null!==this.state.deviceList[0].deviceType&&null!==this.state.deviceList[0].mobileApp&&null!==this.state.appName);else{let e=null===this.state.formName?"Enter Form Name":null,t=null===this.state.deviceList[0].deviceType?"Select device":null,a=null===this.state.deviceList[0].mobileApp?"Select mobile app":null,s=[...this.state.deviceList];s[0].error.errDeviceType=t,s[0].error.errMobileApp=a,this.setState({deviceList:s}),null!==e&&this.setState({errFormName:e})}}}),y.jsx(ke,{icon:Ye,iconColor:"blue",iconSize:"md",tooltip:"Reset",color:"blue",onClick:()=>{this.setState({newFieldTrackIcon:!1,editFieldTrackIcon:!1,getEventsData:[],showDateCondition:!1,Customrange:!1,Lifetime:!0,mobileAppDisable:!1})}})]}):null,this.state.newFieldTrackIcon?null:y.jsx(y.Fragment,{children:y.jsx(ke,{icon:Re,iconColor:"blue",iconSize:"md",tooltip:"Configure custom event",mainClass:0==(null==(i=this.state.formName)?void 0:i.length)||1==this.state.fieldTrackIconCheck_CustomName?"click-off":"click-on",color:"blue",onClick:()=>{let e=[...this.state.deviceList],a={appName:this.state.appName,appId:this.state.appId,deviceType:e[t].deviceType,mode:"add"};if(this.setState({dataFieldTrack:a,socketDisconnect:!1}),null!==this.state.deviceList[0].deviceType&&null!==this.state.deviceList[0].mobileApp&&null!==this.state.appName)this.setState({isFieldTrack:!0,isEdit:!1,imageSetCondition:!0});else{let e=null===this.state.deviceList[0].deviceType?"Select device":null,t=null===this.state.formName?"Enter Form Name":null,a=null===this.state.appName?"Select mobile app":null,s=[...this.state.deviceList];s[0].error.errDeviceType=e,s[0].error.errMobileApp=a,this.setState({deviceList:s,errFormName:t,errMobileApp:a})}}})})]})})})]})}),y.jsx(ga,{children:null!==this.state.getEventsData&&this.state.getEventsData.length>0?y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom event period"})}),y.jsx(ka,{md:7,children:y.jsxs(Ta,{children:[y.jsxs(ka,{md:3,className:"d-flex",children:[y.jsx(ae,{lbl:"Life time",name:"matchtype",labelId:"all",checked:this.state.Lifetime,cb:e=>{this.setState({Lifetime:!0,Customrange:!1,startDate:null,endDate:null,showDateCondition:!1})}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a lifetime duration",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})]}),y.jsxs(ka,{md:2,className:"d-flex align-items-center",children:[y.jsx(ae,{lbl:"Custom range",name:"matchtype",labelId:"any",checked:this.state.Customrange,cb:e=>{this.setState({Lifetime:!1,Customrange:!0})}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a specific date range",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})]})]})})]}):null}),null!==this.state.getEventsData&&this.state.getEventsData.length>0&&this.state.Customrange?y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom range period"})}),y.jsx(ka,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:5,children:y.jsx($a,{required:!0,placeholder:"Start date",errorMessage:this.state.errStartDate,value:null!==this.state.startDate?this.state.startDate:null,min:_r,handleChange:e=>{var t=e.target.value,a=t.setDate(t.getDate()+3);let s=new Date(a),r=new Date(e.target.value);r.setHours(12,0,0,0),this.setState({endDateMinValue:s,startDate:r,endDataDisable:!1,endDate:null});let i=null!==e.target.value?null:ConstStr.START_DATE;this.setState({errStartDate:i})}})}),y.jsx(ka,{md:5,className:null!=this.state.startDate?"click-on":"click-off",children:y.jsx($a,{required:!0,placeholder:"End date",errorMessage:this.state.errEndDate,disabled:!!this.state.endDataDisable,value:null!==this.state.endDate?this.state.endDate:null,min:this.state.endDateMinValue,handleChange:e=>{this.setState({endDate:e.target.value});let t=null!==e.target.value?null:ConstStr.START_DATE;this.setState({errEndDate:t})}})})]})})]})}):null]}):null,null!==this.state.getEventsData&&this.state.getEventsData.length>0?y.jsxs(Ta,{children:["  ",this.state.markAsGoalElementDelete&&y.jsx(_a,{size:"md",para:this.state.markAsGoalElementDelete_Content,pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{var t;if(!0===e){if("Do you want to delete the form field?"==this.state.markAsGoalElementDelete_Content){let e={...this.state.fieldTrackData};(null==e?void 0:e.elementArray)&&this.state.fieldData_Deletecopy&&(e.elementArray=[...this.state.fieldTrackData_Deletecopy],e.controlsArray.map((e=>{var t,a;e.viewId===(null==(a=null==(t=this.state.deletedItem_EventData)?void 0:t.field)?void 0:a.viewId)&&(e.select=!1,e.click=!1)}))),null==(t=null==e?void 0:e.controlArray)||t.filter((e=>!0===e.select)),this.setState({fieldTrackData:e,getEventsData:this.state.fieldData_Deletecopy}),this.setState({getEventsData:this.state.getEventsData_Deletecopy,deviceList:this.state.deviceList_Deletecopy,fieldData:this.state.fieldData_Deletecopy})}this.setState({markAsGoalElementDelete:!1})}else this.setState({markAsGoalElementDelete:!1})}}),null!=this.state.markAsGoalElementDelete&&y.jsx("div",{className:"",children:this.state.markAsGoalElementDelete}),y.jsx(ka,{md:12,children:y.jsx(this.AddFormEventsData,{index:0,head:!1})})]}):null]})})),(null==(t=this.state.deviceList)?void 0:t.length)<5?y.jsx("div",{className:"pos-icon-2 d-none",children:y.jsx(Ue,{text:"Add",position:"top",children:y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer icon-shadow "+(5===this.state.deviceList?"click-off":""),onClick:()=>{this.addBtnClick()}})})}):null]}),this.state.showSaveBTN||null!==this.state.fieldTrackData&&this.state.fieldTrackData.length?y.jsxs("div",{className:"btn-container d-flex justify-content-end marginT30 "+(this.state.viewClickOff?"d-none":"click-on"),children:[y.jsx(he,{onClick:()=>{var e;let t=!1;(null==(e=this.state.getEventData)?void 0:e.length)>0&&(t=!0),this.setState({showForm:!1,showSaveBTN:!1,showKendoGrid:t,loaderCondition:!0,getEventsData:[],eventForm:!0,editFieldTrackIcon:!0,Lifetime:!1,Customrange:!1,eventNameStatus:!1,customEventValue:null,getEventData:this.state.getEventDataCopy,AddBtnShow:!0,mobileAppDisable:!1,editScenario:!1})},children:"Cancel"}),y.jsx(fe,{className:(null==(a=this.state.getEventsData)?void 0:a.length)>0?"":"click-off",onClick:()=>{this.saveFormData()},children:this.state.saveBTNCondition?"Update":"Save"})]}):null,this.state.eventForm&&y.jsx("div",{children:y.jsxs(Ta,{className:"d-flex align-items-center marginT-10 marginB20",children:[y.jsx(ka,{md:2,className:"marginL5",children:y.jsx("h3",{children:"Custom events "})}),y.jsx(ka,{md:(null==(s=this.state.getEventData)||s.length,9),className:"justify-content-end marginL81",children:this.state.AddBtnShow&&y.jsx(xa,{className:"justify-content-end",children:y.jsx(_e,{alignRight:!0,children:y.jsx(ke,{shadow:!0,tooltip:"Add custom event",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",iconClass:!0===me()?"click-off":"",onClick:()=>{this.setState({showKendoGrid:!1,AddBtnShow:!1}),this.addCustomEvent()}})})})})]})}),this.state.showKendoGrid&&(null==(r=this.state.getEventData)?void 0:r.length)>0?y.jsx("div",{children:y.jsx(Oa,{config:{take:5,skip:0},data:this.state.getEventData,settings:{total:null==(i=this.state.getEventData)?void 0:i.length},pageable:(null==(n=this.state.getEventData)?void 0:n.length)>5,isDataStateRequired:!1,column:[{title:"Event name",field:"customEventName",filter:"text",cell:e=>{var t;return y.jsx("td",{children:y.jsx("span",{children:null==(t=e.dataItem)?void 0:t.customEventName})})}},{title:"Domain name",field:"appName"},{title:"Created by",field:"userFirstName"},{title:"Event range",field:"startDate",cell:this.CustomDateCell},{title:"Actions",field:"Actions",width:"180",cell:this.MyCustomCell}]})}):this.state.loaderCondition?y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsxs("div",{className:"nodata-bar add-func",children:[y.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),y.jsx("p",{children:"No data available"})]})})}):this.state.showLoaderKendo?y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsx("div",{})})}):null]}),this.state.viewClickOff?y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{this.unableViewOff()},children:"Back"})}):null]})}}x(Fr,"contextType",le);const Mr=S(Fr);var Rr;class Pr extends w.Component{constructor(){super(...arguments),x(this,"state",{formName:"",platformName:this.props.mobile,webUrl:"",formpageUrl:"",lSocket:null,isSocketConnect:!1,errorMessage:"",fieldTrackClose:null,fieldTrackWait:null,fieldTrackSuccess:null,fullData:null,isEdit:!1,mobEventsData:[],isMobileFieldTrack:!1,mobFieldTrackData:[],clientMSG:!0}),x(this,"componentDidUpdate",(e=>{})),x(this,"editFormGenerator",(e=>{ce({path:Ke,params:{recipientFormID:e},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(null==e?void 0:e.status){let t=null==e?void 0:e.data,a=JSON.parse(t.jsondata),s=null==a?void 0:a.deviceType;return"web"!==s.toLowerCase()&&(s="Mobile"),void this.setState({webUrl:null==a?void 0:a.domainName,fullData:null==a?void 0:a.fullData,platformName:s,formName:null==a?void 0:a.formName})}},fail:e=>{}})})),x(this,"socketClosed",(()=>{Rr.on("closed",(e=>{try{e.status}catch(t){}}))})),x(this,"socketInit",(e=>{const t=io("https://mobsoc.resu.io/");this.setState({lSocket:t},(()=>{this.state.lSocket.on("connect",(()=>{Rr.emit("new_user",{userName:"platform",domainName:e,appId:14441}),this.socketClosed()}))}))})),x(this,"formNameCheck",(e=>{ce({path:$e,params:{formName:e},ok:e=>{e.status&&this.setState({errorMessage:null==e?void 0:e.message})},fail:e=>{}})})),x(this,"getContentData",(()=>{var e;const t=O.parse(null==(e=window.location)?void 0:e.search);if("true"===(void 0!==t.isEdit&&t.isEdit))return!1;let a="";return this.state.fieldTrackWait?a="Waiting for event set":this.state.fieldTrackData?a="Client closed unexpected":this.state.fieldTrackSuccess&&(a="Field tracking enabled successfully"),a})),x(this,"storeEventsData_LocatStorage",(()=>{localStorage.setItem("eventsData",this.state.mobEventsData)}))}componentDidMount(){var e,t;const a=O.parse(null==(t=null==(e=this.props.history)?void 0:e.location)?void 0:t.search);let s=void 0!==a.webft&&a.webft,r=void 0!==a.isEdit&&a.isEdit,i=void 0!==a.cId?a.cId:0;"true"===s&&this.setState({isWebFieldTrack:!0,platformName:"Web"}),"true"===r&&this.editFormGenerator(parseInt(i))}render(){var e;return y.jsxs(y.Fragment,{children:[this.state.isMobileFieldTrack&&y.jsx(y.Fragment,{children:y.jsxs(Da,{fullscreen:!0,show:this.state.isMobileFieldTrack,children:[y.jsxs(Da.Header,{children:[y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isMobileFieldTrack:!1,isEdit:!1})}}),y.jsx(Ta,{md:12,style:{width:"80%"},children:y.jsx(ka,{md:2,children:y.jsx("h2",{children:"Brand own form"})})})]}),y.jsx(Da.Body,{children:y.jsx(jr,{isForm:!0,isEdit:this.state.isEdit,isWebFieldTrack:!1,fieldTrackData:this.state.mobFieldTrackData,domainName:e=>{this.socketInit(e)},cancelBtnClicked:()=>{this.setState({isMobileFieldTrack:!1,isEdit:!1,clientMSG:!1})},saveBtnClicked:e=>{this.setState({fieldTrackData:e,isMobileFieldTrack:!1,mobFieldTrackData:e,isEdit:!1,clientMSG:!1})}})})]})}),this.getContentData().length>1&&this.state.clientMSG&&y.jsx(ns,{content:this.getContentData(),isShowBtn:!0,proceedBtnClick:()=>{this.setState({fieldTrackWait:!1,fieldTrackSucess:!1,fieldTrackClose:!1})}}),y.jsx("div",{className:"mt20 mb30",children:"mobile"===this.state.platformName.toLowerCase()&&y.jsx(y.Fragment,{children:y.jsx(Ta,{children:y.jsx(ka,{md:{offset:0,span:12},children:y.jsx(Mr,{mobileData:this.props.mobileData,formName:this.state.formName,fullData:(null==(e=this.state)?void 0:e.fullData)||[],mobEventsData:this.state.mobEventsData,onChange:e=>{},editBtnClick:e=>{this.setState({mobEventsData:e.getEventsData,mobFieldTrackData:e.fieldTrack,isMobileFieldTrack:!0,isEdit:!0}),this.storeEventsData_LocatStorage()},socketChange:(e,t,a)=>{this.setState({fieldTrackWait:e,fieldTrackSucess:t,fieldTrackClose:a})},socketBtnClicked:e=>{e&&this.setState({mobFieldTrackData:e.fData,isEdit:e.isEdit,isMobileFieldTrack:e.isMobileFieldTrack}),this.setState({isMobileFieldTrack:!0})}})})})})})]})}}x(Pr,"contextType",le);const Ur=S(Pr),Br=e=>{const t=w.useContext(le),[a,s]=w.useState(""),[r,i]=w.useState(""),[n,l]=w.useState([]),[o,c]=w.useState(""),[d,u]=w.useState(""),[h,f]=w.useState(""),[m,p]=w.useState(""),[v,g]=w.useState(!1),[b,x]=w.useState(!1),[S,T]=w.useState([{id:1,goalName:"",goalType:"",eventsList:"",screens:"",subScreen:""}]),[k,D]=w.useState({}),[C,E]=w.useState(null),[N,A]=w.useState(0),[I,j]=w.useState(""),[_,O]=w.useState(null),[L,F]=w.useState(0),[M,R]=w.useState([]),[P,U]=w.useState([]),[B,G]=w.useState(""),[V,W]=w.useState([]),[H,z]=w.useState(""),[Y,K]=w.useState(!1);w.useEffect((()=>{var e;let t=Oe(),a=null==(e=null==t?void 0:t.mobileAppsList)?void 0:e.map((e=>null==e?void 0:e.appName)),s=null==t?void 0:t.mobileAppsList;return O(s),l(a),()=>{$()}}),[]);const $=()=>{s(""),i(""),l([]),c(""),u(""),f(""),p(""),g(!1),x(!1),T([{id:1,goalName:"",goalType:"",eventsList:"",screens:"",subScreen:""}]),D({}),E(null),A(0),j(""),F(0),R([]),U([]),G(""),W([]),K(!1)};w.useEffect((()=>{(()=>{let e=null;(null==C?void 0:C.pushGoalJSON)&&(e=JSON.parse(null==C?void 0:C.pushGoalJSON),A(null==C?void 0:C.pushNotifyGoalSettingID)),C&&(f(C.pushNotifyGoalName),s((null==C?void 0:C.deviceType)||""),T(null==e?void 0:e.Tracking_Type.map((e=>({goalName:null==e?void 0:e.goalName,goalType:null==e?void 0:e.goalType,eventsList:null==e?void 0:e.eventsList,screens:null==e?void 0:e.screens,subScreen:null==e?void 0:e.subScreen})))))})()}),[C]),w.useEffect((()=>{var e;if(H.length){let t=H,a=_.filter((e=>e.appName===t));G(null==(e=a[0])?void 0:e.appGuid),c(t)}}));const q=w.useCallback((()=>x(localStorage.getItem("GridView"))),[]);w.useEffect((()=>{q()}),[]);const J=e=>{let t=!0,a={};return""===(null==e?void 0:e.goalName)?(t=!1,a.goalName="Goal Name is required",{isValid:t,rowErrors:a}):""===(null==e?void 0:e.goalType)?(t=!1,a.goalType="Goal Type is required",{isValid:t,rowErrors:a}):"Custom events"===(null==e?void 0:e.goalType)&&""===e.eventsList?(t=!1,a.eventsList="Select event",{isValid:t,rowErrors:a}):"Screen"===(null==e?void 0:e.goalType)&&""===e.screens?(t=!1,a.screens="Select screen",{isValid:t,rowErrors:a}):P.length&&"Screen"===(null==e?void 0:e.goalType)&&""===e.subScreen?(t=!1,a.subScreen="Select sub screen",{isValid:t,rowErrors:a}):{isValid:t,rowErrors:a}},X=(e,t,a)=>{const s=null==S?void 0:S.map((s=>s.id===e?{...s,[t]:a}:s));T(s);let r={...k};""===a?r[e]={...r[e],[t]:`${t} is required`}:r[e]&&(delete r[e][t],0===Object.keys(r[e]).length&&delete r[e]),D(r)};return y.jsxs(y.Fragment,{children:[b&&y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{children:"Goal settings"}),y.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[y.jsx(ke,{shadow:!0,tooltip:"Add Goal",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",onClick:()=>{g(!0),x(!1)}}),y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",id:"dl_back_button",onClick:()=>{null==e||e.onIndexChangeValue(0),$()},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})]})]}),b?y.jsx(y.Fragment,{children:y.jsx(Gr,{onGoalNameClick:e=>{K(!0),E(e),j("Edit"),x(!1),g(!0)},appOnboardId:L||(null==e?void 0:e.onBoardId),onEditModeAppName:e=>{z(e)}})}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{children:"Goal settings"}),y.jsx("div",{style:{display:"flex",alignItems:"center"},children:y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",id:"dl_back_button",onClick:()=>{$(),(null==e?void 0:e.onBoardId)>0?x(!0):null==e||e.onIndexChangeValue(0)},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})})]}),y.jsxs("div",{className:"p30",children:[y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Goal name"})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"goalname",placeholder:"Goal name",required:!0,val:h,handleOnchange:e=>{f(e),p("")},handleOnBlur:e=>{f(e);let t=e.length?"":"Enter goal name";p(t)},errorMessage:m})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"App name"})}),y.jsx(ka,{md:6,children:y.jsx(te,{disabled:!0,required:!0,label:"App name",data:n,value:o,onChange:e=>{(e=>{var t,a;let s=null==e?void 0:e.value,r=_.filter((e=>e.appName===s));F(null==(t=r[0])?void 0:t.mpId),G(null==(a=r[0])?void 0:a.appGuid)})(e),c(null==e?void 0:e.value);let t=(null==e?void 0:e.value.length)?"":"Select app name";u(t)},errorMessage:d})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Mobile platform"})}),y.jsx(ka,{md:6,children:y.jsx(te,{required:!0,label:"Mobile platform",data:["Android phone","Android tab","iphone","ipad"],value:a,disabled:Y,onChange:e=>{s(e.value);let t=(null==e?void 0:e.value.length)?"":"Select mobile platform";i(t)},errorMessage:r})})]})}),y.jsxs(ga,{children:[y.jsx(Ta,{children:y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Goal tracking type"})})}),y.jsxs(Ta,{children:[y.jsx(ka,{md:11,children:null==S?void 0:S.map(((e,s)=>{var r,i,n,l,o;return y.jsxs("div",{className:"pt30",children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ie,{name:"friendlyName",placeholder:"Friendly name",required:!0,val:e.goalName,handleOnchange:t=>X(e.id,"goalName",t),handleOnBlur:t=>X(e.id,"goalName",t),errorMessage:null==(r=k[e.id])?void 0:r.goalName})}),y.jsx(ka,{md:3,children:y.jsx(te,{required:!0,label:"Goal type",data:["Screen","Custom events"],value:e.goalType,onChange:s=>{"Screen"===(null==s?void 0:s.value)?ce({path:Wt,params:{appId:B,deviceType:a,isdeepLink:!0,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"},ok:e=>{var t,a;if((null==e?void 0:e.status)&&(null==(t=null==e?void 0:e.data)?void 0:t.appScreensList)){let t=null==(a=e.data.appScreensList)?void 0:a.map((e=>null==e?void 0:e.displayName));R(t)}},fail:e=>{}}):ce({path:zt,isServiceWorker:!1,params:{appId:B,listType:"CustomEvents"},sessionOut:t.globalStateData.setSessionOutData,ok:e=>{var t;(null==e?void 0:e.status)&&W(null==(t=null==e?void 0:e.data)?void 0:t.appdataList)},fail:e=>{}}),X(e.id,"goalType",null==s?void 0:s.value)},errorMessage:null==(i=k[e.id])?void 0:i.goalType})}),"Custom events"===e.goalType?y.jsx(ka,{md:5,children:y.jsx(te,{required:!0,label:"Select events",data:V,value:e.eventsList,onChange:t=>X(e.id,"eventsList",null==t?void 0:t.value),errorMessage:null==(n=k[e.id])?void 0:n.eventsList})}):y.jsxs(y.Fragment,{children:[y.jsx(ka,{md:P.length?3:5,children:y.jsx(te,{required:!0,label:"Activity",data:M,value:e.screens,onChange:t=>{var s;s=null==t?void 0:t.value,ce({path:Ht,params:{appId:B,deviceType:a,screenName:s,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"},ok:e=>{(null==e?void 0:e.status)&&void 0!==(null==e?void 0:e.data)&&U(e.data.appSubScreensList)},fail:e=>{}}),X(e.id,"screens",null==t?void 0:t.value)},errorMessage:null==(l=k[e.id])?void 0:l.screens})}),P.length?y.jsx(ka,{md:2,children:y.jsx(te,{required:!0,label:"Sub screen",data:P,value:e.subScreen,onChange:t=>X(e.id,"subScreen",null==t?void 0:t.value),errorMessage:null==(o=k[e.id])?void 0:o.subScreen})}):null]})]}),y.jsx("div",{className:"moto-log",children:e.id>1&&y.jsx(ke,{shadow:!0,tooltip:"Remove",icon:"icon-rs-circle-minus-fill-edge-medium icons-md red",size:"md",onClick:()=>{(e=>{T(null==S?void 0:S.filter((t=>t.id!==e)));const t={...k};delete t[e],D(t)})(e.id)}})})]},e.id)}))}),y.jsx(ka,{md:1,children:y.jsx(ke,{mainClass:"gtc-plus-icon",shadow:!0,tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",onClick:()=>{(()=>{let e=!0;const t={};let a=!1;null==S||S.forEach((s=>{if(a)return;const{isValid:r,rowErrors:i}=J(s);return r?void 0:(t[s.id]=i,e=!1,void(a=!0))})),D(t),e&&S.length<10&&T([...S,{id:S.length+1,goalName:"",goalType:"",subScreen:"",eventsList:"",screens:""}])})()}})})]})]})]}),y.jsxs("div",{className:"d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{$(),(null==e?void 0:e.onBoardId)>0?x(!0):null==e||e.onIndexChangeValue(0)},children:"Cancel"}),y.jsx(fe,{onClick:()=>{(()=>{let s=!0;const r={};if(!v&&""===o)return u("Select app name"),void(s=!1);if(u(""),""===h)return p("Enter goal name"),void(s=!1);if(p(""),""===a)return i("Select mobile platform"),void(s=!1);i("");let n=!1;if(null==S||S.forEach((e=>{if(n)return;const{isValid:t,rowErrors:a}=J(e);return t?void 0:(r[e.id]=a,s=!1,void(n=!0))})),D(r),s){let s={Tracking_Type:S};(s=>{let r={PushNotifyGoalName:h,DeviceType:a,PushGoalJSON:s,PushNotifyAppStoreID:L||(null==e?void 0:e.onBoardId),PushNotifyGoalSettingID:"Edit"===I?N:0,StatusID:"1"};ce({path:Vt,params:r,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{(null==e?void 0:e.status)&&(x(!0),$())},fail:e=>{}})})(JSON.stringify(s))}})()},children:"Save"})]})]})]})},Gr=e=>{const[t,a]=w.useState(!1),[s,r]=w.useState(null),[i,n]=w.useState("");w.useEffect((()=>{localStorage.removeItem("GridView"),l()}),[]),w.useEffect((()=>{null==e||e.onEditModeAppName(i)}),[i]);const l=()=>{let t={PushNotifyAppStoreID:null==e?void 0:e.appOnboardId};ce({path:Gt,params:t,ok:e=>{var t;(null==e?void 0:e.status)&&(null==e?void 0:e.data.length)?(r(null==e?void 0:e.data),n(null==(t=null==e?void 0:e.data[0])?void 0:t.appName)):a(!0)},fail:e=>{a(!0)}})};return y.jsx(y.Fragment,{children:(null==s?void 0:s.length)?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:{take:5,skip:0},data:s,pageable:(null==s?void 0:s.length)>5,settings:{total:null==s?void 0:s.length},isDataStateRequired:!1,column:[{field:"appName",title:"App name",cell:e=>y.jsxs("td",{children:[" ",e.dataItem.appName," "]})},{field:"pushNotifyGoalName",title:"Goal name",cell:t=>y.jsx("td",{children:y.jsx("div",{style:{display:"table-cell"},className:"text-underline-h cp",onClick:a=>{return s=t.dataItem,void(null==e||e.onGoalNameClick(s));var s},children:t.dataItem.pushNotifyGoalName})})},{field:"action",title:"Status",width:"200",cell:e=>y.jsx(Vr,{...e,changeStatusID:e=>{(e=>{ce({path:Vt,params:e,ok:e=>{null==e||e.status},fail:e=>{}})})(e)}})}]})}):y.jsx("div",{children:y.jsx("div",{className:"p0 mt15",children:y.jsx(Ia,{count:5,isError:t})})})})},Vr=e=>{var t,a;const[s,r]=w.useState("1"===(null==(t=null==e?void 0:e.dataItem)?void 0:t.statusID));return w.useEffect((()=>{var t;r(1===(null==(t=null==e?void 0:e.dataItem)?void 0:t.statusID))}),[null==(a=null==e?void 0:e.dataItem)?void 0:a.statusID]),y.jsx("td",{children:y.jsx("div",{className:"text-end ",children:y.jsx(R,{className:"mt0",checked:s,onChange:t=>{r(t.value);let a={...null==e?void 0:e.dataItem};a.statusID=t.value?1:0,e.changeStatusID(a)}})})})},Wr={title:"Geofencing Information",sections:[{heading:"What is a Region?",content:"A region is a geofenced area with a center and radius, used to track entry or exit, and must be at least 100 meters from other regions."},{heading:"What is a Cluster?",content:"A cluster is a group of regions treated as one, triggering actions when any are crossed."},{heading:"SmartDX Limitations",content:"The platform supports up to 50 clusters and 50 regions per cluster."},{heading:"Platform Limitations",subSections:[{platform:"iOS",details:{minRadius:"100 meters",maxRadius:"Around 1000 meters (recommended for accuracy)",note:"Supports up to 20 monitored regions per app. Background execution required.",failureCases:["If the app is killed and not configured for background location, notification may not be delivered.","Limited to 50 regions per app. Exceeding this can drop older regions without notification.","Accuracy may reduce indoors or in areas with poor GPS/Wi-Fi signal.","Geofence triggers may be delayed if the system prioritizes battery saving or location updates are infrequent."]}},{platform:"Android",details:{minRadius:"Typically 100 meters (depends on location accuracy)",maxRadius:"No strict limit, but larger radii reduce event precision",note:"Can support hundreds of regions, but requires location permissions and battery optimization.",failureCases:["Doze Mode or background restrictions may prevent timely geofence triggers.","App must request background location permission from Android 10+. Without it, geofencing wont work properly.","Battery saver or aggressive OEM customizations (e.g., Xiaomi, Oppo) may kill geofence services.","Device restarts or network changes can cause inconsistencies in region monitoring."]}}]}]},Hr=()=>y.jsx("div",{className:"portlet-container",children:Wr.sections.map(((e,t)=>y.jsxs("div",{className:"info-section",children:[y.jsx("h2",{className:"section-heading",children:e.heading}),e.content&&y.jsx("p",{className:"section-content",children:e.content}),e.listItems&&y.jsx("ul",{className:"section-list",children:e.listItems.map(((e,t)=>y.jsx("li",{children:e},t)))}),e.subSections&&y.jsx("div",{className:"platform-block",children:e.subSections.map(((e,t)=>y.jsxs("div",{className:"platform-card",children:[y.jsx("h3",{children:e.platform}),y.jsxs("ul",{children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Min Radius:"})," ",e.details.minRadius]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Max Radius:"})," ",e.details.maxRadius]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Note:"})," ",e.details.note]})]}),e.details.failureCases&&y.jsxs("div",{className:"failures",children:[y.jsx("p",{className:"failures-heading",children:"Failure Cases:"}),y.jsx("ul",{className:"failure-list",children:e.details.failureCases.map(((e,t)=>y.jsxs("li",{children:[" ",e]},t)))})]})]},t)))})]},t)))});var zr={exports:{}}.exports=function e(){var t,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==a?a:{},s=!a.document&&!!a.postMessage,r=a.IS_PAPA_WORKER||!1,i={},n=0,l={};function o(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=x(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var s=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<s){let t=this._config.newline;t||(i=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,i)),e=[...e.split(t).slice(s)].join(t)}this.isFirstChunk&&S(this._config.beforeFirstChunk)&&void 0!==(i=this._config.beforeFirstChunk(e))&&(e=i),this.isFirstChunk=!1,this._halted=!1,s=this._partialLine+e;var i=(this._partialLine="",this._handle.parse(s,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=i.meta.cursor,this._finished||(this._partialLine=s.substring(e-this._baseIndex),this._baseIndex=e),i&&i.data&&(this._rowCount+=i.data.length),s=this._finished||this._config.preview&&this._rowCount>=this._config.preview,r)a.postMessage({results:i,workerId:l.WORKER_ID,finished:s});else if(S(this._config.chunk)&&!t){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!S(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(e){S(this._config.error)?this._config.error(e):r&&this._config.error&&a.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function c(e){var t;(e=e||{}).chunkSize||(e.chunkSize=l.RemoteChunkSize),o.call(this,e),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),s||(t.onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var e,a=this._config.downloadRequestHeaders;for(e in a)t.setRequestHeader(e,a[e])}var r;this._config.chunkSize&&(r=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+r));try{t.send(this._config.downloadRequestBody)}catch(i){this._chunkError(i.message)}s&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){var e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null!==(e=(e=t).getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function d(e){(e=e||{}).chunkSize||(e.chunkSize=l.LocalChunkSize),o.call(this,e);var t,a,s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,a=e.slice||e.webkitSlice||e.mozSlice,s?((t=new FileReader).onload=y(this._chunkLoaded,this),t.onerror=y(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,r=(this._config.chunkSize&&(r=Math.min(this._start+this._config.chunkSize,this._input.size),e=a.call(e,this._start,r)),t.readAsText(e,this._config.encoding));s||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function u(e){var t;o.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,a;if(!this._finished)return e=this._config.chunkSize,t=e?(a=t.substring(0,e),t.substring(e)):(a=t,""),this._finished=!t,this.parseChunk(a)}}function h(e){o.call(this,e=e||{});var t=[],a=!0,s=!1;this.pause=function(){o.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){o.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){s&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):a=!0},this._streamData=y((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),a&&(a=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(s){this._streamError(s)}}),this),this._streamError=y((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=y((function(){this._streamCleanUp(),s=!0,this._streamData("")}),this),this._streamCleanUp=y((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function f(e){var t,a,s,r,i=Math.pow(2,53),n=-i,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,c=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,u=0,h=0,f=!1,v=!1,g=[],b={data:[],errors:[],meta:{}};function y(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function w(){if(b&&s&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),s=!1),e.skipEmptyLines&&(b.data=b.data.filter((function(e){return!y(e)}))),T()){let a=function(t,a){S(e.transformHeader)&&(t=e.transformHeader(t,a)),g.push(t)};if(b)if(Array.isArray(b.data[0])){for(var t=0;T()&&t<b.data.length;t++)b.data[t].forEach(a);b.data.splice(0,1)}else b.data.forEach(a)}function a(t,a){for(var s=e.header?{}:[],r=0;r<t.length;r++){var l=r,d=t[r];u=l=e.header?r>=g.length?"__parsed_extra":g[r]:l,f=d=e.transform?e.transform(d,l):d,void 0,m=u,e.dynamicTypingFunction&&void 0===e.dynamicTyping[m]&&(e.dynamicTyping[m]=e.dynamicTypingFunction(m)),d=!0===(e.dynamicTyping[m]||e.dynamicTyping)?"true"===f||"TRUE"===f||"false"!==f&&"FALSE"!==f&&((e=>{if(o.test(e)&&(e=parseFloat(e),n<e&&e<i))return 1})(f)?parseFloat(f):c.test(f)?new Date(f):""===f?null:f):f,"__parsed_extra"===l?(s[l]=s[l]||[],s[l].push(d)):s[l]=d}var u,f,m;return e.header&&(r>g.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+g.length+" fields but parsed "+r,h+a):r<g.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+g.length+" fields but parsed "+r,h+a)),s}var r;b&&(e.header||e.dynamicTyping||e.transform)&&(r=1,!b.data.length||Array.isArray(b.data[0])?(b.data=b.data.map(a),r=b.data.length):b.data=a(b.data,0),e.header&&b.meta&&(b.meta.fields=g),h+=r)}function T(){return e.header&&0===g.length}function k(e,t,a,s){e={type:e,code:t,message:a},void 0!==s&&(e.row=s),b.errors.push(e)}S(e.step)&&(r=e.step,e.step=function(t){b=t,T()?w():(w(),0!==b.data.length&&(u+=t.data.length,e.preview&&u>e.preview?a.abort():(b.data=b.data[0],r(b,d))))}),this.parse=function(r,i,n){var o=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(r,o)),s=!1,e.delimiter?S(e.delimiter)&&(e.delimiter=e.delimiter(r),b.meta.delimiter=e.delimiter):((o=((t,a,s,r,i)=>{var n,o,c,d;i=i||[",","\t","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var u=0;u<i.length;u++){for(var h,f=i[u],m=0,v=0,g=0,b=(c=void 0,new p({comments:r,delimiter:f,newline:a,preview:10}).parse(t)),x=0;x<b.data.length;x++)s&&y(b.data[x])?g++:(v+=h=b.data[x].length,void 0===c?c=h:0<h&&(m+=Math.abs(h-c),c=h));0<b.data.length&&(v/=b.data.length-g),(void 0===o||m<=o)&&(void 0===d||d<v)&&1.99<v&&(o=m,n=f,d=v)}return{successful:!!(e.delimiter=n),bestDelimiter:n}})(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=o.bestDelimiter:(s=!0,e.delimiter=l.DefaultDelimiter),b.meta.delimiter=e.delimiter),o=x(e),e.preview&&e.header&&o.preview++,t=r,a=new p(o),b=a.parse(t,i,n),w(),f?{meta:{paused:!0}}:b||{meta:{paused:!1}}},this.paused=function(){return f},this.pause=function(){f=!0,a.abort(),t=S(e.chunk)?"":t.substring(a.getCharIndex())},this.resume=function(){d.streamer._halted?(f=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return v},this.abort=function(){v=!0,a.abort(),b.meta.aborted=!0,S(e.complete)&&e.complete(b),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(m(t)+"([^]*?)"+m(t),"gm");var a=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<a[0].length,1===a.length||e)return"\n";for(var s=0,r=0;r<a.length;r++)"\n"===a[r][0]&&s++;return s>=a.length/2?"\r\n":"\r"}}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function p(e){var t=(e=e||{}).delimiter,a=e.newline,s=e.comments,r=e.step,i=e.preview,n=e.fastMode,o=null,c=!1,d=null==e.quoteChar?'"':e.quoteChar,u=d;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof t||-1<l.BAD_DELIMITERS.indexOf(t))&&(t=","),s===t)throw new Error("Comment character same as delimiter");!0===s?s="#":("string"!=typeof s||-1<l.BAD_DELIMITERS.indexOf(s))&&(s=!1),"\n"!==a&&"\r"!==a&&"\r\n"!==a&&(a="\n");var h=0,f=!1;this.parse=function(l,p,v){if("string"!=typeof l)throw new Error("Input must be a string");var g=l.length,b=t.length,x=a.length,y=s.length,w=S(r),T=[],k=[],D=[],C=h=0;if(!l)return P();if(n||!1!==n&&-1===l.indexOf(d)){for(var E=l.split(a),N=0;N<E.length;N++){if(D=E[N],h+=D.length,N!==E.length-1)h+=a.length;else if(v)return P();if(!s||D.substring(0,y)!==s){if(w){if(T=[],L(D.split(t)),U(),f)return P()}else L(D.split(t));if(i&&i<=N)return T=T.slice(0,i),P(!0)}}return P()}for(var A=l.indexOf(t,h),I=l.indexOf(a,h),j=new RegExp(m(u)+m(d),"g"),_=l.indexOf(d,h);;)if(l[h]===d)for(_=h,h++;;){if(-1===(_=l.indexOf(d,_+1)))return v||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:T.length,index:h}),M();if(_===g-1)return M(l.substring(h,_).replace(j,d));if(d===u&&l[_+1]===u)_++;else if(d===u||0===_||l[_-1]!==u){-1!==A&&A<_+1&&(A=l.indexOf(t,_+1));var O=F(-1===(I=-1!==I&&I<_+1?l.indexOf(a,_+1):I)?A:Math.min(A,I));if(l.substr(_+1+O,b)===t){D.push(l.substring(h,_).replace(j,d)),l[h=_+1+O+b]!==d&&(_=l.indexOf(d,h)),A=l.indexOf(t,h),I=l.indexOf(a,h);break}if(O=F(I),l.substring(_+1+O,_+1+O+x)===a){if(D.push(l.substring(h,_).replace(j,d)),R(_+1+O+x),A=l.indexOf(t,h),_=l.indexOf(d,h),w&&(U(),f))return P();if(i&&T.length>=i)return P(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:T.length,index:h}),_++}}else if(s&&0===D.length&&l.substring(h,h+y)===s){if(-1===I)return P();h=I+x,I=l.indexOf(a,h),A=l.indexOf(t,h)}else if(-1!==A&&(A<I||-1===I))D.push(l.substring(h,A)),h=A+b,A=l.indexOf(t,h);else{if(-1===I)break;if(D.push(l.substring(h,I)),R(I+x),w&&(U(),f))return P();if(i&&T.length>=i)return P(!0)}return M();function L(e){T.push(e),C=h}function F(e){return-1!==e&&(e=l.substring(_+1,e))&&""===e.trim()?e.length:0}function M(e){return v||(void 0===e&&(e=l.substring(h)),D.push(e),h=g,L(D),w&&U()),P()}function R(e){h=e,L(D),D=[],I=l.indexOf(a,h)}function P(s){if(e.header&&!p&&T.length&&!c){var r=T[0],i={},n=new Set(r);let t=!1;for(let a=0;a<r.length;a++){let s=r[a];if(i[s=S(e.transformHeader)?e.transformHeader(s,a):s]){let e,l=i[s];for(;e=s+"_"+l,l++,n.has(e););n.add(e),r[a]=e,i[s]++,t=!0,(o=null===o?{}:o)[e]=s}else i[s]=1,r[a]=s;n.add(s)}c=!0}return{data:T,errors:k,meta:{delimiter:t,linebreak:a,aborted:f,truncated:!!s,cursor:C+(p||0),renamedHeaders:o}}}function U(){r(P()),T=[],k=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return h}}function v(e){var t=e.data,a=i[t.workerId],s=!1;if(t.error)a.userError(t.error,t.file);else if(t.results&&t.results.data){var r={abort:function(){s=!0,g(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(S(a.userStep)){for(var n=0;n<t.results.data.length&&(a.userStep({data:t.results.data[n],errors:t.results.errors,meta:t.results.meta},r),!s);n++);delete t.results}else S(a.userChunk)&&(a.userChunk(t.results,r,t.file),delete t.results)}t.finished&&!s&&g(t.workerId,t.results)}function g(e,t){var a=i[e];S(a.userComplete)&&a.userComplete(t),a.terminate(),delete i[e]}function b(){throw new Error("Not implemented.")}function x(e){if("object"!=typeof e||null===e)return e;var t,a=Array.isArray(e)?[]:{};for(t in e)a[t]=x(e[t]);return a}function y(e,t){return function(){e.apply(t,arguments)}}function S(e){return"function"==typeof e}return l.parse=function(t,s){var r,o=(s=s||{}).dynamicTyping||!1;if(S(o)&&(s.dynamicTypingFunction=o,o={}),s.dynamicTyping=o,s.transform=!!S(s.transform)&&s.transform,!s.worker||!l.WORKERS_SUPPORTED)return o=null,l.NODE_STREAM_INPUT,"string"==typeof t?(t=65279!==(r=t).charCodeAt(0)?r:r.slice(1),o=new(s.download?c:u)(s)):!0===t.readable&&S(t.read)&&S(t.on)?o=new h(s):(a.File&&t instanceof File||t instanceof Object)&&(o=new d(s)),o.stream(t);(o=(()=>{var t,s,r;return!!l.WORKERS_SUPPORTED&&(s=a.URL||a.webkitURL||null,r=e.toString(),t=l.BLOB_URL||(l.BLOB_URL=s.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"}))),(t=new a.Worker(t)).onmessage=v,t.id=n++,i[t.id]=t)})()).userStep=s.step,o.userChunk=s.chunk,o.userComplete=s.complete,o.userError=s.error,s.step=S(s.step),s.chunk=S(s.chunk),s.complete=S(s.complete),s.error=S(s.error),delete s.worker,o.postMessage({input:t,config:s,workerId:o.id})},l.unparse=function(e,t){var a=!1,s=!0,r=",",i="\r\n",n='"',o=n+n,c=!1,d=null,u=!1,h=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||l.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(r=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(a=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(c=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(n=t.quoteChar),"boolean"==typeof t.header&&(s=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");d=t.columns}void 0!==t.escapeChar&&(o=t.escapeChar+n),t.escapeFormulae instanceof RegExp?u=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(u=/^[=+\-@\t\r].*$/)}})(),new RegExp(m(n),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,c);if("object"==typeof e[0])return f(d||Object.keys(e[0]),e,c)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],c);throw new Error("Unable to serialize unrecognized input");function f(e,t,a){var n="",l=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),o=!Array.isArray(t[0]);if(l&&s){for(var c=0;c<e.length;c++)0<c&&(n+=r),n+=p(e[c],c);0<t.length&&(n+=i)}for(var d=0;d<t.length;d++){var u=(l?e:t[d]).length,h=!1,f=l?0===Object.keys(t[d]).length:0===t[d].length;if(a&&!l&&(h="greedy"===a?""===t[d].join("").trim():1===t[d].length&&0===t[d][0].length),"greedy"===a&&l){for(var m=[],v=0;v<u;v++){var g=o?e[v]:v;m.push(t[d][g])}h=""===m.join("").trim()}if(!h){for(var b=0;b<u;b++){0<b&&!f&&(n+=r);var x=l&&o?e[b]:b;n+=p(t[d][x],b)}d<t.length-1&&(!a||0<u&&!f)&&(n+=i)}}return n}function p(e,t){var s,i;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(i=!1,u&&"string"==typeof e&&u.test(e)&&(e="'"+e,i=!0),s=e.toString().replace(h,o),(i=i||!0===a||"function"==typeof a&&a(e,t)||Array.isArray(a)&&a[t]||((e,t)=>{for(var a=0;a<t.length;a++)if(-1<e.indexOf(t[a]))return!0;return!1})(s,l.BAD_DELIMITERS)||-1<s.indexOf(r)||" "===s.charAt(0)||" "===s.charAt(s.length-1))?n+s+n:s)}},l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="\ufeff",l.BAD_DELIMITERS=["\r","\n",'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!s&&!!a.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=p,l.ParserHandle=f,l.NetworkStreamer=c,l.FileStreamer=d,l.StringStreamer=u,l.ReadableStreamStreamer=h,a.jQuery&&((t=a.jQuery).fn.parse=function(e){var s=e.config||{},r=[];return this.each((function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!a.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)r.push({file:this.files[i],inputElem:this,instanceConfig:t.extend({},s)})})),i(),this;function i(){if(0===r.length)S(e.complete)&&e.complete();else{var a,s,i,o=r[0];if(S(e.before)){var c=e.before(o.file,o.inputElem);if("object"==typeof c){if("abort"===c.action)return a=o.file,s=o.inputElem,i=c.reason,void(S(e.error)&&e.error({name:"AbortError"},a,s,i));if("skip"===c.action)return void n();"object"==typeof c.config&&(o.instanceConfig=t.extend(o.instanceConfig,c.config))}else if("skip"===c)return void n()}var d=o.instanceConfig.complete;o.instanceConfig.complete=function(e){S(d)&&d(e,o.file,o.inputElem),n()},l.parse(o.file,o.instanceConfig)}}function n(){r.splice(0,1),i()}}),r&&(a.onmessage=function(e){e=e.data,void 0===l.WORKER_ID&&e&&(l.WORKER_ID=e.workerId),"string"==typeof e.input?a.postMessage({workerId:l.WORKER_ID,results:l.parse(e.input,e.config),finished:!0}):(a.File&&e.input instanceof File||e.input instanceof Object)&&(e=l.parse(e.input,e.config))&&a.postMessage({workerId:l.WORKER_ID,results:e,finished:!0})}),(c.prototype=Object.create(o.prototype)).constructor=c,(d.prototype=Object.create(o.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(h.prototype=Object.create(o.prototype)).constructor=h,l}(),Yr=1252,Kr=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$r={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},qr=function(e){-1!=Kr.indexOf(e)&&(Yr=$r[0]=e)},Jr=function(e){qr(e)};function Xr(){Jr(1200),qr(1252)}function Zr(e){for(var t=[],a=0,s=e.length;a<s;++a)t[a]=e.charCodeAt(a);return t}function Qr(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return t.join("")}var ei,ti=function(e){var t=e.charCodeAt(0),a=e.charCodeAt(1);return 255==t&&254==a?function(e){for(var t=[],a=0;a<e.length>>1;++a)t[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==a?Qr(e.slice(2)):65279==t?e.slice(1):e},ai=function(e){return String.fromCharCode(e)},si=function(e){return String.fromCharCode(e)},ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ii(e){for(var t="",a=0,s=0,r=0,i=0,n=0,l=0,o=0,c=0;c<e.length;)i=(a=e.charCodeAt(c++))>>2,n=(3&a)<<4|(s=e.charCodeAt(c++))>>4,l=(15&s)<<2|(r=e.charCodeAt(c++))>>6,o=63&r,isNaN(s)?l=o=64:isNaN(r)&&(o=64),t+=ri.charAt(i)+ri.charAt(n)+ri.charAt(l)+ri.charAt(o);return t}function ni(e){var t="",a=0,s=0,r=0,i=0,n=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var o=0;o<e.length;)a=ri.indexOf(e.charAt(o++))<<2|(i=ri.indexOf(e.charAt(o++)))>>4,t+=String.fromCharCode(a),s=(15&i)<<4|(n=ri.indexOf(e.charAt(o++)))>>2,64!==n&&(t+=String.fromCharCode(s)),r=(3&n)<<6|(l=ri.indexOf(e.charAt(o++))),64!==l&&(t+=String.fromCharCode(r));return t}var li=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),oi=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ci(e){return li?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function di(e){return li?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var ui=function(e){return li?oi(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function hi(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}function fi(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return fi(new Uint8Array(e));for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=e[a];return t}var mi=li?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:oi(e)})))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,a=0;for(t=0;t<e.length;++t)a+=e[t].length;var s=new Uint8Array(a),r=0;for(t=0,a=0;t<e.length;a+=r,++t)if(r=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],a);else{if("string"==typeof e[t])throw"wtf";s.set(new Uint8Array(e[t]),a)}return s}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))},pi=/\u0000/g,vi=/[\u0001-\u0006]/g;function gi(e){for(var t="",a=e.length-1;a>=0;)t+=e.charAt(a--);return t}function bi(e,t){var a=""+e;return a.length>=t?a:Cn("0",t-a.length)+a}function xi(e,t){var a=""+e;return a.length>=t?a:Cn(" ",t-a.length)+a}function yi(e,t){var a=""+e;return a.length>=t?a:a+Cn(" ",t-a.length)}var Si=Math.pow(2,32);function wi(e,t){return e>Si||e<-Si?function(e,t){var a=""+Math.round(e);return a.length>=t?a:Cn("0",t-a.length)+a}(e,t):function(e,t){var a=""+e;return a.length>=t?a:Cn("0",t-a.length)+a}(Math.round(e),t)}function Ti(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var ki=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Di=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Ci={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ei={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ni={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ai(e,t,a){for(var s=e<0?-1:1,r=e*s,i=0,n=1,l=0,o=1,c=0,d=0,u=Math.floor(r);c<t&&(l=(u=Math.floor(r))*n+i,d=u*c+o,!(r-u<5e-8));)r=1/(r-u),i=n,n=l,o=c,c=d;if(d>t&&(c>t?(d=o,l=i):(d=c,l=n)),!a)return[0,s*l,d];var h=Math.floor(s*l/d);return[h,s*l-h*d,d]}function Ii(e,t,a){if(e>2958465||e<0)return null;var s=0|e,r=Math.floor(86400*(e-s)),i=0,n=[],l={D:s,T:r,u:86400*(e-s)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(s+=1462),l.u>.9999&&(l.u=0,86400==++r&&(l.T=r=0,++s,++l.D)),60===s)n=a?[1317,10,29]:[1900,2,29],i=3;else if(0===s)n=a?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var o=new Date(1900,0,1);o.setDate(o.getDate()+s-1),n=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),s<60&&(i=(i+6)%7),a&&(i=function(e,t){t[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}(o,n))}return l.y=n[0],l.m=n[1],l.d=n[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=i,l}var ji=new Date(1899,11,31,0,0,0),_i=ji.getTime(),Oi=new Date(1900,2,1,0,0,0);function Li(e,t){var a=e.getTime();return t?a-=1262304e5:e>=Oi&&(a+=864e5),(a-(_i+6e4*(e.getTimezoneOffset()-ji.getTimezoneOffset())))/864e5}function Fi(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Mi(e){var t,a=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=a>=-4&&a<=-1?e.toPrecision(10+a):Math.abs(a)<=9?function(e){var t=e<0?12:11,a=Fi(e.toFixed(12));return a.length<=t||(a=e.toPrecision(10)).length<=t?a:e.toExponential(5)}(e):10===a?e.toFixed(10).substr(0,12):function(e){var t=Fi(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Fi(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Ri(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Mi(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return sn(14,Li(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Pi(e,t,a,s){var r,i="",n=0,l=0,o=a.y,c=0;switch(e){case 98:o=a.y+543;case 121:switch(t.length){case 1:case 2:r=o%100,c=2;break;default:r=o%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:r=a.m,c=t.length;break;case 3:return Di[a.m-1][1];case 5:return Di[a.m-1][0];default:return Di[a.m-1][2]}break;case 100:switch(t.length){case 1:case 2:r=a.d,c=t.length;break;case 3:return ki[a.q][0];default:return ki[a.q][1]}break;case 104:switch(t.length){case 1:case 2:r=1+(a.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:r=a.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:r=a.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==a.u||"s"!=t&&"ss"!=t?(l=s>=2?3===s?1e3:100:1===s?10:1,(n=Math.round(l*(a.S+a.u)))>=60*l&&(n=0),"s"===t?0===n?"0":""+n/l:(i=bi(n,2+s),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):bi(a.S,t.length);case 90:switch(t){case"[h]":case"[hh]":r=24*a.D+a.H;break;case"[m]":case"[mm]":r=60*(24*a.D+a.H)+a.M;break;case"[s]":case"[ss]":r=60*(60*(24*a.D+a.H)+a.M)+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:r=o,c=1}return c>0?bi(r,c):""}function Ui(e){if(e.length<=3)return e;for(var t=e.length%3,a=e.substr(0,t);t!=e.length;t+=3)a+=(a.length>0?",":"")+e.substr(t,3);return a}var Bi=/%/g;function Gi(e,t){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Gi(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%r;if(i<0&&(i+=r),-1===(a=(t/Math.pow(10,i)).toPrecision(s+1+(r+i)%r)).indexOf("e")){var n=Math.floor(Math.log(t)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(n-a.length+i):a+="E+"+(n-i);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,r)+"."+a.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,a,s){return t+a+s.substr(0,(r+i)%r)+"."+s.substr(i)+"E"}))}else a=t.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Vi=/# (\?+)( ?)\/( ?)(\d+)/,Wi=/^#*0*\.([0#]+)/,Hi=/\).*[0#]/,zi=/\(###\) ###\\?-####/;function Yi(e){for(var t,a="",s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(t)}return a}function Ki(e,t){var a=Math.pow(10,t);return""+Math.round(e*a)/a}function $i(e,t){var a=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(a*s)).length?0:Math.round(a*s)}function qi(e,t,a){if(40===e.charCodeAt(0)&&!t.match(Hi)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?qi("n",s,a):"("+qi("n",s,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var s=t.length-1;44===t.charCodeAt(s-1);)--s;return Zi(e,t.substr(0,s),a/Math.pow(10,3*(t.length-s)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var s=t.replace(Bi,""),r=t.length-s.length;return Zi(e,s,a*Math.pow(10,2*r))+Cn("%",r)}(e,t,a);if(-1!==t.indexOf("E"))return Gi(t,a);if(36===t.charCodeAt(0))return"$"+qi(e,t.substr(" "==t.charAt(1)?2:1),a);var r,i,n,l,o=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+wi(o,t.length);if(t.match(/^[#?]+$/))return"0"===(r=wi(a,0))&&(r=""),r.length>t.length?r:Yi(t.substr(0,t.length-r.length))+r;if(i=t.match(Vi))return function(e,t,a){var s=parseInt(e[4],10),r=Math.round(t*s),i=Math.floor(r/s),n=r-i*s,l=s;return a+(0===i?"":""+i)+" "+(0===n?Cn(" ",e[1].length+1+e[4].length):xi(n,e[1].length)+e[2]+"/"+e[3]+bi(l,e[4].length))}(i,o,c);if(t.match(/^#+0+$/))return c+wi(o,t.length-t.indexOf("0"));if(i=t.match(Wi))return r=Ki(a,i[1].length).replace(/^([^\.]+)$/,"$1."+Yi(i[1])).replace(/\.$/,"."+Yi(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Cn("0",Yi(i[1]).length-t.length)})),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+Ki(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Ui(wi(o,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+qi(e,t,-a):Ui(""+(Math.floor(a)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(a,i[1].length)))+"."+bi($i(a,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return qi(e,t.replace(/^#,#*,/,""),a);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=gi(qi(e,t.replace(/[\\-]/g,""),a)),n=0,gi(gi(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return n<r.length?r.charAt(n++):"0"===e?"0":""})));if(t.match(zi))return"("+(r=qi(e,"##########",a)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(i[4].length,7),l=Ai(o,Math.pow(10,n)-1,!1),r=""+c," "==(d=Zi("n",i[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),r+=d+i[2]+"/"+i[3],(d=yi(l[2],n)).length<i[4].length&&(d=Yi(i[4].substr(i[4].length-d.length))+d),r+=d;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(Math.max(i[1].length,i[4].length),7),c+((l=Ai(o,Math.pow(10,n)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?xi(l[1],n)+i[2]+"/"+i[3]+yi(l[2],n):Cn(" ",2*n+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return r=wi(a,0),t.length<=r.length?r:Yi(t.substr(0,t.length-r.length))+r;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+a.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),n=r.indexOf(".");var u=t.indexOf(".")-n,h=t.length-r.length-u;return Yi(t.substr(0,u)+r+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return n=$i(a,i[1].length),a<0?"-"+qi(e,t,-a):Ui(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?bi(0,3-e.length):"")+e}))+"."+bi(n,i[1].length);switch(t){case"###,##0.00":return qi(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var f=Ui(wi(o,0));return"0"!==f?c+f:"";case"###,###.00":return qi(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return qi(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ji(e,t){var a,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Ji(e,-t);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%r;if(i<0&&(i+=r),!(a=(t/Math.pow(10,i)).toPrecision(s+1+(r+i)%r)).match(/[Ee]/)){var n=Math.floor(Math.log(t)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(n-a.length+i):a+="E+"+(n-i),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,a,s){return t+a+s.substr(0,(r+i)%r)+"."+s.substr(i)+"E"}))}else a=t.toExponential(s);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Xi(e,t,a){if(40===e.charCodeAt(0)&&!t.match(Hi)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Xi("n",s,a):"("+Xi("n",s,-a)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,a){for(var s=t.length-1;44===t.charCodeAt(s-1);)--s;return Zi(e,t.substr(0,s),a/Math.pow(10,3*(t.length-s)))}(e,t,a);if(-1!==t.indexOf("%"))return function(e,t,a){var s=t.replace(Bi,""),r=t.length-s.length;return Zi(e,s,a*Math.pow(10,2*r))+Cn("%",r)}(e,t,a);if(-1!==t.indexOf("E"))return Ji(t,a);if(36===t.charCodeAt(0))return"$"+Xi(e,t.substr(" "==t.charAt(1)?2:1),a);var r,i,n,l,o=Math.abs(a),c=a<0?"-":"";if(t.match(/^00+$/))return c+bi(o,t.length);if(t.match(/^[#?]+$/))return r=""+a,0===a&&(r=""),r.length>t.length?r:Yi(t.substr(0,t.length-r.length))+r;if(i=t.match(Vi))return function(e,t,a){return a+(0===t?"":""+t)+Cn(" ",e[1].length+2+e[4].length)}(i,o,c);if(t.match(/^#+0+$/))return c+bi(o,t.length-t.indexOf("0"));if(i=t.match(Wi))return r=(r=(""+a).replace(/^([^\.]+)$/,"$1."+Yi(i[1])).replace(/\.$/,"."+Yi(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Cn("0",Yi(i[1]).length-t.length)})),-1!==t.indexOf("0.")?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Ui(""+o);if(i=t.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Xi(e,t,-a):Ui(""+a)+"."+Cn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Xi(e,t.replace(/^#,#*,/,""),a);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=gi(Xi(e,t.replace(/[\\-]/g,""),a)),n=0,gi(gi(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return n<r.length?r.charAt(n++):"0"===e?"0":""})));if(t.match(zi))return"("+(r=Xi(e,"##########",a)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(i[4].length,7),l=Ai(o,Math.pow(10,n)-1,!1),r=""+c," "==(d=Zi("n",i[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),r+=d+i[2]+"/"+i[3],(d=yi(l[2],n)).length<i[4].length&&(d=Yi(i[4].substr(i[4].length-d.length))+d),r+=d;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return n=Math.min(Math.max(i[1].length,i[4].length),7),c+((l=Ai(o,Math.pow(10,n)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?xi(l[1],n)+i[2]+"/"+i[3]+yi(l[2],n):Cn(" ",2*n+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return r=""+a,t.length<=r.length?r:Yi(t.substr(0,t.length-r.length))+r;if(i=t.match(/^([#0]+)\.([#0]+)$/)){r=""+a.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),n=r.indexOf(".");var u=t.indexOf(".")-n,h=t.length-r.length-u;return Yi(t.substr(0,u)+r+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Xi(e,t,-a):Ui(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?bi(0,3-e.length):"")+e}))+"."+bi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=Ui(""+o);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Xi(e,t.slice(0,t.lastIndexOf(".")),a)+Yi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Zi(e,t,a){return(0|a)===a?Xi(e,t,a):qi(e,t,a)}var Qi=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function en(e){for(var t=0,a="",s="";t<e.length;)switch(a=e.charAt(t)){case"G":Ti(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("/"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(s=a;"]"!==e.charAt(t++)&&t<e.length;)s+=e.charAt(t);if(s.match(Qi))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++t))>-1||"\\"==a&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===a;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var tn=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function an(e,t){if(null==t)return!1;var a=parseFloat(t[2]);switch(t[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0}return!1}function sn(e,t,a){null==a&&(a={});var s="";switch(typeof e){case"string":s="m/d/yy"==e&&a.dateNF?a.dateNF:e;break;case"number":null==(s=14==e&&a.dateNF?a.dateNF:(null!=a.table?a.table:Ci)[e])&&(s=a.table&&a.table[Ei[e]]||Ci[Ei[e]]),null==s&&(s=Ni[e]||"General")}if(Ti(s,0))return Ri(t,a);t instanceof Date&&(t=Li(t,a.date1904));var r=function(e,t){var a=function(e){for(var t=[],a=!1,s=0,r=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(r,s-r),r=s+1}if(t[t.length]=e.substr(r),!0===a)throw new Error("Format |"+e+"| unterminated string ");return t}(e),s=a.length,r=a[s-1].indexOf("@");if(s<4&&r>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if("number"!=typeof t)return[4,4===a.length||r>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=r>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=r>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=r>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"]}var i=t>0?a[0]:t<0?a[1]:a[2];if(-1===a[0].indexOf("[")&&-1===a[1].indexOf("["))return[s,i];if(null!=a[0].match(/\[[=<>]/)||null!=a[1].match(/\[[=<>]/)){var n=a[0].match(tn),l=a[1].match(tn);return an(t,n)?[s,a[0]]:an(t,l)?[s,a[1]]:[s,a[null!=n&&null!=l?2:1]]}return[s,i]}(s,t);if(Ti(r[1]))return Ri(t,a);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,a,s){for(var r,i,n,l=[],o="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Ti(e,c))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";34!==(n=e.charCodeAt(++c))&&c<e.length;)o+=String.fromCharCode(n);l[l.length]={t:"t",v:o},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";l[l.length]={t:m,v:f},++c;break;case"_":l[l.length]={t:"t",v:" "},c+=2;break;case"@":l[l.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==r&&null==(r=Ii(t,a,"2"===e.charAt(c+1))))return"";l[l.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==r&&null==(r=Ii(t,a)))return"";for(o=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)o+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),l[l.length]={t:d,v:o},u=d;break;case"A":case"a":case"":var p={t:d,v:d};if(null==r&&(r=Ii(t,a)),"A/P"===e.substr(c,3).toUpperCase()?(null!=r&&(p.v=r.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=r&&(p.v=r.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"/"===e.substr(c,5).toUpperCase()?(null!=r&&(p.v=r.H>=12?"":""),p.t="T",c+=5,h="h"):(p.t="t",++c),null==r&&"T"===p.t)return"";l[l.length]=p,u=d;break;case"[":for(o=d;"]"!==e.charAt(c++)&&c<e.length;)o+=e.charAt(c);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(Qi)){if(null==r&&null==(r=Ii(t,a)))return"";l[l.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",en(e)||(l[l.length]={t:"t",v:o}));break;case".":if(null!=r){for(o=d;++c<e.length&&"0"===(d=e.charAt(c));)o+=d;l[l.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)o+=d;l[l.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++c)===d;)o+=d;l[l.length]={t:d,v:o},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":l[l.length]={t:1===s?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);l[l.length]={t:"D",v:o};break;case" ":l[l.length]={t:d,v:d},++c;break;case"$":l[l.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"t",v:d},++c}var v,g=0,b=0;for(c=l.length-1,u="t";c>=0;--c)switch(l[c].t){case"h":case"H":l[c].t=h,u="h",g<1&&(g=1);break;case"s":(v=l[c].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":u=l[c].t;break;case"m":"s"===u&&(l[c].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&l[c].v.match(/[Hh]/)&&(g=1),g<2&&l[c].v.match(/[Mm]/)&&(g=2),g<3&&l[c].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var x,y="";for(c=0;c<l.length;++c)switch(l[c].t){case"t":case"T":case" ":case"D":break;case"X":l[c].v="",l[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[c].v=Pi(l[c].t.charCodeAt(0),l[c].v,r,b),l[c].t="t";break;case"n":case"?":for(x=c+1;null!=l[x]&&("?"===(d=l[x].t)||"D"===d||(" "===d||"t"===d)&&null!=l[x+1]&&("?"===l[x+1].t||"t"===l[x+1].t&&"/"===l[x+1].v)||"("===l[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===l[x].v||" "===l[x].v&&null!=l[x+1]&&"?"==l[x+1].t));)l[c].v+=l[x].v,l[x]={v:"",t:";"},++x;y+=l[c].v,c=x-1;break;case"G":l[c].t="t",l[c].v=Ri(t,a)}var S,w,T="";if(y.length>0){40==y.charCodeAt(0)?(S=t<0&&45===y.charCodeAt(0)?-t:t,w=Zi("n",y,S)):(w=Zi("n",y,S=t<0&&s>1?-t:t),S<0&&l[0]&&"t"==l[0].t&&(w=w.substr(1),l[0].v="-"+l[0].v)),x=w.length-1;var k=l.length;for(c=0;c<l.length;++c)if(null!=l[c]&&"t"!=l[c].t&&l[c].v.indexOf(".")>-1){k=c;break}var D=l.length;if(k===l.length&&-1===w.indexOf("E")){for(c=l.length-1;c>=0;--c)null!=l[c]&&-1!=="n?".indexOf(l[c].t)&&(x>=l[c].v.length-1?(x-=l[c].v.length,l[c].v=w.substr(x+1,l[c].v.length)):x<0?l[c].v="":(l[c].v=w.substr(0,x+1),x=-1),l[c].t="t",D=c);x>=0&&D<l.length&&(l[D].v=w.substr(0,x+1)+l[D].v)}else if(k!==l.length&&-1===w.indexOf("E")){for(x=w.indexOf(".")-1,c=k;c>=0;--c)if(null!=l[c]&&-1!=="n?".indexOf(l[c].t)){for(i=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")-1:l[c].v.length-1,T=l[c].v.substr(i+1);i>=0;--i)x>=0&&("0"===l[c].v.charAt(i)||"#"===l[c].v.charAt(i))&&(T=w.charAt(x--)+T);l[c].v=T,l[c].t="t",D=c}for(x>=0&&D<l.length&&(l[D].v=w.substr(0,x+1)+l[D].v),x=w.indexOf(".")+1,c=k;c<l.length;++c)if(null!=l[c]&&(-1!=="n?(".indexOf(l[c].t)||c===k)){for(i=l[c].v.indexOf(".")>-1&&c===k?l[c].v.indexOf(".")+1:0,T=l[c].v.substr(0,i);i<l[c].v.length;++i)x<w.length&&(T+=w.charAt(x++));l[c].v=T,l[c].t="t",D=c}}}for(c=0;c<l.length;++c)null!=l[c]&&"n?".indexOf(l[c].t)>-1&&(S=s>1&&t<0&&c>0&&"-"===l[c-1].v?-t:t,l[c].v=Zi(l[c].t,l[c].v,S),l[c].t="t");var C="";for(c=0;c!==l.length;++c)null!=l[c]&&(C+=l[c].v);return C}(r[1],t,a,r[0])}function rn(e,t){if("number"!=typeof t){t=+t||-1;for(var a=0;a<392;++a)if(null!=Ci[a]){if(Ci[a]==e){t=a;break}}else t<0&&(t=a);t<0&&(t=391)}return Ci[t]=e,t}function nn(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',Ci=e}var ln={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},on=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,cn=function(){var e={version:"1.2.0"},t=function(){for(var e=0,t=new Array(256),a=0;256!=a;++a)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=a)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[a]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),a=function(e){var t=0,a=0,s=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(s=0;256!=s;++s)r[s]=e[s];for(s=0;256!=s;++s)for(a=e[s],t=256+s;t<4096;t+=256)a=r[t]=a>>>8^e[255&a];var i=[];for(s=1;16!=s;++s)i[s-1]="undefined"!=typeof Int32Array?r.subarray(256*s,256*s+256):r.slice(256*s,256*s+256);return i}(t),s=a[0],r=a[1],i=a[2],n=a[3],l=a[4],o=a[5],c=a[6],d=a[7],u=a[8],h=a[9],f=a[10],m=a[11],p=a[12],v=a[13],g=a[14];return e.table=t,e.bstr=function(e,a){for(var s=~a,r=0,i=e.length;r<i;)s=s>>>8^t[255&(s^e.charCodeAt(r++))];return~s},e.buf=function(e,a){for(var b=~a,x=e.length-15,y=0;y<x;)b=g[e[y++]^255&b]^v[e[y++]^b>>8&255]^p[e[y++]^b>>16&255]^m[e[y++]^b>>>24]^f[e[y++]]^h[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^o[e[y++]]^l[e[y++]]^n[e[y++]]^i[e[y++]]^r[e[y++]]^s[e[y++]]^t[e[y++]];for(x+=15;y<x;)b=b>>>8^t[255&(b^e[y++])];return~b},e.str=function(e,a){for(var s=~a,r=0,i=e.length,n=0,l=0;r<i;)(n=e.charCodeAt(r++))<128?s=s>>>8^t[255&(s^n)]:n<2048?s=(s=s>>>8^t[255&(s^(192|n>>6&31))])>>>8^t[255&(s^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),l=1023&e.charCodeAt(r++),s=(s=(s=(s=s>>>8^t[255&(s^(240|n>>8&7))])>>>8^t[255&(s^(128|n>>2&63))])>>>8^t[255&(s^(128|l>>6&15|(3&n)<<4))])>>>8^t[255&(s^(128|63&l))]):s=(s=(s=s>>>8^t[255&(s^(224|n>>12&15))])>>>8^t[255&(s^(128|n>>6&63))])>>>8^t[255&(s^(128|63&n))];return~s},e}(),dn=function(){var e,t={};function a(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:a(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function s(e){if("/"==e.charAt(e.length-1))return s(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function r(e,t){"string"==typeof t&&(t=new Date(t));var a=t.getHours();a=(a=a<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,a);var s=t.getFullYear()-1980;s=(s=s<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,s)}function i(e){Zl(e,0);for(var t={},a=0;e.l<=e.length-4;){var s=e.read_shift(2),r=e.read_shift(2),i=e.l+r,n={};21589===s&&(1&(a=e.read_shift(1))&&(n.mtime=e.read_shift(4)),r>5&&(2&a&&(n.atime=e.read_shift(4)),4&a&&(n.ctime=e.read_shift(4))),n.mtime&&(n.mt=new Date(1e3*n.mtime))),e.l=i,t[s]=n}return t}function n(){return e||(e={})}function l(e,t){if(80==e[0]&&75==e[1])return se(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=w(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var a=t&&t.root||"",s=(li&&Buffer.isBuffer(e)?e.toString("binary"):w(e)).split("\r\n"),r=0,i="";for(r=0;r<s.length;++r)if(i=s[r],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),a||(a=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,a.length)!=a))for(;a.length>0&&(a=(a=a.slice(0,a.length-1)).slice(0,a.lastIndexOf("/")+1),i.slice(0,a.length)!=a););var n=(s[1]||"").match(/boundary="(.*?)"/);if(!n)throw new Error("MAD cannot find boundary");var l="--"+(n[1]||""),o={FileIndex:[],FullPaths:[]};h(o);var c,d=0;for(r=0;r<s.length;++r){var u=s[r];u!==l&&u!==l+"--"||(d++&&ce(o,s.slice(c,r),a),c=r)}return o}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var a,s,r,i,n,l,f=512,m=[],p=e.slice(0,512);Zl(p,0);var v=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(a=v[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==v[1])return se(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+a)}512!==f&&Zl(p=e.slice(0,f),28);var x=e.slice(0,f);!function(e,t){var a;switch(e.l+=2,a=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+a);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+a);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+a)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,a);var y=p.read_shift(4,"i");if(3===a&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,i=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),n=p.read_shift(4,"i"),s=p.read_shift(4,"i"),l=p.read_shift(4,"i"),r=p.read_shift(4,"i");for(var S=-1,T=0;T<109&&!((S=p.read_shift(4,"i"))<0);++T)m[T]=S;var k=function(e,t){for(var a=Math.ceil(e.length/t)-1,s=[],r=1;r<a;++r)s[r-1]=e.slice(r*t,(r+1)*t);return s[a-1]=e.slice(a*t),s}(e,f);c(l,r,k,f,m);var D=function(e,t,a,s){var r=e.length,i=[],n=[],l=[],o=[],c=s-1,d=0,u=0,h=0,f=0;for(d=0;d<r;++d)if(l=[],(h=d+t)>=r&&(h-=r),!n[h]){o=[];var m=[];for(u=h;u>=0;){m[u]=!0,n[u]=!0,l[l.length]=u,o.push(e[u]);var p=a[Math.floor(4*u/s)];if(s<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+s);if(!e[p])break;if(m[u=Hl(e[p],f)])break}i[h]={nodes:l,data:yl([o])}}return i}(k,i,m,f);D[i].name="!Directory",s>0&&n!==g&&(D[n].name="!MiniFAT"),D[m[0]].name="!FAT",D.fat_addrs=m,D.ssz=f;var C=[],E=[],N=[];!function(e,t,a,s,r,i,n,l){for(var c,h=0,f=s.length?2:0,m=t[e].data,p=0,v=0;p<m.length;p+=128){var b=m.slice(p,p+128);Zl(b,64),v=b.read_shift(2),c=wl(b,0,v-f),s.push(c);var x={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.ct=u(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(x.mt=u(b,b.l-8)),x.start=b.read_shift(4,"i"),x.size=b.read_shift(4,"i"),x.size<0&&x.start<0&&(x.size=x.type=0,x.start=g,x.name=""),5===x.type?(h=x.start,r>0&&h!==g&&(t[h].name="!StreamData")):x.size>=4096?(x.storage="fat",void 0===t[x.start]&&(t[x.start]=d(a,x.start,t.fat_addrs,t.ssz)),t[x.start].name=x.name,x.content=t[x.start].data.slice(0,x.size)):(x.storage="minifat",x.size<0?x.size=0:h!==g&&x.start!==g&&t[h]&&(x.content=o(x,t[h].data,(t[l]||{}).data))),x.content&&Zl(x.content,0),i[c]=x,n.push(x)}}(i,D,k,C,s,{},E,n),function(e,t,a){for(var s=0,r=0,i=0,n=0,l=0,o=a.length,c=[],d=[];s<o;++s)c[s]=d[s]=s,t[s]=a[s];for(;l<d.length;++l)r=e[s=d[l]].L,i=e[s].R,n=e[s].C,c[s]===s&&(-1!==r&&c[r]!==r&&(c[s]=c[r]),-1!==i&&c[i]!==i&&(c[s]=c[i])),-1!==n&&(c[n]=s),-1!==r&&s!=c[s]&&(c[r]=c[s],d.lastIndexOf(r)<l&&d.push(r)),-1!==i&&s!=c[s]&&(c[i]=c[s],d.lastIndexOf(i)<l&&d.push(i));for(s=1;s<o;++s)c[s]===s&&(-1!==i&&c[i]!==i?c[s]=c[i]:-1!==r&&c[r]!==r&&(c[s]=c[r]));for(s=1;s<o;++s)if(0!==e[s].type){if((l=s)!=c[l])do{l=c[l],t[s]=t[l]+"/"+t[s]}while(0!==l&&-1!==c[l]&&l!=c[l]);c[s]=-1}for(t[0]+="/",s=1;s<o;++s)2!==e[s].type&&(t[s]+="/")}(E,N,C),C.shift();var A={FileIndex:E,FullPaths:N};return t&&t.raw&&(A.raw={header:x,sectors:k}),A}function o(e,t,a){for(var s=e.start,r=e.size,i=[],n=s;a&&r>0&&n>=0;)i.push(t.slice(n*v,n*v+v)),r-=v,n=Hl(a,4*n);return 0===i.length?eo(0):mi(i).slice(0,e.size)}function c(e,t,a,s,r){var i=g;if(e===g){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var n=a[e],l=(s>>>2)-1;if(!n)return;for(var o=0;o<l&&(i=Hl(n,4*o))!==g;++o)r.push(i);c(Hl(n,s-4),t-1,a,s,r)}}function d(e,t,a,s,r){var i=[],n=[];r||(r=[]);var l=s-1,o=0,c=0;for(o=t;o>=0;){r[o]=!0,i[i.length]=o,n.push(e[o]);var d=a[Math.floor(4*o/s)];if(s<4+(c=4*o&l))throw new Error("FAT boundary crossed: "+o+" 4 "+s);if(!e[d])break;o=Hl(e[d],c)}return{nodes:i,data:yl([n])}}function u(e,t){return new Date(1e3*(Wl(e,t+4)/1e7*Math.pow(2,32)+Wl(e,t)/1e7-11644473600))}function h(e,t){var a=t||{},s=a.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=s+"/",e.FileIndex[0]={name:s,type:5}),a.CLSID&&(e.FileIndex[0].clsid=a.CLSID),function(e){var t="Sh33tJ5";if(!dn.find(e,"/"+t)){var a=eo(4);a[0]=55,a[1]=a[3]=50,a[2]=54,e.FileIndex.push({name:t,type:2,content:a,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}}(e)}function f(e,t){h(e);for(var r=!1,i=!1,n=e.FullPaths.length-1;n>=0;--n){var l=e.FileIndex[n];switch(l.type){case 0:i?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(l.R*l.L*l.C)&&(r=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(r=!0);break;default:r=!0}}if(r||t){var o=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(n=0;n<e.FullPaths.length;++n)d[e.FullPaths[n]]=!0,0!==e.FileIndex[n].type&&u.push([e.FullPaths[n],e.FileIndex[n]]);for(n=0;n<u.length;++n){var f=a(u[n][0]);(i=d[f])||(u.push([f,{name:s(f).replace("/",""),type:1,clsid:y,ct:o,mt:o,content:null}]),d[f]=!0)}for(u.sort((function(e,t){return function(e,t){for(var a=e.split("/"),s=t.split("/"),r=0,i=0,n=Math.min(a.length,s.length);r<n;++r){if(i=a[r].length-s[r].length)return i;if(a[r]!=s[r])return a[r]<s[r]?-1:1}return a.length-s.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],n=0;n<u.length;++n)e.FullPaths[n]=u[n][0],e.FileIndex[n]=u[n][1];for(n=0;n<u.length;++n){var m=e.FileIndex[n],p=e.FullPaths[n];if(m.name=s(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===n)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=n+1;c<u.length&&a(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=n+1;c<u.length&&a(e.FullPaths[c])!=a(p);++c);m.R=c>=u.length?-1:c,m.type=1}else a(e.FullPaths[n+1]||"")==a(p)&&(m.R=n+1),m.type=2}}}function m(e,t){var a=t||{};if("mad"==a.fileType)return function(e,t){for(var a=t||{},s=a.boundary||"SheetJS",r=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(s="------="+s).slice(2)+'"',"","",""],i=e.FullPaths[0],n=i,l=e.FileIndex[0],o=1;o<e.FullPaths.length;++o)if(n=e.FullPaths[o].slice(i.length),(l=e.FileIndex[o]).size&&l.content&&"Sh33tJ5"!=n){n=n.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=l.content,d=li&&Buffer.isBuffer(c)?c.toString("binary"):w(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;r.push(s),r.push("Content-Location: "+(a.root||"file:///C:/SheetJS/")+n),r.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),r.push("Content-Type: "+ne(l,n)),r.push(""),r.push(p?oe(d):le(d))}return r.push(s+"--\r\n"),r.join("\r\n")}(e,a);if(f(e),"zip"===a.fileType)return function(e,t){var a,s=t||{},i=[],n=[],l=eo(1),o=s.compression?8:0,c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,v=e.FileIndex[0],g=[],b=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(v=e.FileIndex[c]).size&&v.content&&"Sh33tJ5"!=m){var x=u,y=eo(m.length);for(d=0;d<m.length;++d)y.write_shift(1,127&m.charCodeAt(d));y=y.slice(0,y.l),g[h]=cn.buf(v.content,0);var S=v.content;8==o&&(a=S,S=p?p.deflateRawSync(a):$(a)),(l=eo(30)).write_shift(4,67324752),l.write_shift(2,20),l.write_shift(2,0),l.write_shift(2,o),v.mt?r(l,v.mt):l.write_shift(4,0),l.write_shift(-4,g[h]),l.write_shift(4,S.length),l.write_shift(4,v.content.length),l.write_shift(2,y.length),l.write_shift(2,0),u+=l.length,i.push(l),u+=y.length,i.push(y),u+=S.length,i.push(S),(l=eo(46)).write_shift(4,33639248),l.write_shift(2,0),l.write_shift(2,20),l.write_shift(2,0),l.write_shift(2,o),l.write_shift(4,0),l.write_shift(-4,g[h]),l.write_shift(4,S.length),l.write_shift(4,v.content.length),l.write_shift(2,y.length),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(4,0),l.write_shift(4,x),b+=l.l,n.push(l),b+=y.length,n.push(y),++h}return(l=eo(22)).write_shift(4,101010256),l.write_shift(2,0),l.write_shift(2,0),l.write_shift(2,h),l.write_shift(2,h),l.write_shift(4,b),l.write_shift(4,u),l.write_shift(2,0),mi([mi(i),mi(n),l])}(e,a);var s=function(e){for(var t=0,a=0,s=0;s<e.FileIndex.length;++s){var r=e.FileIndex[s];if(r.content){var i=r.content.length;i>0&&(i<4096?t+=i+63>>6:a+=i+511>>9)}}for(var n=e.FullPaths.length+3>>2,l=t+127>>7,o=(t+7>>3)+a+n+l,c=o+127>>7,d=c<=109?0:Math.ceil((c-109)/127);o+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,l,n,a,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),i=eo(s[7]<<9),n=0,l=0;for(n=0;n<8;++n)i.write_shift(1,x[n]);for(n=0;n<8;++n)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),n=0;n<3;++n)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,s[2]),i.write_shift(4,s[0]+s[1]+s[2]+s[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,s[3]?s[0]+s[1]+s[2]-1:g),i.write_shift(4,s[3]),i.write_shift(-4,s[1]?s[0]-1:g),i.write_shift(4,s[1]),n=0;n<109;++n)i.write_shift(-4,n<s[2]?s[1]+n:-1);if(s[1])for(l=0;l<s[1];++l){for(;n<236+127*l;++n)i.write_shift(-4,n<s[2]?s[1]+n:-1);i.write_shift(-4,l===s[1]-1?g:l+1)}var o=function(e){for(l+=e;n<l-1;++n)i.write_shift(-4,n+1);e&&(++n,i.write_shift(-4,g))};for(l=n=0,l+=s[1];n<l;++n)i.write_shift(-4,S.DIFSECT);for(l+=s[2];n<l;++n)i.write_shift(-4,S.FATSECT);o(s[3]),o(s[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=l,o(d+511>>9)));for(o(s[6]+7>>3);511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(l=n=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=l,o(d+63>>6)));for(;511&i.l;)i.write_shift(-4,S.ENDOFCHAIN);for(n=0;n<s[4]<<2;++n){var h=e.FullPaths[n];if(h&&0!==h.length){u=e.FileIndex[n],0===n&&(u.start=u.size?u.start-1:g);var m=0===n&&a.root||u.name;if(d=2*(m.length+1),i.write_shift(64,m,"utf16le"),i.write_shift(2,d),i.write_shift(1,u.type),i.write_shift(1,u.color),i.write_shift(-4,u.L),i.write_shift(-4,u.R),i.write_shift(-4,u.C),u.clsid)i.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,u.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,u.start),i.write_shift(4,u.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(n=1;n<e.FileIndex.length;++n)if((u=e.FileIndex[n]).size>=4096)if(i.l=u.start+1<<9,li&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(n=1;n<e.FileIndex.length;++n)if((u=e.FileIndex[n]).size>0&&u.size<4096)if(li&&Buffer.isBuffer(u.content))u.content.copy(i,i.l,0,u.size),i.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)i.write_shift(1,u.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(li)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var p,v=64,g=-2,b="d0cf11e0a1b11ae1",x=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:g,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function w(e){for(var t=new Array(e.length),a=0;a<e.length;++a)t[a]=String.fromCharCode(e[a]);return t.join("")}for(var T,k,D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],E=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],N="undefined"!=typeof Uint8Array,A=N?new Uint8Array(256):[],I=0;I<256;++I)A[I]=(void 0,255&((k=139536&((T=I)<<1|T<<11)|558144&(T<<5|T<<15))>>16|k>>8|k));function j(e,t){var a=A[255&e];return t<=8?a>>>8-t:(a=a<<8|A[e>>8&255],t<=16?a>>>16-t:(a=a<<8|A[e>>16&255])>>>24-t)}function _(e,t){var a=7&t,s=t>>>3;return(e[s]|(a<=6?0:e[s+1]<<8))>>>a&3}function O(e,t){var a=7&t,s=t>>>3;return(e[s]|(a<=5?0:e[s+1]<<8))>>>a&7}function L(e,t){var a=7&t,s=t>>>3;return(e[s]|(a<=3?0:e[s+1]<<8))>>>a&31}function F(e,t){var a=7&t,s=t>>>3;return(e[s]|(a<=1?0:e[s+1]<<8))>>>a&127}function M(e,t,a){var s=7&t,r=t>>>3,i=(1<<a)-1,n=e[r]>>>s;return a<8-s?n&i:(n|=e[r+1]<<8-s,a<16-s?n&i:(n|=e[r+2]<<16-s,a<24-s?n&i:(n|=e[r+3]<<24-s)&i))}function R(e,t,a){var s=7&t,r=t>>>3;return s<=5?e[r]|=(7&a)<<s:(e[r]|=a<<s&255,e[r+1]=(7&a)>>8-s),t+3}function P(e,t,a){return a=(1&a)<<(7&t),e[t>>>3]|=a,t+1}function U(e,t,a){var s=t>>>3;return a<<=7&t,e[s]|=255&a,a>>>=8,e[s+1]=a,t+8}function B(e,t,a){var s=t>>>3;return a<<=7&t,e[s]|=255&a,a>>>=8,e[s+1]=255&a,e[s+2]=a>>>8,t+16}function G(e,t){var a=e.length,s=2*a>t?2*a:t+5,r=0;if(a>=t)return e;if(li){var i=di(s);if(e.copy)e.copy(i);else for(;r<e.length;++r)i[r]=e[r];return i}if(N){var n=new Uint8Array(s);if(n.set)n.set(e);else for(;r<a;++r)n[r]=e[r];return n}return e.length=s,e}function V(e){for(var t=new Array(e),a=0;a<e;++a)t[a]=0;return t}function W(e,t,a){var s=1,r=0,i=0,n=0,l=0,o=e.length,c=N?new Uint16Array(32):V(32);for(i=0;i<32;++i)c[i]=0;for(i=o;i<a;++i)e[i]=0;o=e.length;var d=N?new Uint16Array(o):V(o);for(i=0;i<o;++i)c[r=e[i]]++,s<r&&(s=r),d[i]=0;for(c[0]=0,i=1;i<=s;++i)c[i+16]=l=l+c[i-1]<<1;for(i=0;i<o;++i)0!=(l=e[i])&&(d[i]=c[l+16]++);var u=0;for(i=0;i<o;++i)if(0!=(u=e[i]))for(l=j(d[i],s)>>s-u,n=(1<<s+4-u)-1;n>=0;--n)t[l|n<<u]=15&u|i<<4;return s}var H=N?new Uint16Array(512):V(512),z=N?new Uint16Array(32):V(32);if(!N){for(var Y=0;Y<512;++Y)H[Y]=0;for(Y=0;Y<32;++Y)z[Y]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,z,32);var a=[];for(t=0;t<=143;t++)a.push(8);for(;t<=255;t++)a.push(9);for(;t<=279;t++)a.push(7);for(;t<=287;t++)a.push(8);W(a,H,288)}();var K=function(){for(var e=N?new Uint8Array(32768):[],t=0,a=0;t<E.length-1;++t)for(;a<E[t+1];++a)e[a]=t;for(;a<32768;++a)e[a]=29;var s=N?new Uint8Array(259):[];for(t=0,a=0;t<C.length-1;++t)for(;a<C[t+1];++a)s[a]=t;return function(t,a){return t.length<8?function(e,t){for(var a=0;a<e.length;){var s=Math.min(65535,e.length-a),r=a+s==e.length;for(t.write_shift(1,+r),t.write_shift(2,s),t.write_shift(2,65535&~s);s-- >0;)t[t.l++]=e[a++]}return t.l}(t,a):function(t,a){for(var r=0,i=0,n=N?new Uint16Array(32768):[];i<t.length;){var l=Math.min(65535,t.length-i);if(l<10){for(7&(r=R(a,r,+!(i+l!=t.length)))&&(r+=8-(7&r)),a.l=r/8|0,a.write_shift(2,l),a.write_shift(2,65535&~l);l-- >0;)a[a.l++]=t[i++];r=8*a.l}else{r=R(a,r,+!(i+l!=t.length)+2);for(var o=0;l-- >0;){var c=t[i],d=-1,u=0;if((d=n[o=32767&(o<<5^c)])&&((d|=-32768&i)>i&&(d-=32768),d<i))for(;t[d+u]==t[i+u]&&u<250;)++u;if(u>2){(c=s[u])<=22?r=U(a,r,A[c+1]>>1)-1:(U(a,r,3),U(a,r+=5,A[c-23]>>5),r+=3);var h=c<8?0:c-4>>2;h>0&&(B(a,r,u-C[c]),r+=h),c=e[i-d],r=U(a,r,A[c]>>3),r-=3;var f=c<4?0:c-2>>1;f>0&&(B(a,r,i-d-E[c]),r+=f);for(var m=0;m<u;++m)n[o]=32767&i,o=32767&(o<<5^t[i]),++i;l-=u-1}else c<=143?c+=48:r=P(a,r,1),r=U(a,r,A[c]),n[o]=32767&i,++i}r=U(a,r,0)-1}}return a.l=(r+7)/8|0,a.l}(t,a)}}();function $(e){var t=eo(50+Math.floor(1.1*e.length)),a=K(e,t);return t.slice(0,a)}var q=N?new Uint16Array(32768):V(32768),J=N?new Uint16Array(32768):V(32768),X=N?new Uint16Array(128):V(128),Z=1,Q=1;function ee(e,t){var a=L(e,t)+257,s=L(e,t+=5)+1,r=function(e,t){var a=7&t,s=t>>>3;return(e[s]|(a<=4?0:e[s+1]<<8))>>>a&15}(e,t+=5)+4;t+=4;for(var i=0,n=N?new Uint8Array(19):V(19),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=1,c=N?new Uint8Array(8):V(8),d=N?new Uint8Array(8):V(8),u=n.length,h=0;h<r;++h)n[D[h]]=i=O(e,t),o<i&&(o=i),c[i]++,t+=3;var f=0;for(c[0]=0,h=1;h<=o;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=n[h])&&(l[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=n[h])){f=A[l[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)X[f|p<<m]=7&m|h<<3}var v=[];for(o=1;v.length<a+s;)switch(t+=7&(f=X[F(e,t)]),f>>>=3){case 16:for(i=3+_(e,t),t+=2,f=v[v.length-1];i-- >0;)v.push(f);break;case 17:for(i=3+O(e,t),t+=3;i-- >0;)v.push(0);break;case 18:for(i=11+F(e,t),t+=7;i-- >0;)v.push(0);break;default:v.push(f),o<f&&(o=f)}var g=v.slice(0,a),b=v.slice(a);for(h=a;h<286;++h)g[h]=0;for(h=s;h<30;++h)b[h]=0;return Z=W(g,q,286),Q=W(b,J,30),t}function te(e,t){var a=function(e,t){if(3==e[0]&&!(3&e[1]))return[ci(t),2];for(var a=0,s=0,r=di(t||1<<18),i=0,n=r.length>>>0,l=0,o=0;!(1&s);)if(s=O(e,a),a+=3,s>>>1!=0)for(s>>1==1?(l=9,o=5):(a=ee(e,a),l=Z,o=Q);;){!t&&n<i+32767&&(n=(r=G(r,i+32767)).length);var c=M(e,a,l),d=s>>>1==1?H[c]:q[c];if(a+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=i+C[d];u>0&&(h+=M(e,a,u),a+=u),c=M(e,a,o),a+=15&(d=s>>>1==1?z[c]:J[c]);var f=(d>>>=4)<4?0:d-2>>1,m=E[d];for(f>0&&(m+=M(e,a,f),a+=f),!t&&n<h&&(n=(r=G(r,h+100)).length);i<h;)r[i]=r[i-m],++i}else r[i++]=d}else{7&a&&(a+=8-(7&a));var p=e[a>>>3]|e[1+(a>>>3)]<<8;if(a+=32,p>0)for(!t&&n<i+p&&(n=(r=G(r,i+p)).length);p-- >0;)r[i++]=e[a>>>3],a+=8}return t?[r,a+7>>>3]:[r.slice(0,i),a+7>>>3]}(e.slice(e.l||0),t);return e.l+=a[1],a[0]}function ae(e,t){if(!e)throw new Error(t)}function se(e,t){var a=e;Zl(a,0);var s={FileIndex:[],FullPaths:[]};h(s,{root:t.root});for(var r=a.length-4;(80!=a[r]||75!=a[r+1]||5!=a[r+2]||6!=a[r+3])&&r>=0;)--r;a.l=r+4,a.l+=4;var n=a.read_shift(2);a.l+=6;var l=a.read_shift(4);for(a.l=l,r=0;r<n;++r){a.l+=20;var o=a.read_shift(4),c=a.read_shift(4),d=a.read_shift(2),u=a.read_shift(2),f=a.read_shift(2);a.l+=8;var m=a.read_shift(4),p=i(a.slice(a.l+d,a.l+d+u));a.l+=d+u+f;var v=a.l;a.l=m+4,re(a,o,c,s,p),a.l=v}return s}function re(e,t,a,s,r){e.l+=2;var n=e.read_shift(2),l=e.read_shift(2),o=function(e){var t=65535&e.read_shift(2),a=65535&e.read_shift(2),s=new Date,r=31&a,i=15&(a>>>=5);a>>>=4,s.setMilliseconds(0),s.setFullYear(a+1980),s.setMonth(i-1),s.setDate(r);var n=31&t,l=63&(t>>>=5);return t>>>=6,s.setHours(t),s.setMinutes(l),s.setSeconds(n<<1),s}(e);if(8257&n)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var v=i(e.slice(e.l,e.l+h));(v[21589]||{}).mt&&(o=v[21589].mt),((r||{})[21589]||{}).mt&&(o=r[21589].mt)}e.l+=h;var g=e.slice(e.l,e.l+c);switch(l){case 8:g=function(e,t){if(!p)return te(e,t);var a=new(0,p.InflateRaw),s=a._processChunk(e.slice(e.l),a._finishFlushFlag);return e.l+=a.bytesRead,s}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var b=!1;8&n&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&ae(b,"Bad compressed size: "+t+" != "+c),d!=a&&ae(b,"Bad uncompressed size: "+a+" != "+d),de(s,f,g,{unsafe:!0,mt:o})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ne(e,t){if(e.ctype)return e.ctype;var a=e.name||"",s=a.match(/\.([^\.]+)$/);return s&&ie[s[1]]||t&&(s=(a=t).match(/[\.\\]([^\.\\])+$/))&&ie[s[1]]?ie[s[1]]:"application/octet-stream"}function le(e){for(var t=ii(e),a=[],s=0;s<t.length;s+=76)a.push(t.slice(s,s+76));return a.join("\r\n")+"\r\n"}function oe(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var a=[],s=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),r=0;r<s.length;++r){var i=s[r];if(0!=i.length)for(var n=0;n<i.length;){var l=76,o=i.slice(n,n+l);"="==o.charAt(l-1)?l--:"="==o.charAt(l-2)?l-=2:"="==o.charAt(l-3)&&(l-=3),o=i.slice(n,n+l),(n+=l)<i.length&&(o+="="),a.push(o)}else a.push("")}return a.join("\r\n")}function ce(e,t,a){for(var s,r="",i="",n="",l=0;l<10;++l){var o=t[l];if(!o||o.match(/^\s*$/))break;var c=o.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":r=c[2].trim();break;case"content-type":n=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++l,i.toLowerCase()){case"base64":s=ui(ni(t.slice(l).join("")));break;case"quoted-printable":s=function(e){for(var t=[],a=0;a<e.length;++a){for(var s=e[a];a<=e.length&&"="==s.charAt(s.length-1);)s=s.slice(0,s.length-1)+e[++a];t.push(s)}for(var r=0;r<t.length;++r)t[r]=t[r].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return ui(t.join("\r\n"))}(t.slice(l));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var d=de(e,r.slice(a.length),s,{unsafe:!0});n&&(d.ctype=n)}function de(e,t,a,r){var i=r&&r.unsafe;i||h(e);var n=!i&&dn.find(e,t);if(!n){var l=e.FullPaths[0];t.slice(0,l.length)==l?l=t:("/"!=l.slice(-1)&&(l+="/"),l=(l+t).replace("//","/")),n={name:s(t),type:2},e.FileIndex.push(n),e.FullPaths.push(l),i||dn.utils.cfb_gc(e)}return n.content=a,n.size=a?a.length:0,r&&(r.CLSID&&(n.clsid=r.CLSID),r.mt&&(n.mt=r.mt),r.ct&&(n.ct=r.ct)),n}return t.find=function(e,t){var a=e.FullPaths.map((function(e){return e.toUpperCase()})),s=a.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),r=!1;47===t.charCodeAt(0)?(r=!0,t=a[0].slice(0,-1)+t):r=-1!==t.indexOf("/");var i=t.toUpperCase(),n=!0===r?a.indexOf(i):s.indexOf(i);if(-1!==n)return e.FileIndex[n];var l=!i.match(vi);for(i=i.replace(pi,""),l&&(i=i.replace(vi,"!")),n=0;n<a.length;++n){if((l?a[n].replace(vi,"!"):a[n]).replace(pi,"")==i)return e.FileIndex[n];if((l?s[n].replace(vi,"!"):s[n]).replace(pi,"")==i)return e.FileIndex[n]}return null},t.read=function(t,a){var s=a&&a.type;switch(s||li&&Buffer.isBuffer(t)&&(s="buffer"),s||"base64"){case"file":return function(t,a){return n(),l(e.readFileSync(t),a)}(t,a);case"base64":return l(ui(ni(t)),a);case"binary":return l(ui(t),a)}return l(t,a)},t.parse=l,t.write=function(t,a){var s=m(t,a);switch(a&&a.type||"buffer"){case"file":return n(),e.writeFileSync(a.filename,s),s;case"binary":return"string"==typeof s?s:w(s);case"base64":return ii("string"==typeof s?s:w(s));case"buffer":if(li)return Buffer.isBuffer(s)?s:oi(s);case"array":return"string"==typeof s?ui(s):s}return s},t.writeFile=function(t,a,s){n();var r=m(t,s);e.writeFileSync(a,r)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var a=dn.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex.splice(s,1),e.FullPaths.splice(s,1),!0;return!1},cfb_mov:function(e,t,a){h(e);var r=dn.find(e,t);if(r)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==r)return e.FileIndex[i].name=s(a),e.FullPaths[i]=a,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Yl,CheckField:Xl,prep_blob:Zl,bconcat:mi,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(a){}},_deflateRaw:$,_inflateRaw:te,consts:S},t}();function un(e){for(var t=Object.keys(e),a=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&a.push(t[s]);return a}function hn(e){for(var t=[],a=un(e),s=0;s!==a.length;++s)t[e[a[s]]]=a[s];return t}var fn=new Date(1899,11,30,0,0,0);function mn(e,t){var a=e.getTime();return t&&(a-=1263168e5),(a-(fn.getTime()+6e4*(e.getTimezoneOffset()-fn.getTimezoneOffset())))/864e5}var pn=new Date,vn=fn.getTime()+6e4*(pn.getTimezoneOffset()-fn.getTimezoneOffset()),gn=pn.getTimezoneOffset();function bn(e){var t=new Date;return t.setTime(24*e*60*60*1e3+vn),t.getTimezoneOffset()!==gn&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-gn)),t}function xn(e){var t=0,a=0,s=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=r.length;++i)if(r[i]){switch(a=1,i>3&&(s=!0),r[i].slice(r[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[i].slice(r[i].length-1));case"D":a*=24;case"H":a*=60;case"M":if(!s)throw new Error("Unsupported ISO Duration Field: M");a*=60}t+=a*parseInt(r[i],10)}return t}var yn=new Date("2017-02-19T19:06:09.000Z"),Sn=isNaN(yn.getFullYear())?new Date("2/19/17"):yn,wn=2017==Sn.getFullYear();function Tn(e,t){var a=new Date(e);if(wn)return t>0?a.setTime(a.getTime()+60*a.getTimezoneOffset()*1e3):t<0&&a.setTime(a.getTime()-60*a.getTimezoneOffset()*1e3),a;if(e instanceof Date)return e;if(1917==Sn.getFullYear()&&!isNaN(a.getFullYear())){var s=a.getFullYear();return e.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function kn(e,t){if(li&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return ol(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return ol(Qr(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return ol(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return ol(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,(function(e){return a[e]||e}))}catch(i){}for(var s=[],r=0;r!=e.length;++r)s.push(String.fromCharCode(e[r]));return s.join("")}function Dn(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=Dn(e[a]));return t}function Cn(e,t){for(var a="";a.length<t;)a+=e;return a}function En(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var a=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return a*=100,""}));return isNaN(t=Number(s))?(s=s.replace(/[(](.*)[)]/,(function(e,t){return a=-a,t})),isNaN(t=Number(s))?t:t/a):t/a}var Nn=["january","february","march","april","may","june","july","august","september","october","november","december"];function An(e){var t=new Date(e),a=new Date(NaN),s=t.getYear(),r=t.getMonth(),i=t.getDate();if(isNaN(i))return a;var n=e.toLowerCase();if(n.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((n=n.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Nn.indexOf(n))return a}else if(n.match(/[a-z]/))return a;return s<0||s>8099?a:(r>0||i>1)&&101!=s?t:e.match(/[^-0-9:,\/\\]/)?a:t}var In=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,a,s){if(e||"string"==typeof a)return t.split(a);for(var r=t.split(a),i=[r[0]],n=1;n<r.length;++n)i.push(s),i.push(r[n]);return i}}();function jn(e){return e?e.content&&e.type?kn(e.content,!0):e.data?ti(e.data):e.asNodeBuffer&&li?ti(e.asNodeBuffer().toString("binary")):e.asBinary?ti(e.asBinary()):e._data&&e._data.getContent?ti(kn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function _n(e){if(!e)return null;if(e.data)return Zr(e.data);if(e.asNodeBuffer&&li)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?Zr(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function On(e,t){for(var a=e.FullPaths||un(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),r=s.replace(/\\/g,"/"),i=0;i<a.length;++i){var n=a[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==n||r==n)return e.files?e.files[a[i]]:e.FileIndex[i]}return null}function Ln(e,t){var a=On(e,t);if(null==a)throw new Error("Cannot find file "+t+" in zip");return a}function Fn(e,t,a){if(!a)return(s=Ln(e,t))&&".bin"===s.name.slice(-4)?_n(s):jn(s);var s;if(!t)return null;try{return Fn(e,t)}catch(r){return null}}function Mn(e,t,a){if(!a)return jn(Ln(e,t));if(!t)return null;try{return Mn(e,t)}catch(s){return null}}function Rn(e,t,a){if(!a)return _n(Ln(e,t));if(!t)return null;try{return Rn(e,t)}catch(s){return null}}function Pn(e){for(var t=e.FullPaths||un(e.files),a=[],s=0;s<t.length;++s)"/"!=t[s].slice(-1)&&a.push(t[s].replace(/^Root Entry[\/]/,""));return a.sort()}function Un(e,t){switch(t.type){case"base64":return dn.read(e,{type:"base64"});case"binary":return dn.read(e,{type:"binary"});case"buffer":case"array":return dn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Bn(e,t){if("/"==e.charAt(0))return e.slice(1);var a=t.split("/");"/"!=t.slice(-1)&&a.pop();for(var s=e.split("/");0!==s.length;){var r=s.shift();".."===r?a.pop():"."!==r&&a.push(r)}return a.join("/")}var Gn='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Vn=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Wn=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Hn=Gn.match(Wn)?Wn:/<[^>]*>/g,zn=/<\w*:/,Yn=/<(\/?)\w+:/;function Kn(e,t,a){for(var s={},r=0,i=0;r!==e.length&&32!==(i=e.charCodeAt(r))&&10!==i&&13!==i;++r);if(t||(s[0]=e.slice(0,r)),r===e.length)return s;var n=e.match(Vn),l=0,o="",c=0,d="",u="",h=1;if(n)for(c=0;c!=n.length;++c){for(u=n[c],i=0;i!=u.length&&61!==u.charCodeAt(i);++i);for(d=u.slice(0,i).trim();32==u.charCodeAt(i+1);)++i;for(h=34==(r=u.charCodeAt(i+1))||39==r?1:0,o=u.slice(i+1+h,u.length-h),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=o,a||(s[d.toLowerCase()]=o);else{var f=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1);if(s[f]&&"ext"==d.slice(l-3,l))continue;s[f]=o,a||(s[f.toLowerCase()]=o)}}return s}function $n(e){return e.replace(Yn,"<$1")}var qn={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Jn=hn(qn),Xn=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function a(s){var r=s+"",i=r.indexOf("<![CDATA[");if(-1==i)return r.replace(e,(function(e,t){return qn[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var n=r.indexOf("]]>");return a(r.slice(0,i))+r.slice(i+9,n)+a(r.slice(n+3))}}(),Zn=/[&<>'"]/g,Qn=/[\u0000-\u001f]/g;function el(e){return(e+"").replace(Zn,(function(e){return Jn[e]})).replace(/\n/g,"<br/>").replace(Qn,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var tl=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(a){return a.replace(e,t)}}();function al(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sl(e){for(var t="",a=0,s=0,r=0,i=0,n=0,l=0;a<e.length;)(s=e.charCodeAt(a++))<128?t+=String.fromCharCode(s):(r=e.charCodeAt(a++),s>191&&s<224?(n=(31&s)<<6,n|=63&r,t+=String.fromCharCode(n)):(i=e.charCodeAt(a++),s<240?t+=String.fromCharCode((15&s)<<12|(63&r)<<6|63&i):(l=((7&s)<<18|(63&r)<<12|(63&i)<<6|63&(n=e.charCodeAt(a++)))-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(1023&l)))));return t}function rl(e){var t,a,s,r=ci(2*e.length),i=1,n=0,l=0;for(a=0;a<e.length;a+=i)i=1,(s=e.charCodeAt(a))<128?t=s:s<224?(t=64*(31&s)+(63&e.charCodeAt(a+1)),i=2):s<240?(t=4096*(15&s)+64*(63&e.charCodeAt(a+1))+(63&e.charCodeAt(a+2)),i=3):(i=4,t=262144*(7&s)+4096*(63&e.charCodeAt(a+1))+64*(63&e.charCodeAt(a+2))+(63&e.charCodeAt(a+3)),l=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==l&&(r[n++]=255&l,r[n++]=l>>>8,l=0),r[n++]=t%256,r[n++]=t>>>8;return r.slice(0,n).toString("ucs2")}function il(e){return oi(e,"binary").toString("utf8")}var nl="foo bar baz",ll=li&&(il(nl)==sl(nl)&&il||rl(nl)==sl(nl)&&rl)||sl,ol=li?function(e){return oi(e,"utf8").toString("binary")}:function(e){for(var t=[],a=0,s=0,r=0;a<e.length;)switch(s=e.charCodeAt(a++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(63&s)));break;case s>=55296&&s<57344:s-=55296,r=e.charCodeAt(a++)-56320+(s<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(63&s)))}return t.join("")},cl=function(){var e={};return function(t,a){var s=t+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),dl=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),ul=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),hl=/<\/?(?:vt:)?variant>/g,fl=/<(?:vt:)([^>]*)>([\s\S]*)</;function ml(e,t){var a=Kn(e),s=e.match(ul(a.baseType))||[],r=[];if(s.length!=a.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+a.size);return r}return s.forEach((function(e){var t=e.replace(hl,"").match(fl);t&&r.push({v:ll(t[2]),t:t[1]})})),r}var pl=/(^\s|\s$|\n)/;function vl(e){if(li&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return ll(hi(fi(e)));throw new Error("Bad input format: expected Buffer or string")}var gl=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,bl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xl=function(e){for(var t=[],a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,r=e[0][a].length;s<r;s+=10240)t.push.apply(t,e[0][a].slice(s,s+10240));return t},yl=li?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:oi(e)}))):xl(e)}:xl,Sl=function(e,t,a){for(var s=[],r=t;r<a;r+=2)s.push(String.fromCharCode(Gl(e,r)));return s.join("").replace(pi,"")},wl=li?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf16le",t,a).replace(pi,""):Sl(e,t,a)}:Sl,Tl=function(e,t,a){for(var s=[],r=t;r<t+a;++r)s.push(("0"+e[r].toString(16)).slice(-2));return s.join("")},kl=li?function(e,t,a){return Buffer.isBuffer(e)?e.toString("hex",t,t+a):Tl(e,t,a)}:Tl,Dl=function(e,t,a){for(var s=[],r=t;r<a;r++)s.push(String.fromCharCode(Bl(e,r)));return s.join("")},Cl=li?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):Dl(e,t,a)}:Dl,El=function(e,t){var a=Wl(e,t);return a>0?Cl(e,t+4,t+4+a-1):""},Nl=El,Al=function(e,t){var a=Wl(e,t);return a>0?Cl(e,t+4,t+4+a-1):""},Il=Al,jl=function(e,t){var a=2*Wl(e,t);return a>0?Cl(e,t+4,t+4+a-1):""},_l=jl,Ol=function(e,t){var a=Wl(e,t);return a>0?wl(e,t+4,t+4+a):""},Ll=Ol,Fl=function(e,t){var a=Wl(e,t);return a>0?Cl(e,t+4,t+4+a):""},Ml=Fl,Rl=function(e,t){return function(e,t){for(var a=1-2*(e[t+7]>>>7),s=((127&e[t+7])<<4)+(e[t+6]>>>4&15),r=15&e[t+6],i=5;i>=0;--i)r=256*r+e[t+i];return 2047==s?0==r?a*(1/0):NaN:(0==s?s=-1022:(s-=1023,r+=Math.pow(2,52)),a*Math.pow(2,s-52)*r)}(e,t)},Pl=Rl,Ul=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};li&&(Nl=function(e,t){if(!Buffer.isBuffer(e))return El(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},Il=function(e,t){if(!Buffer.isBuffer(e))return Al(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},_l=function(e,t){if(!Buffer.isBuffer(e))return jl(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},Ll=function(e,t){if(!Buffer.isBuffer(e))return Ol(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},Ml=function(e,t){if(!Buffer.isBuffer(e))return Fl(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},Pl=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Rl(e,t)},Ul=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var Bl=function(e,t){return e[t]},Gl=function(e,t){return 256*e[t+1]+e[t]},Vl=function(e,t){var a=256*e[t+1]+e[t];return a<32768?a:-1*(65535-a+1)},Wl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Hl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zl=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Yl(e,t){var a,s,r,i,n,l,o="",c=[];switch(t){case"dbcs":if(l=this.l,li&&Buffer.isBuffer(this))o=this.slice(this.l,this.l+2*e).toString("utf16le");else for(n=0;n<e;++n)o+=String.fromCharCode(Gl(this,l)),l+=2;e*=2;break;case"utf8":o=Cl(this,this.l,this.l+e);break;case"utf16le":e*=2,o=wl(this,this.l,this.l+e);break;case"wstr":return Yl.call(this,e,"dbcs");case"lpstr-ansi":o=Nl(this,this.l),e=4+Wl(this,this.l);break;case"lpstr-cp":o=Il(this,this.l),e=4+Wl(this,this.l);break;case"lpwstr":o=_l(this,this.l),e=4+2*Wl(this,this.l);break;case"lpp4":e=4+Wl(this,this.l),o=Ll(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Wl(this,this.l),o=Ml(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,o="";0!==(r=Bl(this,this.l+e++));)c.push(ai(r));o=c.join("");break;case"_wstr":for(e=0,o="";0!==(r=Gl(this,this.l+e));)c.push(ai(r)),e+=2;e+=2,o=c.join("");break;case"dbcs-cont":for(o="",l=this.l,n=0;n<e;++n){if(this.lens&&-1!==this.lens.indexOf(l))return r=Bl(this,l),this.l=l+1,i=Yl.call(this,e-n,r?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(ai(Gl(this,l))),l+=2}o=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(o="",l=this.l,n=0;n!=e;++n){if(this.lens&&-1!==this.lens.indexOf(l))return r=Bl(this,l),this.l=l+1,i=Yl.call(this,e-n,r?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(ai(Bl(this,l))),l+=1}o=c.join("");break;default:switch(e){case 1:return a=Bl(this,this.l),this.l++,a;case 2:return a=("i"===t?Vl:Gl)(this,this.l),this.l+=2,a;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(s=Wl(this,this.l),this.l+=4,s):(a=(e>0?Hl:zl)(this,this.l),this.l+=4,a);case 8:case-8:if("f"===t)return s=8==e?Pl(this,this.l):Pl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:o=kl(this,this.l,e)}}return this.l+=e,o}var Kl=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255,e[a+2]=t>>>16&255,e[a+3]=t>>>24&255},$l=function(e,t,a){e[a]=255&t,e[a+1]=t>>8&255,e[a+2]=t>>16&255,e[a+3]=t>>24&255},ql=function(e,t,a){e[a]=255&t,e[a+1]=t>>>8&255};function Jl(e,t,a){var s=0,r=0;if("dbcs"===a){for(r=0;r!=t.length;++r)ql(this,t.charCodeAt(r),this.l+2*r);s=2*t.length}else if("sbcs"===a){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=255&t.charCodeAt(r);s=t.length}else{if("hex"===a){for(;r<e;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===a){var i=Math.min(this.l+e,this.length);for(r=0;r<Math.min(t.length,e);++r){var n=t.charCodeAt(r);this[this.l++]=255&n,this[this.l++]=n>>8}for(;this.l<i;)this[this.l++]=0;return this}switch(e){case 1:s=1,this[this.l]=255&t;break;case 2:s=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:s=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:s=4,Kl(this,t,this.l);break;case 8:if(s=8,"f"===a){!function(e,t,a){var s=(t<0||1/t==-1/0?1:0)<<7,r=0,i=0,n=s?-t:t;isFinite(n)?0==n?r=i=0:(r=Math.floor(Math.log(n)/Math.LN2),i=n*Math.pow(2,52-r),r<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?r=-1022:(i-=Math.pow(2,52),r+=1023)):(r=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[a+l]=255&i;e[a+6]=(15&r)<<4|15&i,e[a+7]=r>>4|s}(this,t,this.l);break}case 16:break;case-4:s=4,$l(this,t,this.l)}}return this.l+=s,this}function Xl(e,t){var a=kl(this,this.l,e.length>>1);if(a!==e)throw new Error(t+"Expected "+e+" saw "+a);this.l+=e.length>>1}function Zl(e,t){e.l=t,e.read_shift=Yl,e.chk=Xl,e.write_shift=Jl}function Ql(e,t){e.l+=t}function eo(e){var t=ci(e);return Zl(t,0),t}function to(e,t,a){if(e){var s,r,i;Zl(e,e.l||0);for(var n=e.length,l=0,o=0;e.l<n;){128&(l=e.read_shift(1))&&(l=(127&l)+((127&e.read_shift(1))<<7));var c=Vh[l]||Vh[65535];for(i=127&(s=e.read_shift(1)),r=1;r<4&&128&s;++r)i+=(127&(s=e.read_shift(1)))<<7*r;o=e.l+i;var d=c.f&&c.f(e,i,a);if(e.l=o,t(d,c,l))return}}}function ao(){var e=[],t=li?256:2048,a=function(e){var t=eo(e);return Zl(t,0),t},s=a(t),r=function(){s&&(s.length>s.l&&((s=s.slice(0,s.l)).l=s.length),s.length>0&&e.push(s),s=null)},i=function(e){return s&&e<s.length-s.l?s:(r(),s=a(Math.max(e+1,t)))};return{next:i,push:function(e){r(),null==(s=e).l&&(s.l=s.length),i(t)},end:function(){return r(),mi(e)},_bufs:e}}function so(e,t,a){var s=Dn(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function ro(e,t,a){var s=Dn(e);return s.s=so(s.s,t.s,a),s.e=so(s.e,t.s,a),s}function no(e,t){if(e.cRel&&e.c<0)for(e=Dn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Dn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var a=mo(e);return e.cRel||null==e.cRel||(a=a.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(a=a.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")),a}function lo(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?no(e.s,t.biff)+":"+no(e.e,t.biff):(e.s.rRel?"":"$")+co(e.s.r)+":"+(e.e.rRel?"":"$")+co(e.e.r):(e.s.cRel?"":"$")+ho(e.s.c)+":"+(e.e.cRel?"":"$")+ho(e.e.c)}function oo(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function co(e){return""+(e+1)}function uo(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),a=0,s=0;s!==t.length;++s)a=26*a+t.charCodeAt(s)-64;return a-1}function ho(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fo(e){for(var t=0,a=0,s=0;s<e.length;++s){var r=e.charCodeAt(s);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(a=26*a+(r-64))}return{c:a-1,r:t-1}}function mo(e){for(var t=e.c+1,a="";t;t=(t-1)/26|0)a=String.fromCharCode((t-1)%26+65)+a;return a+(e.r+1)}function po(e){var t=e.indexOf(":");return-1==t?{s:fo(e),e:fo(e)}:{s:fo(e.slice(0,t)),e:fo(e.slice(t+1))}}function vo(e,t){return void 0===t||"number"==typeof t?vo(e.s,e.e):("string"!=typeof e&&(e=mo(e)),"string"!=typeof t&&(t=mo(t)),e==t?e:e+":"+t)}function go(e){var t={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,r=0,i=e.length;for(a=0;s<i&&!((r=e.charCodeAt(s)-64)<1||r>26);++s)a=26*a+r;for(t.s.c=--a,a=0;s<i&&!((r=e.charCodeAt(s)-48)<0||r>9);++s)a=10*a+r;if(t.s.r=--a,s===i||10!=r)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,a=0;s!=i&&!((r=e.charCodeAt(s)-64)<1||r>26);++s)a=26*a+r;for(t.e.c=--a,a=0;s!=i&&!((r=e.charCodeAt(s)-48)<0||r>9);++s)a=10*a+r;return t.e.r=--a,t}function bo(e,t,a){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),"e"==e.t?zo[e.v]||e.v:function(e,t){var a="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=sn(e.z,a?mn(t):t)}catch(s){}try{return e.w=sn((e.XF||{}).numFmtId||(a?14:0),a?mn(t):t)}catch(s){return""+t}}(e,null==t?e.v:t))}function xo(e,t){var a=t&&t.sheet?t.sheet:"Sheet1",s={};return s[a]=e,{SheetNames:[a],Sheets:s}}function yo(e,t,a){var s=a||{},r=e?Array.isArray(e):s.dense,i=e||(r?[]:{}),n=0,l=0;if(i&&null!=s.origin){if("number"==typeof s.origin)n=s.origin;else{var o="string"==typeof s.origin?fo(s.origin):s.origin;n=o.r,l=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=go(i["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==n&&(c.e.r=n=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(void 0!==t[u][h]){var f={v:t[u][h]},m=n+u,p=l+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!=typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(s.nullError)f.t="e",f.v=0;else{if(!s.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=s.dateNF||Ci[14],s.cellDates?(f.t="d",f.w=sn(f.z,mn(f.v))):(f.t="n",f.v=mn(f.v),f.w=sn(f.z,f.v))):f.t="s";else f=t[u][h];if(r)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(f.z=i[m][p].z),i[m][p]=f;else{var v=mo({c:p,r:m});i[v]&&i[v].z&&(f.z=i[v].z),i[v]=f}}}return c.s.c<1e7&&(i["!ref"]=vo(c)),i}function So(e,t){return yo(null,e,t)}function wo(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function To(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ko(e,t){var a=e.l,s=e.read_shift(1),r=wo(e),i=[],n={t:r,h:r};if(1&s){for(var l=e.read_shift(4),o=0;o!=l;++o)i.push(To(e));n.r=i}else n.r=[{ich:0,ifnt:0}];return e.l=a+t,n}var Do=ko;function Co(e){var t=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:a}}function Eo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var No=wo;function Ao(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var Io=wo,jo=Ao;function _o(e){var t=e.slice(e.l,e.l+4),a=1&t[0],s=2&t[0];e.l+=4;var r=0===s?Pl([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Hl(t,0)>>2;return a?r/100:r}function Oo(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Lo=Oo;function Fo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Mo(e,t){var a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Ro=80,Po=[Ro,81],Uo={1:{n:"CodePage",t:2},2:{n:"Category",t:Ro},3:{n:"PresentationFormat",t:Ro},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Ro},15:{n:"Company",t:Ro},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Ro},27:{n:"ContentStatus",t:Ro},28:{n:"Language",t:Ro},29:{n:"Version",t:Ro},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Bo={1:{n:"CodePage",t:2},2:{n:"Title",t:Ro},3:{n:"Subject",t:Ro},4:{n:"Author",t:Ro},5:{n:"Keywords",t:Ro},6:{n:"Comments",t:Ro},7:{n:"Template",t:Ro},8:{n:"LastAuthor",t:Ro},9:{n:"RevNumber",t:Ro},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Ro},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Go={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Vo=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Wo(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Ho=Dn(Wo([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),zo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Yo={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ko={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$o={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Jo(e,t){var a={"!id":{}};if(!e)return a;"/"!==t.charAt(0)&&(t="/"+t);var s={};return(e.match(Hn)||[]).forEach((function(e){var r=Kn(e);if("<Relationship"===r[0]){var i={};i.Type=r.Type,i.Target=r.Target,i.Id=r.Id,r.TargetMode&&(i.TargetMode=r.TargetMode);var n="External"===r.TargetMode?r.Target:Bn(r.Target,t);a[n]=i,s[r.Id]=i}})),a["!id"]=s,a}var Xo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Zo=function(){for(var e=new Array(Xo.length),t=0;t<Xo.length;++t){var a=Xo[t],s="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function Qo(e){var t={};e=ll(e);for(var a=0;a<Xo.length;++a){var s=Xo[a],r=e.match(Zo[a]);null!=r&&r.length>0&&(t[s[1]]=Xn(r[1])),"date"===s[2]&&t[s[1]]&&(t[s[1]]=Tn(t[s[1]]))}return t}var ec=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function tc(e,t,a,s){var r=[];if("string"==typeof e)r=ml(e,s);else for(var i=0;i<e.length;++i)r=r.concat(e[i].map((function(e){return{v:e}})));var n="string"==typeof t?ml(t,s).map((function(e){return e.v})):t,l=0,o=0;if(n.length>0)for(var c=0;c!==r.length;c+=2){switch(o=+r[c+1].v,r[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=o,a.SheetNames=n.slice(l,l+o);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=o,a.DefinedNames=n.slice(l,l+o);break;case"Charts":case"Diagramme":a.Chartsheets=o,a.ChartNames=n.slice(l,l+o)}l+=o}}var ac,sc=/<[^>]+>[^<]*/g,rc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function ic(e,t,a){ac||(ac=hn(rc)),e[t=ac[t]||t]=a}function nc(e){var t=e.read_shift(4),a=e.read_shift(4);return new Date(1e3*(a/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function lc(e,t,a){var s=e.l,r=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-s&3;)++e.l;return r}function oc(e,t,a){var s=e.read_shift(0,"lpwstr");return a&&(e.l+=4-(s.length+1&3)&3),s}function cc(e,t,a){return 31===t?oc(e):lc(e,0,a)}function dc(e,t,a){return cc(e,t,!1===a?0:4)}function uc(e){var t=e.l,a=mc(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[a,mc(e,3)]}function hc(e,t){for(var a=e.read_shift(4),s={},r=0;r!=a;++r){var i=e.read_shift(4),n=e.read_shift(4);s[i]=e.read_shift(n,1200===t?"utf16le":"utf8").replace(pi,"").replace(vi,"!"),1200===t&&n%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),s}function fc(e){var t=e.read_shift(4),a=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),a}function mc(e,t,a){var s,r=e.read_shift(2),i=a||{};if(e.l+=2,12!==t&&r!==t&&-1===Po.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&r)))throw new Error("Expected type "+t+" saw "+r);switch(12===t?r:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:return lc(e,0,4).replace(pi,"");case 31:return oc(e);case 64:return nc(e);case 65:return fc(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return dc(e,r,!i.raw).replace(pi,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return cc(e,t,0)}(e,r).replace(pi,"");case 4108:return function(e){for(var t=e.read_shift(4),a=[],s=0;s<t/2;++s)a.push(uc(e));return a}(e);case 4126:case 4127:return 4127==r?function(e){for(var t=e.read_shift(4),a=[],s=0;s!=t;++s){var r=e.l;a[s]=e.read_shift(0,"lpwstr").replace(pi,""),e.l-r&2&&(e.l+=2)}return a}(e):function(e){for(var t=e.read_shift(4),a=[],s=0;s!=t;++s)a[s]=e.read_shift(0,"lpstr-cp").replace(pi,"");return a}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function pc(e,t){var a=e.l,s=e.read_shift(4),r=e.read_shift(4),i=[],n=0,l=0,o=-1,c={};for(n=0;n!=r;++n){var d=e.read_shift(4),u=e.read_shift(4);i[n]=[d,u+a]}i.sort((function(e,t){return e[1]-t[1]}));var h={};for(n=0;n!=r;++n){if(e.l!==i[n][1]){var f=!0;if(n>0&&t)switch(t[i[n-1][0]].t){case 2:e.l+2===i[n][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=i[n][1]&&(e.l=i[n][1],f=!1)}if((!t||0==n)&&e.l<=i[n][1]&&(f=!1,e.l=i[n][1]),f)throw new Error("Read Error: Expected address "+i[n][1]+" at "+e.l+" :"+n)}if(t){var m=t[i[n][0]];if(h[m.n]=mc(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jr(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===i[n][0]){if(l=h.CodePage=mc(e,2),Jr(l),-1!==o){var p=e.l;e.l=i[o][1],c=hc(e,l),e.l=p}}else if(0===i[n][0]){if(0===l){o=n,e.l=i[n+1][1];continue}c=hc(e,l)}else{var v,g=c[i[n][0]];switch(e[e.l]){case 65:e.l+=4,v=fc(e);break;case 30:case 31:e.l+=4,v=dc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=bc(e,4);break;case 64:e.l+=4,v=Tn(nc(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=v}}return e.l=a+s,h}function vc(e,t,a){var s=e.content;if(!s)return{};Zl(s,0);var r,i,n,l,o=0;s.chk("feff","Byte Order: "),s.read_shift(2);var c=s.read_shift(4),d=s.read_shift(16);if(d!==dn.utils.consts.HEADER_CLSID&&d!==a)throw new Error("Bad PropertySet CLSID "+d);if(1!==(r=s.read_shift(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(i=s.read_shift(16),l=s.read_shift(4),1===r&&l!==s.l)throw new Error("Length mismatch: "+l+" !== "+s.l);2===r&&(n=s.read_shift(16),o=s.read_shift(4));var u,h=pc(s,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=i,1===r)return f;if(o-s.l==2&&(s.l+=2),s.l!==o)throw new Error("Length mismatch 2: "+s.l+" !== "+o);try{u=pc(s,null)}catch(p){}for(m in u)f[m]=u[m];return f.FMTID=[i,n],f}function gc(e,t){return e.read_shift(t),null}function bc(e,t){return 1===e.read_shift(t)}function xc(e){return e.read_shift(2,"u")}function yc(e,t){return function(e,t,a){for(var s=[],r=e.l+t;e.l<r;)s.push(a(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return s}(e,t,xc)}function Sc(e,t,a){var s=e.read_shift(a&&a.biff>=12?2:1),r="sbcs-cont";return a&&a.biff,a&&8!=a.biff?12==a.biff&&(r="wstr"):e.read_shift(1)&&(r="dbcs-cont"),a.biff>=2&&a.biff<=5&&(r="cpstr"),s?e.read_shift(s,r):""}function wc(e){var t,a=e.read_shift(2),s=e.read_shift(1),r=4&s,i=8&s,n=1+(1&s),l=0,o={};i&&(l=e.read_shift(2)),r&&(t=e.read_shift(4));var c=2==n?"dbcs-cont":"sbcs-cont",d=0===a?"":e.read_shift(a,c);return i&&(e.l+=4*l),r&&(e.l+=t),o.t=d,i||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function Tc(e,t,a){if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(t,"cpstr");if(a.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function kc(e,t,a){var s=e.read_shift(a&&2==a.biff?1:2);return 0===s?(e.l++,""):Tc(e,s,a)}function Dc(e,t,a){if(a.biff>5)return kc(e,0,a);var s=e.read_shift(1);return 0===s?(e.l++,""):e.read_shift(s,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Cc(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(pi,""):""}function Ec(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Nc(e,t){var a=Ec(e);return a[3]=0,a}function Ac(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Ic(e,t,a){var s=a.biff>8?4:2;return[e.read_shift(s),e.read_shift(s,"i"),e.read_shift(s,"i")]}function jc(e){return[e.read_shift(2),_o(e)]}function _c(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:a}}}function Oc(e){var t=e.read_shift(2),a=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:a}}}var Lc=Oc;function Fc(e){e.l+=4;var t=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[a,t,s]}function Mc(e){e.l+=2,e.l+=e.read_shift(2)}var Rc={0:Mc,4:Mc,5:Mc,6:Mc,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Mc,9:Mc,10:Mc,11:Mc,12:Mc,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Mc,15:Mc,16:Mc,17:Mc,18:Mc,19:Mc,20:Mc,21:Fc};function Pc(e,t){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),(t-=2)>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(t),a}function Uc(e,t,a){var s=0;a&&2==a.biff||(s=e.read_shift(2));var r=e.read_shift(2);return a&&2==a.biff&&(s=1-(r>>15),r&=32767),[{Unsynced:1&s,DyZero:(2&s)>>1,ExAsc:(4&s)>>2,ExDsc:(8&s)>>3},r]}var Bc=Dc;function Gc(e,t,a){var s=e.l+t,r=8!=a.biff&&a.biff?2:4,i=e.read_shift(r),n=e.read_shift(r),l=e.read_shift(2),o=e.read_shift(2);return e.l=s,{s:{r:i,c:l},e:{r:n,c:o}}}function Vc(e,t,a){var s=Ac(e);2!=a.biff&&9!=t||++e.l;var r=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return s.val=r,s.t=!0===r||!1===r?"b":"e",s}var Wc=function(e,t,a){return 0===t?"":Dc(e,0,a)};function Hc(e,t,a){var s,r=e.read_shift(2),i={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===a.sbcch&&(s=function(e,t,a){e.l+=4,t-=4;var s=e.l+t,r=Sc(e,0,a),i=e.read_shift(2);if(i!==(s-=e.l))throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,r}(e,t-2,a)),i.body=s||e.read_shift(t-2),"string"==typeof s&&(i.Name=s),i}var zc=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Yc(e,t,a){var s=e.l+t,r=e.read_shift(2),i=e.read_shift(1),n=e.read_shift(1),l=e.read_shift(a&&2==a.biff?1:2),o=0;(!a||a.biff>=5)&&(5!=a.biff&&(e.l+=2),o=e.read_shift(2),5==a.biff&&(e.l+=2),e.l+=4);var c=Tc(e,n,a);32&r&&(c=zc[c.charCodeAt(0)]);var d=s-e.l;a&&2==a.biff&&--d;var u=s!=e.l&&0!==l&&d>0?function(e,t,a,s){var r,i=e.l+t,n=Au(e,s,a);return i!==e.l&&(r=Nu(e,i-e.l,n,a)),[n,r]}(e,d,a,l):[];return{chKey:i,Name:c,itab:o,rgce:u}}function Kc(e,t,a){if(a.biff<8)return function(e,t,a){3==e[e.l+1]&&e[e.l]++;var s=Sc(e,0,a);return 3==s.charCodeAt(0)?s.slice(1):s}(e,0,a);for(var s=[],r=e.l+t,i=e.read_shift(a.biff>8?4:2);0!=i--;)s.push(Ic(e,a.biff,a));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return s}function $c(e,t,a){var s=Lc(e);switch(a.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,Fu(e,t,a)]}var qc={8:function(e,t){var a=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=a,{fmt:s}}};function Jc(e,t,a){if(!a.cellStyles)return Ql(e,t);var s=a&&a.biff>=12?4:2,r=e.read_shift(s),i=e.read_shift(s),n=e.read_shift(s),l=e.read_shift(s),o=e.read_shift(2);2==s&&(e.l+=2);var c={s:r,e:i,w:n,ixfe:l,flags:o};return(a.biff>=5||!a.biff)&&(c.level=o>>8&7),c}var Xc=Ac,Zc=yc,Qc=kc,ed=[2,3,48,49,131,139,140,245],td=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=hn({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(t,a){var s=a||{};s.dateNF||(s.dateNF="yyyymmdd");var r=So(function(t,a){var s=[],r=ci(1);switch(a.type){case"base64":r=ui(ni(t));break;case"binary":r=ui(t);break;case"buffer":case"array":r=t}Zl(r,0);var i=r.read_shift(1),n=!!(136&i),l=!1,o=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:l=!0,n=!0;break;case 140:o=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,d=521;2==i&&(c=r.read_shift(2)),r.l+=3,2!=i&&(c=r.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(d=r.read_shift(2));var u=r.read_shift(2),h=a.codepage||1252;2!=i&&(r.l+=16,r.read_shift(1),0!==r[r.l]&&(h=e[r[r.l]]),r.l+=1,r.l+=2),o&&(r.l+=36);for(var f=[],m={},p=Math.min(r.length,2==i?521:d-10-(l?264:0)),v=o?32:11;r.l<p&&13!=r[r.l];)switch((m={}).name=ei.utils.decode(h,r.slice(r.l,r.l+v)).replace(/[\u0000\r\n].*$/g,""),r.l+=v,m.type=String.fromCharCode(r.read_shift(1)),2==i||o||(m.offset=r.read_shift(4)),m.len=r.read_shift(1),2==i&&(m.offset=r.read_shift(2)),m.dec=r.read_shift(1),m.name.length&&f.push(m),2!=i&&(r.l+=o?13:14),m.type){case"B":(!l||8!=m.len)&&a.WTF;break;case"G":case"P":a.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==r[r.l]&&(r.l=d-1),13!==r.read_shift(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=d;var g=0,b=0;for(s[0]=[],b=0;b!=f.length;++b)s[0][b]=f[b].name;for(;c-- >0;)if(42!==r[r.l])for(++r.l,s[++g]=[],b=0,b=0;b!=f.length;++b){var x=r.slice(r.l,r.l+f[b].len);r.l+=f[b].len,Zl(x,0);var y=ei.utils.decode(h,x);switch(f[b].type){case"C":y.trim().length&&(s[g][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?s[g][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):s[g][b]=y;break;case"F":s[g][b]=parseFloat(y.trim());break;case"+":case"I":s[g][b]=o?2147483648^x.read_shift(-4,"i"):x.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":s[g][b]=!0;break;case"N":case"F":s[g][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!n)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));s[g][b]="##MEMO##"+(o?parseInt(y.trim(),10):x.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(s[g][b]=+y||0);break;case"@":s[g][b]=new Date(x.read_shift(-8,"f")-621356832e5);break;case"T":s[g][b]=new Date(864e5*(x.read_shift(4)-2440588)+x.read_shift(4));break;case"Y":s[g][b]=x.read_shift(4,"i")/1e4+x.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":s[g][b]=-x.read_shift(-8,"f");break;case"B":if(l&&8==f[b].len){s[g][b]=x.read_shift(8,"f");break}case"G":case"P":x.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else r.l+=u;if(2!=i&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return a&&a.sheetRows&&(s=s.slice(0,a.sheetRows)),a.DBF=f,s}(t,s),s);return r["!cols"]=s.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete s.DBF,r}var s={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return xo(a(e,t),t)}catch(s){if(t&&t.WTF)throw s}return{SheetNames:[],Sheets:{}}},to_sheet:a,from_sheet:function(e,a){var r=a||{};if(+r.codepage>=0&&Jr(+r.codepage),"string"==r.type)throw new Error("Cannot write DBF to JS string");var i=ao(),n=Df(e,{header:1,raw:!0,cellDates:!0}),l=n[0],o=n.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<l.length;++d)if(((c[d]||{}).DBF||{}).name)l[d]=c[d].DBF.name,++h;else if(null!=l[d]){if(++h,"number"==typeof l[d]&&(l[d]=l[d].toString(10)),"string"!=typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+typeof l[d]+"|");if(l.indexOf(l[d])!==d)for(u=0;u<1024;++u)if(-1==l.indexOf(l[d]+"_"+u)){l[d]+="_"+u;break}}var m=go(e["!ref"]),p=[],v=[],g=[];for(d=0;d<=m.e.c-m.s.c;++d){var b="",x="",y=0,S=[];for(u=0;u<o.length;++u)null!=o[u][d]&&S.push(o[u][d]);if(0!=S.length&&null!=l[d]){for(u=0;u<S.length;++u){switch(typeof S[u]){case"number":x="B";break;case"string":default:x="C";break;case"boolean":x="L";break;case"object":x=S[u]instanceof Date?"D":"C"}y=Math.max(y,String(S[u]).length),b=b&&b!=x?"C":x}y>250&&(y=250),"C"==(x=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==x&&(b="N",g[d]=c[d].DBF.dec,y=c[d].DBF.len),v[d]="C"==b||"N"==x?y:s[b]||0,f+=v[d],p[d]=b}else p[d]="?"}var w=i.next(32);for(w.write_shift(4,318902576),w.write_shift(4,o.length),w.write_shift(2,296+32*h),w.write_shift(2,f),d=0;d<4;++d)w.write_shift(4,0);for(w.write_shift(4,(+t[Yr]||3)<<8),d=0,u=0;d<l.length;++d)if(null!=l[d]){var T=i.next(32),k=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,k,"sbcs"),T.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),T.write_shift(4,u),T.write_shift(1,v[d]||s[p[d]]||0),T.write_shift(1,g[d]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),u+=v[d]||s[p[d]]||0}var D=i.next(264);for(D.write_shift(4,13),d=0;d<65;++d)D.write_shift(4,0);for(d=0;d<o.length;++d){var C=i.next(f);for(C.write_shift(1,0),u=0;u<l.length;++u)if(null!=l[u])switch(p[u]){case"L":C.write_shift(1,null==o[d][u]?63:o[d][u]?84:70);break;case"B":C.write_shift(8,o[d][u]||0,"f");break;case"N":var E="0";for("number"==typeof o[d][u]&&(E=o[d][u].toFixed(g[u]||0)),h=0;h<v[u]-E.length;++h)C.write_shift(1,32);C.write_shift(1,E,"sbcs");break;case"D":o[d][u]?(C.write_shift(4,("0000"+o[d][u].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(o[d][u].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+o[d][u].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var N=String(null!=o[d][u]?o[d][u]:"").slice(0,v[u]);for(C.write_shift(1,N,"sbcs"),h=0;h<v[u]-N.length;++h)C.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),ad=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+un(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(t,a){var s=e[a];return"number"==typeof s?si(s):s},s=function(e,t,a){var s=t.charCodeAt(0)-32<<4|a.charCodeAt(0)-48;return 59==s?e:si(s)};function r(e,r){var i,n=e.split(/[\n\r]+/),l=-1,o=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],v=[],g=[],b=0;for(+r.codepage>=0&&Jr(+r.codepage);c!==n.length;++c){b=0;var x,y=n[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,a),S=y.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),w=S[0];if(y.length>0)switch(w){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==S[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var T=!1,k=!1,D=!1,C=!1,E=-1,N=-1;for(d=1;d<S.length;++d)switch(S[d].charAt(0)){case"A":case"G":break;case"X":o=parseInt(S[d].slice(1))-1,k=!0;break;case"Y":for(l=parseInt(S[d].slice(1))-1,k||(o=0),i=u.length;i<=l;++i)u[i]=[];break;case"K":'"'===(x=S[d].slice(1)).charAt(0)?x=x.slice(1,x.length-1):"TRUE"===x?x=!0:"FALSE"===x?x=!1:isNaN(En(x))?isNaN(An(x).getDate())||(x=Tn(x)):(x=En(x),null!==f&&en(f)&&(x=bn(x))),T=!0;break;case"E":C=!0;var A=su(S[d].slice(1),{r:l,c:o});u[l][o]=[u[l][o],A];break;case"S":D=!0,u[l][o]=[u[l][o],"S5S"];break;case"R":E=parseInt(S[d].slice(1))-1;break;case"C":N=parseInt(S[d].slice(1))-1;break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}if(T&&(u[l][o]&&2==u[l][o].length?u[l][o][0]=x:u[l][o]=x,f=null),D){if(C)throw new Error("SYLK shared formula cannot have own formula");var I=E>-1&&u[E][N];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");u[l][o][1]=nu(I[1],{r:l-E,c:o-N})}break;case"F":var j=0;for(d=1;d<S.length;++d)switch(S[d].charAt(0)){case"X":o=parseInt(S[d].slice(1))-1,++j;break;case"Y":for(l=parseInt(S[d].slice(1))-1,i=u.length;i<=l;++i)u[i]=[];break;case"M":b=parseInt(S[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(S[d].slice(1))];break;case"W":for(g=S[d].slice(1).split(" "),i=parseInt(g[0],10);i<=parseInt(g[1],10);++i)b=parseInt(g[2],10),v[i-1]=0===b?{hidden:!0}:{wch:b},Fd(v[i-1]);break;case"C":v[o=parseInt(S[d].slice(1))-1]||(v[o]={});break;case"R":p[l=parseInt(S[d].slice(1))-1]||(p[l]={}),b>0?(p[l].hpt=b,p[l].hpx=Pd(b)):0===b&&(p[l].hidden=!0);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}j<1&&(f=null);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),v.length>0&&(m["!cols"]=v),r&&r.sheetRows&&(u=u.slice(0,r.sheetRows)),[u,m]}function i(e,t){var a=function(e,t){switch(t.type){case"base64":return r(ni(e),t);case"binary":return r(e,t);case"buffer":return r(li&&Buffer.isBuffer(e)?e.toString("binary"):hi(e),t);case"array":return r(kn(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),s=a[0],i=a[1],n=So(s,t);return un(i).forEach((function(e){n[e]=i[e]})),n}function n(e,t,a,s){var r="C;Y"+(a+1)+";X"+(s+1)+";K";switch(e.t){case"n":r+=e.v||0,e.f&&!e.F&&(r+=";E"+iu(e.f,{r:a,c:s}));break;case"b":r+=e.v?"TRUE":"FALSE";break;case"e":r+=e.w||e.v;break;case"d":r+='"'+(e.w||e.v)+'"';break;case"s":r+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return r}return e["|"]=254,{to_workbook:function(e,t){return xo(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var a,s,r=["ID;PWXL;N;E"],i=[],l=go(e["!ref"]),o=Array.isArray(e),c="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),e["!cols"]&&(s=r,e["!cols"].forEach((function(e,t){var a="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?a+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Id(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=jd(e.wpx)),"number"==typeof e.wch&&(a+=Math.round(e.wch)))," "!=a.charAt(a.length-1)&&s.push(a)}))),e["!rows"]&&function(e,t){t.forEach((function(t,a){var s="F;";t.hidden?s+="M0;":t.hpt?s+="M"+20*t.hpt+";":t.hpx&&(s+="M"+20*Rd(t.hpx)+";"),s.length>2&&e.push(s+"R"+(a+1))}))}(r,e["!rows"]),r.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" "));for(var d=l.s.r;d<=l.e.r;++d)for(var u=l.s.c;u<=l.e.c;++u){var h=mo({r:d,c:u});(a=o?(e[d]||[])[u]:e[h])&&(null!=a.v||a.f&&!a.F)&&i.push(n(a,0,d,u))}return r.join(c)+c+i.join(c)+c+"E"+c}}}(),sd=function(){function e(e,t){for(var a=e.split("\n"),s=-1,r=-1,i=0,n=[];i!==a.length;++i)if("BOT"!==a[i].trim()){if(!(s<0)){for(var l=a[i].trim().split(","),o=l[0],c=l[1],d=a[++i]||"";1&(d.match(/["]/g)||[]).length&&i<a.length-1;)d+="\n"+a[++i];switch(d=d.trim(),+o){case-1:if("BOT"===d){n[++s]=[],r=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?n[s][r]=!0:"FALSE"===d?n[s][r]=!1:isNaN(En(c))?isNaN(An(c).getDate())?n[s][r]=c:n[s][r]=Tn(c):n[s][r]=En(c),++r;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),n[s][r++]=""!==d?d:null}if("EOD"===d)break}}else n[++s]=[],r=0;return t&&t.sheetRows&&(n=n.slice(0,t.sheetRows)),n}function t(t,a){return So(function(t,a){switch(a.type){case"base64":return e(ni(t),a);case"binary":return e(t,a);case"buffer":return e(li&&Buffer.isBuffer(t)?t.toString("binary"):hi(t),a);case"array":return e(kn(t),a)}throw new Error("Unrecognized type "+a.type)}(t,a),a)}return{to_workbook:function(e,a){return xo(t(e,a),a)},to_sheet:t,from_sheet:function(){var e=function(e,t,a,s,r){e.push(t),e.push(a+","+s),e.push('"'+r.replace(/"/g,'""')+'"')},t=function(e,t,a,s){e.push(t+","+a),e.push(1==t?'"'+s.replace(/"/g,'""')+'"':s)};return function(a){var s,r=[],i=go(a["!ref"]),n=Array.isArray(a);e(r,"TABLE",0,1,"sheetjs"),e(r,"VECTORS",0,i.e.r-i.s.r+1,""),e(r,"TUPLES",0,i.e.c-i.s.c+1,""),e(r,"DATA",0,0,"");for(var l=i.s.r;l<=i.e.r;++l){t(r,-1,0,"BOT");for(var o=i.s.c;o<=i.e.c;++o){var c=mo({r:l,c:o});if(s=n?(a[l]||[])[o]:a[c])switch(s.t){case"n":var d=s.w;d||null==s.v||(d=s.v),null==d?s.f&&!s.F?t(r,1,0,"="+s.f):t(r,1,0,""):t(r,0,d,"V");break;case"b":t(r,0,s.v?1:0,s.v?"TRUE":"FALSE");break;case"s":t(r,1,0,isNaN(s.v)?s.v:'="'+s.v+'"');break;case"d":s.w||(s.w=sn(s.z||Ci[14],mn(Tn(s.v)))),t(r,0,s.w,"V");break;default:t(r,1,0,"")}else t(r,1,0,"")}}return t(r,-1,0,"EOD"),r.join("\r\n")}}()}}(),rd=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return So(function(e,t){for(var a=e.split("\n"),s=-1,r=-1,i=0,n=[];i!==a.length;++i){var l=a[i].trim().split(":");if("cell"===l[0]){var o=fo(l[1]);if(n.length<=o.r)for(s=n.length;s<=o.r;++s)n[s]||(n[s]=[]);switch(s=o.r,r=o.c,l[2]){case"t":n[s][r]=l[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":n[s][r]=+l[3];break;case"vtf":var c=l[l.length-1];case"vtc":"nl"===l[3]?n[s][r]=!!+l[4]:n[s][r]=+l[4],"vtf"==l[2]&&(n[s][r]=[n[s][r],c])}}}return t&&t.sheetRows&&(n=n.slice(0,t.sheetRows)),n}(e,t),t)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",r=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function n(t){if(!t||!t["!ref"])return"";for(var a,s=[],r=[],i="",n=po(t["!ref"]),l=Array.isArray(t),o=n.s.r;o<=n.e.r;++o)for(var c=n.s.c;c<=n.e.c;++c)if(i=mo({r:o,c:c}),(a=l?(t[o]||[])[c]:t[i])&&null!=a.v&&"z"!==a.t){switch(r=["cell",i,"t"],a.t){case"s":case"str":r.push(e(a.v));break;case"n":a.f?(r[2]="vtf",r[3]="n",r[4]=a.v,r[5]=e(a.f)):(r[2]="v",r[3]=a.v);break;case"b":r[2]="vt"+(a.f?"f":"c"),r[3]="nl",r[4]=a.v?"1":"0",r[5]=e(a.f||(a.v?"TRUE":"FALSE"));break;case"d":var d=mn(Tn(a.v));r[2]="vtc",r[3]="nd",r[4]=""+d,r[5]=a.w||sn(a.z||Ci[14],d);break;case"e":continue}s.push(r.join(":"))}return s.push("sheet:c:"+(n.e.c-n.s.c+1)+":r:"+(n.e.r-n.s.r+1)+":tvf:1"),s.push("valueformat:1:text-wiki"),s.join("\n")}return{to_workbook:function(e,a){return xo(t(e,a),a)},to_sheet:t,from_sheet:function(e){return[a,s,r,s,n(e),i].join("\n")}}}(),id=function(){function e(e,t,a,s,r){r.raw?t[a][s]=e:""===e||("TRUE"===e?t[a][s]=!0:"FALSE"===e?t[a][s]=!1:isNaN(En(e))?isNaN(An(e).getDate())?t[a][s]=e:t[a][s]=Tn(e):t[a][s]=En(e))}var t={44:",",9:"\t",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(e){for(var s={},r=!1,i=0,n=0;i<e.length;++i)34==(n=e.charCodeAt(i))?r=!r:!r&&n in t&&(s[n]=(s[n]||0)+1);for(i in n=[],s)Object.prototype.hasOwnProperty.call(s,i)&&n.push([s[i],i]);if(!n.length)for(i in s=a)Object.prototype.hasOwnProperty.call(s,i)&&n.push([s[i],i]);return n.sort((function(e,t){return e[0]-t[0]||a[e[1]]-a[t[1]]})),t[n.pop()[1]]||44}function r(e,t){var a=t||{},r="",i=a.dense?[]:{},n={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(r=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(r=e.charAt(4),e=e.slice(6)):r=s(e.slice(0,1024)):r=a&&a.FS?a.FS:s(e.slice(0,1024));var l=0,o=0,c=0,d=0,u=0,h=r.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var v,g,b=null!=a.dateNF?(g=(g="number"==typeof(v=a.dateNF)?Ci[v]:v).replace(on,"(\\d+)"),new RegExp("^"+g+"$")):null;function x(){var t=e.slice(d,u),s={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)s.t="z";else if(a.raw)s.t="s",s.v=t;else if(0===t.trim().length)s.t="s",s.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(s.t="s",s.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(s.t="n",s.f=t.slice(1)):(s.t="s",s.v=t);else if("TRUE"==t)s.t="b",s.v=!0;else if("FALSE"==t)s.t="b",s.v=!1;else if(isNaN(c=En(t)))if(!isNaN(An(t).getDate())||b&&t.match(b)){s.z=a.dateNF||Ci[14];var r=0;b&&t.match(b)&&(t=function(e,t,a){var s=-1,r=-1,i=-1,n=-1,l=-1,o=-1;(t.match(on)||[]).forEach((function(e,t){var c=parseInt(a[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":s=c;break;case"d":i=c;break;case"h":n=c;break;case"s":o=c;break;case"m":n>=0?l=c:r=c}})),o>=0&&-1==l&&r>=0&&(l=r,r=-1);var c=(""+(s>=0?s:(new Date).getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(n>=0?n:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return-1==n&&-1==l&&-1==o?c:-1==s&&-1==r&&-1==i?d:c+"T"+d}(0,a.dateNF,t.match(b)||[]),r=1),a.cellDates?(s.t="d",s.v=Tn(t,r)):(s.t="n",s.v=mn(Tn(t,r))),!1!==a.cellText&&(s.w=sn(s.z,s.v instanceof Date?mn(s.v):s.v)),a.cellNF||delete s.z}else s.t="s",s.v=t;else s.t="n",!1!==a.cellText&&(s.w=t),s.v=c;if("z"==s.t||(a.dense?(i[l]||(i[l]=[]),i[l][o]=s):i[mo({c:o,r:l})]=s),d=u+1,p=e.charCodeAt(d),n.e.c<o&&(n.e.c=o),n.e.r<l&&(n.e.r=l),m==h)++o;else if(o=0,++l,a.sheetRows&&a.sheetRows<=l)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&x())break e}return u-d>0&&x(),i["!ref"]=vo(n),i}function i(t,a){var s="",i="string"==a.type?[0,0,0,0]:yf(t,a);switch(a.type){case"base64":s=ni(t);break;case"binary":case"string":s=t;break;case"buffer":65001==a.codepage?s=t.toString("utf8"):(a.codepage,s=li&&Buffer.isBuffer(t)?t.toString("binary"):hi(t));break;case"array":s=kn(t);break;default:throw new Error("Unrecognized type "+a.type)}return 239==i[0]&&187==i[1]&&191==i[2]?s=ll(s.slice(3)):"string"!=a.type&&"buffer"!=a.type&&65001==a.codepage?s=ll(s):a.type,"socialcalc:version:"==s.slice(0,19)?rd.to_sheet("string"==a.type?s:ll(s),a):function(t,a){return a&&a.PRN?a.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?r(t,a):So(function(t,a){var s=a||{},r=[];if(!t||0===t.length)return r;for(var i=t.split(/[\r\n]/),n=i.length-1;n>=0&&0===i[n].length;)--n;for(var l=10,o=0,c=0;c<=n;++c)-1==(o=i[c].indexOf(" "))?o=i[c].length:o++,l=Math.max(l,o);for(c=0;c<=n;++c){r[c]=[];var d=0;for(e(i[c].slice(0,l).trim(),r,c,d,s),d=1;d<=(i[c].length-l)/10+1;++d)e(i[c].slice(l+10*(d-1),l+10*d).trim(),r,c,d,s)}return s.sheetRows&&(r=r.slice(0,s.sheetRows)),r}(t,a),a):r(t,a)}(s,a)}return{to_workbook:function(e,t){return xo(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,a=[],s=go(e["!ref"]),r=Array.isArray(e),i=s.s.r;i<=s.e.r;++i){for(var n=[],l=s.s.c;l<=s.e.c;++l){var o=mo({r:i,c:l});if((t=r?(e[i]||[])[l]:e[o])&&null!=t.v){for(var c=(t.w||(bo(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";n.push(c+(0===l?" ":""))}else n.push("          ")}a.push(n.join(""))}return a.join("\n")}}}(),nd=function(){function e(e,t,a){if(e){Zl(e,e.l||0);for(var s=a.Enum||g;e.l<e.length;){var r=e.read_shift(2),i=s[r]||s[65535],n=e.read_shift(2),l=e.l+n,o=i.f&&i.f(e,n,a);if(e.l=l,t(o,i,r))return}}}function t(t,a){if(!t)return t;var s=a||{},r=s.dense?[]:{},i="Sheet1",n="",l=0,o={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=s.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])s.Enum=g,e(t,(function(e,t,a){switch(a){case 0:s.vers=e,e>=4096&&(s.qpro=!0);break;case 6:u=e;break;case 204:e&&(n=e);break;case 222:n=e;break;case 15:case 51:s.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==a&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=s.dateNF||Ci[14],s.cellDates&&(e[1].t="d",e[1].v=bn(e[1].v))),s.qpro&&e[3]>l&&(r["!ref"]=vo(u),o[i]=r,c.push(i),r=s.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],i=n||"Sheet"+(l+1),n="");var d=s.dense?(r[e[0].r]||[])[e[0].c]:r[mo(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}s.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[mo(e[0])]=e[1]}}),s);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);s.Enum=b,14==t[2]&&(s.qpro=!0,t.l=0),e(t,(function(e,t,a){switch(a){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(r["!ref"]=vo(u),o[i]=r,c.push(i),r=s.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],i="Sheet"+(l+1)),h>0&&e[0].r>=h)break;s.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[mo(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(i=e[1])}}),s)}if(r["!ref"]=vo(u),o[n||i]=r,c.push(n||i),!d.length)return{SheetNames:c,Sheets:o};for(var f={},m=[],p=0;p<d.length;++p)o[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=o[d[p]]||o[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function a(e,t,a){var s=[{c:0,r:0},{t:"n",v:0},0,0];return a.qpro&&20768!=a.vers?(s[0].c=e.read_shift(1),s[3]=e.read_shift(1),s[0].r=e.read_shift(2),e.l+=2):(s[2]=e.read_shift(1),s[0].c=e.read_shift(2),s[0].r=e.read_shift(2)),s}function s(e,t,s){var r=e.l+t,i=a(e,0,s);if(i[1].t="s",20768==s.vers){e.l++;var n=e.read_shift(1);return i[1].v=e.read_shift(n,"utf8"),i}return s.qpro&&e.l++,i[1].v=e.read_shift(r-e.l,"cstr"),i}function r(e,t,a){var s=eo(7+a.length);s.write_shift(1,255),s.write_shift(2,t),s.write_shift(2,e),s.write_shift(1,39);for(var r=0;r<s.length;++r){var i=a.charCodeAt(r);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}function i(e,t,a){var s=eo(7);return s.write_shift(1,255),s.write_shift(2,t),s.write_shift(2,e),s.write_shift(2,a,"i"),s}function n(e,t,a){var s=eo(13);return s.write_shift(1,255),s.write_shift(2,t),s.write_shift(2,e),s.write_shift(8,a,"f"),s}function l(e,t,a){var s=32768&t;return t=(s?e:0)+((t&=-32769)>=8192?t-16384:t),(s?"":"$")+(a?ho(t):co(t))}var o={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,a,s){var r=eo(6+s.length);r.write_shift(2,e),r.write_shift(1,a),r.write_shift(1,t),r.write_shift(1,39);for(var i=0;i<s.length;++i){var n=s.charCodeAt(i);r.write_shift(1,n>=128?95:n)}return r.write_shift(1,0),r}function h(e,t){var a=d(e),s=e.read_shift(4),r=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===s&&3221225472===r?(a[1].t="e",a[1].v=15):0===s&&3489660928===r?(a[1].t="e",a[1].v=42):a[1].v=0,a;var n=32768&i;return i=(32767&i)-16446,a[1].v=(1-2*n)*(r*Math.pow(2,i+32)+s*Math.pow(2,i)),a}function f(e,t,a,s){var r=eo(14);if(r.write_shift(2,e),r.write_shift(1,a),r.write_shift(1,t),0==s)return r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,65535),r;var i,n=0,l=0,o=0;return s<0&&(n=1,s=-s),l=0|Math.log2(s),2147483648&(o=(s/=Math.pow(2,l-31))>>>0)||(++l,o=(s/=2)>>>0),s-=o,o|=2147483648,o>>>=0,i=(s*=Math.pow(2,32))>>>0,r.write_shift(4,i),r.write_shift(4,o),l+=16383+(n?32768:0),r.write_shift(2,l),r}function m(e,t){var a=d(e),s=e.read_shift(8,"f");return a[1].v=s,a}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function v(e,t){var a=eo(5+e.length);a.write_shift(2,14e3),a.write_shift(2,t);for(var s=0;s<e.length;++s){var r=e.charCodeAt(s);a[a.l++]=r>127?95:r}return a[a.l++]=0,a}var g={0:{n:"BOF",f:xc},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,a){var s={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&a.qpro?(s.s.c=e.read_shift(1),e.l++,s.s.r=e.read_shift(2),s.e.c=e.read_shift(1),e.l++,s.e.r=e.read_shift(2),s):(s.s.c=e.read_shift(2),s.s.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),s.e.c=e.read_shift(2),s.e.r=e.read_shift(2),12==t&&a.qpro&&(e.l+=2),65535==s.s.c&&(s.s.c=s.e.c=s.s.r=s.e.r=0),s)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,s){var r=a(e,0,s);return r[1].v=e.read_shift(2,"i"),r}},14:{n:"NUMBER",f:function(e,t,s){var r=a(e,0,s);return r[1].v=e.read_shift(8,"f"),r}},15:{n:"LABEL",f:s},16:{n:"FORMULA",f:function(e,t,s){var r=e.l+t,i=a(e,0,s);if(i[1].v=e.read_shift(8,"f"),s.qpro)e.l=r;else{var n=e.read_shift(2);!function(e,t){Zl(e,0);for(var a=[],s=0,r="",i="",n="",d="";e.l<e.length;){var u=e[e.l++];switch(u){case 0:a.push(e.read_shift(8,"f"));break;case 1:i=l(t[0].c,e.read_shift(2),!0),r=l(t[0].r,e.read_shift(2),!1),a.push(i+r);break;case 2:var h=l(t[0].c,e.read_shift(2),!0),f=l(t[0].r,e.read_shift(2),!1);i=l(t[0].c,e.read_shift(2),!0),r=l(t[0].r,e.read_shift(2),!1),a.push(h+f+":"+i+r);break;case 3:if(e.l<e.length)return;break;case 4:a.push("("+a.pop()+")");break;case 5:a.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);a.push('"'+m.replace(/"/g,'""')+'"');break;case 8:a.push("-"+a.pop());break;case 23:a.push("+"+a.pop());break;case 22:a.push("NOT("+a.pop()+")");break;case 20:case 21:d=a.pop(),n=a.pop(),a.push(["AND","OR"][u-20]+"("+n+","+d+")");break;default:if(u<32&&c[u])d=a.pop(),n=a.pop(),a.push(n+c[u]+d);else{if(!o[u])return;if(69==(s=o[u][1])&&(s=e[e.l++]),s>a.length)return;var p=a.slice(-s);a.length-=s,a.push(o[u][0]+"("+p.join(",")+")")}}}1==a.length&&(t[1].f=""+a[0])}(e.slice(e.l,e.l+n),i),e.l+=n}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:s},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var a=e[e.l++];a>t-1&&(a=t-1);for(var s="";s.length<a;)s+=String.fromCharCode(e[e.l++]);return s}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var a=d(e);return a[1].t="s",a[1].v=e.read_shift(t-4,"cstr"),a}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var a=d(e);a[1].v=e.read_shift(2);var s=a[1].v>>1;if(1&a[1].v)switch(7&s){case 0:s=5e3*(s>>3);break;case 1:s=500*(s>>3);break;case 2:s=(s>>3)/20;break;case 3:s=(s>>3)/200;break;case 4:s=(s>>3)/2e3;break;case 5:s=(s>>3)/2e4;break;case 6:s=(s>>3)/16;break;case 7:s=(s>>3)/64}return a[1].v=s,a}},25:{n:"FORMULA19",f:function(e,t){var a=h(e);return e.l+=t-14,a}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var a={},s=e.l+t;e.l<s;){var r=e.read_shift(2);if(14e3==r){for(a[r]=[0,""],a[r][0]=e.read_shift(2);e[e.l];)a[r][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return a}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var a=d(e),s=e.read_shift(4);return a[1].v=s>>6,a}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var a=m(e);return e.l+=t-10,a}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,a){if(a.qpro&&!(t<21)){var s=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[s,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var a=t||{};if(+a.codepage>=0&&Jr(+a.codepage),"string"==a.type)throw new Error("Cannot write WK1 to JS string");var s,l=ao(),o=go(e["!ref"]),c=Array.isArray(e),d=[];Hh(l,0,((s=eo(2)).write_shift(2,1030),s)),Hh(l,6,function(e){var t=eo(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var f=co(h),m=o.s.c;m<=o.e.c;++m){h===o.s.r&&(d[m]=ho(m));var p=d[m]+f,v=c?(e[h]||[])[m]:e[p];v&&"z"!=v.t&&("n"==v.t?(0|v.v)==v.v&&v.v>=-32768&&v.v<=32767?Hh(l,13,i(h,m,v.v)):Hh(l,14,n(h,m,v.v)):Hh(l,15,r(h,m,bo(v).slice(0,239))))}return Hh(l,1),l.end()},book_to_wk3:function(e,t){var a=t||{};if(+a.codepage>=0&&Jr(+a.codepage),"string"==a.type)throw new Error("Cannot write WK3 to JS string");var s=ao();Hh(s,0,function(e){var t=eo(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var a=0,s=0,r=0,i=0;i<e.SheetNames.length;++i){var n=e.SheetNames[i],l=e.Sheets[n];if(l&&l["!ref"]){++r;var o=po(l["!ref"]);a<o.e.r&&(a=o.e.r),s<o.e.c&&(s=o.e.c)}}return a>8191&&(a=8191),t.write_shift(2,a),t.write_shift(1,r),t.write_shift(1,s),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var r=0,i=0;r<e.SheetNames.length;++r)(e.Sheets[e.SheetNames[r]]||{})["!ref"]&&Hh(s,27,v(e.SheetNames[r],i++));var n=0;for(r=0;r<e.SheetNames.length;++r){var l=e.Sheets[e.SheetNames[r]];if(l&&l["!ref"]){for(var o=go(l["!ref"]),c=Array.isArray(l),d=[],h=Math.min(o.e.r,8191),m=o.s.r;m<=h;++m)for(var p=co(m),g=o.s.c;g<=o.e.c;++g){m===o.s.r&&(d[g]=ho(g));var b=d[g]+p,x=c?(l[m]||[])[g]:l[b];x&&"z"!=x.t&&("n"==x.t?Hh(s,23,f(m,g,n,x.v)):Hh(s,22,u(m,g,n,bo(x).slice(0,239))))}++n}}return Hh(s,1),s.end()},to_workbook:function(e,a){switch(a.type){case"base64":return t(ui(ni(e)),a);case"binary":return t(ui(e),a);case"buffer":case"array":return t(e,a)}throw"Unsupported type "+a.type}}}(),ld=function(){var e=cl("t"),t=cl("rPr");function a(a){var s=a.match(e);if(!s)return{t:"s",v:""};var r={t:"s",v:Xn(s[1])},i=a.match(t);return i&&(r.s=function(e){var t={},a=e.match(Hn),s=0,r=!1;if(a)for(;s!=a.length;++s){var i=Kn(a[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=$r[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==i[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),r}var s=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(e){return e.replace(s,"").split(r).map(a).filter((function(e){return e.v}))}}(),od=function(){var e=/(\r\n|\n)/g;function t(t){var a=[[],t.v,[]];return t.v?(t.s&&function(e,t,a){var s=[];e.u&&s.push("text-decoration: underline;"),e.uval&&s.push("text-underline-style:"+e.uval+";"),e.sz&&s.push("font-size:"+e.sz+"pt;"),e.outline&&s.push("text-effect: outline;"),e.shadow&&s.push("text-shadow: auto;"),t.push('<span style="'+s.join("")+'">'),e.b&&(t.push("<b>"),a.push("</b>")),e.i&&(t.push("<i>"),a.push("</i>")),e.strike&&(t.push("<s>"),a.push("</s>"));var r=e.valign||"";"superscript"==r||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(t.push("<"+r+">"),a.push("</"+r+">")),a.push("</span>")}(t.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(e){return e.map(t).join("")}}(),cd=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,dd=/<(?:\w+:)?r>/,ud=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hd(e,t){var a=!t||t.cellHTML,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Xn(ll(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=ll(e),a&&(s.h=el(s.t))):e.match(dd)&&(s.r=ll(e),s.t=Xn(ll((e.replace(ud,"").match(cd)||[]).join("").replace(Hn,""))),a&&(s.h=od(ld(s.r)))),s):{t:""}}var fd=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,md=/<(?:\w+:)?(?:si|sstItem)>/g,pd=/<\/(?:\w+:)?(?:si|sstItem)>/;function vd(e){for(var t=[],a=e.split(""),s=0;s<a.length;++s)t[s]=a[s].charCodeAt(0);return t}function gd(e,t){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),a}function bd(e){for(var t=e.read_shift(4),a=e.l+t-4,s={},r=e.read_shift(4),i=[];r-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return s}function xd(e,t){var a=e.l+t,s={};s.Flags=63&e.read_shift(4),e.l+=4,s.AlgID=e.read_shift(4);var r=!1;switch(s.AlgID){case 26126:case 26127:case 26128:r=36==s.Flags;break;case 26625:r=4==s.Flags;break;case 0:r=16==s.Flags||4==s.Flags||36==s.Flags;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,s}function yd(e,t){var a={},s=e.l+t;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,s),e.l=s,a}function Sd(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:xd(e,t),v:yd(e,e.length-e.l)}}function wd(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Td(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),s={};return a.replace(Hn,(function(e){var a=Kn(e);switch($n(a[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){s[e]=a[e]}));break;case"<dataIntegrity":s.encryptedHmacKey=a.encryptedHmacKey,s.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"<keyEncryptor":s.uri=a.uri;break;case"<encryptedKey":s.encs.push(a);break;default:throw a[0]}})),s}var kd=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(e,t){return 255&((a=e^t)/2|128*a);var a};return function(r){for(var i,n,l,o=vd(r),c=function(e){for(var s=t[e.length-1],r=104,i=e.length-1;i>=0;--i)for(var n=e[i],l=0;7!=l;++l)64&n&&(s^=a[r]),n*=2,--r;return s}(o),d=o.length,u=ci(16),h=0;16!=h;++h)u[h]=0;for(1&~d||(i=c>>8,u[d]=s(e[0],i),--d,i=255&c,n=o[o.length-1],u[d]=s(n,i));d>0;)i=c>>8,u[--d]=s(o[d],i),i=255&c,u[--d]=s(o[d],i);for(d=15,l=15-o.length;l>0;)i=c>>8,u[d]=s(e[l],i),--l,i=255&c,u[--d]=s(o[d],i),--d,--l;return u}}();function Dd(e,t,a,s){var r,i,n,l={key:xc(e),verificationBytes:xc(e)};return a.password&&(l.verifier=function(e){var t,a,s=0,r=vd(e),i=r.length+1;for((t=ci(i))[0]=r.length,a=1;a!=i;++a)t[a]=r[a-1];for(a=i-1;a>=0;--a)s=((16384&s?1:0)|s<<1&32767)^t[a];return 52811^s}(a.password)),s.valid=l.verificationBytes===l.verifier,s.valid&&(s.insitu=(r=a.password,i=0,n=kd(r),function(e){var t=function(e,t,a,s,r){var i,n;for(r||(r=t),s||(s=kd("")),i=0;i!=t.length;++i)n=t[i],n=255&((n^=s[a])>>5|n<<3),r[i]=n,++a;return[r,a,s]}(0,e,i,n);return i=t[1],t[0]})),l}var Cd=function(){function e(e,a){switch(a.type){case"base64":return t(ni(e),a);case"binary":return t(e,a);case"buffer":return t(li&&Buffer.isBuffer(e)?e.toString("binary"):hi(e),a);case"array":return t(kn(e),a)}throw new Error("Unrecognized type "+a.type)}function t(e,t){var a=(t||{}).dense?[]:{},s=e.match(/\\trowd.*?\\row\b/g);if(!s.length)throw new Error("RTF missing table");var r={s:{c:0,r:0},e:{c:0,r:s.length-1}};return s.forEach((function(e,t){Array.isArray(a)&&(a[t]=[]);for(var s,i=/\\\w+\b/g,n=0,l=-1;s=i.exec(e);){if("\\cell"===s[0]){var o=e.slice(n,i.lastIndex-s[0].length);if(" "==o[0]&&(o=o.slice(1)),++l,o.length){var c={v:o,t:"s"};Array.isArray(a)?a[t][l]=c:a[mo({r:t,c:l})]=c}}n=i.lastIndex}l>r.e.c&&(r.e.c=l)})),a["!ref"]=vo(r),a}return{to_workbook:function(t,a){return xo(e(t,a),a)},to_sheet:e,from_sheet:function(e){for(var t,a=["{\\rtf1\\ansi"],s=go(e["!ref"]),r=Array.isArray(e),i=s.s.r;i<=s.e.r;++i){a.push("\\trowd\\trautofit1");for(var n=s.s.c;n<=s.e.c;++n)a.push("\\cellx"+(n+1));for(a.push("\\pard\\intbl"),n=s.s.c;n<=s.e.c;++n){var l=mo({r:i,c:n});(t=r?(e[i]||[])[n]:e[l])&&(null!=t.v||t.f&&!t.F)&&(a.push(" "+(t.w||(bo(t),t.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}}}();function Ed(e){for(var t=0,a=1;3!=t;++t)a=256*a+(e[t]>255?255:e[t]<0?0:e[t]);return a.toString(16).toUpperCase().slice(1)}function Nd(e,t){if(0===t)return e;var a,s,r=function(e){var t=e[0]/255,a=e[1]/255,s=e[2]/255,r=Math.max(t,a,s),i=Math.min(t,a,s),n=r-i;if(0===n)return[0,0,t];var l,o=0,c=r+i;switch(l=n/(c>1?2-c:c),r){case t:o=((a-s)/n+6)%6;break;case a:o=(s-t)/n+2;break;case s:o=(t-a)/n+4}return[o/6,l,c/2]}((s=(a=e).slice("#"===a[0]?1:0).slice(0,6),[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),Ed(function(e){var t,a=e[0],s=e[1],r=e[2],i=2*s*(r<.5?r:1-r),n=r-i/2,l=[n,n,n],o=6*a;if(0!==s)switch(0|o){case 0:case 6:t=i*o,l[0]+=i,l[1]+=t;break;case 1:t=i*(2-o),l[0]+=t,l[1]+=i;break;case 2:t=i*(o-2),l[1]+=i,l[2]+=t;break;case 3:t=i*(4-o),l[1]+=t,l[2]+=i;break;case 4:t=i*(o-4),l[2]+=i,l[0]+=t;break;case 5:t=i*(6-o),l[2]+=t,l[0]+=i}for(var c=0;3!=c;++c)l[c]=Math.round(255*l[c]);return l}(r))}var Ad=6;function Id(e){return Math.floor((e+Math.round(128/Ad)/256)*Ad)}function jd(e){return Math.floor((e-5)/Ad*100+.5)/100}function _d(e){return Math.round((e*Ad+5)/Ad*256)/256}function Od(e){return _d(jd(Id(e)))}function Ld(e){var t=Math.abs(e-Od(e)),a=Ad;if(t>.005)for(Ad=1;Ad<15;++Ad)Math.abs(e-Od(e))<=t&&(t=Math.abs(e-Od(e)),a=Ad);Ad=a}function Fd(e){e.width?(e.wpx=Id(e.width),e.wch=jd(e.wpx),e.MDW=Ad):e.wpx?(e.wch=jd(e.wpx),e.width=_d(e.wch),e.MDW=Ad):"number"==typeof e.wch&&(e.width=_d(e.wch),e.wpx=Id(e.width),e.MDW=Ad),e.customWidth&&delete e.customWidth}var Md=96;function Rd(e){return 96*e/Md}function Pd(e){return e*Md/96}var Ud={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Bd=["numFmtId","fillId","fontId","borderId","xfId"],Gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],Vd=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,r=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,n,l){var o,c={};return i?((o=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,a){t.NumberFmt=[];for(var s=un(Ci),r=0;r<s.length;++r)t.NumberFmt[s[r]]=Ci[s[r]];var i=e[0].match(Hn);if(i)for(r=0;r<i.length;++r){var n=Kn(i[r]);switch($n(n[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=Xn(ll(n.formatCode)),o=parseInt(n.numFmtId,10);if(t.NumberFmt[o]=l,o>0){if(o>392){for(o=392;o>60&&null!=t.NumberFmt[o];--o);t.NumberFmt[o]=l}rn(l,o)}break;default:if(a.WTF)throw new Error("unrecognized "+n[0]+" in numFmts")}}}(o,c,l),(o=i.match(s))&&function(e,t,a,s){t.Fonts=[];var r={},i=!1;(e[0].match(Hn)||[]).forEach((function(e){var n=Kn(e);switch($n(n[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(r),r={};break;case"<name":n.val&&(r.name=ll(n.val));break;case"<b":r.bold=n.val?al(n.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=n.val?al(n.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(n.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=n.val?al(n.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=n.val?al(n.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=n.val?al(n.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=n.val?al(n.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=n.val?al(n.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":n.val&&(r.sz=+n.val);break;case"<vertAlign":n.val&&(r.vertAlign=n.val);break;case"<family":n.val&&(r.family=parseInt(n.val,10));break;case"<scheme":n.val&&(r.scheme=n.val);break;case"<charset":if("1"==n.val)break;n.codepage=$r[parseInt(n.val,10)];break;case"<color":if(r.color||(r.color={}),n.auto&&(r.color.auto=al(n.auto)),n.rgb)r.color.rgb=n.rgb.slice(-6);else if(n.indexed){r.color.index=parseInt(n.indexed,10);var l=Ho[r.color.index];81==r.color.index&&(l=Ho[1]),l||(l=Ho[1]),r.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else n.theme&&(r.color.theme=parseInt(n.theme,10),n.tint&&(r.color.tint=parseFloat(n.tint)),n.theme&&a.themeElements&&a.themeElements.clrScheme&&(r.color.rgb=Nd(a.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+n[0]+" in fonts")}}))}(o,c,n,l),(o=i.match(a))&&function(e,t,a,s){t.Fills=[];var r={},i=!1;(e[0].match(Hn)||[]).forEach((function(e){var a=Kn(e);switch($n(a[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r={},t.Fills.push(r);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":a.patternType&&(r.patternType=a.patternType);break;case"<bgColor":r.bgColor||(r.bgColor={}),a.indexed&&(r.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(r.bgColor.theme=parseInt(a.theme,10)),a.tint&&(r.bgColor.tint=parseFloat(a.tint)),a.rgb&&(r.bgColor.rgb=a.rgb.slice(-6));break;case"<fgColor":r.fgColor||(r.fgColor={}),a.theme&&(r.fgColor.theme=parseInt(a.theme,10)),a.tint&&(r.fgColor.tint=parseFloat(a.tint)),null!=a.rgb&&(r.fgColor.rgb=a.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+a[0]+" in fills")}}))}(o,c,0,l),(o=i.match(r))&&function(e,t,a,s){t.Borders=[];var r={},i=!1;(e[0].match(Hn)||[]).forEach((function(e){var a=Kn(e);switch($n(a[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":r={},a.diagonalUp&&(r.diagonalUp=al(a.diagonalUp)),a.diagonalDown&&(r.diagonalDown=al(a.diagonalDown)),t.Borders.push(r);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+a[0]+" in borders")}}))}(o,c,0,l),(o=i.match(t))&&function(e,t,a){var s;t.CellXf=[];var r=!1;(e[0].match(Hn)||[]).forEach((function(e){var i=Kn(e),n=0;switch($n(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(s=i)[0],n=0;n<Bd.length;++n)s[Bd[n]]&&(s[Bd[n]]=parseInt(s[Bd[n]],10));for(n=0;n<Gd.length;++n)s[Gd[n]]&&(s[Gd[n]]=al(s[Gd[n]]));if(t.NumberFmt&&s.numFmtId>392)for(n=392;n>60;--n)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[n]){s.numFmtId=n;break}t.CellXf.push(s);break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),null!=i.textRotation&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=al(i.wrapText)),s.alignment=l;break;case"<AlternateContent":case"<ext":r=!0;break;case"</AlternateContent>":case"</ext>":r=!1;break;default:if(a&&a.WTF&&!r)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(o,c,l),c):c}}(),Wd=Ql,Hd=Ql,zd=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Yd(e,t,a){t.themeElements.clrScheme=[];var s={};(e[0].match(Hn)||[]).forEach((function(e){var r=Kn(e);switch(r[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=r.val;break;case"<a:sysClr":s.rgb=r.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===r[0].charAt(1)?(t.themeElements.clrScheme[zd.indexOf(r[0])]=s,s={}):s.name=r[0].slice(3,r[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+r[0]+" in clrScheme")}}))}function Kd(){}function $d(){}var qd=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Jd=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xd=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,Zd=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Qd(e,t){var a;e&&0!==e.length||(e=function(){var e=[Gn];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}());var s={};if(!(a=e.match(Zd)))throw new Error("themeElements not found in theme");return function(e,t,a){var s;t.themeElements={},[["clrScheme",qd,Yd],["fontScheme",Jd,Kd],["fmtScheme",Xd,$d]].forEach((function(r){if(!(s=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](s,t,a)}))}(a[0],s,t),s.raw=e,s}function eu(e){var t=e.read_shift(2),a=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=function(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e){return Ql(e,4)}(e);break;case 2:t.xclrValue=Ec(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}(e);break;case 6:s[1]=function(e,t){return Ql(e,t)}(e,a);break;case 14:case 15:s[1]=e.read_shift(1===a?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+a)}return s}function tu(e,t,a,s){var r,i=Array.isArray(e);t.forEach((function(t){var n=fo(t.ref);if(i?(e[n.r]||(e[n.r]=[]),r=e[n.r][n.c]):r=e[t.ref],!r){r={t:"z"},i?e[n.r][n.c]=r:e[t.ref]=r;var l=go(e["!ref"]||"BDWGO1000001:A1");l.s.r>n.r&&(l.s.r=n.r),l.e.r<n.r&&(l.e.r=n.r),l.s.c>n.c&&(l.s.c=n.c),l.e.c<n.c&&(l.e.c=n.c);var o=vo(l);o!==e["!ref"]&&(e["!ref"]=o)}r.c||(r.c=[]);var c={a:t.author,t:t.t,r:t.r,T:a};t.h&&(c.h=t.h);for(var d=r.c.length-1;d>=0;--d){if(!a&&r.c[d].T)return;a&&!r.c[d].T&&r.c.splice(d,1)}if(a&&s)for(d=0;d<s.length;++d)if(c.a==s[d].id){c.a=s[d].name||c.a;break}r.c.push(c)}))}var au=wo,su=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function a(e,a,s,r){var i=!1,n=!1;0==s.length?n=!0:"["==s.charAt(0)&&(n=!0,s=s.slice(1,-1)),0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1));var l=s.length>0?0|parseInt(s,10):0,o=r.length>0?0|parseInt(r,10):0;return i?o+=t.c:--o,n?l+=t.r:--l,a+(i?"":"$")+ho(o)+(n?"":"$")+co(l)}return function(s,r){return t=r,s.replace(e,a)}}(),ru=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,iu=function(){return function(e,t){return e.replace(ru,(function(e,a,s,r,i,n){var l=uo(r)-(s?0:t.c),o=oo(n)-(i?0:t.r);return a+"R"+(0==o?"":i?o+1:"["+o+"]")+"C"+(0==l?"":s?l+1:"["+l+"]")}))}}();function nu(e,t){return e.replace(ru,(function(e,a,s,r,i,n){return a+("$"==s?s+r:ho(uo(r)+t.c))+("$"==i?i+n:co(oo(n)+t.r))}))}function lu(e,t,a){var s=po(t).s,r=fo(a);return nu(e,{r:r.r-s.r,c:r.c-s.c})}function ou(e){return e.replace(/_xlfn\./g,"")}function cu(e){e.l+=1}function du(e,t){var a=e.read_shift(1==t?1:2);return[16383&a,a>>14&1,a>>15&1]}function uu(e,t,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return hu(e);12==a.biff&&(s=4)}var r=e.read_shift(s),i=e.read_shift(s),n=du(e,2),l=du(e,2);return{s:{r:r,c:n[0],cRel:n[1],rRel:n[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function hu(e){var t=du(e,2),a=du(e,2),s=e.read_shift(1),r=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:a[0],c:r,cRel:a[1],rRel:a[2]}}}function fu(e,t,a){if(a&&a.biff>=2&&a.biff<=5)return function(e){var t=du(e,2),a=e.read_shift(1);return{r:t[0],c:a,cRel:t[1],rRel:t[2]}}(e);var s=e.read_shift(a&&12==a.biff?4:2),r=du(e,2);return{r:s,c:r[0],cRel:r[1],rRel:r[2]}}function mu(e){var t=e.read_shift(2),a=e.read_shift(2);return{r:t,c:255&a,fQuoted:!!(16384&a),cRel:a>>15,rRel:a>>15}}function pu(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function vu(e){return[e.read_shift(1),e.read_shift(1)]}function gu(e,t){var a=[e.read_shift(1)];if(12==t)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2}switch(a[0]){case 4:a[1]=bc(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:a[1]=zo[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:a[1]=Fo(e);break;case 2:a[1]=Dc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function bu(e,t,a){for(var s=e.read_shift(12==a.biff?4:2),r=[],i=0;i!=s;++i)r.push((12==a.biff?Lo:_c)(e));return r}function xu(e,t,a){var s=0,r=0;12==a.biff?(s=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),s=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,0==--r&&(r=256));for(var i=0,n=[];i!=s&&(n[i]=[]);++i)for(var l=0;l!=r;++l)n[i][l]=gu(e,a.biff);return n}function yu(e,t,a){return e.l+=2,[mu(e)]}function Su(e){return e.l+=6,[]}function wu(e){return e.l+=2,[xc(e),1&e.read_shift(2)]}var Tu=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],ku={1:{n:"PtgExp",f:function(e,t,a){return e.l++,a&&12==a.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(a&&2==a.biff?1:2)]}},2:{n:"PtgTbl",f:Ql},3:{n:"PtgAdd",f:cu},4:{n:"PtgSub",f:cu},5:{n:"PtgMul",f:cu},6:{n:"PtgDiv",f:cu},7:{n:"PtgPower",f:cu},8:{n:"PtgConcat",f:cu},9:{n:"PtgLt",f:cu},10:{n:"PtgLe",f:cu},11:{n:"PtgEq",f:cu},12:{n:"PtgGe",f:cu},13:{n:"PtgGt",f:cu},14:{n:"PtgNe",f:cu},15:{n:"PtgIsect",f:cu},16:{n:"PtgUnion",f:cu},17:{n:"PtgRange",f:cu},18:{n:"PtgUplus",f:cu},19:{n:"PtgUminus",f:cu},20:{n:"PtgPercent",f:cu},21:{n:"PtgParen",f:cu},22:{n:"PtgMissArg",f:cu},23:{n:"PtgStr",f:function(e,t,a){return e.l++,Sc(e,0,a)}},26:{n:"PtgSheet",f:function(e,t,a){return e.l+=5,e.l+=2,e.l+=2==a.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,a){return e.l+=2==a.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,zo[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Fo(e)}},32:{n:"PtgArray",f:function(e,t,a){var s=(96&e[e.l++])>>5;return e.l+=2==a.biff?6:12==a.biff?14:7,[s]}},33:{n:"PtgFunc",f:function(e,t,a){var s=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(a&&a.biff<=3?1:2);return[zu[r],Hu[r],s]}},34:{n:"PtgFuncVar",f:function(e,t,a){var s=e[e.l++],r=e.read_shift(1),i=a&&a.biff<=3?[88==s?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[r,(0===i[0]?Hu:Wu)[i[1]]]}},35:{n:"PtgName",f:function(e,t,a){var s=e.read_shift(1)>>>5&3,r=!a||a.biff>=8?4:2,i=e.read_shift(r);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[s,0,i]}},36:{n:"PtgRef",f:function(e,t,a){var s=(96&e[e.l])>>5;return e.l+=1,[s,fu(e,0,a)]}},37:{n:"PtgArea",f:function(e,t,a){return[(96&e[e.l++])>>5,uu(e,a.biff>=2&&a.biff,a)]}},38:{n:"PtgMemArea",f:function(e,t,a){var s=e.read_shift(1)>>>5&3;return e.l+=a&&2==a.biff?3:4,[s,e.read_shift(a&&2==a.biff?1:2)]}},39:{n:"PtgMemErr",f:Ql},40:{n:"PtgMemNoMem",f:Ql},41:{n:"PtgMemFunc",f:function(e,t,a){return[e.read_shift(1)>>>5&3,e.read_shift(a&&2==a.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,a){var s=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,12==a.biff&&(e.l+=2),[s]}},43:{n:"PtgAreaErr",f:function(e,t,a){var s=(96&e[e.l++])>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}},44:{n:"PtgRefN",f:function(e,t,a){var s=(96&e[e.l])>>5;e.l+=1;var r=function(e,t,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return function(e){var t=e.read_shift(2),a=e.read_shift(1),s=(32768&t)>>15,r=(16384&t)>>14;return t&=16383,1==s&&t>=8192&&(t-=16384),1==r&&a>=128&&(a-=256),{r:t,c:a,cRel:r,rRel:s}}(e);var r=e.read_shift(s>=12?4:2),i=e.read_shift(2),n=(16384&i)>>14,l=(32768&i)>>15;if(i&=16383,1==l)for(;r>524287;)r-=1048576;if(1==n)for(;i>8191;)i-=16384;return{r:r,c:i,cRel:n,rRel:l}}(e,0,a);return[s,r]}},45:{n:"PtgAreaN",f:function(e,t,a){var s=(96&e[e.l++])>>5,r=function(e,t,a){if(a.biff<8)return hu(e);var s=e.read_shift(12==a.biff?4:2),r=e.read_shift(12==a.biff?4:2),i=du(e,2),n=du(e,2);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:r,c:n[0],cRel:n[1],rRel:n[2]}}}(e,0,a);return[s,r]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,a){return 5==a.biff?function(e){var t=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,a,s]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,a){var s=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(2);return a&&5==a.biff&&(e.l+=12),[s,r,fu(e,0,a)]}},59:{n:"PtgArea3d",f:function(e,t,a){var s=(96&e[e.l++])>>5,r=e.read_shift(2,"i");if(a&&5===a.biff)e.l+=12;return[s,r,uu(e,0,a)]}},60:{n:"PtgRefErr3d",f:function(e,t,a){var s=(96&e[e.l++])>>5,r=e.read_shift(2),i=4;if(a)switch(a.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[s,r]}},61:{n:"PtgAreaErr3d",f:function(e,t,a){var s=(96&e[e.l++])>>5,r=e.read_shift(2),i=8;if(a)switch(a.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[s,r]}},255:{}},Du={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Cu={1:{n:"PtgElfLel",f:wu},2:{n:"PtgElfRw",f:yu},3:{n:"PtgElfCol",f:yu},6:{n:"PtgElfRwV",f:yu},7:{n:"PtgElfColV",f:yu},10:{n:"PtgElfRadical",f:yu},11:{n:"PtgElfRadicalS",f:Su},13:{n:"PtgElfColS",f:Su},15:{n:"PtgElfColSV",f:Su},16:{n:"PtgElfRadicalLel",f:wu},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),r=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&a,rt:Tu[a>>2&31],idx:s,c:r,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Eu={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,a){var s=255&e[e.l+1]?1:0;return e.l+=a&&2==a.biff?3:4,[s]}},2:{n:"PtgAttrIf",f:function(e,t,a){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(a&&2==a.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,a){e.l+=2;for(var s=e.read_shift(a&&2==a.biff?1:2),r=[],i=0;i<=s;++i)r.push(e.read_shift(a&&2==a.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(e,t,a){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(a&&2==a.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,a){e.l+=a&&2==a.biff?3:4}},32:{n:"PtgAttrBaxcel",f:pu},33:{n:"PtgAttrBaxcel",f:pu},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),vu(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),vu(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function Nu(e,t,a,s){if(s.biff<8)return Ql(e,t);for(var r=e.l+t,i=[],n=0;n!==a.length;++n)switch(a[n][0]){case"PtgArray":a[n][1]=xu(e,0,s),i.push(a[n][1]);break;case"PtgMemArea":a[n][2]=bu(e,a[n][1],s),i.push(a[n][2]);break;case"PtgExp":s&&12==s.biff&&(a[n][1][1]=e.read_shift(4),i.push(a[n][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[n][0]}return 0!=(t=r-e.l)&&i.push(Ql(e,t)),i}function Au(e,t,a){for(var s,r,i=e.l+t,n=[];i!=e.l;)t=i-e.l,r=e[e.l],s=ku[r]||ku[Du[r]],24!==r&&25!==r||(s=(24===r?Cu:Eu)[e[e.l+1]]),s&&s.f?n.push([s.n,s.f(e,t,a)]):Ql(e,t);return n}function Iu(e){for(var t=[],a=0;a<e.length;++a){for(var s=e[a],r=[],i=0;i<s.length;++i){var n=s[i];n?2===n[0]?r.push('"'+n[1].replace(/"/g,'""')+'"'):r.push(n[1]):r.push("")}t.push(r.join(","))}return t.join(";")}var ju={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function _u(e,t,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(a.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var r="";if(a.biff>8)switch(e[s[0]][0]){case 357:return r=-1==s[1]?"#REF":e.SheetNames[s[1]],s[1]==s[2]?r:r+":"+e.SheetNames[s[2]];case 358:return null!=a.SID?e.SheetNames[a.SID]:"SH33TJSSAME"+e[s[0]][0];default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return r=-1==s[1]?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?r:r+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[s[0]][0][3]?(r=-1==s[1]?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?r:r+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Ou(e,t,a){var s=_u(e,t,a);return"#REF"==s?s:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(s,a)}function Lu(e,t,a,s,r){var i,n,l,o,c=r&&r.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,v="",g=0,b=e[0].length;g<b;++g){var x=e[0][g];switch(x[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=u.pop(),n=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:v=Cn(" ",e[0][p][1][1]);break;case 1:v=Cn("\r",e[0][p][1][1]);break;default:if(v="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}n+=v,p=-1}u.push(n+ju[x[0]]+i);break;case"PtgIsect":i=u.pop(),n=u.pop(),u.push(n+" "+i);break;case"PtgUnion":i=u.pop(),n=u.pop(),u.push(n+","+i);break;case"PtgRange":i=u.pop(),n=u.pop(),u.push(n+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":l=so(x[1][1],d,r),u.push(no(l,c));break;case"PtgRefN":l=a?so(x[1][1],a,r):x[1][1],u.push(no(l,c));break;case"PtgRef3d":h=x[1][1],l=so(x[1][2],d,r),m=Ou(s,h,r),u.push(m+"!"+no(l,c));break;case"PtgFunc":case"PtgFuncVar":var y=x[1][0],S=x[1][1];y||(y=0);var w=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===S&&(S=w.shift()),u.push(S+"("+w.join(",")+")");break;case"PtgBool":u.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(x[1]);break;case"PtgNum":u.push(String(x[1]));break;case"PtgStr":u.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":o=ro(x[1][1],a?{s:a}:d,r),u.push(lo(o,r));break;case"PtgArea":o=ro(x[1][1],d,r),u.push(lo(o,r));break;case"PtgArea3d":h=x[1][1],o=x[1][2],m=Ou(s,h,r),u.push(m+"!"+lo(o,r));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=x[1][2];var T=(s.names||[])[f-1]||(s[0]||[])[f],k=T?T.Name:"SH33TJSNAME"+String(f);k&&"_xlfn."==k.slice(0,6)&&!r.xlfn&&(k=k.slice(6)),u.push(k);break;case"PtgNameX":var D,C=x[1][1];if(f=x[1][2],!(r.biff<=5)){var E="";if(14849==((s[C]||[])[0]||[])[0]||(1025==((s[C]||[])[0]||[])[0]?s[C][f]&&s[C][f].itab>0&&(E=s.SheetNames[s[C][f].itab-1]+"!"):E=s.SheetNames[f-1]+"!"),s[C]&&s[C][f])E+=s[C][f].Name;else if(s[0]&&s[0][f])E+=s[0][f].Name;else{var N=(_u(s,C,r)||"").split(";;");N[f-1]?E=N[f-1]:E+="SH33TJSERRX"}u.push(E);break}C<0&&(C=-C),s[C]&&(D=s[C][f]),D||(D={Name:"SH33TJSERRY"}),u.push(D.Name);break;case"PtgParen":var A="(",I=")";if(p>=0){switch(v="",e[0][p][1][0]){case 2:A=Cn(" ",e[0][p][1][1])+A;break;case 3:A=Cn("\r",e[0][p][1][1])+A;break;case 4:I=Cn(" ",e[0][p][1][1])+I;break;case 5:I=Cn("\r",e[0][p][1][1])+I;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(A+u.pop()+I);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":l={c:x[1][1],r:x[1][0]};var j={c:a.c,r:a.r};if(s.sharedf[mo(l)]){var _=s.sharedf[mo(l)];u.push(Lu(_,0,j,s,r))}else{var O=!1;for(i=0;i!=s.arrayf.length;++i)if(n=s.arrayf[i],!(l.c<n[0].s.c||l.c>n[0].e.c||l.r<n[0].s.r||l.r>n[0].e.r)){u.push(Lu(n[1],0,j,s,r)),O=!0;break}O||u.push(x[1])}break;case"PtgArray":u.push("{"+Iu(x[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(x))}if(3!=r.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var L=!0;switch((x=e[0][p])[1][0]){case 4:L=!1;case 0:v=Cn(" ",x[1][1]);break;case 5:L=!1;case 1:v=Cn("\r",x[1][1]);break;default:if(v="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}u.push((L?v:"")+u.pop()+(L?"":v)),p=-1}}if(u.length>1&&r.WTF)throw new Error("bad formula stack");return u[0]}function Fu(e,t,a){var s,r=e.l+t,i=2==a.biff?1:2,n=e.read_shift(i);if(65535==n)return[[],Ql(e,t-2)];var l=Au(e,n,a);return t!==n+i&&(s=Nu(e,t-n-i,l,a)),e.l=r,[l,s]}function Mu(e,t,a){var s,r=e.l+t,i=e.read_shift(2),n=Au(e,i,a);return 65535==i?[[],Ql(e,t-2)]:(t!==i+2&&(s=Nu(e,r-i-2,n,a)),[n,s])}function Ru(e,t,a){var s=e.l+t,r=Ac(e);2==a.biff&&++e.l;var i=function(e){var t;if(65535!==Gl(e,e.l+6))return[Fo(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),n=e.read_shift(1);2!=a.biff&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var l=function(e,t,a){var s,r=e.l+t,i=2==a.biff?1:2,n=e.read_shift(i);if(65535==n)return[[],Ql(e,t-2)];var l=Au(e,n,a);return t!==n+i&&(s=Nu(e,t-n-i,l,a)),e.l=r,[l,s]}(e,s-e.l,a);return{cell:r,val:i[0],formula:l,shared:n>>3&1,tt:i[1]}}function Pu(e,t,a){var s=e.read_shift(4),r=Au(e,s,a),i=e.read_shift(4);return[r,i>0?Nu(e,i,r,a):null]}var Uu=Pu,Bu=Pu,Gu=Pu,Vu=Pu,Wu={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},zu={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yu(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Ku(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var $u={},qu={};function Ju(e,t){if(e){var a=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(a=[1,1,1,1,.5,.5]),null==e.left&&(e.left=a[0]),null==e.right&&(e.right=a[1]),null==e.top&&(e.top=a[2]),null==e.bottom&&(e.bottom=a[3]),null==e.header&&(e.header=a[4]),null==e.footer&&(e.footer=a[5])}}function Xu(e,t,a,s,r,i){try{s.cellNF&&(e.z=Ci[t])}catch(l){if(s.WTF)throw l}if("z"!==e.t||s.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=Tn(e.v)),(!s||!1!==s.cellText)&&"z"!==e.t)try{if(null==Ci[t]&&rn(ln[t]||"General",t),"e"===e.t)e.w=e.w||zo[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mi(e.v);else if("d"===e.t){var n=mn(e.v);e.w=(0|n)===n?n.toString(10):Mi(n)}else{if(void 0===e.v)return"";e.w=Ri(e.v,qu)}else"d"===e.t?e.w=sn(t,mn(e.v),qu):e.w=sn(t,e.v,qu)}catch(l){if(s.WTF)throw l}if(s.cellStyles&&null!=a)try{e.s=i.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Nd(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Nd(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(s.WTF&&i.Fills)throw l}}}var Zu=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Qu=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,eh=/<(?:\w:)?hyperlink [^>]*>/gm,th=/"(\w*:\w*)"/,ah=/<(?:\w:)?col\b[^>]*[\/]?>/g,sh=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,rh=/<(?:\w:)?pageMargins[^>]*\/>/g,ih=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nh=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,lh=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function oh(e,t,a,s){var r=Kn(e);a.Sheets[s]||(a.Sheets[s]={}),r.codeName&&(a.Sheets[s].CodeName=Xn(ll(r.codeName)))}var ch=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,dh=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,i=cl("v"),n=cl("f");return function(l,o,c,d,u,h){for(var f,m,p,v,g,b=0,x="",y=[],S=[],w=0,T=0,k=0,D="",C=0,E=0,N=0,A=0,I=Array.isArray(h.CellXf),j=[],_=[],O=Array.isArray(o),L=[],F={},M=!1,R=!!c.sheetStubs,P=l.split(t),U=0,B=P.length;U!=B;++U){var G=(x=P[U].trim()).length;if(0!==G){var V=0;e:for(b=0;b<G;++b)switch(x[b]){case">":if("/"!=x[b-1]){++b;break e}if(c&&c.cellStyles){if(C=null!=(m=Kn(x.slice(V,b),!0)).r?parseInt(m.r,10):C+1,E=-1,c.sheetRows&&c.sheetRows<C)continue;F={},M=!1,m.ht&&(M=!0,F.hpt=parseFloat(m.ht),F.hpx=Pd(F.hpt)),"1"==m.hidden&&(M=!0,F.hidden=!0),null!=m.outlineLevel&&(M=!0,F.level=+m.outlineLevel),M&&(L[C-1]=F)}break;case"<":V=b}if(V>=b)break;if(C=null!=(m=Kn(x.slice(V,b),!0)).r?parseInt(m.r,10):C+1,E=-1,!(c.sheetRows&&c.sheetRows<C)){d.s.r>C-1&&(d.s.r=C-1),d.e.r<C-1&&(d.e.r=C-1),c&&c.cellStyles&&(F={},M=!1,m.ht&&(M=!0,F.hpt=parseFloat(m.ht),F.hpx=Pd(F.hpt)),"1"==m.hidden&&(M=!0,F.hidden=!0),null!=m.outlineLevel&&(M=!0,F.level=+m.outlineLevel),M&&(L[C-1]=F)),y=x.slice(b).split(e);for(var W=0;W!=y.length&&"<"==y[W].trim().charAt(0);++W);for(y=y.slice(W),b=0;b!=y.length;++b)if(0!==(x=y[b].trim()).length){if(S=x.match(a),w=b,T=0,k=0,x="<c "+("<"==x.slice(0,1)?">":"")+x,null!=S&&2===S.length){for(w=0,D=S[1],T=0;T!=D.length&&!((k=D.charCodeAt(T)-64)<1||k>26);++T)w=26*w+k;E=--w}else++E;for(T=0;T!=x.length&&62!==x.charCodeAt(T);++T);if(++T,(m=Kn(x.slice(0,T),!0)).r||(m.r=mo({r:C-1,c:E})),f={t:""},null!=(S=(D=x.slice(T)).match(i))&&""!==S[1]&&(f.v=Xn(S[1])),c.cellFormula){if(null!=(S=D.match(n))&&""!==S[1]){if(f.f=Xn(ll(S[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=ou(f.f)),S[0].indexOf('t="array"')>-1)f.F=(D.match(r)||[])[1],f.F.indexOf(":")>-1&&j.push([go(f.F),f.F]);else if(S[0].indexOf('t="shared"')>-1){v=Kn(S[0]);var H=Xn(ll(S[1]));c.xlfn||(H=ou(H)),_[parseInt(v.si,10)]=[v,H,m.r]}}else(S=D.match(/<f[^>]*\/>/))&&_[(v=Kn(S[0])).si]&&(f.f=lu(_[v.si][1],_[v.si][2],m.r));var z=fo(m.r);for(T=0;T<j.length;++T)z.r>=j[T][0].s.r&&z.r<=j[T][0].e.r&&z.c>=j[T][0].s.c&&z.c<=j[T][0].e.c&&(f.F=j[T][1])}if(null==m.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!R)continue;f.t="z"}else f.t=m.t||"n";switch(d.s.c>E&&(d.s.c=E),d.e.c<E&&(d.e.c=E),f.t){case"n":if(""==f.v||null==f.v){if(!R)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!R)continue;f.t="z"}else p=$u[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?ll(f.v):"",c.cellHTML&&(f.h=el(f.v));break;case"inlineStr":S=D.match(s),f.t="s",null!=S&&(p=hd(S[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=al(f.v);break;case"d":c.cellDates?f.v=Tn(f.v,1):(f.v=mn(Tn(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=Yo[f.v]}if(N=A=0,g=null,I&&void 0!==m.s&&null!=(g=h.CellXf[m.s])&&(null!=g.numFmtId&&(N=g.numFmtId),c.cellStyles&&null!=g.fillId&&(A=g.fillId)),Xu(f,N,A,c,u,h),c.cellDates&&I&&"n"==f.t&&en(Ci[N])&&(f.t="d",f.v=bn(f.v)),m.cm&&c.xlmeta){var Y=(c.xlmeta.Cell||[])[+m.cm-1];Y&&"XLDAPR"==Y.type&&(f.D=!0)}if(O){var K=fo(m.r);o[K.r]||(o[K.r]=[]),o[K.r][K.c]=f}else o[m.r]=f}}}}L.length>0&&(o["!rows"]=L)}}(),uh=Lo;function hh(e){return[Eo(e),Fo(e),"n"]}var fh=Lo,mh=["left","right","top","bottom","header","footer"];var ph=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vh=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gh=[],bh=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function xh(e,t){for(var a=0;a!=e.length;++a)for(var s=e[a],r=0;r!=t.length;++r){var i=t[r];if(null==s[i[0]])s[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof s[i[0]]&&(s[i[0]]=al(s[i[0]]));break;case"int":"string"==typeof s[i[0]]&&(s[i[0]]=parseInt(s[i[0]],10))}}}function yh(e,t){for(var a=0;a!=t.length;++a){var s=t[a];if(null==e[s[0]])e[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof e[s[0]]&&(e[s[0]]=al(e[s[0]]));break;case"int":"string"==typeof e[s[0]]&&(e[s[0]]=parseInt(e[s[0]],10))}}}function Sh(e){yh(e.WBProps,ph),yh(e.CalcPr,bh),xh(e.WBView,vh),xh(e.Sheets,gh),qu.date1904=al(e.WBProps.date1904)}var wh="][*?/\\".split(""),Th=/<\w+:workbook/;function kh(e,t){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=t-8,a}function Dh(e,t,a,s,r,i,n,l){return".bin"===t.slice(-4)?function(e,t,a,s,r,i,n){if(!e)return e;var l=t||{};s||(s={"!id":{}});var o,c,d,u,h,f,m,p,v,g,b=l.dense?[]:{},x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,S=!1,w=[];l.biff=12,l["!row"]=0;var T=0,k=!1,D=[],C={},E=l.supbooks||r.supbooks||[[]];if(E.sharedf=C,E.arrayf=D,E.SheetNames=r.SheetNames||r.Sheets.map((function(e){return e.name})),!l.supbooks&&(l.supbooks=E,r.Names))for(var N=0;N<r.Names.length;++N)E[0][N+1]=r.Names[N];var A,I=[],j=[],_=!1;if(Vh[16]={n:"BrtShortReal",f:hh},to(e,(function(e,t,N){if(!S)switch(N){case 148:o=e;break;case 0:c=e,l.sheetRows&&l.sheetRows<=c.r&&(S=!0),v=co(h=c.r),l["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Pd(e.hpt)),j[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=$u[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==l.cellText&&(d.w=zo[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=n.CellXf[e[0].iStyleRef])&&Xu(d,u.numFmtId,null,l,i,n),f=-1==e[0].c?f+1:e[0].c,l.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[ho(f)+v]=d,l.cellFormula){for(k=!1,T=0;T<D.length;++T){var O=D[T];c.r>=O[0].s.r&&c.r<=O[0].e.r&&f>=O[0].s.c&&f<=O[0].e.c&&(d.F=vo(O[0]),k=!0)}!k&&e.length>3&&(d.f=e[3])}if(x.s.r>c.r&&(x.s.r=c.r),x.s.c>f&&(x.s.c=f),x.e.r<c.r&&(x.e.r=c.r),x.e.c<f&&(x.e.c=f),l.cellDates&&u&&"n"==d.t&&en(Ci[u.numFmtId])){var L=Ii(d.v);L&&(d.t="d",d.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0);break;case 1:case 12:if(!l.sheetStubs||y)break;d={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,l.dense?(b[h]||(b[h]=[]),b[h][f]=d):b[ho(f)+v]=d,x.s.r>c.r&&(x.s.r=c.r),x.s.c>f&&(x.s.c=f),x.e.r<c.r&&(x.e.r=c.r),x.e.c<f&&(x.e.c=f),A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0);break;case 176:w.push(e);break;case 49:A=((l.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=s["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)l.dense?(b[h]||(b[h]=[]),b[h][f]||(b[h][f]={t:"z",v:void 0}),b[h][f].l=e):(m=mo({c:f,r:h}),b[m]||(b[m]={t:"z",v:void 0}),b[m].l=e);break;case 426:if(!l.cellFormula)break;D.push(e),(g=l.dense?b[h][f]:b[ho(f)+v]).f=Lu(e[1],0,{r:c.r,c:f},E,l),g.F=vo(e[0]);break;case 427:if(!l.cellFormula)break;C[mo(e[0].s)]=e[1],(g=l.dense?b[h][f]:b[ho(f)+v]).f=Lu(e[1],0,{r:c.r,c:f},E,l);break;case 60:if(!l.cellStyles)break;for(;e.e>=e.s;)I[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},_||(_=!0,Ld(e.w/256)),Fd(I[e.e+1]);break;case 161:b["!autofilter"]={ref:vo(e)};break;case 476:b["!margins"]=e;break;case 147:r.Sheets[a]||(r.Sheets[a]={}),e.name&&(r.Sheets[a].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),e.RTL&&(r.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:y=!0;break;case 36:case 38:y=!1;break;default:if(t.T);else if(!y||l.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}}),l),delete l.supbooks,delete l["!row"],!b["!ref"]&&(x.s.r<2e6||o&&(o.e.r>0||o.e.c>0||o.s.r>0||o.s.c>0))&&(b["!ref"]=vo(o||x)),l.sheetRows&&b["!ref"]){var O=go(b["!ref"]);l.sheetRows<=+O.e.r&&(O.e.r=l.sheetRows-1,O.e.r>x.e.r&&(O.e.r=x.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>x.e.c&&(O.e.c=x.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),b["!fullref"]=b["!ref"],b["!ref"]=vo(O))}return w.length>0&&(b["!merges"]=w),I.length>0&&(b["!cols"]=I),j.length>0&&(b["!rows"]=j),b}(e,s,a,r,i,n,l):function(e,t,a,s,r,i,n){if(!e)return e;s||(s={"!id":{}});var l=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(Qu);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(ih);h?oh(h[0],0,r,a):(h=c.match(nh))&&function(e,t,a,s,r){oh(e.slice(0,e.indexOf(">")),0,s,r)}(h[0],h[1],0,r,a);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(th);m&&function(e,t){var a=go(t);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=vo(a))}(l,m[1])}var p=c.match(lh);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]),(e.match(ch)||[]).forEach((function(e,a){var s=Kn(e);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),al(s.rightToLeft)&&(t.Views[a].RTL=!0)}))}(p[1],r);var v=[];if(t.cellStyles){var g=c.match(ah);g&&function(e,t){for(var a=!1,s=0;s!=t.length;++s){var r=Kn(t[s],!0);r.hidden&&(r.hidden=al(r.hidden));var i=parseInt(r.min,10)-1,n=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!a&&r.width&&(a=!0,Ld(r.width)),Fd(r);i<=n;)e[i++]=Dn(r)}}(v,g)}u&&dh(u[1],l,t,o,i,n);var b=d.match(sh);b&&(l["!autofilter"]=function(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(b[0]));var x=[],y=d.match(Zu);if(y)for(f=0;f!=y.length;++f)x[f]=go(y[f].slice(y[f].indexOf('"')+1));var S=d.match(eh);S&&function(e,t,a){for(var s=Array.isArray(e),r=0;r!=t.length;++r){var i=Kn(ll(t[r]),!0);if(!i.ref)return;var n=((a||{})["!id"]||[])[i.id];n?(i.Target=n.Target,i.location&&(i.Target+="#"+Xn(i.location))):(i.Target="#"+Xn(i.location),n={Target:i.Target,TargetMode:"Internal"}),i.Rel=n,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=go(i.ref),o=l.s.r;o<=l.e.r;++o)for(var c=l.s.c;c<=l.e.c;++c){var d=mo({c:c,r:o});s?(e[o]||(e[o]=[]),e[o][c]||(e[o][c]={t:"z",v:void 0}),e[o][c].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}(l,S,s);var w,T,k=d.match(rh);if(k&&(l["!margins"]=(w=Kn(k[0]),T={},["left","right","top","bottom","header","footer"].forEach((function(e){w[e]&&(T[e]=parseFloat(w[e]))})),T)),!l["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(l["!ref"]=vo(o)),t.sheetRows>0&&l["!ref"]){var D=go(l["!ref"]);t.sheetRows<=+D.e.r&&(D.e.r=t.sheetRows-1,D.e.r>o.e.r&&(D.e.r=o.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>o.e.c&&(D.e.c=o.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),l["!fullref"]=l["!ref"],l["!ref"]=vo(D))}return v.length>0&&(l["!cols"]=v),x.length>0&&(l["!merges"]=x),l}(e,s,a,r,i,n,l)}var Ch,Eh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Nh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ah(e,t){var a=e.split(/\s+/),s=[];if(t||(s[0]=a[0]),1===a.length)return s;var r,i,n,l=e.match(Eh);if(l)for(n=0;n!=l.length;++n)-1===(i=(r=l[n].match(Nh))[1].indexOf(":"))?s[r[1]]=r[2].slice(1,r[2].length-1):s["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(i+1)]=r[2].slice(1,r[2].length-1);return s}function Ih(e){var t={};if(1===e.split(/\s+/).length)return t;var a,s,r,i=e.match(Eh);if(i)for(r=0;r!=i.length;++r)-1===(s=(a=i[r].match(Nh))[1].indexOf(":"))?t[a[1]]=a[2].slice(1,a[2].length-1):t["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return t}function jh(e,t,a,s){var r=s;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=al(s);break;case"i2":case"int":r=parseInt(s,10);break;case"r4":case"float":r=parseFloat(s);break;case"date":case"dateTime.tz":r=Tn(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[Xn(t)]=r}function _h(e,t,a){if(a.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=Ud[s.Pattern]||s.Pattern)}e[t.ID]=t}function Oh(e,t,a,s,r,i,n,l,o,c){var d="General",u=s.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===u&&l&&(u=l.StyleID),void 0===u&&n&&(u=n.StyleID);void 0!==i[u]&&(i[u].nf&&(d=i[u].nf),i[u].Interior&&f.push(i[u].Interior),i[u].Parent);)u=i[u].Parent;switch(a.Type){case"Boolean":s.t="b",s.v=al(e);break;case"String":s.t="s",s.r=tl(Xn(e)),s.v=e.indexOf("<")>-1?Xn(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),s.v=(Tn(e)-new Date(Date.UTC(1899,11,30)))/864e5,s.v!=s.v?s.v=Xn(e):s.v<60&&(s.v=s.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===s.v&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=Yo[e],!1!==c.cellText&&(s.w=e);break;default:""==e&&""==t?s.t="z":(s.t="s",s.v=tl(t||e))}if(function(e,t,a){if("z"!==e.t){if(!a||!1!==a.cellText)try{"e"===e.t?e.w=e.w||zo[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mi(e.v):e.w=Ri(e.v):e.w=(s=t||"General",r=e.v,"General"===(i=Ch[s]||Xn(s))?Ri(r):sn(i,r))}catch(o){if(a.WTF)throw o}var s,r,i;try{var n=Ch[t]||t||"General";if(a.cellNF&&(e.z=n),a.cellDates&&"n"==e.t&&en(n)){var l=Ii(e.v);l&&(e.t="d",e.v=new Date(l.y,l.m-1,l.d,l.H,l.M,l.S,l.u))}}catch(o){if(a.WTF)throw o}}}(s,d,c),!1!==c.cellFormula)if(s.Formula){var p=Xn(s.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),s.f=su(p,r),delete s.Formula,"RC"==s.ArrayRange?s.F=su("RC:RC",r):s.ArrayRange&&(s.F=su(s.ArrayRange,r),o.push([go(s.F),s.F]))}else for(m=0;m<o.length;++m)r.r>=o[m][0].s.r&&r.r<=o[m][0].e.r&&r.c>=o[m][0].s.c&&r.c<=o[m][0].e.c&&(s.F=o[m][1]);c.cellStyles&&(f.forEach((function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)})),s.s=h),void 0!==s.StyleID&&(s.ixfe=s.StyleID)}function Lh(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Fh(e,t){var a=t||{};nn();var s=ti(vl(e));"binary"!=a.type&&"array"!=a.type&&"base64"!=a.type||(s=ll(s));var r,i=s.slice(0,1024).toLowerCase(),n=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var l=Dn(a);return l.type="string",id.to_workbook(s,l)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(n=!0)})),n)return function(e,t){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||0==a.length)throw new Error("Invalid HTML: could not find <table>");if(1==a.length)return xo(zh(a[0],t),t);var s={SheetNames:[],Sheets:{}};return a.forEach((function(e,a){jf(s,zh(e,t),"Sheet"+(a+1))})),s}(s,a);Ch={"General Number":"General","General Date":Ci[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ci[15],"Short Date":Ci[14],"Long Time":Ci[19],"Medium Time":Ci[18],"Short Time":Ci[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ci[2],Standard:Ci[4],Percent:Ci[10],Scientific:Ci[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c,d=[],u={},h=[],f=a.dense?[]:{},m="",p={},v={},g=Ah('<Data ss:Type="String">'),b=0,x=0,y=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},T={},k="",D=0,C=[],E={},N={},A=0,I=[],j=[],_={},O=[],L=!1,F=[],M=[],R={},P=0,U=0,B={Sheets:[],WBProps:{date1904:!1}},G={};gl.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/gm,"");for(var V="";r=gl.exec(s);)switch(r[3]=(V=r[3]).toLowerCase()){case"data":if("data"==V){if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break}if(d[d.length-1][1])break;"/"===r[1]?Oh(s.slice(b,r.index),k,g,"comment"==d[d.length-1][0]?_:p,{c:x,r:y},w,O[x],v,F,a):(k="",g=Ah(r[0]),b=r.index+r[0].length);break;case"cell":if("/"===r[1])if(j.length>0&&(p.c=j),(!a.sheetRows||a.sheetRows>y)&&void 0!==p.v&&(a.dense?(f[y]||(f[y]=[]),f[y][x]=p):f[ho(x)+co(y)]=p),p.HRef&&(p.l={Target:Xn(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(P=x+(0|parseInt(p.MergeAcross,10)),U=y+(0|parseInt(p.MergeDown,10)),C.push({s:{c:x,r:y},e:{c:P,r:U}})),a.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var W=x;W<=P;++W)for(var H=y;H<=U;++H)(W>x||H>y)&&(a.dense?(f[H]||(f[H]=[]),f[H][W]={t:"z"}):f[ho(W)+co(H)]={t:"z"});x=P+1}else++x;else p.MergeAcross?x=P+1:++x;else(p=Ih(r[0])).Index&&(x=+p.Index-1),x<S.s.c&&(S.s.c=x),x>S.e.c&&(S.e.c=x),"/>"===r[0].slice(-2)&&++x,j=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(y<S.s.r&&(S.s.r=y),y>S.e.r&&(S.e.r=y),"/>"===r[0].slice(-2)&&(v=Ah(r[0])).Index&&(y=+v.Index-1),x=0,++y):((v=Ah(r[0])).Index&&(y=+v.Index-1),R={},("0"==v.AutoFitHeight||v.Height)&&(R.hpx=parseInt(v.Height,10),R.hpt=Rd(R.hpx),M[y]=R),"1"==v.Hidden&&(R.hidden=!0,M[y]=R));break;case"worksheet":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"));h.push(m),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(f["!ref"]=vo(S),a.sheetRows&&a.sheetRows<=S.e.r&&(f["!fullref"]=f["!ref"],S.e.r=a.sheetRows-1,f["!ref"]=vo(S))),C.length&&(f["!merges"]=C),O.length>0&&(f["!cols"]=O),M.length>0&&(f["!rows"]=M),u[m]=f}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=x=0,d.push([r[3],!1]),o=Ah(r[0]),m=Xn(o.Name),f=a.dense?[]:{},C=[],F=[],M=[],G={name:m,Hidden:0},B.Sheets.push(G);break;case"table":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else{if("/>"==r[0].slice(-2))break;d.push([r[3],!1]),O=[],L=!1}break;case"style":"/"===r[1]?_h(w,T,a):T=Ah(r[0]);break;case"numberformat":T.nf=Xn(Ah(r[0]).Format||"General"),Ch[T.nf]&&(T.nf=Ch[T.nf]);for(var z=0;392!=z&&Ci[z]!=T.nf;++z);if(392==z)for(z=57;392!=z;++z)if(null==Ci[z]){rn(T.nf,z);break}break;case"column":if("table"!==d[d.length-1][0])break;if((c=Ah(r[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!L&&c.wpx>10){L=!0,Ad=6;for(var Y=0;Y<O.length;++Y)O[Y]&&Fd(O[Y])}L&&Fd(c),O[c.Index-1||O.length]=c;for(var K=0;K<+c.Span;++K)O[O.length]=Dn(c);break;case"namedrange":if("/"===r[1])break;B.Names||(B.Names=[]);var $=Kn(r[0]),q={Name:$.Name,Ref:su($.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(q.Sheet=B.Sheets.length-1),B.Names.push(q);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===r[0].slice(-2))break;"/"===r[1]?k+=s.slice(D,r.index):D=r.index+r[0].length;break;case"interior":if(!a.cellStyles)break;T.Interior=Ah(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===r[0].slice(-2))break;"/"===r[1]?ic(E,V,s.slice(A,r.index)):A=r.index+r[0].length;break;case"styles":case"workbook":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else d.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"));Lh(_),j.push(_)}else d.push([r[3],!1]),_={a:(o=Ah(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var J=Ah(r[0]);f["!autofilter"]={ref:su(J.Range).replace(/\$/g,"")},d.push([r[3],!0])}break;case"datavalidation":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((o=d.pop())[0]!==r[3])throw new Error("Bad state: "+o.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break;default:if(0==d.length&&"document"==r[3])return Qh(s,a);if(0==d.length&&"uof"==r[3])return Qh(s,a);var X=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(r[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:X=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(s.slice(A,r.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2}else A=r.index+r[0].length;break;case"header":f["!margins"]||Ju(f["!margins"]={},"xlml"),isNaN(+Kn(r[0]).Margin)||(f["!margins"].header=+Kn(r[0]).Margin);break;case"footer":f["!margins"]||Ju(f["!margins"]={},"xlml"),isNaN(+Kn(r[0]).Margin)||(f["!margins"].footer=+Kn(r[0]).Margin);break;case"pagemargins":var Z=Kn(r[0]);f["!margins"]||Ju(f["!margins"]={},"xlml"),isNaN(+Z.Top)||(f["!margins"].top=+Z.Top),isNaN(+Z.Left)||(f["!margins"].left=+Z.Left),isNaN(+Z.Right)||(f["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(f["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:X=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:X=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:X=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:X=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1}if(X)break;if(r[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+d.join("|");if("customdocumentproperties"===d[d.length-1][0]){if("/>"===r[0].slice(-2))break;"/"===r[1]?jh(N,V,I,s.slice(A,r.index)):(I=r,A=r.index+r[0].length);break}if(a.WTF)throw"Unrecognized tag: "+r[3]+"|"+d.join("|")}var Q={};return a.bookSheets||a.bookProps||(Q.Sheets=u),Q.SheetNames=h,Q.Workbook=B,Q.SSF=Dn(Ci),Q.Props=E,Q.Custprops=N,Q}function Mh(e,t){switch(pf(t=t||{}),t.type||"base64"){case"base64":return Fh(ni(e),t);case"binary":case"buffer":case"file":return Fh(e,t);case"array":return Fh(hi(e),t)}}var Rh=[60,1084,2066,2165,2175];function Ph(e,t,a,s,r){var i=s,n=[],l=a.slice(a.l,a.l+i);if(r&&r.enc&&r.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:r.enc.insitu(l)}n.push(l),a.l+=i;for(var o=Gl(a,a.l),c=Wh[o],d=0;null!=c&&Rh.indexOf(o)>-1;)i=Gl(a,a.l+2),d=a.l+4,2066==o?d+=4:2165!=o&&2175!=o||(d+=12),l=a.slice(d,a.l+4+i),n.push(l),a.l+=4+i,c=Wh[o=Gl(a,a.l)];var u=mi(n);Zl(u,0);var h=0;u.lens=[];for(var f=0;f<n.length;++f)u.lens.push(h),h+=n[f].length;if(u.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+s;return t.f(u,u.length,r)}function Uh(e,t,a){if("z"!==e.t&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ci[s])}catch(i){if(t.WTF)throw i}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||zo[e.v]:0===s||"General"==s?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Mi(e.v):e.w=Ri(e.v):e.w=sn(s,e.v,{date1904:!!a,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&"n"==e.t&&en(Ci[s]||String(s))){var r=Ii(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function Bh(e,t,a){return{v:e,ixfe:t,t:a}}function Gh(e,t){var a,s,r,i;if(t||(t={}),pf(t),Xr(),t.codepage&&qr(t.codepage),e.FullPaths){if(dn.find(e,"/encryption"))throw new Error("File is password-protected");a=dn.find(e,"!CompObj"),s=dn.find(e,"/Workbook")||dn.find(e,"/Book")}else{switch(t.type){case"base64":e=ui(ni(e));break;case"binary":e=ui(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Zl(e,0),s={content:e}}if(a&&function(e){var t={},a=e.content;if(a.l=28,t.AnsiUserType=a.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Mo(e,1)}(a),a.length-a.l<=4)return t;var s=a.read_shift(4);0==s||s>40||(a.l-=4,t.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4||1907505652!==(s=a.read_shift(4))||(t.UnicodeClipboardFormat=function(e){return Mo(e,2)}(a),0==(s=a.read_shift(4))||s>40||(a.l-=4,t.Reserved2=a.read_shift(0,"lpwstr"))))}(a),t.bookProps&&!t.bookSheets)r={};else{var n=li?"buffer":"array";if(s&&s.content)r=function(e,t){var a,s,r,i,n,l,o,c,d={opts:{}},u={},h=t.dense?[]:{},f={},m={},p=null,v=[],g="",b={},x="",y={},S=[],w=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},C=function(e){return e<8?Ho[e]:e<64&&T[e-8]||Ho[e]},E=function(e,t,s){if(!(R>1||s.sheetRows&&e.r>=s.sheetRows)){if(s.cellStyles&&t.XF&&t.XF.data&&function(e,t,a){var s,r=t.XF.data;r&&r.patternType&&a&&a.cellStyles&&(t.s={},t.s.patternType=r.patternType,(s=Ed(C(r.icvFore)))&&(t.s.fgColor={rgb:s}),(s=Ed(C(r.icvBack)))&&(t.s.bgColor={rgb:s}))}(0,t,s),delete t.ixfe,delete t.XF,a=e,x=mo(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),s.cellFormula&&t.f)for(var r=0;r<S.length;++r)if(!(S[r][0].s.c>e.c||S[r][0].s.r>e.r||S[r][0].e.c<e.c||S[r][0].e.r<e.r)){t.F=vo(S[r][0]),S[r][0].s.c==e.c&&S[r][0].s.r==e.r||delete t.f,t.f&&(t.f=""+Lu(S[r][1],0,e,L,N));break}s.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[x]=t}},N={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(N.password=t.password);var A=[],I=[],j=[],_=[],O=!1,L=[];L.SheetNames=N.snames,L.sharedf=N.sharedf,L.arrayf=N.arrayf,L.names=[],L.XTI=[];var F,M=0,R=0,P=0,U=[],B=[];N.codepage=1200,Jr(1200);for(var G=!1;e.l<e.length-1;){var V=e.l,W=e.read_shift(2);if(0===W&&10===M)break;var H=e.l===e.length?0:e.read_shift(2),z=Wh[W];if(z&&z.f){if(t.bookSheets&&133===M&&133!==W)break;if(M=W,2===z.r||12==z.r){var Y=e.read_shift(2);if(H-=2,!N.enc&&Y!==W&&((255&Y)<<8|Y>>8)!==W)throw new Error("rt mismatch: "+Y+"!="+W);12==z.r&&(e.l+=10,H-=10)}var K={};if(K=10===W?z.f(e,H,N):Ph(W,z,e,H,N),0==R&&-1===[9,521,1033,2057].indexOf(M))continue;switch(W){case 34:d.opts.Date1904=k.WBProps.date1904=K;break;case 134:d.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=K;break;case 66:var $=Number(K);switch($){case 21010:$=1200;break;case 32768:$=1e4;break;case 32769:$=1252}Jr(N.codepage=$),G=!0;break;case 317:N.rrtabid=K;break;case 25:N.winlocked=K;break;case 439:d.opts.RefreshAll=K;break;case 12:d.opts.CalcCount=K;break;case 16:d.opts.CalcDelta=K;break;case 17:d.opts.CalcIter=K;break;case 13:d.opts.CalcMode=K;break;case 14:d.opts.CalcPrecision=K;break;case 95:d.opts.CalcSaveRecalc=K;break;case 15:N.CalcRefMode=K;break;case 2211:d.opts.FullCalc=K;break;case 129:K.fDialog&&(h["!type"]="dialog"),K.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),K.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:w.push(K);break;case 430:L.push([K]),L[L.length-1].XTI=[];break;case 35:case 547:L[L.length-1].push(K);break;case 24:case 536:F={Name:K.Name,Ref:Lu(K.rgce,0,null,L,N)},K.itab>0&&(F.Sheet=K.itab-1),L.names.push(F),L[0]||(L[0]=[],L[0].XTI=[]),L[L.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(B[K.itab-1]={ref:vo(K.rgce[0][0][1][2])});break;case 22:N.ExternCount=K;break;case 23:0==L.length&&(L[0]=[],L[0].XTI=[]),L[L.length-1].XTI=L[L.length-1].XTI.concat(K),L.XTI=L.XTI.concat(K);break;case 2196:if(N.biff<8)break;null!=F&&(F.Comment=K[1]);break;case 18:h["!protect"]=K;break;case 19:0!==K&&N.WTF;break;case 133:f[K.pos]=K,N.snames.push(K.name);break;case 10:if(--R)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,h["!ref"]=vo(m),t.sheetRows&&t.sheetRows<=m.e.r){var q=m.e.r;m.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=vo(m),m.e.r=q}m.e.r++,m.e.c++}A.length>0&&(h["!merges"]=A),I.length>0&&(h["!objects"]=I),j.length>0&&(h["!cols"]=j),_.length>0&&(h["!rows"]=_),k.Sheets.push(D)}""===g?b=h:u[g]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===N.biff&&(N.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),N.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(N.biff=5,G=!0,Jr(N.codepage=28591)),8==N.biff&&0==K.BIFFVer&&16==K.dt&&(N.biff=2),R++)break;if(h=t.dense?[]:{},N.biff<8&&!G&&(G=!0,Jr(N.codepage=t.codepage||1252)),N.biff<5||0==K.BIFFVer&&4096==K.dt){""===g&&(g="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-H,name:g};f[J.pos]=J,N.snames.push(g)}else g=(f[V]||{name:""}).name;32==K.dt&&(h["!type"]="chart"),64==K.dt&&(h["!type"]="macro"),A=[],I=[],N.arrayf=S=[],j=[],_=[],O=!1,D={Hidden:(f[V]||{hs:0}).hs,name:g};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[K.r]||[])[K.c]:h[mo({c:K.c,r:K.r})])&&++K.c,l={ixfe:K.ixfe,XF:w[K.ixfe]||{},v:K.val,t:"n"},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t);break;case 5:case 517:l={ixfe:K.ixfe,XF:w[K.ixfe],v:K.val,t:K.t},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t);break;case 638:l={ixfe:K.ixfe,XF:w[K.ixfe],v:K.rknum,t:"n"},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t);break;case 189:for(var X=K.c;X<=K.C;++X){var Z=K.rkrec[X-K.c][0];l={ixfe:Z,XF:w[Z],v:K.rkrec[X-K.c][1],t:"n"},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:X,r:K.r},l,t)}break;case 6:case 518:case 1030:if("String"==K.val){p=K;break}if((l=Bh(K.val,K.cell.ixfe,K.tt)).XF=w[l.ixfe],t.cellFormula){var Q=K.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],te=Q[0][0][1][1],ae=mo({r:ee,c:te});y[ae]?l.f=""+Lu(K.formula,0,K.cell,L,N):l.F=((t.dense?(h[ee]||[])[te]:h[ae])||{}).F}else l.f=""+Lu(K.formula,0,K.cell,L,N)}P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E(K.cell,l,t),p=K;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=K,(l=Bh(K,p.cell.ixfe,"s")).XF=w[l.ixfe],t.cellFormula&&(l.f=""+Lu(p.formula,0,p.cell,L,N)),P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E(p.cell,l,t),p=null;break;case 33:case 545:S.push(K);var se=mo(K[0].s);if(s=t.dense?(h[K[0].s.r]||[])[K[0].s.c]:h[se],t.cellFormula&&s){if(!p)break;if(!se||!s)break;s.f=""+Lu(K[1],0,K[0],L,N),s.F=vo(K[0])}break;case 1212:if(!t.cellFormula)break;if(x){if(!p)break;y[mo(p.cell)]=K[0],((s=t.dense?(h[p.cell.r]||[])[p.cell.c]:h[mo(p.cell)])||{}).f=""+Lu(K[0],0,a,L,N)}break;case 253:l=Bh(v[K.isst].t,K.ixfe,"s"),v[K.isst].h&&(l.h=v[K.isst].h),l.XF=w[l.ixfe],P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t);break;case 513:t.sheetStubs&&(l={ixfe:K.ixfe,XF:w[K.ixfe],t:"z"},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t));break;case 190:if(t.sheetStubs)for(var re=K.c;re<=K.C;++re){var ie=K.ixfe[re-K.c];l={ixfe:ie,XF:w[ie],t:"z"},P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:re,r:K.r},l,t)}break;case 214:case 516:case 4:(l=Bh(K.val,K.ixfe,"s")).XF=w[l.ixfe],P>0&&(l.z=U[l.ixfe>>8&63]),Uh(l,t,d.opts.Date1904),E({c:K.c,r:K.r},l,t);break;case 0:case 512:1===R&&(m=K);break;case 252:v=K;break;case 1054:if(4==N.biff){U[P++]=K[1];for(var ne=0;ne<P+163&&Ci[ne]!=K[1];++ne);ne>=163&&rn(K[1],P+163)}else rn(K[1],K[0]);break;case 30:U[P++]=K;for(var le=0;le<P+163&&Ci[le]!=K;++le);le>=163&&rn(K,P+163);break;case 229:A=A.concat(K);break;case 93:I[K.cmo[0]]=N.lastobj=K;break;case 438:N.lastobj.TxO=K;break;case 127:N.lastobj.ImData=K;break;case 440:for(n=K[0].s.r;n<=K[0].e.r;++n)for(i=K[0].s.c;i<=K[0].e.c;++i)(s=t.dense?(h[n]||[])[i]:h[mo({c:i,r:n})])&&(s.l=K[1]);break;case 2048:for(n=K[0].s.r;n<=K[0].e.r;++n)for(i=K[0].s.c;i<=K[0].e.c;++i)(s=t.dense?(h[n]||[])[i]:h[mo({c:i,r:n})])&&s.l&&(s.l.Tooltip=K[1]);break;case 28:if(N.biff<=5&&N.biff>=2)break;s=t.dense?(h[K[0].r]||[])[K[0].c]:h[mo(K[0])];var oe=I[K[2]];s||(t.dense?(h[K[0].r]||(h[K[0].r]=[]),s=h[K[0].r][K[0].c]={t:"z"}):s=h[mo(K[0])]={t:"z"},m.e.r=Math.max(m.e.r,K[0].r),m.s.r=Math.min(m.s.r,K[0].r),m.e.c=Math.max(m.e.c,K[0].c),m.s.c=Math.min(m.s.c,K[0].c)),s.c||(s.c=[]),r={a:K[1],t:oe.TxO.t},s.c.push(r);break;case 2173:w[K.ixfe],K.ext.forEach((function(e){e[0]}));break;case 125:if(!N.cellStyles)break;for(;K.e>=K.s;)j[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},O||(O=!0,Ld(K.w/256)),Fd(j[K.e+1]);break;case 520:var ce={};null!=K.level&&(_[K.r]=ce,ce.level=K.level),K.hidden&&(_[K.r]=ce,ce.hidden=!0),K.hpt&&(_[K.r]=ce,ce.hpt=K.hpt,ce.hpx=Pd(K.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||Ju(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=K;break;case 161:h["!margins"]||Ju(h["!margins"]={}),h["!margins"].header=K.header,h["!margins"].footer=K.footer;break;case 574:K.RTL&&(k.Views[0].RTL=!0);break;case 146:T=K;break;case 2198:c=K;break;case 140:o=K;break;case 442:g?D.CodeName=K||D.name:k.WBProps.CodeName=K||"ThisWorkbook"}}else e.l+=H}return d.SheetNames=un(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(d.Sheets=u),!d.SheetNames.length&&b["!ref"]?(d.SheetNames.push("Sheet1"),d.Sheets&&(d.Sheets.Sheet1=b)):d.Preamble=b,d.Sheets&&B.forEach((function(e,t){d.Sheets[d.SheetNames[t]]["!autofilter"]=e})),d.Strings=v,d.SSF=Dn(Ci),N.enc&&(d.Encryption=N.enc),c&&(d.Themes=c),d.Metadata={},void 0!==o&&(d.Metadata.Country=o),L.names.length>0&&(k.Names=L.names),d.Workbook=k,d}(s.content,t);else if((i=dn.find(e,"PerfectOffice_MAIN"))&&i.content)r=nd.to_workbook(i.content,(t.type=n,t));else{if(!(i=dn.find(e,"NativeContent_MAIN"))||!i.content)throw(i=dn.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=nd.to_workbook(i.content,(t.type=n,t))}t.bookVBA&&e.FullPaths&&dn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=function(e){var t=dn.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(a,s){if("/"!==a.slice(-1)&&a.match(/_VBA_PROJECT_CUR/)){var r=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");dn.utils.cfb_add(t,r,e.FileIndex[s].content)}})),dn.write(t)}(e))}var l={};return e.FullPaths&&function(e,t,a){var s=dn.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var r=vc(s,Uo,"02d5cdd59c2e1b10939708002b2cf9ae");for(var i in r)t[i]=r[i]}catch(c){if(a.WTF)throw c}var n=dn.find(e,"/!SummaryInformation");if(n&&n.size>0)try{var l=vc(n,Bo,"e0859ff2f94f6810ab9108002b27b3d9");for(var o in l)null==t[o]&&(t[o]=l[o])}catch(c){if(a.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(tc(t.HeadingPairs,t.TitlesOfParts,t,a),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,l,t),r.Props=r.Custprops=l,t.bookFiles&&(r.cfb=e),r}var Vh={0:{f:function(e,t){var a={},s=e.l+t;a.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,7&i&&(a.level=7&i),16&i&&(a.hidden=!0),32&i&&(a.hpt=r/20),a}},1:{f:function(e){return[Co(e)]}},2:{f:function(e){return[Co(e),_o(e),"n"]}},3:{f:function(e){return[Co(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Co(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Co(e),Fo(e),"n"]}},6:{f:function(e){return[Co(e),wo(e),"str"]}},7:{f:function(e){return[Co(e),e.read_shift(4),"s"]}},8:{f:function(e,t,a){var s=e.l+t,r=Co(e);r.r=a["!row"];var i=[r,wo(e),"str"];if(a.cellFormula){e.l+=2;var n=Bu(e,s-e.l,a);i[3]=Lu(n,0,r,a.supbooks,a)}else e.l=s;return i}},9:{f:function(e,t,a){var s=e.l+t,r=Co(e);r.r=a["!row"];var i=[r,Fo(e),"n"];if(a.cellFormula){e.l+=2;var n=Bu(e,s-e.l,a);i[3]=Lu(n,0,r,a.supbooks,a)}else e.l=s;return i}},10:{f:function(e,t,a){var s=e.l+t,r=Co(e);r.r=a["!row"];var i=[r,e.read_shift(1),"b"];if(a.cellFormula){e.l+=2;var n=Bu(e,s-e.l,a);i[3]=Lu(n,0,r,a.supbooks,a)}else e.l=s;return i}},11:{f:function(e,t,a){var s=e.l+t,r=Co(e);r.r=a["!row"];var i=[r,e.read_shift(1),"e"];if(a.cellFormula){e.l+=2;var n=Bu(e,s-e.l,a);i[3]=Lu(n,0,r,a.supbooks,a)}else e.l=s;return i}},12:{f:function(e){return[Eo(e)]}},13:{f:function(e){return[Eo(e),_o(e),"n"]}},14:{f:function(e){return[Eo(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Eo(e),e.read_shift(1),"b"]}},16:{f:hh},17:{f:function(e){return[Eo(e),wo(e),"str"]}},18:{f:function(e){return[Eo(e),e.read_shift(4),"s"]}},19:{f:ko},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,a){var s=e.l+t;e.l+=4,e.l+=1;var r=e.read_shift(4),i=Io(e),n=Gu(e,0,a),l=Ao(e);e.l=s;var o={Name:i,Ptg:n};return r<268435455&&(o.Sheet=r),l&&(o.Comment=l),o}},40:{},42:{},43:{f:function(e,t,a){var s={};s.sz=e.read_shift(2)/20;var r=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(r.fItalic&&(s.italic=1),r.fCondense&&(s.condense=1),r.fExtend&&(s.extend=1),r.fShadow&&(s.shadow=1),r.fOutline&&(s.outline=1),r.fStrikeout&&(s.strike=1),700===e.read_shift(2)&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(s.underline=i);var n=e.read_shift(1);n>0&&(s.family=n);var l=e.read_shift(1);switch(l>0&&(s.charset=l),e.l++,s.color=function(e){var t={},a=e.read_shift(1)>>>1,s=e.read_shift(1),r=e.read_shift(2,"i"),i=e.read_shift(1),n=e.read_shift(1),l=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var o=Ho[s];o&&(t.rgb=Ed(o));break;case 2:t.rgb=Ed([i,n,l]);break;case 3:t.theme=s}return 0!=r&&(t.tint=r>0?r/32767:r/32768),t}(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor"}return s.name=wo(e),s}},44:{f:function(e,t){return[e.read_shift(2),wo(e)]}},45:{f:Wd},46:{f:Hd},47:{f:function(e,t){var a=e.l+t,s=e.read_shift(2),r=e.read_shift(2);return e.l=a,{ixfe:s,numFmtId:r}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],a=e.read_shift(4);a-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Jc},62:{f:function(e){return[Co(e),ko(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),t.r=mo(a);var s=e.read_shift(1);return 2&s&&(t.l="1"),8&s&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ql,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var a={},s=e[e.l];return++e.l,a.above=!(64&s),a.left=!(128&s),e.l+=18,a.name=No(e),a}},148:{f:uh,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var a={},s=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var r=t>8?wo(e):"";return r.length>0&&(a.CodeName=r),a.autoCompressPictures=!!(65536&s),a.backupFile=!!(64&s),a.checkCompatibility=!!(4096&s),a.date1904=!!(1&s),a.filterPrivacy=!!(8&s),a.hidePivotFieldList=!!(1024&s),a.promptedSolutions=!!(16&s),a.publishItems=!!(2048&s),a.refreshAllConnections=!!(262144&s),a.saveExternalLinkValues=!!(128&s),a.showBorderUnselectedTables=!!(4&s),a.showInkAnnotation=!!(32&s),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(32768&s),a.updateLinks=["userSet","never","always"][s>>8&3],a}},154:{},155:{},156:{f:function(e,t){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=jo(e),a.name=wo(e),a}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Lo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fh},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:wo(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jo},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Kc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,a){var s=e.l+t,r=Oo(e),i=e.read_shift(1),n=[r];if(n[2]=i,a.cellFormula){var l=Uu(e,s-e.l,a);n[1]=l}else e.l=s;return n}},427:{f:function(e,t,a){var s=e.l+t,r=[Lo(e)];if(a.cellFormula){var i=Vu(e,s-e.l,a);r[1]=i,e.l=s}else e.l=s;return r}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return mh.forEach((function(a){t[a]=Fo(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var a=e.l+t,s=Lo(e),r=Ao(e),i=wo(e),n=wo(e),l=wo(e);e.l=a;var o={rfx:s,relId:r,loc:i,display:l};return n&&(o.Tooltip=n),o}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jo},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:au},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var a=Lo(e);return t.rfx=a.s,t.ref=mo(a.s),e.l+=16,t}},636:{T:-1},637:{f:Do},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:wo(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Wh={6:{f:Ru},10:{f:gc},12:{f:xc},13:{f:xc},14:{f:bc},15:{f:bc},16:{f:Fo},17:{f:bc},18:{f:bc},19:{f:xc},20:{f:Wc},21:{f:Wc},23:{f:Kc},24:{f:Yc},25:{f:bc},26:{},27:{},28:{f:function(e,t,a){return function(e,t,a){if(!(a.biff<8)){var s=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),n=e.read_shift(2),l=Dc(e,0,a);return a.biff<8&&e.read_shift(1),[{r:s,c:r},l,n,i]}}(e,0,a)}},29:{},34:{f:bc},35:{f:Hc},38:{f:Fo},39:{f:Fo},40:{f:Fo},41:{f:Fo},42:{f:bc},43:{f:bc},47:{f:function(e,t,a){var s={Type:a.biff>=8?e.read_shift(2):0};return s.Type?function(e,t,a){var s=a||{};s.Info=e.read_shift(2),e.l-=2,1===s.Info?s.Data=function(e){var t={},a=t.EncryptionVersionInfo=gd(e,4);if(1!=a.Major||1!=a.Minor)throw"unrecognized version code "+a.Major+" : "+a.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):s.Data=function(e,t){var a={},s=a.EncryptionVersionInfo=gd(e,4);if(t-=4,2!=s.Minor)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);a.Flags=e.read_shift(4),t-=4;var r=e.read_shift(4);return t-=4,a.EncryptionHeader=xd(e,r),t-=r,a.EncryptionVerifier=yd(e,t),a}(e,t)}(e,t-2,s):Dd(e,a.biff,a,s),s}},49:{f:function(e,t,a){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return s.name=Sc(e,0,a),s}},51:{f:xc},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:bc},65:{f:function(){}},66:{f:xc},77:{},80:{},81:{},82:{},85:{f:xc},89:{},90:{},91:{},92:{f:function(e,t,a){if(a.enc)return e.l+=t,"";var s=e.l,r=Dc(e,0,a);return e.read_shift(t+s-e.l),r}},93:{f:function(e,t,a){if(a&&a.biff<8)return function(e,t,a){e.l+=4;var s=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var n=[];return n.push((qc[s]||Ql)(e,t,a)),{cmo:[r,s,i],ft:n}}(e,t,a);var s=Fc(e),r=function(e,t){for(var a=e.l+t,s=[];e.l<a;){var r=e.read_shift(2);e.l-=2;try{s.push(Rc[r](e,a-e.l))}catch(i){return e.l=a,s}}return e.l!=a&&(e.l=a),s}(e,t-22,s[1]);return{cmo:s,ft:r}}},94:{},95:{f:bc},96:{},97:{},99:{f:bc},125:{f:Jc},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,a){var s=a&&8==a.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&s,fBelow:64&s,fRight:128&s}}},130:{f:xc},131:{f:bc},132:{f:bc},133:{f:function(e,t,a){var s=e.read_shift(4),r=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var n=Sc(e,0,a);return 0===n.length&&(n="Sheet1"),{pos:s,hs:r,dt:i,name:n}}},134:{},140:{f:function(e){var t,a=[0,0];return t=e.read_shift(2),a[0]=Go[t]||t,t=e.read_shift(2),a[1]=Go[t]||t,a}},141:{f:xc},144:{},146:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(Nc(e));return a}},151:{},152:{},153:{},154:{},155:{},156:{f:xc},157:{},158:{},160:{f:Zc},161:{f:function(e,t){var a={};return t<32||(e.l+=16,a.header=Fo(e),a.footer=Fo(e),e.l+=2),a}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var a=e.l+t-2,s=e.read_shift(2),r=e.read_shift(2),i=[];e.l<a;)i.push(jc(e));if(e.l!==a)throw new Error("MulRK read error");var n=e.read_shift(2);if(i.length!=n-r+1)throw new Error("MulRK length mismatch");return{r:s,c:r,C:n,rkrec:i}}},190:{f:function(e,t){for(var a=e.l+t-2,s=e.read_shift(2),r=e.read_shift(2),i=[];e.l<a;)i.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var n=e.read_shift(2);if(i.length!=n-r+1)throw new Error("MulBlank length mismatch");return{r:s,c:r,C:n,ixfe:i}}},193:{f:gc},197:{},198:{},199:{},200:{},201:{},202:{f:bc},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:xc},220:{},221:{f:bc},222:{},224:{f:function(e,t,a){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,s.data=function(e,t,a,s){var r={},i=e.read_shift(4),n=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(2);return r.patternType=Vo[l>>26],s.cellStyles?(r.alc=7&i,r.fWrap=i>>3&1,r.alcV=i>>4&7,r.fJustLast=i>>7&1,r.trot=i>>8&255,r.cIndent=i>>16&15,r.fShrinkToFit=i>>20&1,r.iReadOrder=i>>22&2,r.fAtrNum=i>>26&1,r.fAtrFnt=i>>27&1,r.fAtrAlc=i>>28&1,r.fAtrBdr=i>>29&1,r.fAtrPat=i>>30&1,r.fAtrProt=i>>31&1,r.dgLeft=15&n,r.dgRight=n>>4&15,r.dgTop=n>>8&15,r.dgBottom=n>>12&15,r.icvLeft=n>>16&127,r.icvRight=n>>23&127,r.grbitDiag=n>>30&3,r.icvTop=127&l,r.icvBottom=l>>7&127,r.icvDiag=l>>14&127,r.dgDiag=l>>21&15,r.icvFore=127&o,r.icvBack=o>>7&127,r.fsxButton=o>>14&1,r):r}(e,0,s.fStyle,a),s}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:gc},227:{},229:{f:function(e,t){for(var a=[],s=e.read_shift(2);s--;)a.push(_c(e));return a}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var a=e.l+t,s=e.read_shift(4),r=e.read_shift(4),i=[],n=0;n!=r&&e.l<a;++n)i.push(wc(e));return i.Count=s,i.Unique=r,i}},253:{f:function(e){var t=Ac(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var a={};return a.dsst=e.read_shift(2),e.l+=t-2,a}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bc},353:{f:gc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,a){var s=e.l+t,r=e.read_shift(2),i=e.read_shift(2);if(a.sbcch=i,1025==i||14849==i)return[i,r];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var n=Tc(e,i),l=[];s>e.l;)l.push(kc(e));return[i,r,n,l]}},431:{f:bc},432:{},433:{},434:{},437:{},438:{f:function(e,t,a){var s=e.l,r="";try{e.l+=4;var i=(a.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var a=e.read_shift(2);e.l+=2}(e);var n=e.read_shift(2);e.read_shift(2),xc(e);var l=e.read_shift(2);e.l+=l;for(var o=1;o<e.lens.length-1;++o){if(e.l-s!=e.lens[o])throw new Error("TxO: bad continue record");var c=e[e.l];if((r+=Tc(e,e.lens[o+1]-e.lens[o]-1)).length>=(c?n:2*n))break}if(r.length!==n&&r.length!==2*n)throw new Error("cchText: "+n+" != "+r.length);return e.l=s+t,{t:r}}catch(d){return e.l=s+t,{t:r}}}},439:{f:bc},440:{f:function(e,t){var a=_c(e);e.l+=16;var s=function(e,t){var a=e.l+t,s=e.read_shift(4);if(2!==s)throw new Error("Unrecognized streamVersion: "+s);var r=e.read_shift(2);e.l+=2;var i,n,l,o,c,d,u="";16&r&&(i=Cc(e,e.l)),128&r&&(n=Cc(e,e.l)),257&~r||(l=Cc(e,e.l)),1==(257&r)&&(o=function(e){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),a=e.l,s=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(s=!0),e.l=a);var r=e.read_shift((s?t-24:t)>>1,"utf16le").replace(pi,"");return s&&(e.l+=24),r}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),a="";t-- >0;)a+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return a+s.replace(/\\/g,"/");var r=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return a+e.read_shift(r>>1,"utf16le").replace(pi,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}(e,e.l)),8&r&&(u=Cc(e,e.l)),32&r&&(c=e.read_shift(16)),64&r&&(d=nc(e)),e.l=a;var h=n||l||o||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&r&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),i&&(f.Tooltip=i),f}(e,t-24);return[a,s]}},441:{},442:{f:kc},443:{},444:{f:xc},445:{},446:{},448:{f:gc},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:gc},512:{f:Gc},513:{f:Xc},515:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5);var s=Ac(e),r=Fo(e);return s.val=r,s}},516:{f:function(e,t,a){a.biffguess&&2==a.biff&&(a.biff=5),e.l;var s=Ac(e);2==a.biff&&e.l++;var r=kc(e,e.l,a);return s.val=r,s}},517:{f:Vc},519:{f:Qc},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var a=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,7&s&&(t.level=7&s),32&s&&(t.hidden=!0),64&s&&(t.hpt=a/20),t}},523:{},545:{f:$c},549:{f:Uc},566:{},574:{f:function(e,t,a){return a&&a.biff>=2&&a.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),s=jc(e);return{r:t,c:a,ixfe:s[0],rknum:s[1]}}},659:{},1048:{},1054:{f:function(e,t,a){return[e.read_shift(2),Dc(e,0,a)]}},1084:{},1212:{f:function(e,t,a){var s=Oc(e);e.l++;var r=e.read_shift(1);return[Mu(e,t-=8,a),r,s]}},2048:{f:function(e,t){e.read_shift(2);var a=_c(e),s=e.read_shift((t-10)/2,"dbcs-cont");return[a,s=s.replace(pi,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Pc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:gc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),r=[];s-- >0;)r.push(eu(e,e.l));return{ixfe:a,ext:r}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bc,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,a){if(!(a.biff<8)){var s=e.read_shift(2),r=e.read_shift(2);return[Tc(e,s,a),Tc(e,r,a)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,a){var s=e.l+t;if(124226!==e.read_shift(4))if(a.cellStyles){var r,i=e.slice(e.l);e.l=s;try{r=Un(i,{type:"array"})}catch(l){return}var n=Mn(r,"theme/theme/theme1.xml",!0);if(n)return Qd(n,a)}else e.l=s},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:gc},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:t,flags:a}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:xc},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,a){var s={area:!1};if(5!=a.biff)return e.l+=t,s;var r=e.read_shift(1);return e.l+=3,16&r&&(s.area=!0),s}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),a=[];t-- >0;)a.push(Nc(e));return a}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Gc},1:{},2:{f:function(e){var t=Ac(e);++e.l;var a=e.read_shift(2);return t.t="n",t.val=a,t}},3:{f:function(e){var t=Ac(e);++e.l;var a=Fo(e);return t.t="n",t.val=a,t}},4:{f:function(e,t,a){a.biffguess&&5==a.biff&&(a.biff=2);var s=Ac(e);++e.l;var r=Dc(e,0,a);return s.t="str",s.val=r,s}},5:{f:Vc},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Pc},11:{},22:{f:xc},30:{f:Bc},31:{},32:{},33:{f:$c},36:{},37:{f:Uc},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:xc},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(4),r={fmt:t,env:a,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,r}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,a){var s=e.l+t,r=Ac(e),i=e.read_shift(2),n=Tc(e,i,a);return e.l=s,r.t="str",r.val=n,r}},223:{},234:{},354:{},421:{},518:{f:Ru},521:{f:Pc},536:{f:Yc},547:{f:Hc},561:{},579:{},1030:{f:Ru},1033:{f:Pc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Hh(e,t,a,s){var r=t;if(!isNaN(r)){var i=s||(a||[]).length||0,n=e.next(4);n.write_shift(2,r),n.write_shift(2,i),i>0&&Ul(a)&&e.push(a)}}function zh(e,t){var a=t||{},s=a.dense?[]:{},r=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),n=r.index,l=i&&i.index||e.length,o=In(e.slice(n,l),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(n=0;n<o.length;++n){var p=o[n].trim(),v=p.slice(0,3).toLowerCase();if("<tr"!=v){if("<td"==v||"<th"==v){var g=p.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var b=g[l].trim();if(b.match(/<t[dh]/i)){for(var x=b,y=0;"<"==x.charAt(0)&&(y=x.indexOf(">"))>-1;)x=x.slice(y+1);for(var S=0;S<m.length;++S){var w=m[S];w.s.c==d&&w.s.r<c&&c<=w.e.r&&(d=w.e.c+1,S=-1)}var T=Kn(b.slice(0,b.indexOf(">")));h=T.colspan?+T.colspan:1,((u=+T.rowspan)>1||h>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var k=T.t||T["data-t"]||"";if(x.length)if(x=dl(x),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),x.length){var D={t:"s",v:x};a.raw||!x.trim().length||"s"==k||("TRUE"===x?D={t:"b",v:!0}:"FALSE"===x?D={t:"b",v:!1}:isNaN(En(x))?isNaN(An(x).getDate())||(D={t:"d",v:Tn(x)},a.cellDates||(D={t:"n",v:mn(D.v)}),D.z=a.dateNF||Ci[14]):D={t:"n",v:En(x)}),a.dense?(s[c]||(s[c]=[]),s[c][d]=D):s[mo({r:c,c:d})]=D,d+=h}else d+=h;else d+=h}}}}else{if(++c,a.sheetRows&&a.sheetRows<=c){--c;break}d=0}}return s["!ref"]=vo(f),m.length&&(s["!merges"]=m),s}function Yh(e,t,a,s){for(var r=e["!merges"]||[],i=[],n=t.s.c;n<=t.e.c;++n){for(var l=0,o=0,c=0;c<r.length;++c)if(!(r[c].s.r>a||r[c].s.c>n||r[c].e.r<a||r[c].e.c<n)){if(r[c].s.r<a||r[c].s.c<n){l=-1;break}l=r[c].e.r-r[c].s.r+1,o=r[c].e.c-r[c].s.c+1;break}if(!(l<0)){var d=mo({r:a,c:n}),u=s.dense?(e[a]||[])[n]:e[d],h=u&&null!=u.v&&(u.h||el(u.w||(bo(u),u.w)||""))||"",f={};l>1&&(f.rowspan=l),o>1&&(f.colspan=o),s.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(s.id||"sjs")+"-"+d,i.push((p=h,"<"+(m="td")+(null!=(v=f)?function(e){return un(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}(v):"")+(null!=p?(p.match(pl)?' xml:space="preserve"':"")+">"+p+"</"+m:"/")+">"))}}var m,p,v;return"<tr>"+i.join("")+"</tr>"}function Kh(e,t,a){var s=a||{},r=0,i=0;if(null!=s.origin)if("number"==typeof s.origin)r=s.origin;else{var n="string"==typeof s.origin?fo(s.origin):s.origin;r=n.r,i=n.c}var l=t.getElementsByTagName("tr"),o=Math.min(s.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:r,c:i}};if(e["!ref"]){var d=po(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==r&&(c.e.r=r=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,v=0,g=0,b=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&p<o;++m){var y=l[m];if(qh(y)){if(s.display)continue;f[p]={hidden:!0}}var S=y.children;for(v=g=0;v<S.length;++v){var w=S[v];if(!s.display||!qh(w)){var T=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):dl(w.innerHTML),k=w.getAttribute("data-z")||w.getAttribute("z");for(h=0;h<u.length;++h){var D=u[h];D.s.c==g+i&&D.s.r<p+r&&p+r<=D.e.r&&(g=D.e.c+1-i,h=-1)}x=+w.getAttribute("colspan")||1,((b=+w.getAttribute("rowspan")||1)>1||x>1)&&u.push({s:{r:p+r,c:g+i},e:{r:p+r+(b||1)-1,c:g+i+(x||1)-1}});var C={t:"s",v:T},E=w.getAttribute("data-t")||w.getAttribute("t")||"";null!=T&&(0==T.length?C.t=E||"z":s.raw||0==T.trim().length||"s"==E||("TRUE"===T?C={t:"b",v:!0}:"FALSE"===T?C={t:"b",v:!1}:isNaN(En(T))?isNaN(An(T).getDate())||(C={t:"d",v:Tn(T)},s.cellDates||(C={t:"n",v:mn(C.v)}),C.z=s.dateNF||Ci[14]):C={t:"n",v:En(T)})),void 0===C.z&&null!=k&&(C.z=k);var N="",A=w.getElementsByTagName("A");if(A&&A.length)for(var I=0;I<A.length&&(!A[I].hasAttribute("href")||"#"==(N=A[I].getAttribute("href")).charAt(0));++I);N&&"#"!=N.charAt(0)&&(C.l={Target:N}),s.dense?(e[p+r]||(e[p+r]=[]),e[p+r][g+i]=C):e[mo({c:g+i,r:p+r})]=C,c.e.c<g+i&&(c.e.c=g+i),g+=x}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+r),e["!ref"]=vo(c),p>=o&&(e["!fullref"]=vo((c.e.r=l.length-m+p-1+r,c))),e}function $h(e,t){return Kh((t||{}).dense?[]:{},e,t)}function qh(e){var t="",a=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return a&&(t=a(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var Jh={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Xh(e,t){var a,s,r,i,n,l,o,c=t||{},d=vl(e),u=[],h={name:""},f="",m=0,p={},v=[],g=c.dense?[]:{},b={value:""},x="",y=0,S=[],w=-1,T=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,C={},E=[],N={},A=[],I=1,j=1,_=[],O={Names:[]},L={},F=["",""],M=[],R={},P="",U=0,B=!1,G=!1,V=0;for(gl.lastIndex=0,d=d.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");n=gl.exec(d);)switch(n[3]=n[3].replace(/_.*$/,"")){case"table":case"":"/"===n[1]?(k.e.c>=k.s.c&&k.e.r>=k.s.r?g["!ref"]=vo(k):g["!ref"]="A1:A1",c.sheetRows>0&&c.sheetRows<=k.e.r&&(g["!fullref"]=g["!ref"],k.e.r=c.sheetRows-1,g["!ref"]=vo(k)),E.length&&(g["!merges"]=E),A.length&&(g["!rows"]=A),r.name=r[""]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),v.push(r.name),p[r.name]=g,G=!1):"/"!==n[0].charAt(n[0].length-2)&&(r=Kn(n[0],!1),w=T=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,g=c.dense?[]:{},E=[],A=[],G=!0);break;case"table-row-group":"/"===n[1]?--D:++D;break;case"table-row":case"":if("/"===n[1]){w+=I,I=1;break}if((i=Kn(n[0],!1))[""]?w=i[""]-1:-1==w&&(w=0),(I=+i["number-rows-repeated"]||1)<10)for(V=0;V<I;++V)D>0&&(A[w+V]={level:D});T=-1;break;case"covered-table-cell":"/"!==n[1]&&++T,c.sheetStubs&&(c.dense?(g[w]||(g[w]=[]),g[w][T]={t:"z"}):g[mo({r:w,c:T})]={t:"z"}),x="",S=[];break;case"table-cell":case"":if("/"===n[0].charAt(n[0].length-2))++T,b=Kn(n[0],!1),j=parseInt(b["number-columns-repeated"]||"1",10),l={t:"z",v:null},b.formula&&0!=c.cellFormula&&(l.f=Yu(Xn(b.formula))),"string"==(b[""]||b["value-type"])&&(l.t="s",l.v=Xn(b["string-value"]||""),c.dense?(g[w]||(g[w]=[]),g[w][T]=l):g[mo({r:w,c:T})]=l),T+=j-1;else if("/"!==n[1]){x="",y=0,S=[],j=1;var W=I?w+I-1:w;if(++T>k.e.c&&(k.e.c=T),T<k.s.c&&(k.s.c=T),w<k.s.r&&(k.s.r=w),W>k.e.r&&(k.e.r=W),M=[],R={},l={t:(b=Kn(n[0],!1))[""]||b["value-type"],v:null},c.cellFormula)if(b.formula&&(b.formula=Xn(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(N={s:{r:w,c:T},e:{r:w+(parseInt(b["number-matrix-rows-spanned"],10)||0)-1,c:T+(parseInt(b["number-matrix-columns-spanned"],10)||0)-1}},l.F=vo(N),_.push([N,l.F])),b.formula)l.f=Yu(b.formula);else for(V=0;V<_.length;++V)w>=_[V][0].s.r&&w<=_[V][0].e.r&&T>=_[V][0].s.c&&T<=_[V][0].e.c&&(l.F=_[V][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(N={s:{r:w,c:T},e:{r:w+(parseInt(b["number-rows-spanned"],10)||0)-1,c:T+(parseInt(b["number-columns-spanned"],10)||0)-1}},E.push(N)),b["number-columns-repeated"]&&(j=parseInt(b["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=al(b["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(b.value);break;case"date":l.t="d",l.v=Tn(b["date-value"]),c.cellDates||(l.t="n",l.v=mn(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=xn(b["time-value"])/86400,c.cellDates&&(l.t="d",l.v=bn(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(b[""]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=b["string-value"]&&(x=Xn(b["string-value"]),S=[])}}else{if(B=!1,"s"===l.t&&(l.v=x||"",S.length&&(l.R=S),B=0==y),L.Target&&(l.l=L),M.length>0&&(l.c=M,M=[]),x&&!1!==c.cellText&&(l.w=x),B&&(l.t="z",delete l.v),(!B||c.sheetStubs)&&!(c.sheetRows&&c.sheetRows<=w))for(var H=0;H<I;++H){if(j=parseInt(b["number-columns-repeated"]||"1",10),c.dense)for(g[w+H]||(g[w+H]=[]),g[w+H][T]=0==H?l:Dn(l);--j>0;)g[w+H][T+j]=Dn(l);else for(g[mo({r:w+H,c:T})]=l;--j>0;)g[mo({r:w+H,c:T+j})]=Dn(l);k.e.c<=T&&(k.e.c=T)}T+=(j=parseInt(b["number-columns-repeated"]||"1",10))-1,j=0,l={},x="",S=[]}L={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===n[1]){if((a=u.pop())[0]!==n[3])throw"Bad state: "+a}else"/"!==n[0].charAt(n[0].length-2)&&u.push([n[3],!0]);break;case"annotation":if("/"===n[1]){if((a=u.pop())[0]!==n[3])throw"Bad state: "+a;R.t=x,S.length&&(R.R=S),R.a=P,M.push(R)}else"/"!==n[0].charAt(n[0].length-2)&&u.push([n[3],!1]);P="",U=0,x="",y=0,S=[];break;case"creator":"/"===n[1]?P=d.slice(U,n.index):U=n.index+n[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===n[1]){if((a=u.pop())[0]!==n[3])throw"Bad state: "+a}else"/"!==n[0].charAt(n[0].length-2)&&u.push([n[3],!1]);x="",y=0,S=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===n[1]){if(C[h.name]=f,(a=u.pop())[0]!==n[3])throw"Bad state: "+a}else"/"!==n[0].charAt(n[0].length-2)&&(f="",h=Kn(n[0],!1),u.push([n[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":s=Kn(n[0],!1),f+=Jh[n[3]]["long"===s.style?1:0]}break;case"text":if("/>"===n[0].slice(-2))break;if("/"===n[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":f+=d.slice(m,n.index)}else m=n.index+n[0].length;break;case"named-range":F=Ku((s=Kn(n[0],!1))["cell-range-address"]);var z={Name:s.name,Ref:F[0]+"!"+F[1]};G&&(z.Sheet=v.length),O.Names.push(z);break;case"p":case"":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==n[1]||b&&b["string-value"])Kn(n[0],!1),y=n.index+n[0].length;else{var Y=(o=void 0,o=d.slice(y,n.index).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n"),[Xn(o.replace(/<[^>]*>/g,""))]);x=(x.length>0?x+"\n":"")+Y[0]}break;case"database-range":if("/"===n[1])break;try{p[(F=Ku(Kn(n[0])["target-range-address"]))[0]]["!autofilter"]={ref:F[1]}}catch($){}break;case"a":if("/"!==n[1]){if(!(L=Kn(n[0],!1)).href)break;L.Target=Xn(L.href),delete L.href,"#"==L.Target.charAt(0)&&L.Target.indexOf(".")>-1?(F=Ku(L.Target.slice(1)),L.Target="#"+F[0]+"!"+F[1]):L.Target.match(/^\.\.[\\\/]/)&&(L.Target=L.Target.slice(3))}break;default:switch(n[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(c.WTF)throw new Error(n)}}var K={Sheets:p,SheetNames:v,Workbook:O};return c.bookSheets&&delete K.Sheets,K}function Zh(e,t){t=t||{},On(e,"META-INF/manifest.xml")&&function(e,t){for(var a,s,r=vl(e);a=gl.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if("/"==(s=Kn(a[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==s.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}(Fn(e,"META-INF/manifest.xml"),t);var a=Mn(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var s=Xh(ll(a),t);return On(e,"meta.xml")&&(s.Props=Qo(Fn(e,"meta.xml"))),s}function Qh(e,t){return Xh(e,t)}function ef(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function tf(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):ll(hi(e))}function af(e){var t=e.reduce((function(e,t){return e+t.length}),0),a=new Uint8Array(t),s=0;return e.forEach((function(e){a.set(e,s),s+=e.length})),a}function sf(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function rf(e,t){var a=t?t[0]:0,s=127&e[a];e:if(e[a++]>=128){if(s|=(127&e[a])<<7,e[a++]<128)break e;if(s|=(127&e[a])<<14,e[a++]<128)break e;if(s|=(127&e[a])<<21,e[a++]<128)break e;if(s+=(127&e[a])*Math.pow(2,28),++a,e[a++]<128)break e;if(s+=(127&e[a])*Math.pow(2,35),++a,e[a++]<128)break e;if(s+=(127&e[a])*Math.pow(2,42),++a,e[a++]<128)break e}return t&&(t[0]=a),s}function nf(e){var t=0,a=127&e[t];e:if(e[t++]>=128){if(a|=(127&e[t])<<7,e[t++]<128)break e;if(a|=(127&e[t])<<14,e[t++]<128)break e;if(a|=(127&e[t])<<21,e[t++]<128)break e;a|=(127&e[t])<<28}return a}function lf(e){for(var t=[],a=[0];a[0]<e.length;){var s,r=a[0],i=rf(e,a),n=7&i,l=0;if(0==(i=Math.floor(i/8)))break;switch(n){case 0:for(var o=a[0];e[a[0]++]>=128;);s=e.slice(o,a[0]);break;case 5:l=4,s=e.slice(a[0],a[0]+l),a[0]+=l;break;case 1:l=8,s=e.slice(a[0],a[0]+l),a[0]+=l;break;case 2:l=rf(e,a),s=e.slice(a[0],a[0]+l),a[0]+=l;break;default:throw new Error("PB Type ".concat(n," for Field ").concat(i," at offset ").concat(r))}var c={data:s,type:n};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function of(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function cf(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],s=rf(t,a),r=[];a[0]<t.length;){var i=3&t[a[0]];if(0!=i){var n=0,l=0;if(1==i?(l=4+(t[a[0]]>>2&7),n=(224&t[a[0]++])<<3,n|=t[a[0]++]):(l=1+(t[a[0]++]>>2),2==i?(n=t[a[0]]|t[a[0]+1]<<8,a[0]+=2):(n=(t[a[0]]|t[a[0]+1]<<8|t[a[0]+2]<<16|t[a[0]+3]<<24)>>>0,a[0]+=4)),r=[af(r)],0==n)throw new Error("Invalid offset 0");if(n>r[0].length)throw new Error("Invalid offset beyond length");if(l>=n)for(r.push(r[0].slice(-n)),l-=n;l>=r[r.length-1].length;)r.push(r[r.length-1]),l-=r[r.length-1].length;r.push(r[0].slice(-n,-n+l))}else{var o=t[a[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[a[0]],c>1&&(o|=t[a[0]+1]<<8),c>2&&(o|=t[a[0]+2]<<16),c>3&&(o|=t[a[0]+3]<<24),o>>>=0,o++,a[0]+=c}r.push(t.slice(a[0],a[0]+o)),a[0]+=o}}var d=af(r);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function df(e,t,a){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,a,s){var r,i=ef(e),n=i.getUint32(4,!0),l=(s>1?12:8)+4*sf(n&(s>1?3470:398)),o=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&n&&(o=i.getUint32(l,!0),l+=4),l+=4*sf(n&(s>1?12288:4096)),16&n&&(c=i.getUint32(l,!0),l+=4),32&n&&(d=i.getFloat64(l,!0),l+=8),64&n&&(u.setTime(u.getTime()+1e3*i.getFloat64(l,!0)),l+=8),e[2]){case 0:break;case 2:r={t:"n",v:d};break;case 3:r={t:"s",v:t[c]};break;case 5:r={t:"d",v:u};break;case 6:r={t:"b",v:d>0};break;case 7:r={t:"n",v:d/86400};break;case 8:r={t:"e",v:0};break;case 9:if(o>-1)r={t:"s",v:a[o]};else if(c>-1)r={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));r={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return r}(e,t,a,e[0]);case 5:return function(e,t,a){var s,r=ef(e),i=r.getUint32(8,!0),n=12,l=-1,o=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&i&&(c=function(e,t){for(var a=(127&e[t+15])<<7|e[t+14]>>1,s=1&e[t+14],r=t+13;r>=t;--r)s=256*s+e[r];return(128&e[t+15]?-s:s)*Math.pow(10,a-6176)}(e,n),n+=16),2&i&&(d=r.getFloat64(n,!0),n+=8),4&i&&(u.setTime(u.getTime()+1e3*r.getFloat64(n,!0)),n+=8),8&i&&(o=r.getUint32(n,!0),n+=4),16&i&&(l=r.getUint32(n,!0),n+=4),e[1]){case 0:break;case 2:case 10:s={t:"n",v:c};break;case 3:s={t:"s",v:t[o]};break;case 5:s={t:"d",v:u};break;case 6:s={t:"b",v:d>0};break;case 7:s={t:"n",v:d/86400};break;case 8:s={t:"e",v:0};break;case 9:if(!(l>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));s={t:"s",v:a[l]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return s}(e,t,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function uf(e){return rf(lf(e)[1][0].data)}function hf(e,t){var a=lf(t.data),s=nf(a[1][0].data),r=a[3],i=[];return(r||[]).forEach((function(t){var a=lf(t.data),r=nf(a[1][0].data)>>>0;switch(s){case 1:i[r]=tf(a[3][0].data);break;case 8:var n=lf(e[uf(a[9][0].data)][0].data),l=e[uf(n[1][0].data)][0],o=nf(l.meta[1][0].data);if(2001!=o)throw new Error("2000 unexpected reference to ".concat(o));var c=lf(l.data);i[r]=c[3].map((function(e){return tf(e.data)})).join("")}})),i}function ff(e,t){var a={"!ref":"A1"},s=e[uf(lf(t.data)[2][0].data)],r=nf(s[0].meta[1][0].data);if(6001!=r)throw new Error("6000 unexpected reference to ".concat(r));return function(e,t,a){var s,r=lf(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(nf(r[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(i.e.c=(nf(r[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));a["!ref"]=vo(i);var n=lf(r[4][0].data),l=hf(e,e[uf(n[4][0].data)][0]),o=(null==(s=n[17])?void 0:s[0])?hf(e,e[uf(n[17][0].data)][0]):[],c=lf(n[3][0].data),d=0;c[1].forEach((function(t){var s=lf(t.data),r=e[uf(s[2][0].data)][0],i=nf(r.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var n=function(e,t){var a,s=lf(t.data),r=(null==(a=null==s?void 0:s[7])?void 0:a[0])?nf(s[7][0].data)>>>0>0?1:0:-1,i=of(s[5],(function(e){return function(e,t){var a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b=lf(e),x=nf(b[1][0].data)>>>0,y=nf(b[2][0].data)>>>0,S=(null==(s=null==(a=b[8])?void 0:a[0])?void 0:s.data)&&nf(b[8][0].data)>0||!1;if((null==(i=null==(r=b[7])?void 0:r[0])?void 0:i.data)&&0!=t)v=null==(l=null==(n=b[7])?void 0:n[0])?void 0:l.data,g=null==(c=null==(o=b[6])?void 0:o[0])?void 0:c.data;else{if(!(null==(u=null==(d=b[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");v=null==(f=null==(h=b[4])?void 0:h[0])?void 0:f.data,g=null==(p=null==(m=b[3])?void 0:m[0])?void 0:p.data}for(var w=S?4:1,T=ef(v),k=[],D=0;D<v.length/2;++D){var C=T.getUint16(2*D,!0);C<65535&&k.push([D,C])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var E=[];for(D=0;D<k.length-1;++D)E[k[D][0]]=g.subarray(k[D][1]*w,k[D+1][1]*w);return k.length>=1&&(E[k[k.length-1][0]]=g.subarray(k[k.length-1][1]*w)),{R:x,cells:E}}(e,r)}));return{nrows:nf(s[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(a,s){if(e[t.R][s])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(s));e[t.R][s]=a})),e}),[])}}(0,r);n.data.forEach((function(e,t){e.forEach((function(e,s){var r=mo({r:d+t,c:s}),i=df(e,l,o);i&&(a[r]=i)}))})),d+=n.nrows}))}(e,s[0],a),a}function mf(e){var t,a,s,r,i={},n=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,a;try{t=function(e){for(var t=[],a=0;a<e.length;){var s=e[a++],r=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,t.push(cf(s,e.slice(a,a+r))),a+=r}if(a!==e.length)throw new Error("data is not a valid framed stream!");return af(t)}(e.content)}catch(s){return}try{a=function(e){for(var t,a=[],s=[0];s[0]<e.length;){var r=rf(e,s),i=lf(e.slice(s[0],s[0]+r));s[0]+=r;var n={id:nf(i[1][0].data),messages:[]};i[2].forEach((function(t){var a=lf(t.data),r=nf(a[3][0].data);n.messages.push({meta:a,data:e.slice(s[0],s[0]+r)}),s[0]+=r})),(null==(t=i[3])?void 0:t[0])&&(n.merge=nf(i[3][0].data)>>>0>0),a.push(n)}return a}(t)}catch(s){return}a.forEach((function(e){i[e.id]=e.messages,n.push(e.id)}))}})),!n.length)throw new Error("File has no messages");var l=(null==(r=null==(s=null==(a=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:a.meta)?void 0:s[1])?void 0:r[0].data)&&1==nf(i[1][0].meta[1][0].data)&&i[1][0];if(l||n.forEach((function(e){i[e].forEach((function(e){if(1==nf(e.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=e}}))})),!l)throw new Error("Cannot find Document root");return function(e,t){var a={SheetNames:[],Sheets:{}};if(of(lf(t.data)[1],uf).forEach((function(t){e[t].forEach((function(t){if(2==nf(t.meta[1][0].data)){var s=function(e,t){var a,s=lf(t.data),r={name:(null==(a=s[1])?void 0:a[0])?tf(s[1][0].data):"",sheets:[]};return of(s[2],uf).forEach((function(t){e[t].forEach((function(t){6e3==nf(t.meta[1][0].data)&&r.sheets.push(ff(e,t))}))})),r}(e,t);s.sheets.forEach((function(e,t){jf(a,e,0==t?s.name:s.name+"_"+t,!0)}))}}))})),0==a.SheetNames.length)throw new Error("Empty NUMBERS file");return a}(i,l)}function pf(e){var t;(t=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var a=0;a!=t.length;++a){var s=t[a];void 0===e[s[0]]&&(e[s[0]]=s[1]),"n"===s[2]&&(e[s[0]]=Number(e[s[0]]))}})(e)}function vf(e,t,a,s,r,i,n,l,o,c,d,u){try{i[s]=Jo(Mn(e,a,!0),t);var h,f=Fn(e,t);switch(l){case"sheet":h=Dh(f,t,r,o,i[s],c,d,u);break;case"chart":if(!(h=function(e,t,a,s,r,i){return".bin"===t.slice(-4)?function(e,t,a,s,r){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},n=!1;return to(e,(function(e,s,l){switch(l){case 550:i["!rel"]=e;break;case 651:r.Sheets[a]||(r.Sheets[a]={}),e.name&&(r.Sheets[a].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T>0);else if(s.T<0);else if(!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}(e,s,a,r,i):function(e,t,a,s,r){if(!e)return e;s||(s={"!id":{}});var i,n={"!type":"chart","!drawel":null,"!rel":""},l=e.match(ih);return l&&oh(l[0],0,r,a),(i=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=i[1]),s["!id"][n["!rel"]]&&(n["!drawel"]=s["!id"][n["!rel"]]),n}(e,0,a,r,i)}(f,t,r,o,i[s],c))||!h["!drawel"])break;var m=Bn(h["!drawel"].Target,t),p=qo(m),v=function(e,t){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][a].Target}(Mn(e,m,!0),Jo(Mn(e,p,!0),m)),g=Bn(v,m),b=qo(g);h=function(e,t,a,s,r,i){var n=i||{"!type":"chart"};if(!e)return i;var l=0,o=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,a=[],s=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(a[+t[1]]=s?+t[2]:t[2])}));var r=Xn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[a,r,t]}(e);d.s.r=d.s.c=0,d.e.c=l,c=ho(l),t[0].forEach((function(e,a){n[c+co(a)]={t:"n",v:e,z:t[1]},o=a})),d.e.r<o&&(d.e.r=o),++l})),l>0&&(n["!ref"]=vo(d)),n}(Mn(e,g,!0),0,0,Jo(Mn(e,b,!0),g),0,h);break;case"macro":y=t,i[s],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,i[s]);break;default:throw new Error("Unrecognized sheet type "+l)}n[s]=h;var x=[];i&&i[s]&&un(i[s]).forEach((function(a){var r="";if(i[s][a].Type==$o.CMNT){r=Bn(i[s][a].Target,t);var n=function(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],s=[],r={},i=!1;return to(e,(function(e,n,l){switch(l){case 632:s.push(e);break;case 635:r=e;break;case 637:r.t=e.t,r.h=e.h,r.r=e.r;break;case 636:if(r.author=s[r.iauthor],delete r.iauthor,t.sheetRows&&r.rfx&&t.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,a.push(r);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(n.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}})),a}(e,a):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],s=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&a.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?comment[^>]*>/);if(r){var i=Kn(r[0]),n={author:i.authorId&&a[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},l=fo(i.ref);if(!(t.sheetRows&&t.sheetRows<=l.r)){var o=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!o&&!!o[1]&&hd(o[1])||{r:"",t:"",h:""};n.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),n.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(n.h=c.h),s.push(n)}}}})),s}(e,a)}(Fn(e,r,!0),r,o);if(!n||!n.length)return;tu(h,n,!1)}i[s][a].Type==$o.TCMNT&&(r=Bn(i[s][a].Target,t),x=x.concat(function(e,t){var a=[],s=!1,r={},i=0;return e.replace(Hn,(function(n,l){var o=Kn(n);switch($n(o[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":r={author:o.personId,guid:o.id,ref:o.ref,T:1};break;case"</threadedComment>":null!=r.t&&a.push(r);break;case"<text>":case"<text":i=l+n.length;break;case"</text>":r.t=e.slice(i,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":s=!0;break;case"</mentions>":case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return n})),a}(Fn(e,r,!0),o)))})),x&&x.length&&tu(h,x,!0,o.people||[])}catch(S){if(o.WTF)throw S}var y}function gf(e){return"/"==e.charAt(0)?e.slice(1):e}function bf(e,t){if(nn(),pf(t=t||{}),On(e,"META-INF/manifest.xml"))return Zh(e,t);if(On(e,"objectdata.xml"))return Zh(e,t);if(On(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==mf){if(e.FileIndex)return mf(e);var a=dn.utils.cfb_new();return Pn(e).forEach((function(t){!function(e,t,a){if(e.FullPaths){var s;if("string"==typeof a)return s=li?oi(a):function(e){for(var t=[],a=0,s=e.length+250,r=ci(e.length+255),i=0;i<e.length;++i){var n=e.charCodeAt(i);if(n<128)r[a++]=n;else if(n<2048)r[a++]=192|n>>6&31,r[a++]=128|63&n;else if(n>=55296&&n<57344){n=64+(1023&n);var l=1023&e.charCodeAt(++i);r[a++]=240|n>>8&7,r[a++]=128|n>>2&63,r[a++]=128|l>>6&15|(3&n)<<4,r[a++]=128|63&l}else r[a++]=224|n>>12&15,r[a++]=128|n>>6&63,r[a++]=128|63&n;a>s&&(t.push(r.slice(0,a)),a=0,r=ci(65535),s=65530)}return t.push(r.slice(0,a)),mi(t)}(a),dn.utils.cfb_add(e,t,s);dn.utils.cfb_add(e,t,a)}else e.file(t,a)}(a,t,Rn(e,t))})),mf(a)}throw new Error("Unsupported NUMBERS file")}if(!On(e,"[Content_Types].xml")){if(On(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(On(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var s,r,i=Pn(e),n=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var a={};if((e.match(Hn)||[]).forEach((function(e){var s=Kn(e);switch(s[0].replace(zn,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[s.Extension]=s.ContentType;break;case"<Override":void 0!==t[Ko[s.ContentType]]&&t[Ko[s.ContentType]].push(s.PartName)}})),"http://schemas.openxmlformats.org/package/2006/content-types"!==t.xmlns)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=a,delete t.calcchains,t}(Mn(e,"[Content_Types].xml")),l=!1;if(0===n.workbooks.length&&Fn(e,r="xl/workbook.xml",!0)&&n.workbooks.push(r),0===n.workbooks.length){if(!Fn(e,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");n.workbooks.push(r),l=!0}"bin"==n.workbooks[0].slice(-3)&&(l=!0);var o={},c={};if(!t.bookSheets&&!t.bookProps){if($u=[],n.sst)try{$u=function(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a=[],s=!1;return to(e,(function(e,r,i){switch(i){case 159:a.Count=e[0],a.Unique=e[1];break;case 19:a.push(e);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(r.T,!s||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),a}(e,a):function(e,t){var a=[],s="";if(!e)return a;var r=e.match(fd);if(r){s=r[2].replace(md,"").split(pd);for(var i=0;i!=s.length;++i){var n=hd(s[i].trim(),t);null!=n&&(a[a.length]=n)}r=Kn(r[1]),a.Count=r.count,a.Unique=r.uniqueCount}return a}(e,a)}(Fn(e,gf(n.sst)),n.sst,t)}catch(j){if(t.WTF)throw j}t.cellStyles&&n.themes.length&&(o=function(e,t,a){return Qd(e,a)}(Mn(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(c=function(e,t,a,s){return".bin"===t.slice(-4)?function(e,t,a){var s={NumberFmt:[]};for(var r in Ci)s.NumberFmt[r]=Ci[r];s.CellXf=[],s.Fonts=[];var i=[],n=!1;return to(e,(function(e,r,l){switch(l){case 44:s.NumberFmt[e[0]]=e[1],rn(e[1],e[0]);break;case 43:s.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=Nd(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&s.CellXf.push(e);break;case 35:n=!0;break;case 36:n=!1;break;case 37:i.push(l),n=!0;break;case 38:i.pop(),n=!1;break;default:if(r.T>0)i.push(l);else if(r.T<0)i.pop();else if(!n||a.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}})),s}(e,a,s):Vd(e,a,s)}(Fn(e,gf(n.style)),n.style,o,t))}n.links.map((function(a){try{return Jo(Mn(e,qo(gf(a))),a),function(e,t,a,s){if(".bin"===a.slice(-4))return function(e,t,a,s){if(!e)return e;var r=s||{},i=!1;to(e,(function(e,t,a){switch(a){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||r.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r)}(e,0,0,s)}(Fn(e,gf(a)),0,a,t)}catch(j){}}));var d=function(e,t,a){return".bin"===t.slice(-4)?function(e,t){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],r=!1;t||(t={}),t.biff=12;var i=[],n=[[]];return n.SheetNames=[],n.XTI=[],Vh[16]={n:"BrtFRTArchID$",f:kh},to(e,(function(e,l,o){switch(o){case 156:n.SheetNames.push(e.name),a.Sheets.push(e);break;case 153:a.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=Lu(e.Ptg,0,null,n,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:n[0].length?n.push([o,e]):n[0]=[o,e],n[n.length-1].XTI=[];break;case 362:0===n.length&&(n[0]=[],n[0].XTI=[]),n[n.length-1].XTI=n[n.length-1].XTI.concat(e),n.XTI=n.XTI.concat(e);break;case 35:case 37:s.push(o),r=!0;break;case 36:case 38:s.pop(),r=!1;break;default:if(l.T);else if(!r||t.WTF&&37!=s[s.length-1]&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),t),Sh(a),a.Names=i,a.supbooks=n,a}(e,a):function(e,t){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,r="xmlns",i={},n=0;if(e.replace(Hn,(function(l,o){var c=Kn(l);switch($n(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":l.match(Th)&&(r="xmlns"+l.match(/<(\w+):/)[1]),a.xmlns=c[r];break;case"<fileVersion":delete c[0],a.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":ph.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":a.WBProps[e[0]]=al(c[e[0]]);break;case"int":a.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:a.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(a.WBProps.CodeName=ll(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],a.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Xn(ll(c.name)),delete c[0],a.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":s=!1;break;case"<definedName":(i={}).Name=ll(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),al(c.hidden||"0")&&(i.Hidden=!0),n=o+l.length;break;case"</definedName>":i.Ref=Xn(ll(e.slice(n,o))),a.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete c[0],a.CalcPr=c;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l})),-1===bl.indexOf(a.xmlns))throw new Error("Unknown Namespace: "+a.xmlns);return Sh(a),a}(e,a)}(Fn(e,gf(n.workbooks[0])),n.workbooks[0],t),u={},h="";n.coreprops.length&&((h=Fn(e,gf(n.coreprops[0]),!0))&&(u=Qo(h)),0!==n.extprops.length&&(h=Fn(e,gf(n.extprops[0]),!0))&&function(e,t,a){var s={};t||(t={}),e=ll(e),ec.forEach((function(a){var r=(e.match(cl(a[0]))||[])[1];switch(a[2]){case"string":r&&(t[a[1]]=Xn(r));break;case"bool":t[a[1]]="true"===r;break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(s[a[1]]=i[1])}})),s.HeadingPairs&&s.TitlesOfParts&&tc(s.HeadingPairs,s.TitlesOfParts,t,a)}(h,u,t));var f={};t.bookSheets&&!t.bookProps||0!==n.custprops.length&&(h=Mn(e,gf(n.custprops[0]),!0))&&(f=function(e,t){var a={},s="",r=e.match(sc);if(r)for(var i=0;i!=r.length;++i){var n=r[i],l=Kn(n);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":s=Xn(l.name);break;case"</property>":s=null;break;default:if(0===n.indexOf("<vt:")){var o=n.split(">"),c=o[0].slice(4),d=o[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":a[s]=Xn(d);break;case"bool":a[s]=al(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":a[s]=parseFloat(d);break;case"filetime":case"date":a[s]=Tn(d);break;default:if("/"==c.slice(-1))break;t.WTF}}else if("</"===n.slice(0,2));else if(t.WTF)throw new Error(n)}}return a}(h,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?s=d.Sheets.map((function(e){return e.name})):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=f),t.bookSheets&&void 0!==s&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var p,v={};t.bookDeps&&n.calcchain&&(p=Fn(e,gf(n.calcchain)),v=".bin"===n.calcchain.slice(-4)?function(e){var t=[];return to(e,(function(e,a,s){if(63===s)t.push(e);else if(!a.T)throw new Error("Unexpected record 0x"+s.toString(16))})),t}(p):function(e){var t=[];if(!e)return t;var a=1;return(e.match(Hn)||[]).forEach((function(e){var s=Kn(e);switch(s[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?a=s.i:s.i=a,t.push(s)}})),t}(p));var g,b,x=0,y={},S=d.Sheets;u.Worksheets=S.length,u.SheetNames=[];for(var w=0;w!=S.length;++w)u.SheetNames[w]=S[w].name;var T=l?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),D=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");On(e,D)||(D="xl/_rels/workbook."+T+".rels");var C=Jo(Mn(e,D,!0),D.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=function(e,t,a){return".bin"===t.slice(-4)?function(e,t,a){var s={Types:[],Cell:[],Value:[]},r=a||{},i=[],n=!1,l=2;return to(e,(function(e,t,a){switch(a){case 335:s.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==l?s.Cell.push({type:s.Types[e[0]-1].name,index:e[1]}):0==l&&s.Value.push({type:s.Types[e[0]-1].name,index:e[1]})}));break;case 337:l=e?1:0;break;case 338:l=2;break;case 35:i.push(a),n=!0;break;case 36:i.pop(),n=!1;break;default:if(t.T);else if(!n||r.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+a.toString(16))}})),s}(e,0,a):function(e,t,a){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var r,i=!1,n=2;return e.replace(Hn,(function(e){var t=Kn(e);switch($n(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":s.Types.push({name:t.name});break;case"<futureMetadata":for(var l=0;l<s.Types.length;++l)s.Types[l].name==t.name&&(r=s.Types[l]);break;case"<rc":1==n?s.Cell.push({type:s.Types[t.t-1].name,index:+t.v}):0==n&&s.Value.push({type:s.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":n=1;break;case"</cellMetadata>":case"</valueMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!r)break;r.offsets||(r.offsets=[]),r.offsets.push(+t.i);break;default:if(!i&&a.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),s}(e,0,a)}(Fn(e,gf(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=function(e,t){var a=[],s=!1;return e.replace(Hn,(function(e){var r=Kn(e);switch($n(r[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":a.push({name:r.displayname,id:r.id});break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e})),a}(Fn(e,gf(n.people[0])),t)),C&&(C=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(a=e["!id"][t.id].Type,$o.WS.indexOf(a)>-1?"sheet":a==$o.CS?"chart":a==$o.DS?"dialog":a==$o.MS?"macro":a&&a.length?a:"sheet")];var a}))}catch(j){return null}return e&&0!==e.length?e:null}(C,d.Sheets));var E=Fn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=u.Worksheets;++x){var N="sheet";if(C&&C[x]?(g="xl/"+C[x][1].replace(/[\/]?xl\//,""),On(e,g)||(g=C[x][1]),On(e,g)||(g=D.replace(/_rels\/.*$/,"")+C[x][1]),N=C[x][2]):g=(g="xl/worksheets/sheet"+(x+1-E)+"."+T).replace(/sheet0\./,"sheet."),b=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(u.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,I=0;I!=t.sheets.length;++I)"number"==typeof t.sheets[I]&&t.sheets[I]==x&&(A=1),"string"==typeof t.sheets[I]&&t.sheets[I].toLowerCase()==u.SheetNames[x].toLowerCase()&&(A=1);if(!A)continue e}}vf(e,g,b,u.SheetNames[x],x,y,s,N,t,d,o,c)}return m={Directory:n,Workbook:d,Props:u,Custprops:f,Deps:v,Sheets:s,SheetNames:u.SheetNames,Strings:$u,Styles:c,Themes:o,SSF:Dn(Ci)},t&&t.bookFiles&&(e.files?(m.keys=i,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach((function(t,a){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[a]})))),t&&t.bookVBA&&(n.vba.length>0?m.vbaraw=Fn(e,gf(n.vba[0]),!0):n.defaults&&"application/vnd.ms-office.vbaProject"===n.defaults.bin&&(m.vbaraw=Fn(e,"xl/vbaProject.bin",!0))),m}function xf(e,t){var a,s,r=t||{},i="Workbook",n=dn.find(e,i);try{if(i="/!DataSpaces/Version",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(a=n.content,(s={}).id=a.read_shift(0,"lpp4"),s.R=gd(a,4),s.U=gd(a,4),s.W=gd(a,4),i="/!DataSpaces/DataSpaceMap",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var l=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(bd(e));return t}(n.content);if(1!==l.length||1!==l[0].comps.length||0!==l[0].comps[0].t||"StrongEncryptionDataSpace"!==l[0].name||"EncryptedPackage"!==l[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var o=function(e){var t=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(n.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+i);if(i="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);!function(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=gd(e,4),t.U=gd(e,4),t.W=gd(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record")}(n.content)}catch(d){}if(i="/EncryptionInfo",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);var c=function(e){var t=gd(e);switch(t.Minor){case 2:return[t.Minor,Sd(e)];case 3:return[t.Minor,wd()];case 4:return[t.Minor,Td(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(n.content);if(i="/EncryptedPackage",!(n=dn.find(e,i))||!n.content)throw new Error("ECMA-376 Encrypted file missing "+i);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],n.content,r.password||"",r);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function yf(e,t){var a="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=ni(e.slice(0,12));break;case"binary":a=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function Sf(e,t){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return Mh(e.slice(a),t);default:break e}return id.to_workbook(e,t)}function wf(e,t,a,s){return s?(a.type="string",id.to_workbook(e,a)):id.to_workbook(t,a)}function Tf(e,t){Xr();var a=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Tf(new Uint8Array(e),((a=Dn(a)).type="array",a));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!a.type&&(a.type="undefined"!=typeof Deno?"buffer":"array");var s,r=e,i=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),qu={},a.dateNF&&(qu.dateNF=a.dateNF),a.type||(a.type=li&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==a.type&&(a.type=li?"buffer":"binary",r=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var a=t.read();return t.close(),a}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||li||(a.type="array")),"string"==a.type&&(i=!0,a.type="binary",a.codepage=65001,r=function(e){return e.match(/[^\x00-\x7F]/)?ol(e):e}(e)),"array"==a.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var n=new ArrayBuffer(3),l=new Uint8Array(n);if(l.foo="bar",!l.foo)return(a=Dn(a)).type="array",Tf(fi(r),a)}switch((s=yf(r,a))[0]){case 208:if(207===s[1]&&17===s[2]&&224===s[3]&&161===s[4]&&177===s[5]&&26===s[6]&&225===s[7])return function(e,t){return dn.find(e,"EncryptedPackage")?xf(e,t):Gh(e,t)}(dn.read(r,a),a);break;case 9:if(s[1]<=8)return Gh(r,a);break;case 60:return Mh(r,a);case 73:if(73===s[1]&&42===s[2]&&0===s[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===s[1])return function(e,t){var a=t||{},s=!!a.WTF;a.WTF=!0;try{var r=ad.to_workbook(e,a);return a.WTF=s,r}catch(i){if(a.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return id.to_workbook(e,t)}}(r,a);break;case 84:if(65===s[1]&&66===s[2]&&76===s[3])return sd.to_workbook(r,a);break;case 80:return 75===s[1]&&s[2]<9&&s[3]<9?function(e,t){var a=e,s=t||{};return s.type||(s.type=li&&Buffer.isBuffer(e)?"buffer":"base64"),bf(Un(a,s),s)}(r,a):wf(e,r,a,i);case 239:return 60===s[3]?Mh(r,a):wf(e,r,a,i);case 255:if(254===s[1])return function(e,t){var a=e;return"base64"==t.type&&(a=ni(a)),a=ei.utils.decode(1200,a.slice(2),"str"),t.type="binary",Sf(a,t)}(r,a);if(0===s[1]&&2===s[2]&&0===s[3])return nd.to_workbook(r,a);break;case 0:if(0===s[1]){if(s[2]>=2&&0===s[3])return nd.to_workbook(r,a);if(0===s[2]&&(8===s[3]||9===s[3]))return nd.to_workbook(r,a)}break;case 3:case 131:case 139:case 140:return td.to_workbook(r,a);case 123:if(92===s[1]&&114===s[2]&&116===s[3])return Cd.to_workbook(r,a);break;case 10:case 13:case 32:return function(e,t){var a="",s=yf(e,t);switch(t.type){case"base64":a=ni(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=kn(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==s[0]&&187==s[1]&&191==s[2]&&(a=ll(a)),t.type="binary",Sf(a,t)}(r,a);case 137:if(80===s[1]&&78===s[2]&&71===s[3])throw new Error("PNG Image File is not a spreadsheet")}return ed.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?td.to_workbook(r,a):wf(e,r,a,i)}function kf(e,t,a,s,r,i,n,l){var o=co(a),c=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),u=!0,h=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:a,enumerable:!1})}catch(v){h.__rowNum__=a}else h.__rowNum__=a;if(!n||e[a])for(var f=t.s.c;f<=t.e.c;++f){var m=n?e[a][f]:e[s[f]+o];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=i[f]){if(null==p)if("e"==m.t&&null===p)h[i[f]]=null;else if(void 0!==c)h[i[f]]=c;else{if(!d||null!==p)continue;h[i[f]]=null}else h[i[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==l.rawNumbers)?p:bo(m,p,l);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=i[f]&&(h[i[f]]=c)}}return{row:h,isempty:u}}function Df(e,t){if(null==e||null==e["!ref"])return[];var a={t:"n",v:0},s=0,r=1,i=[],n=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?s=1:"A"===c.header?s=2:Array.isArray(c.header)?s=3:null==c.header&&(s=0),typeof d){case"string":o=go(d);break;case"number":(o=go(e["!ref"])).s.r=d;break;default:o=d}s>0&&(r=0);var u=co(o.s.r),h=[],f=[],m=0,p=0,v=Array.isArray(e),g=o.s.r,b=0,x={};v&&!e[g]&&(e[g]=[]);var y=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(b=o.s.c;b<=o.e.c;++b)if(!(y[b]||{}).hidden)switch(h[b]=ho(b),a=v?e[g][b]:e[h[b]+u],s){case 1:i[b]=b-o.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=c.header[b-o.s.c];break;default:if(null==a&&(a={w:"__EMPTY",t:"s"}),l=n=bo(a,null,c),p=x[n]||0){do{l=n+"_"+p++}while(x[l]);x[n]=p,x[l]=1}else x[n]=1;i[b]=l}for(g=o.s.r+r;g<=o.e.r;++g)if(!(S[g]||{}).hidden){var w=kf(e,o,g,h,s,i,v,c);(!1===w.isempty||(1===s?!1!==c.blankrows:c.blankrows))&&(f[m++]=w.row)}return f.length=m,f}var Cf=/"/g;function Ef(e,t,a,s,r,i,n,l){for(var o=!0,c=[],d="",u=co(a),h=t.s.c;h<=t.e.c;++h)if(s[h]){var f=l.dense?(e[a]||[])[h]:e[s[h]+u];if(null==f)d="";else if(null!=f.v){o=!1,d=""+(l.rawNumbers&&"n"==f.t?f.v:bo(f,null,l));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===r||p===i||34===p||l.forceQuotes){d='"'+d.replace(Cf,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(o=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(Cf,'""')+'"'));c.push(d)}return!1===l.blankrows&&o?null:c.join(n)}function Nf(e,t){var a=[],s=null==t?{}:t;if(null==e||null==e["!ref"])return"";var r=go(e["!ref"]),i=void 0!==s.FS?s.FS:",",n=i.charCodeAt(0),l=void 0!==s.RS?s.RS:"\n",o=l.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),d="",u=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],f=s.skipHidden&&e["!rows"]||[],m=r.s.c;m<=r.e.c;++m)(h[m]||{}).hidden||(u[m]=ho(m));for(var p=0,v=r.s.r;v<=r.e.r;++v)(f[v]||{}).hidden||null!=(d=Ef(e,r,v,u,n,o,i,s))&&(s.strip&&(d=d.replace(c,"")),(d||!1!==s.blankrows)&&a.push((p++?l:"")+d));return delete s.dense,a.join("")}function Af(e,t,a){var s,r=a||{},i=+!r.skipHeader,n=e||{},l=0,o=0;if(n&&null!=r.origin)if("number"==typeof r.origin)l=r.origin;else{var c="string"==typeof r.origin?fo(r.origin):r.origin;l=c.r,o=c.c}var d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+i}};if(n["!ref"]){var u=go(n["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==l&&(l=u.e.r+1,d.e.r=l+t.length-1+i)}else-1==l&&(l=0,d.e.r=t.length-1+i);var h=r.header||[],f=0;t.forEach((function(e,t){un(e).forEach((function(a){-1==(f=h.indexOf(a))&&(h[f=h.length]=a);var c=e[a],d="z",u="",m=mo({c:o+f,r:l+t+i});s=If(n,m),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",r.cellDates||(d="n",c=mn(c)),u=r.dateNF||Ci[14]):null===c&&r.nullError&&(d="e",c=0),s?(s.t=d,s.v=c,delete s.w,delete s.R,u&&(s.z=u)):n[m]=s={t:d,v:c},u&&(s.z=u)):n[m]=c}))})),d.e.c=Math.max(d.e.c,o+h.length-1);var m=co(l);if(i)for(f=0;f<h.length;++f)n[ho(f+o)+m]={t:"s",v:h[f]};return n["!ref"]=vo(d),n}function If(e,t,a){if("string"==typeof t){if(Array.isArray(e)){var s=fo(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return If(e,mo("number"!=typeof t?t:{r:t,c:a||0}))}function jf(e,t,a,s){var r=1;if(!a)for(;r<=65535&&-1!=e.SheetNames.indexOf(a="Sheet"+r);++r,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(a)>=0){var i=a.match(/(^.*?)(\d+)$/);r=i&&+i[2]||0;var n=i&&i[1]||a;for(++r;r<=65535&&-1!=e.SheetNames.indexOf(a=n+r);++r);}if(function(e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");wh.forEach((function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}))}(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=t,a}function _f(e,t,a){return t?(e.l={Target:t},a&&(e.l.Tooltip=a)):delete e.l,e}var Of={encode_col:ho,encode_row:co,encode_cell:mo,encode_range:vo,decode_col:uo,decode_row:oo,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:fo,decode_range:po,format_cell:bo,sheet_add_aoa:yo,sheet_add_json:Af,sheet_add_dom:Kh,aoa_to_sheet:So,json_to_sheet:function(e,t){return Af(null,e,t)},table_to_sheet:$h,table_to_book:function(e,t){return xo($h(e,t),t)},sheet_to_csv:Nf,sheet_to_txt:function(e,t){return t||(t={}),t.FS="\t",t.RS="\n",Nf(e,t)},sheet_to_json:Df,sheet_to_html:function(e,t){var a=t||{},s=null!=a.header?a.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r=null!=a.footer?a.footer:"</body></html>",i=[s],n=po(e["!ref"]);a.dense=Array.isArray(e),i.push(function(e,t,a){return[].join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}(0,0,a));for(var l=n.s.r;l<=n.e.r;++l)i.push(Yh(e,n,l,a));return i.push("</table>"+r),i.join("")},sheet_to_formulae:function(e){var t,a="",s="";if(null==e||null==e["!ref"])return[];var r,i=go(e["!ref"]),n="",l=[],o=[],c=Array.isArray(e);for(r=i.s.c;r<=i.e.c;++r)l[r]=ho(r);for(var d=i.s.r;d<=i.e.r;++d)for(n=co(d),r=i.s.c;r<=i.e.c;++r)if(a=l[r]+n,s="",void 0!==(t=c?(e[d]||[])[r]:e[a])){if(null!=t.F){if(a=t.F,!t.f)continue;s=t.f,-1==a.indexOf(":")&&(a=a+":"+a)}if(null!=t.f)s=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)s=""+t.v;else if("b"==t.t)s=t.v?"TRUE":"FALSE";else if(void 0!==t.w)s="'"+t.w;else{if(void 0===t.v)continue;s="s"==t.t?"'"+t.v:""+t.v}}o[o.length]=a+"="+s}return o},sheet_to_row_object_array:Df,sheet_get_cell:If,book_new:function(){return{SheetNames:[],Sheets:{}}},book_append_sheet:jf,book_set_sheet_visibility:function(e,t,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var a=e.SheetNames.indexOf(t);if(a>-1)return a;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[s].Hidden=a},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:_f,cell_set_internal_link:function(e,t,a){return _f(e,"#"+t,a)},cell_add_comment:function(e,t,a){e.c||(e.c=[]),e.c.push({t:t,a:a||"SheetJS"})},sheet_set_array_formula:function(e,t,a,s){for(var r="string"!=typeof t?t:go(t),i="string"==typeof t?t:vo(t),n=r.s.r;n<=r.e.r;++n)for(var l=r.s.c;l<=r.e.c;++l){var o=If(e,n,l);o.t="n",o.F=i,delete o.v,n==r.s.r&&l==r.s.c&&(o.f=a,s&&(o.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Lf=({saveBtnClick:e,cancelBtnClick:t,editData:a})=>{var s,r,i;const[n,l]=w.useState(a||{identifier:"",appList:[],isAllTime:!0,customRange:!1,startDate:null,endDate:null,clusterDetails:[]}),[o,c]=w.useState(""),[d,u]=w.useState((null==a?void 0:a.cluster)||[]),[h,f]=w.useState({identifier:"",placeName:"",appName:"",latitude:"",longitude:"",startDate:"",endDate:"",utmListError:"",radius:"",cluster:""}),[m,p]=w.useState(""),[v,g]=w.useState(-1),[b,x]=w.useState([]),[S,T]=w.useState(null),k=w.useContext(le),[D,C]=w.useState(!1),[E,N]=w.useState(!1),[A,I]=w.useState(!1),[j,_]=w.useState(null),[O,L]=w.useState(new Date),[F,M]=w.useState(new Date),R=w.useRef(null),[P,U]=w.useState(-1),[B,G]=w.useState(null),[V,W]=w.useState(!1),[H,z]=w.useState(!1),[Y,K]=w.useState(!1),[$,q]=w.useState([]),[J,X]=w.useState(!1),[Z,Q]=w.useState(!1),ee=["placeName","latitude","longitude","radius","jsonData"];w.useEffect((()=>{Je.info("editData ::vv",JSON.stringify(a)),u((null==a?void 0:a.cluster)||[]),l(a||{identifier:"",appList:[],isAllTime:!0,customRange:!1,startDate:null,endDate:null,clusterDetails:[]});let e={...a};if(e.isClusterSuccess=null,!1===(null==a?void 0:a.isAllTime)){e.startDate=new Date(a.startDate),e.endDate=new Date(a.endDate);let n=new Date(a.startDate);var t=n,s=3,r=t.setDate(t.getDate()+s);let o=new Date(r);var i=n;s=90,r=i.setDate(i.getDate()+s);let c=new Date(r);M(c),L(o),l(e)}window.sdxIdendifier="",null!==(null==a?void 0:a.identifier)&&void 0!==(null==a?void 0:a.identifier)&&(window.sdxIdendifier=a.identifier)}),[]);const re=(e,t)=>{let a="";switch(e){case"identifier":t.trim()?t.length>50&&(a="Cluster name must be less than 50 characters"):a="Cluster name is required";break;case"appName":0===t.length&&(a="Please select at least one mobile app");break;case"startDate":t?n.endDate&&new Date(t)>new Date(n.endDate)&&(a="Start date must be before end date"):a="Start date is required";break;case"endDate":t?n.startDate&&new Date(t)<new Date(n.startDate)&&(a="End date must be after start date"):a="End date is required";break;case"cluster":0===d.length&&(a="Please add at least one region");break;case"placeName":t.trim()?t.length>50&&(a="Place name must be less than 100 characters"):a="Place name is required";break;case"latitude":t.trim()?isNaN(t)&&(a="Latitude must be a number"):a="Latitude is required";break;case"longitude":t.trim()?isNaN(t)&&(a="Longitude must be a number"):a="Longitude is required";break;case"radius":t.trim()?isNaN(t)&&(a="Radius must be a number"):a="Radius is required"}let s={...h};return s[e]=a,f(s),a},ne=(e,t)=>{l((a=>({...a,[e]:t}))),re(e,t)},oe=()=>{let e=(()=>{let e=n.appList.map((e=>({appId:e.appGuid||e.appId,appName:e.appName}))),t=new Date(null==n?void 0:n.startDate),a=new Date(null==n?void 0:n.endDate);return{geoFenceId:(null==n?void 0:n.geoFenceId)||0,Identifier:null==n?void 0:n.identifier,startDate:t.toDateString(),endDate:a.toDateString(),isAllTime:null==n?void 0:n.isAllTime,appList:e,cluster:d}})();ce({path:Yt,loading:k.globalStateData.setIsLoadingData,params:e,ok:e=>{e.status&&t()},fail:e=>{}})},de=(e,t)=>{let a=n.appList.map((e=>({appId:e.appGuid||e.appId,appName:e.appName})));const s={geoFenceId:(null==n?void 0:n.geoFenceId)||0,Identifier:null==n?void 0:n.identifier,startDate:null==n?void 0:n.startDate,endDate:null==n?void 0:n.endDate,isAllTime:null==n?void 0:n.isAllTime,appList:a,cluster:e};ce({path:Kt,loading:k.globalStateData.setIsLoadingData,params:s,ok:e=>{Je.info("VALIDATE_GEO_FENCING ::",JSON.stringify(e)),e.status,t(e)},fail:e=>{t({status:!1})}})};w.useEffect((()=>{(()=>{let e=Oe();null!==e&&null!==e.mobileAppsList&&x(e.mobileAppsList)})()}),[]);const ue=()=>{var e;let t=!1,a={...h};return null==(e=null==n?void 0:n.utmList)||e.map(((e,s)=>{if(!0!==t)if(""===e.key){let e={...a};a.utmListError[s].key="Custom data is required",f(e),t=!0}else if(""===e.value){let e={...a};a.utmListError[s].value="Custom data key and value are required",f(e),t=!0}})),t},pe=e=>{const t=ee.filter((t=>!e.includes(t)));return Je.info("missingFields",t),!(t.length>0&&(c(`Missing required fields: ${t.join(", ")}`),setTimeout((()=>{c("")}),3e3),1))},ve=e=>{const t=n.utmList.filter(((t,a)=>a!==e)).map((e=>{var t;return null==(t=null==e?void 0:e.key)?void 0:t.id})).filter((e=>1e3!==e));return[{id:0,value:"DEVICE_OS"},{id:1,value:"DEVICE_TYPE"},{id:2,value:"APP_VERSION"},{id:1e3,value:"CUSTOM"}].filter((e=>1e3===e.id||!t.includes(e.id)))},ge=()=>y.jsxs(Da,{show:!0,centered:!0,size:"lg",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"Import file error"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{z(!1)}})]}),y.jsx(Da.Body,{children:y.jsx("div",{className:"d-flex align-items-center justify-content-between",children:y.jsxs("table",{children:[y.jsxs("tr",{children:[y.jsx("th",{children:"Row Id"}),y.jsx("th",{children:"Message"})]}),(null==$?void 0:$.length)>0&&(null==$?void 0:$.map(((e,t)=>y.jsxs("tr",{children:[y.jsx("td",{children:e.row}),y.jsx("td",{children:e.message})]}))))]})})})]}),be=()=>{var e,t;return y.jsxs(Da,{show:j,centered:!0,size:"lg",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"Region validation failed"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{_(!1)}})]}),y.jsx(Da.Body,{children:y.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[y.jsx(Ta,{style:{marginBottom:10},children:null!==(null==j?void 0:j.message)&&void 0!==(null==j?void 0:j.message)&&y.jsx("label",{style:{color:"#ff3939"},children:null==j?void 0:j.message})}),y.jsx(Ta,{children:y.jsx(Oa,{config:{take:5,skip:0},data:j.errorlists,pageable:(null==(e=j.errorlists)?void 0:e.length)>5,settings:{total:null==(t=j.errorlists)?void 0:t.length},isDataStateRequired:!1,column:[{field:"placeName",title:"S.No",cell:e=>y.jsx("td",{children:y.jsx("span",{children:e.dataIndex+1})})},{field:"latitude",title:"Message",cell:e=>y.jsx("td",{children:e.dataItem})}]})})]})})]})},xe=()=>y.jsxs(Da,{show:J,size:"xl",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"MappedData"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{X(!1)}})]}),y.jsx(Da.Body,{children:y.jsx("div",{style:{display:"flex",flexDirection:"column"},children:(null==Z?void 0:Z.length)>0&&y.jsx("iframe",{style:{height:700},srcDoc:Z})})})]});return y.jsxs(y.Fragment,{children:[y.jsxs("div",{children:[!0===J&&y.jsx(xe,{}),!0===V&&y.jsx(_a,{size:"md",headerTitle:"Region",para:"Upload limit exceeded! A single cluster can have a maximum of 50 regions. We will process only the 50 valid regions from your file. Would you like to proceed?",secondaryButtonText:"Cancel",primaryButtonText:"Proceed",buttonClicked:e=>{W(!1),!0===e||u([])}}),!0===Y&&y.jsx(_a,{size:"md",headerTitle:"Region",para:"At least one region must be present under the cluster. You cannot delete all the regions.",primaryButtonText:"Ok",buttonClicked:e=>{K(!1)}}),!0===H&&y.jsx(ge,{}),y.jsx("div",{className:"marginT10",children:y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:9,children:y.jsxs("h3",{className:"font-regular",children:[a?"Update":"Add"," location cluster"]})})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:4,children:y.jsx(ba,{label:"Cluster name",left:!0})}),y.jsx(ka,{md:8,children:y.jsx(ie,{name:"Cluster name",required:!0,placeholder:"Cluster name",val:n.identifier,errorMessage:null==h?void 0:h.identifier,max:50,isLoading:D,iconPlaceholder:!0,iconName:null===(null==n?void 0:n.isClusterSuccess)?"":!0===(null==n?void 0:n.isClusterSuccess)?"icon-rs-circle-tick-medium icons-md green cursor-default paddingL15":"",handleOnchange:e=>{if(e.includes("'"))return;let t={...n};if(""===e||/^[' 'A-Za-z0-9_-]*$/.test(e)){let a=e.replace(/\s+/g," "),s=e.length>0?null:"Enter cluster name";t.identifier=a.trimStart(),t.isClusterSuccess=null,l(t);let r={...h};r.identifier=s,f(r)}},handleOnBlur:e=>{var t;e.trim()!==(null==(t=null==window?void 0:window.sdxIdendifier)?void 0:t.trim())&&0!==e.length?(Je.info("handleOnBlur value ::",e),C(!0),ce({path:qt,params:{Identifier:e},ok:e=>{C(!1);let t={...n};if(null==e?void 0:e.status){let a={...h};a.identifier=null==e?void 0:e.message,f(a),t.isClusterSuccess=!1}else t.isClusterSuccess=!0;l(t)},fail:e=>{C(!1)}})):C(!1)}})})]})})})}),y.jsx(ga,{children:y.jsx(Ta,{children:y.jsx(ka,{md:6,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:4,children:y.jsx(ba,{label:"Mobile apps",left:!0})}),y.jsx(ka,{md:8,className:"multiselect-placeholder",children:y.jsx(se,{required:!0,data:b,errorMessage:null==h?void 0:h.appName,textField:"appName",dataItemKey:"appGuid",placeholder:"Select mobile app",onChange:e=>{let t={...n};t.appList=e.target.value,l(t);let a={...h};a.appName=null,f(a)},value:n.appList,allowCustom:!1})})]})})})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:2,children:y.jsx(ba,{label:"Period"})}),y.jsx(ka,{md:8,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsxs("div",{className:"d-flex align-items-center",children:[y.jsx(ae,{lbl:"Life time",name:"matchtype",labelId:"all",checked:n.isAllTime,cb:e=>{let t={...n};t.isAllTime=!0,t.customRange=!1,t.startDate=null,t.endDate=null,l(t);let a={...h};a.startDate=null,a.endDate=null,f(a)}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a life time duration.",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"position-relative top1 right10",onClick:()=>{}})]})}),y.jsx(ka,{md:3,children:y.jsxs("div",{className:"d-flex align-items-center",children:[y.jsx(ae,{lbl:"Custom range",name:"matchtype",labelId:"any",checked:!n.isAllTime,cb:e=>{let t={...n};t.isAllTime=!1,t.customRange=!0,t.startDate=null,t.endDate=null,l(t)}}),y.jsx(ke,{tooltip:"Choose this option to set the event for a specific date range",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"position-relative top1 right10",onClick:()=>{}})]})})]})})]})}),!1===(null==n?void 0:n.isAllTime)&&y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:2,children:y.jsx(ba,{label:"Date range"})}),y.jsx(ka,{md:8,children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx($a,{label:"Start Date",required:!0,placeholder:"Start date",value:null!==(null==n?void 0:n.startDate)&&null!==n.startDate?new Date(null==n?void 0:n.startDate):null,min:new Date,errorMessage:null==h?void 0:h.startDate,handleChange:e=>{let t={...n};t.startDate=e.target.value,t.endDate=null,l(t);var a=e.target.value,s=3,r=a.setDate(a.getDate()+s);let i=new Date(r);var o=e.target.value;s=90,r=o.setDate(o.getDate()+s);let c=new Date(r);M(c);let d={...h};d.startDate=null,f(d),L(i)}})}),y.jsx(ka,{md:6,children:y.jsx($a,{label:"End Date",required:!0,placeholder:"End date",value:null!==(null==n?void 0:n.endDate)&&void 0!==(null==n?void 0:n.endDate)?new Date(null==n?void 0:n.endDate):null,min:O,max:F,errorMessage:null==h?void 0:h.endDate,handleChange:e=>{let t={...n};t.endDate=e.target.value,l(t);let a={...h};a.endDate=null,f(a)}})})]})})]})}),o&&y.jsx(ga,{className:"mb10",children:y.jsx(Ta,{children:y.jsx(ka,{md:10,children:y.jsx("div",{className:"d-flex align-items-center",children:y.jsxs("div",{className:o.includes("success")?"green":"red",children:[o.includes("success")?"":"Warning"," ",o]})})})})}),y.jsxs(Ta,{className:"d-flex justify-content-end mb20",children:[y.jsx("div",{children:(null==(s=null==h?void 0:h.cluster)?void 0:s.length)>0&&y.jsx("div",{className:"error-message",style:{color:"red"},children:null==h?void 0:h.cluster})}),y.jsx(ka,{md:10,children:y.jsx("h3",{className:"font-regular",children:"Regions"})}),y.jsx(ka,{md:2,children:y.jsxs("ul",{className:"rsp-icon-group justify-content-end",children:[(null==d?void 0:d.length)>0&&y.jsx("li",{className:"rsp-icon "+(Mf(n)?"":"click-off"),children:y.jsx(ke,{tooltip:"Show mapped data",icon:"icon-rs-map-medium",size:"md",iconClass:me()||(null==d?void 0:d.length)>=50?"click-off":"",onClick:()=>{de(d,(e=>{Q(null==e?void 0:e.mapView),setTimeout((()=>{X(!0)}),2e3)}))}})}),y.jsx("li",{className:"rsp-icon "+(Mf(n)?"":"click-off"),children:y.jsx(ke,{tooltip:"Add region",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",iconClass:me()||(null==d?void 0:d.length)>=50?"click-off":"",onClick:()=>{let e={...n};Je.info("temp ::",JSON.stringify(e)),e.placeName="",e.latitude="",e.longitude="",e.radius="",e.radiusType="",e.utm=!1,e.utmList=[],l(e),U(-1),T(!0)}})}),y.jsxs("li",{className:"rsp-icon "+(Mf(n)?"":"click-off"),children:[y.jsx(ke,{tooltip:"Import regions",icon:"icon-rs-import-file-medium",size:"md",iconClass:me()||(null==d?void 0:d.length)>=50?"click-off":"",onClick:()=>{R.current.click()}}),y.jsx("input",{type:"file",ref:R,onChange:e=>{const t=e.target.files[0];if(!t)return;const a=t.name.split(".").pop().toLowerCase();if("csv"===a)zr.parse(t,{header:!0,complete:e=>{Je.info("results ::",JSON.stringify(e));const t=e.meta.fields||[];if(R.current.value="",pe(t)){const t=e.data.filter(Rf);if(0===t.length)return c("Invalid file. No valid rows found."),void setTimeout((()=>{c(null)}),3e3);let a={...n};a.clusterDetails=t,l(a);const s=[...t,...d];de(s,(e=>{if(null==e?void 0:e.status){u(s.length>50?s.slice(0,50):s),c("Region data has been successfully imported");let e={...h};e.cluster=null,f(e),setTimeout((()=>c("")),3e3),(null==s?void 0:s.length)>50&&W(!0)}else _(e)}))}else c("Invalid headers in CSV file.")},error:e=>{R.current.value="",c("Failed to upload regions. Please check your CSV.")}});else if("xlsx"===a||"xls"===a){const e=new FileReader;e.onload=e=>{const t=Tf(new Uint8Array(e.target.result),{type:"array"}),a=t.SheetNames[0],s=t.Sheets[a],r=Of.sheet_to_json(s,{defval:""}),i=Object.keys(r[0]||{});if(R.current.value="",pe(i)){const e=r.filter(Rf);if(0===e.length)return c("Invalid file. No valid rows found."),void setTimeout((()=>{c(null)}),3e3);const t=[...e,...d];de(t,(e=>{if(null==e?void 0:e.status){u(t.length>50?t.slice(0,50):t),c("Region data has been successfully imported");let e={...h};e.cluster=null,f(e),setTimeout((()=>c("")),3e3),(null==t?void 0:t.length)>50&&W(!0)}else _(e)}))}else c("Invalid headers in XLSX file.")},e.readAsArrayBuffer(t)}else R.current.value="",c("Unsupported file format. Please upload a CSV or XLSX.")},style:{display:"none"},accept:".csv, .xlsx, .xls"})]}),y.jsx("li",{className:"rsp-icon",children:y.jsx(ke,{tooltip:"Download sample file",icon:"icon-rs-download-medium",size:"md",onClick:()=>{let e=window.location.origin+"/sample_cluster.csv";const t=document.createElement("a");t.href=e,t.download="sample_cluster.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),setTimeout((()=>{let e=window.location.origin+"/sample_cluster.xlsx";const t=document.createElement("a");t.href=e,t.download="sample_cluster.xlsx",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),2e3)}})})]})})]}),(null==d?void 0:d.length)>0?y.jsx(y.Fragment,{children:y.jsx("div",{className:"mb25",children:y.jsx(Oa,{config:{take:5,skip:0},data:d,pageable:d.length>5,settings:{total:d.length},isDataStateRequired:!1,column:[{field:"placeName",title:"Place name",cell:e=>y.jsx("td",{children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"latitude",title:"Latitude",cell:e=>y.jsx("td",{children:e.dataItem[e.field]})},{field:"longitude",title:"Longitude",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"radius",title:"Radius(m)",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"action",title:"Actions",cell:e=>y.jsx("td",{children:y.jsxs("ul",{className:"camp-icon-pannel",children:[y.jsx("li",{children:y.jsx(Ue,{text:"Edit",position:"top",children:y.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{var t,a,s,r,i,o,c;U(e.dataIndex);let d={...n};d.placeName=e.dataItem.placeName,d.latitude=e.dataItem.latitude,d.longitude=e.dataItem.longitude,d.radius=e.dataItem.radius,d.radiusType=e.dataItem.radiusType,d.utm=(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.jsonData)?void 0:a.length)>0;let u=[];if((null==(r=null==(s=null==e?void 0:e.dataItem)?void 0:s.jsonData)?void 0:r.length)>0){let t={...h},a=[];a="string"==typeof(null==(i=null==e?void 0:e.dataItem)?void 0:i.jsonData)?JSON.parse(null==(o=null==e?void 0:e.dataItem)?void 0:o.jsonData):null==(c=null==e?void 0:e.dataItem)?void 0:c.jsonData,t.utmListError=a.map((e=>(u.push({key:null==e?void 0:e.eventName,value:null==e?void 0:e.eventValue,isDropdown:!1}),{key:null,value:null}))),f(t)}d.utmList=u,l(d),I(!0)}})})}),y.jsx("li",{children:y.jsx(Ue,{text:"Delete",position:"top",children:y.jsx("i",{className:"icon-rs-delete-medium icons-md blue "+(me()?"click-off":""),onClick:()=>{1!==(null==d?void 0:d.length)?(N(!0),U(e.dataIndex),G(e)):K(!0)}})})})]})})}]})})}):y.jsx("div",{className:"portlet-container",children:y.jsx(Ia,{count:5,message:"No regions added yet. Click Add Region to get started.",isError:0===(null==(r=n.clusterDetails)?void 0:r.length)})}),!0===S&&y.jsxs(Da,{show:S,size:"lg",centered:!0,children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:-1===P?"Add new region":"Edit region"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{T(!1)}})]}),y.jsxs(Da.Body,{children:[-1===P&&(null==d?void 0:d.length)>=50&&y.jsxs("p",{style:{backgroundColor:"#f4cd14",color:"#fff",padding:"16px",borderRadius:"4px",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.3)"},className:"marginT10",children:[y.jsx("strong",{children:"Note : "}),"You are successfully added 50 Region"]}),y.jsxs("div",{style:{maxHeight:"430px",overflowY:"auto",overflowX:"hidden",paddingTop:"15px"},className:(null==d?void 0:d.length)>=50&&-1===P?"click-off":"",children:[(null==m?void 0:m.length)?y.jsx(ga,{className:"mb30",children:y.jsx(Ta,{children:y.jsx(ka,{md:9,children:y.jsx("h4",{className:"green",children:m})})})}):null,y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Place name",left:!0})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"placeName",required:!0,placeholder:"Enter place name",val:n.placeName,max:100,errorMessage:null==h?void 0:h.placeName,onChange:e=>{e.target.value;{let t=e.target.value.replace(/\s+/g," "),a=e.target.value.length>0?null:"Enter place name";ne("placeName",t.trimStart());let s={...h};s.placeName=a,f(s)}e.target.value.length>100&&(f((e=>({...e,placeName:"Place name cannot exceed 100 characters"}))),setTimeout((()=>{f((e=>({...e,placeName:null})))}),3e3))}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Latitude",left:!0})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"latitude",required:!0,placeholder:"Enter latitude",val:n.latitude,errorMessage:null==h?void 0:h.latitude,isLoading:D,handleOnchange:e=>{let t=e.replace(/[^\d.-]/g,""),a=(null==e?void 0:e.length)>0?null:"Enter latitude";if(isNaN(e)||e<-90||e>90)return f((e=>({...e,latitude:"Latitude must be a number between -90 and 90"}))),void setTimeout((()=>{f((e=>({...e,latitude:null})))}),3e3);if((null==e?void 0:e.length)>=21)return f((e=>({...e,latitude:"Limit exceed"}))),void setTimeout((()=>{f((e=>({...e,latitude:null})))}),3e3);{let e={...h};e.latitude=a,f(e);let s={...n};s.latitude=t,l(s)}}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Longitude",left:!0})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"longitude",required:!0,placeholder:"Enter longitude",val:n.longitude,errorMessage:null==h?void 0:h.longitude,isLoading:D,handleOnchange:e=>{let t=e.replace(/[^\d.-]/g,""),a=(null==e?void 0:e.length)>0?null:"Enter longitude";if(isNaN(e)||e<-180||e>180)return f((e=>({...e,longitude:"Longitude must be a number between -180 and 180"}))),void setTimeout((()=>{f((e=>({...e,longitude:null})))}),3e3);if((null==e?void 0:e.length)>=21)return f((e=>({...e,longitude:"Limit exceed"}))),void setTimeout((()=>{f((e=>({...e,longitude:null})))}),3e3);{let e={...h};e.longitude=a,f(e);let s={...n};s.longitude=t,l(s)}}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Radius(m)",left:!0})}),y.jsx(ka,{md:6,children:y.jsx(ie,{name:"radius",required:!0,placeholder:"Enter Radius",val:n.radius,errorMessage:null==h?void 0:h.radius,isLoading:D,handleOnchange:e=>{let t=e.replace(/[^0-9]/g,"");!0===t.includes(".")&&(t=t.substring(0,t.length-1)),isNaN(t)||t<0||t>1500?(f((e=>({...e,radius:"Radius must be a number between 100 and 1500"}))),setTimeout((()=>{f((e=>({...e,radius:null})))}),3e3)):ne("radius",t)},handleOnBlur:e=>{let t=e.replace(/[^0-9]/g,"");!0===t.includes(".")&&(t=t.substring(0,t.length-1)),0!==e.length?isNaN(e)||e<99||e>1500?(f((e=>({...e,radius:"Radius must be a number between 100 and 1500"}))),setTimeout((()=>{f((e=>({...e,radius:null})))}),3e3)):ne("radius",t):f((e=>({...e,radius:"Enter radius"})))}})})]})}),y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx(ba,{label:"Custom data",left:!0})}),y.jsx(ka,{md:3,children:y.jsxs("div",{className:"d-flex",children:[y.jsx(La,{onChange:e=>{let t={...n};t.utm=e.target.value;let a={...h};!0===e.target.value?(t.utmList=[{key:"",value:"",isDropdown:!0}],a.utmListError=[{key:null,value:null}]):(t.utmList=[],a.utmListError=[]),f(a),l(t)},checked:n.utm}),y.jsx(ke,{tooltip:"Use custom data for advanced targeting and add up to 5 custom tags per region",icon:"icon-rs-circle-info-medium",size:"md",iconClass:"",mainClass:"ml5 mt2",onClick:()=>{}})]})})]})}),!0===n.utm&&y.jsx(ga,{children:y.jsxs(Ta,{children:[y.jsx(ka,{md:3}),y.jsx(ka,{md:9,style:{paddingRight:"35px"},children:null==(i=null==n?void 0:n.utmList)?void 0:i.map(((e,t)=>{var a,s,r,i;return y.jsx(ga,{children:y.jsxs(Ta,{className:"enable-custom-data",children:[y.jsxs(ka,{md:6,className:"enable-width",children:[!0===(null==e?void 0:e.isDropdown)&&y.jsx(te,{required:!0,data:ve(t),label:1e3===v?"Custom tag":"Add attributes",value:null==e?void 0:e.key,textField:"value",dataItemKey:"id",errorMessage:null==(a=null==h?void 0:h.utmListError[t])?void 0:a.key,onChange:e=>{var a,s;let r={...n},i={...h};i.utmListError[t].key=null;const o=e.target.value;if(g(o.id),1e3===o.id)r.utmList[t].isDropdown=!1,r.utmList[t].key="",r.utmList[t].value="";else{r.utmList[t].key=o;const e=null==(s=null==(a=o.value)?void 0:a.trim())?void 0:s.toUpperCase();r.utmList[t].value=e?`[[${e}]]`:""}f(i),l(r)}}),!1===(null==e?void 0:e.isDropdown)&&y.jsx(ie,{required:!0,placeholder:"Custom tag",val:null==e?void 0:e.key,errorMessage:null==(s=null==h?void 0:h.utmListError[t])?void 0:s.key,max:50,iconPlaceholder:!0,iconName:He,iconColor:"red",iconSize:"sm",iconOnClick:()=>{let e={...n};e.utmList[t].key="",e.utmList[t].isDropdown=!0,l(e);let a={...h};f(a)},onChange:e=>{if(""===e.target.value||/^[''A-Za-z0-9_-]*$/.test(e.target.value)){let a=e.target.value.replace(/\s+/g," "),s={...n};s.utmList[t].key=a.trimStart(),l(s)}let a={...h},s=e.target.value.length>0?null:"A custom tag is required";a.utmListError[t].key=s,f(a)}})]}),y.jsx(ka,{md:6,className:"enable-width",children:y.jsx(ie,{required:!0,placeholder:"Custom value",val:null==e?void 0:e.value,errorMessage:null==h?void 0:h.utmListError[t].value,max:100,disabled:"EMAIL"===(null==(r=null==e?void 0:e.key)?void 0:r.value)||"PHONE"===(null==(i=null==e?void 0:e.key)?void 0:i.value),onChange:e=>{if(""===e.target.value||/^[''A-Za-z0-9_-]*$/.test(e.target.value)){let a=e.target.value.replace(/\s+/g," "),s={...n};s.utmList[t].value=a.trimStart(),l(s)}let a=e.target.value.length>0?null:"A custom value is required",s={...h};s.utmListError[t].value=a,f(s)}})}),0===t&&y.jsx(ke,{tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",mainClass:"position-relative top5",iconClass:`${me()?"click-off":""} ${5===n.utmList.length?"click-off":""}`,onClick:()=>{if(!1===ue()&&n.utmList.length<5){let e={...n},t={...h};e.utmList.push({key:"",value:"",isDropdown:!0}),t.utmListError.push({key:null,value:null}),f(t),l(e)}}}),0!==t&&y.jsx(ke,{icon:"icon-rs-circle-minus-fill-edge-medium",size:"md",mainClass:"position-relative top5",color:"color-primary-red",tooltip:"Remove",onClick:()=>{let e={...n},a={...h};e.utmList.splice(t,1),a.utmListError.splice(t,1),l(e),f(a)}})]})})}))})]})})]})]}),y.jsxs("div",{className:"d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{T(!1),f({placeName:"",latitude:"",longitude:"",utmListError:"",radius:""})},variant:"outline-success",children:"Cancel"}),y.jsx(fe,{className:-1===P&&(null==d?void 0:d.length)>=50?"click-off":"",onClick:()=>{var e,t,a;let s=[];if((null==(e=n.utmList)?void 0:e.length)>0&&(null==(t=null==n?void 0:n.utmList)||t.map((e=>{var t;let a=null==e?void 0:e.key;!0===(null==e?void 0:e.isDropdown)&&(a=null==(t=null==e?void 0:e.key)?void 0:t.value),s.push({eventName:a,eventValue:e.value}),f()}))),!0===(()=>{var e,t,a,s;let r={...h};if((null==(e=re("placeName",n.placeName))?void 0:e.length)>0)return!1;if((null==(t=re("latitude",n.latitude))?void 0:t.length)>0)return!1;if((null==(a=re("longitude",n.longitude))?void 0:a.length)>0)return!1;if(null===(null==n?void 0:n.radius)||void 0===n.radius||""===n.radius)return r.radius="Enter radius",f(r),!1;if((null==(s=null==n?void 0:n.radius)?void 0:s.length)>0){let e=parseInt(null==n?void 0:n.radius);return e>=100&&e<=1500||(r.radius="Radius must be a number between 100 and 1500",f(r),!1)}return!0!==n.utm||!0!==ue()})()){let e={...n},t=[];if((null==(a=n.utmList)?void 0:a.length)>0&&n.utmList.map((e=>{var a;let s=null==e?void 0:e.key;!0===(null==e?void 0:e.isDropdown)&&(s=null==(a=null==e?void 0:e.key)?void 0:a.value),t.push({eventName:s,eventValue:e.value}),f()})),-1===P){l(e);const a=[{placeName:n.placeName,latitude:n.latitude,longitude:n.longitude,radiusType:n.radiusType,radius:n.radius,jsonData:t}],s=[...a,...d];de(s,(t=>{if(!0===(null==t?void 0:t.status)){const t=[...a,...d];u(t.length>50?t.slice(0,50):t);let s=-1===P?"Region added successfully":"Region updated successfully";if((null==t?void 0:t.length)>=50&&(s="Region limit exceed"),p(s),(null==t?void 0:t.length)>=50)return void setTimeout((()=>{p(null),T(!1)}),3e3);setTimeout((()=>{p(""),e.placeName="",e.latitude="",e.longitude="",e.radius="",e.utm=!1,e.utmList=[]}),2e3)}else{let e={...h};e.placeName=t.message,f(e)}}))}else{let e=[...d];e[P].placeName=n.placeName,e[P].latitude=n.latitude,e[P].longitude=n.longitude,e[P].radius=n.radius,e[P].radiusType=n.radiusType,e[P].jsonData=t,n.placeName,n.latitude,n.longitude,n.radiusType,n.radius;const a=[...d];de(a,(t=>{if(!0===(null==t?void 0:t.status)){const t=[...d];u(t.length>50?t.slice(0,50):t),p(-1===P?"Region added successfully":"Region updated successfully"),setTimeout((()=>{p("")}),2e3),u(e),setTimeout((()=>{T(!1)}),2e3)}else{let e={...h};e.placeName=t.message,f(e)}}))}let s={...h};s.cluster=null,f(s)}},children:-1===P?"Add":"Update"})]})]})]}),!0===E&&y.jsx(_a,{size:"md",headerTitle:"Delete region",para:"Deleting this region will affect scheduled communications. Are you sure you want to proceed?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{var t,a,s,r;if(!0===e&&-1!==P)if(null!==(null==(t=null==B?void 0:B.dataItem)?void 0:t.regionId)&&void 0!==(null==(a=null==B?void 0:B.dataItem)?void 0:a.regionId))r=(null==(s=null==B?void 0:B.dataItem)?void 0:s.regionId)||0,ce({path:$t,params:{regionId:r},sessionOut:k.globalStateData.setSessionOutData,loading:k.globalStateData.setIsLoadingData,ok:e=>{if(e.status){let e=[...d];e.splice(B.dataIndex,1),u(e),N(!1)}else N(!1)},fail:e=>{}});else{let e=[...d];e.splice(null==B?void 0:B.dataIndex,1),u(e),N(!1)}else N(!1)}}),A&&y.jsx(_a,{size:"md",headerTitle:"Edit region ",para:"Editing this region will affect scheduled communications. Are you sure you want to proceed?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{!0===e&&T(!0),I(!1)}}),j&&y.jsx(be,{}),y.jsx(Ta,{children:y.jsxs("div",{className:"d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{t()},variant:"outline-success",children:"Cancel"}),y.jsx(fe,{onClick:()=>{(()=>{var e,t,a,s,r;if((null==(e=re("identifier",n.identifier))?void 0:e.length)>0)return!1;if((null==(t=re("appName",n.appList))?void 0:t.length)>0)return!1;if(!1===n.isAllTime){if((null==(a=re("startDate",n.startDate))?void 0:a.length)>0)return!1;if((null==(s=re("endDate",n.endDate))?void 0:s.length)>0)return!1}return!((null==(r=re("cluster",d))?void 0:r.length)>0)})()&&oe()},variant:"outline-success",children:a?"Update":"Save"})]})})]})};function Ff(e){return e instanceof Date&&!isNaN(e)}function Mf(e){if("string"!=typeof e.identifier||""===e.identifier.trim())return!1;if(!Array.isArray(e.appList)||0===e.appList.length)return!1;if(!e.isAllTime&&e.customRange){if(null===e.startDate||null===e.endDate)return!1;const t=new Date(e.startDate),a=new Date(e.endDate);if(!Ff(t)||!Ff(a)||t>a)return!1}return!0}function Rf(e){const{placeName:t,latitude:a,longitude:s,radius:r,jsonData:i}=e;if(!t||t.length>50||/[^a-zA-Z0-9\s\-_,.']/.test(t))return!1;if(!function(e,t){const a=parseFloat(e),s=parseFloat(t);return!isNaN(a)&&!isNaN(s)&&a>=-90&&a<=90&&s>=-180&&s<=180}(a,s))return!1;const n=parseFloat(r);return!(isNaN(n)||n>1e3||i&&""!==i.trim()&&!function(e){try{const t=JSON.parse(e);return!!Array.isArray(t)&&t.every((e=>"object"==typeof e&&"eventName"in e&&"eventValue"in e&&"string"==typeof e.eventName&&"string"==typeof e.eventValue))}catch{return!1}}(i))}const Pf=e=>{const t={skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]},a=w.useContext(le);w.useState(0),w.useState(10);const[s,r]=w.useState(0),[i,n]=w.useState([]),[l,o]=w.useState([]),[c,d]=w.useState(null),[u,h]=w.useState(t);w.useState(null);const[f,m]=w.useState(!1),[p,v]=w.useState(!1);w.useState({}),w.useEffect((()=>{g()}),[]);const g=()=>{Ct(),null!==sessionStorage.getItem("locationData")&&JSON.parse(sessionStorage.getItem("locationData")),ce({path:Jt,sessionOut:a.globalStateData.setSessionOutData,ok:e=>{if(e.status)if(e.data.length){let t=[...null==e?void 0:e.data];const a={skip:0,take:u.take};let s=Z(t,a);o((null==s?void 0:s.data)||[]),n(null==e?void 0:e.data)}else m(!0);else m(!0)},fail:e=>{}})},b=(e,t)=>{const s={geoFenceId:e,statusId:t};if((null==l?void 0:l.length)>0){let a=null==l?void 0:l.filter((t=>(null==t?void 0:t.geoFenceId)===e));if((null==a?void 0:a.length)>0){let e=[...i],s=e.findIndex((e=>e===a[0]));e[s].statusID=t,e[s].statusName=1===t?"Active":"Inactive";let r=Z(e,u);o((null==r?void 0:r.data)||[])}}ce({path:Xt,params:s,loading:a.globalStateData.setIsLoadingData,sessionOut:a.globalStateData.setSessionOutData,ok:a=>{if(a.status);else if((null==l?void 0:l.length)>0){let a=null==l?void 0:l.filter((t=>(null==t?void 0:t.geoFenceId)===e));if((null==a?void 0:a.length)>0){let e=[...l],s=e.findIndex((e=>e===a[0]));e[s].statusID=1===t?2:1,e[s].statusName=1===t?"Inactive":"Active",o(e)}}},fail:e=>{}})},x=({geoFenceId:e})=>{ce({path:Zt,params:{geoFenceId:e},loading:a.globalStateData.setIsLoadingData,sessionOut:a.globalStateData.setSessionOutData,ok:e=>{if(e.status){let t={...e.data};d(t),r(1)}},fail:e=>{}})},S=e=>{const[t,a]=w.useState(!1),[s,n]=w.useState(!1),[c,d]=w.useState(!1),[m,g]=w.useState(!localStorage.getItem("geofencingInfoShown")),[S,T]=w.useState({});return w.useMemo((()=>{localStorage.getItem("geofencingInfoShown")||g(!0)}),[m]),y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb mt20",children:[m&&y.jsxs(Da,{size:"lg",show:m,onHide:()=>setAddClusterPopUp(!1),children:[y.jsx(Da.Header,{children:"Geofencing Information"}),y.jsx(Da.Body,{children:y.jsx("div",{className:"d-flex flex-column",children:y.jsx(Hr,{})})}),y.jsx(Da.Footer,{children:y.jsx(fe,{onClick:()=>{g(!1),localStorage.setItem("geofencingInfoShown",!0)},className:"align-self-end",children:"OK"})})]}),y.jsxs("div",{style:{display:"flex",gap:10},className:"position-relative",children:[y.jsx("h3",{children:"Location clusters"}),y.jsx(ke,{shadow:!0,tooltip:"What is geofencing?",position:"top",icon:"icon-rs-circle-info-mini",size:"md",iconClass:me()?"click-off":"",onClick:()=>{g(!0)}})]}),y.jsx(ke,{shadow:!0,tooltip:"Add location cluster",position:"left",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",iconClass:me()||(null==l?void 0:l.length)>=50?"click-off":"",onClick:()=>{r(1)}})]}),(null==l?void 0:l.length)>0?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:u,data:l,pageable:!0,settings:{total:i.length},isDataStateRequired:!0,pageStateChange:e=>{(e=>{e.page,h(e.page);let t=Z(i,e.page);o(null==t?void 0:t.data)})(e)},column:[{field:"identifier",title:"Cluster name",cell:e=>y.jsx("td",{children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"apps",title:"Apps",cell:e=>y.jsx("td",{children:e.dataItem[e.field].filter((e=>"string"==typeof e.appName)).map((e=>e.appName)).join(", ")})},{field:"createdDate",title:"Created date",width:200,cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:Ge(e.dataItem[e.field])})})},{field:"statusName",title:"Status",width:110,cell:e=>{var t=e.dataItem[e.field];return e.dataItem.isAllTime||function(e){const t=new Date(e),a=new Date;return t.setHours(0,0,0,0),a.setHours(0,0,0,0),(t-a)/864e5>3}(e.dataItem.startDate)&&1===e.dataItem.statusID&&(t="Scheduled"),y.jsx("td",{className:"text-start",children:y.jsx("span",{children:t})})}},{field:"action",title:"Actions",width:180,cell:e=>y.jsx("td",{children:y.jsxs("ul",{className:"camp-icon-pannel",children:[y.jsx("li",{children:y.jsx(Ue,{text:"Status",position:"top",children:y.jsx(La,{onChange:t=>{T(e.dataItem),1===e.dataItem.statusID?a(!0):(e=>{if(Je.info("dataItem ::",JSON.stringify(e.geoFenceId)),1===e.statusID)b(e.geoFenceId,2);else{if(e.isAllTime)return void b(e.geoFenceId,1);let t=new Date(e.endDate),a=new Date;(new Date).setDate(a.getDate()+3),t>a?b(e.geoFenceId,1):d(!0)}})(e.dataItem)},checked:"active"===e.dataItem.statusName.toLowerCase()})})}),y.jsx("li",{children:y.jsx(Ue,{text:"Edit",position:"top",children:y.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{T(e.dataItem),n(!0)}})})})]})})}]})}):y.jsx(Ia,{count:5,message:"No cluster added yet. Click Add cluster to get started.",isError:f}),!0===p&&y.jsx(ja,{headerTitle:"Sorry",para:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{v(!1)}}),!0===t&&y.jsx(_a,{size:"md",headerTitle:"Deactivate cluster ",para:"Deactivating the cluster will affect scheduled communications. Are you sure you want to proceed?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{a(!1),!0===e&&(Je.info("selectedData ::",JSON.stringify(S)),b(null==S?void 0:S.geoFenceId,2))}}),s&&y.jsx(_a,{size:"md",headerTitle:"Edit cluster ",para:"Editing this cluster will affect scheduled communications. Are you sure you want to proceed?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{n(!1),!0===e&&(Je.info("selectedData ::",JSON.stringify(S)),x(S))}}),!0===c&&y.jsx(_a,{size:"md",headerTitle:"Cluster end date expired",para:"This cluster is no longer active. Please update the end date to reactivate it.",secondaryButtonText:"Cancel",primaryButtonText:"Continue",buttonClicked:e=>{d(!1),!0===e&&x(S)}})]})},T=[y.jsx(S,{}),y.jsx(Lf,{editData:c,cancelBtnClick:()=>{g(),r(0),d(null),h(t)},saveBtnClick:()=>{g(),r(0),d(null),h(t)}})];return y.jsx(y.Fragment,{children:T[s]})},Uf=[{text:"Apps list"},{text:"User device setup"},{text:"Custom event"},{text:"Geofencing"}],Bf=e=>{const[t,a]=w.useState(0);w.useState("");const s=T(),[r,i]=w.useState(0),[n,l]=w.useState(0),o=w.useCallback((()=>0===n?null:y.jsx(Br,{onBoardId:n,onIndexChangeValue:e=>{a(e)}})),[n,t]),c=w.useCallback((e=>a(e)),[t]),d=[y.jsx(Gf,{cb:e.cb,onBoarding:r,onChangeIndex:e=>a(e),onGoalIndexChange:e=>{c(e)},onGettingAppOnboardId:e=>{l(e)},...e}),y.jsx(Hf,{}),y.jsx(Ur,{mobile:"mobile",onChangeIndex:e=>a(e)}),y.jsx(Pf,{}),o()];return w.useEffect((()=>{var e,t;(null==(t=null==(e=null==s?void 0:s.location)?void 0:e.state)?void 0:t.mobileOnBoarding)&&i(1)}),[]),y.jsxs("div",{className:"box-design rs-box-min-height",children:[y.jsx(Ua,{defaultSelectedItem:t,defaultClass:"",dynamicTab:"mini float-end mb10",activeClass:"active",tabData:Uf,callBack:(e,t)=>{a(t)}}),y.jsx("div",{className:"clearfix",children:" "}),y.jsx("div",{className:"camp-pannel-content",children:d[t]})]})},Gf=e=>{const t=(e,t)=>({result:Z(t.slice(0),e),dataState:e}),a=w.useContext(le),s=w.useContext(Ze),r=T(),[i,n]=w.useState(null),[l,o]=w.useState(0),[c,d]=w.useState("add"),[u,h]=w.useState(null),[f,m]=w.useState(!1),[p,v]=w.useState(null),[g,b]=w.useState(null),[x,S]=w.useState(t({skip:0,take:5},[]).dataState),[k,D]=w.useState(!1),[C,E]=w.useState(""),[N,A]=w.useState(!1),[I,j]=w.useState(!1);w.useState(""),w.useState({});const[_,L]=w.useState(null),[F,M]=w.useState(!1),[R,P]=w.useState(0);w.useEffect((()=>{var e,t;s.apiStateData.setIsReloadData(!1),(null==(t=null==(e=null==r?void 0:r.location)?void 0:e.state)?void 0:t.mobileOnBoarding)?o(1):U()}),[s.apiStateData.getIsReloadData]),w.useEffect((()=>{let e=O.parse(window.location.search);(null==e?void 0:e.ma)&&o(1)}),[]),w.useEffect((()=>{}),[l]);const U=()=>{ce({path:Ut,sessionOut:a.globalStateData.setSessionOutData,ok:e=>{if(e.status){let a=t({take:5,skip:0},e.data);S(a.dataState),b(a.result),h(e.data),m(!1)}else{let e=t({take:5,skip:0},[]);S(e.dataState),b(e.result),h([]),m(!0)}},fail:e=>{m(!0)}})},B=e=>{let a=t(e.dataState,u);S(a.dataState),b(a.result)},G=t=>y.jsx(Vf,{list:u,...t,cb:(t,a)=>{e.cb(t,a)},updateOnboardId:e=>n(e),onModeChange:e=>{d(e)},onAppOnboardId:t=>{null==e||e.onGettingAppOnboardId(t)},onIndexChange:e=>{o(e)},getData:e=>{v(e)},deleteData:()=>{U()},deleteDataItem:e=>{E(e),D(!0)},healthCheck:e=>{V(e)}}),V=e=>{L(e),j(!0)},W=e=>y.jsxs(y.Fragment,{children:[!0===N&&y.jsx(ja,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{A(!1)}}),!0===F&&y.jsx(ja,{size:"md",headerTitle:"Mobile push",para:"Mobile push limit exceeded, please upgrade your plan.",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:e=>{M(!1),e&&r.push("/subscription")}}),4===R&&y.jsx(Da,{show:!0,centered:!0,onHide:()=>P(0),children:y.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[y.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),y.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>P(0)})]})}),!0===k&&y.jsx(_a,{size:"md",headerTitle:"Mobile push notification ",para:"Are you sure you want to delete this item?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{D(!1),!0===e&&ce({path:ea,params:{appGuid:C},loading:a.globalStateData.setIsLoadingData,sessionOut:a.globalStateData.setSessionOutData,ok:e=>{if(e.status){let s=t({take:5,skip:0},e.data);S(s.dataState),b(s.result),h(e.data),m(!0),Be(a,(e=>{}))}},fail:e=>{A(!0);let a=t({take:5,skip:0},[]);S(a.dataState),b(a.result),h([]),m(!0)}})}}),!0===I&&null!==_&&y.jsx(hr,{title:"Mobile push",data:_,appId:_.appId,domainUrl:"",close:()=>{L(null),j(!1)}}),y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{className:"marginB0",children:(null==u?void 0:u.length)>1?"Mobile apps":"Mobile app"}),y.jsx(ke,{shadow:!0,tooltip:"Add mobile app",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",iconClass:!0===me()?"click-off":"",onClick:()=>{if(!1===tt(null==u?void 0:u.length)){let e=at();if(null!==e&&4===(null==e?void 0:e.planId))return void P(e.planId);M(!0)}else{e.updateOnboardId(0),d("add"),o(1);const t=`${window.location.origin}${window.location.pathname}?ma=${window.btoa("0")}`;window.history.pushState({path:t},"",t)}}})]}),y.jsx("ul",{className:"campaign-box-container",children:(null==u?void 0:u.length)?y.jsx(Q,{data:g,...x,total:u.length,onDataStateChange:B,sortable:!1,className:"grid-pagenation rs-grid-listing rs-child-table-border pager-extra-space",scrollable:"none",messages:{itemsPerPage:"data Items per page"},pageable:(null==u?void 0:u.length)>5?{type:"input",pageSizes:[5,10,20],previousNext:!0,messages:{itemsPerPage:"Data Items per page"}}:null,children:y.jsx(ee,{field:"",filterable:!1,cell:G})}):y.jsx("div",{className:"p0 mt15",children:y.jsx(Ia,{count:5,isError:f,children:y.jsx("div",{className:`nodata-bar add-func ${me()&&"click-off"}`,onClick:()=>{if(!1===tt(null==u?void 0:u.length)){let e=at();if(null!==e&&4===(null==e?void 0:e.planId))return void P(e.planId);M(!0)}else{e.updateOnboardId(0),d("add"),o(1);const t=`${window.location.origin}${window.location.pathname}?ma=${window.btoa("0")}`;window.history.pushState({path:t},"",t)}},children:y.jsxs(y.Fragment,{children:[y.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5"}),y.jsx("p",{children:"Create"})]})})})})})]}),H=w.useCallback((()=>y.jsx(Br,{onBoardId:i,onIndexChangeValue:e=>{o(e)}})),[l]),z=[y.jsx("div",{className:"empty",children:y.jsx(W,{onChangeIndex:e=>o(e),updateOnboardId:e=>n(e)})}),y.jsx(wr,{mode:c,noPannel:!0,onChangeIndex:e=>{o(e),0===e&&U()},updateOnboardId:i}),y.jsx(Ur,{mobile:"mobile",mobileData:p,onChangeIndex:e=>o(e),updateOnboardId:e=>n(e)}),H()];return y.jsx("div",{children:z[l]})},Vf=e=>{var t,a;const[s,r]=w.useState(!1),i=w.useContext(le);T();const[n,l]=w.useState(!1),[o,c]=w.useState(!1);return y.jsxs(y.Fragment,{children:[y.jsxs("li",{className:"campaign-list-box",children:[y.jsx("div",{className:"campaign-label-box",children:y.jsxs("div",{className:"campaign-two-label",children:[y.jsx("small",{children:"App name"}),y.jsx(Ue,{text:e.dataItem.appName,position:"top",children:y.jsx("h4",{children:e.dataItem.appName})})]})}),y.jsx("div",{className:"campaign-label-box",children:y.jsxs("div",{className:"campaign-two-label",children:[y.jsx("small",{children:"Created by"}),y.jsx("h4",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.createdName)||(null==(a=nt())?void 0:a.clientName)||""})]})}),y.jsx("div",{className:"campaign-label-box",children:y.jsxs("div",{className:"campaign-two-label",children:[y.jsx("small",{children:"Created date"}),y.jsx("h4",{children:Ge(e.dataItem.createdDate,!1)})]})}),y.jsx("div",{className:"campaign-label-box",children:(()=>{const[t,a]=w.useState(e.dataItem.isPriority),s=T();return y.jsx(y.Fragment,{children:y.jsxs(_e,{className:"float-end",children:[y.jsx(Ue,{text:"Field tracking",position:"top",children:y.jsx("i",{className:"icon-rs-event-tracking-medium color-primary-blue icons-md cp click-off",onClick:()=>{e.getData(e.dataItem),e.onIndexChange(0),sessionStorage.setItem("AppNameTracking",e.dataItem.appName)}})}),y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",size:"md",tooltip:"Edit",onClick:()=>{e.updateOnboardId(e.dataItem.appGuid),e.onIndexChange(1),e.onModeChange("edit");const t=`${window.location.origin}${window.location.pathname}?ma=${window.btoa(e.dataItem.appGuid)}`;window.history.pushState({path:t},"",t)}}),y.jsx(ke,{mainClass:"",icon:"icon-rs-communication-target-medium",size:"lg",tooltip:"Goal",onClick:()=>{e.updateOnboardId(e.dataItem.mpid),e.onIndexChange(3),localStorage.setItem("GridView",!0)}}),y.jsx(ke,{icon:"icon-rs-settings-medium",size:"md",tooltip:"Settings",onClick:()=>{let t={appGuId:e.dataItem.appGuid,mpid:e.dataItem.mpid,appName:e.dataItem.appName};e.cb(!0,t);let a=Ne(t);const s=`${window.location.origin}${window.location.pathname}?ma=${window.btoa(e.dataItem.appGuid)}&details=${a}&isAppPermission=true`;window.history.pushState({path:s},"",s)}}),y.jsx(ke,{icon:"icon-rs-circle-info-medium",size:"md",tooltip:"Info",onClick:()=>{var t;c(!0),localStorage.setItem("appName",null==(t=e.dataItem)?void 0:t.appName),s.push({state:{appGuId:e.dataItem.appGuid,data:e.dataItem.mobilepushdeviceinfo}})}}),o&&y.jsxs(Da,{backdrop:"static",show:!0,centered:!0,size:"lg",children:[y.jsxs(Da.Header,{children:[y.jsx("h2",{children:"App credentials"}),y.jsx(Ma,{mainClass:"close",size:"md",handleClose:()=>{c(!1)}})]}),y.jsx(Da.Body,{children:y.jsx("div",{className:"d-flex",children:y.jsx(rs,{})})})]}),y.jsx(ke,{mainClass:"",icon:"icon-rs-heart-medium",size:"md",tooltip:"Health check",onClick:()=>{let t={appId:e.dataItem.appGuid,appName:e.dataItem.appName,deviceInfo:e.dataItem.mobilepushdeviceinfo};e.healthCheck(t)}}),y.jsx(ke,{iconClass:`${me()?"click-off":""} ${!0===t?"orange":"grey"}`,icon:"icon-rs-crown-fill-medium",size:"md",tooltip:"Priority",onClick:()=>{!0!==me()&&(0===e.list.filter((e=>e.isPriority)).length||!0===e.dataItem.isPriority)&&(e.dataItem.isPriority=!e.dataItem.isPriority,a(!e.dataItem.isPriority),((t,a)=>{ce({path:aa,params:{appGuid:t,isPriority:a},loading:i.globalStateData.setIsLoadingData,sessionOut:i.globalStateData.setSessionOutData,ok:t=>{t.status?e.deleteData():l(!0)},fail:e=>{oe("Update Priority error",e.message)}})})(e.dataItem.appGuid,e.dataItem.isPriority))}}),y.jsx(ke,{icon:"icon-rs-delete-medium",size:"md",tooltip:"Delete",iconClass:!0===me()?"click-off":"",onClick:()=>{e.deleteDataItem(e.dataItem.appGuid)}})]})})})()}),y.jsx("div",{className:"expand-icon",children:y.jsx("i",{className:s?"k-icon k-i-minus":"k-icon k-i-plus",onClick:()=>{r(!s)}})})]}),s&&y.jsx(Er,{appGuid:e.dataItem.appGuid,data:e.dataItem.mobilepushdeviceinfo}),!0===n&&y.jsx(ja,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{l(!1)}})]})},Wf=(e,t)=>({result:Z(t.slice(0),e),dataState:e}),Hf=e=>{const t=w.useContext(le);w.useState(0),w.useState(10);const[a,s]=w.useState(0),[r,i]=w.useState(0),[n,l]=w.useState([]),[o,c]=w.useState(Wf({skip:0,take:5},[]).dataState),[d,u]=w.useState(null),[h,f]=w.useState(!1),[m,p]=w.useState(!1);w.useEffect((()=>{v()}),[]);const v=()=>{const e={clientId:Ct()};ce({path:Qt,params:e,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{if(e.status){let t=Wf({take:5,skip:0},null==e?void 0:e.data);c(t.dataState),u(t.result),l(e.data),f(!1)}else f(!0),l([])},fail:e=>{}})},g=e=>{const[a,r]=w.useState(!1),[o,c]=w.useState(!1);return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between theme-space-mb",children:[y.jsx("h3",{children:"Users device summary"}),y.jsx(ke,{shadow:!0,tooltip:"Add user device setup",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",iconClass:me()?"click-off":"",onClick:()=>{i(0),s(1)}})]}),(null==n?void 0:n.length)>0?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:{take:5,skip:0},data:n,pageable:n.length>5,settings:{total:n.length},isDataStateRequired:!1,column:[{field:"appName",title:"App name",cell:e=>y.jsx("td",{children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"userName",title:"User name",cell:e=>y.jsx("td",{children:e.dataItem[e.field]})},{field:"deviceModel",title:"User device",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"createdDate",title:"Created date",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:Ge(e.dataItem[e.field],!1)})})},{field:"action",title:"Actions",cell:e=>y.jsxs("td",{children:[y.jsxs("ul",{className:"camp-icon-pannel",children:[y.jsx("li",{children:y.jsx(Ue,{text:"Edit",position:"top",children:y.jsx("i",{className:"'icon-rs-communication-target-medium' icons-lg blue",onClick:()=>{i(e.dataItem.userDeviceId),s(1)}})})}),y.jsx("li",{children:y.jsx(Ue,{text:"Delete",position:"top",children:y.jsx("i",{className:"icon-rs-delete-medium icons-md blue "+(me()?"click-off":""),onClick:()=>{r(!0)}})})})]}),!0===a&&y.jsx(_a,{size:"md",headerTitle:"Users device ",para:"Are you sure you want to delete this item?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:a=>{var s;r(!1),!0===a&&(s=e.dataItem.userDeviceId,ce({path:ta,params:{userDeviceId:s},loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{e.status?(l(e.data),v()):p(!0)},fail:e=>{}}))}})]})}]})}):y.jsx(Ia,{count:5,isError:h}),!0===m&&y.jsx(ja,{headerTitle:"Sorry",para:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{p(!1)}}),o&&y.jsx(ja,{size:"md",headerTitle:"Mobile push",para:"Mobile push limit exceeded, please upgrade your plan.",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:e=>{c(!1),!0===e&&history.push("/subscription")}})]})},b=[y.jsx(g,{}),y.jsx(Cr,{cb:()=>{s(0),f(!1),v()},userDeviceId:r})];return y.jsx(y.Fragment,{children:b[a]})},zf=e=>y.jsx("td",{children:y.jsx(_e,{className:"float-end",children:y.jsx(ke,{tooltip:"Delete",icon:`icon-rs-delete-medium ${!0===me()&&"click-off"}`,size:"md",onClick:()=>{var t,a;t=e.dataItem.appDomainMapID,a=t=>{e.delete(t)},ce({path:ca,loading:e.context.globalStateData.setIsLoadingData,params:{appDomainMapID:t},ok:e=>{e.status?a(!0):a(!1)},fail:e=>{a(!1)}})}})})}),Yf=(e,t)=>({result:Z(t.slice(0),e),dataState:e}),Kf=e=>{const t=w.useContext(le);w.useState(0),w.useState(5);const[a,s]=w.useState([]),[r,i]=w.useState(!1),[n,l]=w.useState({domainName:"-- Select web domain --",webGuid:"-- Select web domain --"}),[o,c]=w.useState({appName:"-- Select mobile app --",appGuid:"0"}),[d,u]=w.useState(null),[h,f]=w.useState(null),[m,p]=w.useState([]),[v,g]=w.useState([]),[b,x]=w.useState(Yf({skip:0,take:5},[]).dataState),[S,T]=w.useState(null),[k,D]=w.useState(!1),[C,E]=w.useState(null),[N,A]=w.useState(!1);w.useEffect((()=>{I()}),[]);const I=()=>{A(!0),ce({path:sa,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{var t,a,r,n,l;if(e.status){let o=Yf({take:5,skip:0},null==(t=null==e?void 0:e.data)?void 0:t.domainappList);A(!1),x(o.dataState),T(o.result),s(null==(a=null==e?void 0:e.data)?void 0:a.domainappList),p(null==(r=null==e?void 0:e.data)?void 0:r.domainList),g(null==(n=null==e?void 0:e.data)?void 0:n.appList),i(!(null==(l=null==e?void 0:e.data)?void 0:l.domainappList.length)&&!0)}else i(!0)},fail:e=>{i(!0)}})};return y.jsxs("div",{className:"box-design rs-box-min-height py40",children:[y.jsx(ga,{className:"mb30",children:y.jsxs(Ta,{children:[y.jsx(ka,{md:4,children:y.jsx(te,{required:!0,label:"Domain name",data:m,textField:"domainName",dataItemKey:"webGuid",value:n,errorMessage:d,onChange:e=>{l(e.target.value);let t=0===e.target.value.domainUrl.length?ra:null;u(t)}})}),y.jsx(ka,{md:1,className:"web-mobile-transaction-icon",children:y.jsx(_e,{children:y.jsx(ke,{icon:ia,size:"md"})})}),y.jsx(ka,{md:4,children:y.jsx(te,{required:!0,label:"App name",data:v,textField:"appName",dataItemKey:"appGuid",value:o,errorMessage:h,onChange:e=>{c(e.target.value);let t=0===e.target.value.appName.length?na:null;f(t)}})}),y.jsx(ka,{md:2,children:y.jsx(Ka,{children:y.jsxs(_e,{children:[y.jsx(fe,{className:"btn-primary-sm mt-7 "+(me()?"click-off":""),onClick:()=>{(()=>{let e=!1;if(n.domainName.toLowerCase().includes("select")&&(e=!0,u(ra)),o.appName.toLowerCase().includes("select")&&(e=!0,f(na)),!e){var a={webGuid:n.webGuid,domainName:n.domainName,appGuid:o.appGuid,appId:o.mpid,appName:o.appName,appDomainMapID:"",createdBy:Tt()};ce({path:oa,loading:t.globalStateData.setIsLoadingData,params:a,ok:e=>{e.status?(l({domainName:"-- Select web domain --",webGuid:"-- Select web domain --"}),c({appName:"-- Select mobile app --",appGuid:"0"}),I()):(D(!0),E((null==e?void 0:e.message)||Ce))},fail:e=>{}})}})()},children:"Add"}),y.jsx(ke,{iconClass:"ml15 mb5",icon:la,size:"md",pophover:"Enhance your resume journey"})]})})})]})}),!0===N?y.jsx(Ia,{count:5,isError:r}):y.jsx(y.Fragment,{children:(null==a?void 0:a.length)>0?y.jsx(y.Fragment,{children:y.jsx(Oa,{config:{take:5,skip:0},data:a,settings:{total:a.length},pageable:a.length>5,isDataStateRequired:!1,column:[{field:"domainName",title:"Domain name",cell:e=>{var t;return y.jsx("td",{children:y.jsx("span",{children:null==(t=e.dataItem)?void 0:t.domainName})})}},{field:"appName",title:"App name",cell:e=>y.jsx("td",{children:e.dataItem[e.field]})},{field:"userName",title:"User name",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:e.dataItem[e.field]})})},{field:"createdDate",title:"Created date",cell:e=>y.jsx("td",{className:"text-start",children:y.jsx("span",{children:Ge(e.dataItem[e.field],!1)})})},{field:"action",title:"Action",cell:a=>y.jsx(zf,{...a,context:t,cb:e.cb,delete:e=>I()})}]})}):y.jsx(Ia,{count:5,isError:r})}),!0===k&&y.jsx(ja,{headerTitle:"Sorry",subtitle:C,primaryButtonText:"OK",buttonClicked:e=>{D(!1)}})]})};class $f extends k.Component{constructor(){super(...arguments),x(this,"getFerquencyName",(()=>this.props.dropDownValue.filter((e=>this.props.limit.frequency===e.frequency))[0].freqName))}render(){return y.jsx("div",{children:y.jsxs(Ta,{children:[y.jsxs(ka,{md:3,children:[" ",y.jsx("label",{children:this.props.limit.limitName})," "]}),y.jsx(ka,{md:3,children:y.jsx(ie,{val:this.props.limit.limitvalue,cb:e=>{this.props.onValueChanged(this.props.limit,e)}})}),y.jsx(ka,{md:4,children:y.jsxs("div",{className:"d-flex align-items-center marginT15",children:[y.jsx("div",{className:"marginR5",children:"/"}),y.jsx(Aa,{data:this.props.dropDownValue,onSelect:e=>{this.props.onDropDownValueChanged(this.props.limit,e)},fieldKey:"freqName",defaultItem:this.getFerquencyName(),customAlignRight:!0,className:"marginR10"}),y.jsx("div",{className:"font-italic",children:this.props.limit.availableLimit}),this.props.limit.errMessage&&y.jsx("div",{className:"validation-message",children:this.props.limit.errMessage})]})})]})})}}class qf extends k.Component{constructor(){super(...arguments),x(this,"getDropDownValue",(e=>this.props.limitsDropDown.filter((t=>t.lId===e))||[]))}render(){const{limits:e}=this.props;return y.jsx("div",{children:e.map((e=>y.jsx($f,{dropDownValue:this.getDropDownValue(e.limitId),limit:e,ferquency:this.props.frequency,onValueChanged:this.props.onValueChanged,onDropDownValueChanged:this.props.onDropDownValueChanged},e.limitId)))})}}const Jf=e=>{var t,a,s;const[r,i]=k.useState({attrData:null,defaultAttribute:[],availableAttribute:[],assignedAttr:[],isLoadingSkeleton:!1}),[n,l]=w.useState(!1),o=k.useRef(0),[c,d]=w.useState(!1),[u,h]=w.useState(!1),f="selected",m=e=>e.sort(((e,t)=>{const a=e.attributeName.toUpperCase(),s=t.attributeName.toUpperCase();return a<s?-1:a>s?1:0}));w.useEffect((()=>{var t,a,s;if(e.attrData){let n=null==(t=e.attrData)?void 0:t.webAttributesdefaults,l=null==(a=e.attrData)?void 0:a.webAttributesavilable;const o=JSON.parse(null==(s=e.attrData)?void 0:s.notifysettingJson)||"";let c=[];l.map((e=>{const t=JSON.stringify(null==o?void 0:o.assignedAttrs);(null==t?void 0:t.includes(e.webAttrID))||c.push(e)}));let d={...r,attrData:e.attrData,defaultAttribute:m(n),availableAttribute:m(c),assignedAttr:(null==o?void 0:o.assignedAttrs)||[]};i(d),e.newState&&e.newState(d)}else i({...r,isLoadingSkeleton:!0}),e.newState&&e.newState(r)}),[e.attrData]);const p=(e,t,a)=>{let s=o.current;const n=[...r[t]],l=n.findIndex((t=>t===e.dataItem));e.nativeEvent.shiftKey||(o.current=s=l),e.nativeEvent.ctrlKey||n.forEach((e=>e.selected=!1));const c=!e.dataItem.selected;for(let r=Math.min(s,l);r<=Math.max(s,l);r++)n[r].selected=c;i({...r,[t]:m(n)})},v=e=>{if((c||u)&&(c&&"transferTo"===e.toolName||u&&"transferFrom"===e.toolName)){let t=e.toolName||"",a=Ls(r.availableAttribute,r.assignedAttr,t,f);d(!1),h(!1),i({...r,availableAttribute:m(a.listBoxOneData),assignedAttr:m(a.listBoxTwoData)})}},g=e=>{i({...r,draggedItem:e.dataItem})},b=e=>{let t=Ms(r.availableAttribute,r.assignedAttr,r.draggedItem,e.dataItem,"attributeName");i({...r,availableAttribute:t.listBoxOneData,assignedAttr:t.listBoxTwoData})};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex justify-content-between mb20",children:[y.jsx("h3",{children:"Attributes"}),y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",tooltip:"Edit attributes",onClick:()=>{l(!n)}})]}),y.jsx("div",{className:"chips-container com-set",children:y.jsxs("div",{className:"chips-box",children:[y.jsxs("h6",{className:"mb10",children:["Default"," ",y.jsx("div",{className:"count-label",children:r.defaultAttribute.length})]}),y.jsx("div",{className:"no-close multi-attr-default-max pointer-none",children:(null==(t=null==r?void 0:r.defaultAttribute)?void 0:t.length)&&y.jsx(X,{data:r.defaultAttribute,textField:"attributeName",dataItemKey:"webAttrID",onChange:e=>{},value:r.defaultAttribute,allowCustom:!1})}),y.jsx("div",{className:"dotted-line my10"}),y.jsxs("h6",{className:"mb10",children:["Additional"," ",y.jsx("div",{className:"count-label",children:null==(a=r.assignedAttr)?void 0:a.length})]}),y.jsx("div",{className:"no-search multi-attr-additional-max",children:(null==(s=r.assignedAttr)?void 0:s.length)>0&&y.jsx(X,{textField:"attributeName",dataItemKey:"webAttrID",onChange:t=>{let a={...r};if(t.target.value.length){var s=a.assignedAttr.filter((e=>!t.target.value.find((t=>e.webAttrID===t.webAttrID))))[0];s.selected=!1;let e=[...a.availableAttribute];e.push(s),a.availableAttribute=e,a.assignedAttr=t.target.value}else{let e=a.assignedAttr[0];e.selected=!1,a.availableAttribute.push(e),a.assignedAttr=[]}e.newState&&e.newState(a),i(a)},value:null==r?void 0:r.assignedAttr,allowCustom:!1,disabled:!0})})]})}),y.jsx(y.Fragment,{children:y.jsxs(Da,{show:n,size:"lg",centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:"Add attributes"})}),y.jsx(Da.Body,{children:y.jsx(y.Fragment,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"justify-content-between mb20 listbox-toolbox",children:[y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Available attributes"}),r.availableAttribute&&y.jsx(Ns,{style:{height:240,width:"100%"},data:r.availableAttribute,textField:"attributeName",selectedField:c?f:"",onItemClick:e=>{d(!0),p(e,"availableAttribute")},onDragStart:g,onDrop:b,toolbar:()=>y.jsx(_s,{tools:["transferTo","transferFrom"],data:r.availableAttribute,dataConnected:r.assignedAttr,onToolClick:v})})]}),y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Assigned attributes"}),r.assignedAttr&&y.jsx(Ns,{style:{height:240,width:"100%"},data:r.assignedAttr,textField:"attributeName",selectedField:u?f:"",onItemClick:e=>{h(!0),p(e,"assignedAttr")},onDragStart:g,onDrop:b})]})]})})})}),y.jsx(Da.Footer,{children:y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{l(!n),e.newState&&e.newState(r)},children:"Close"})})})]})})]})},Xf=e=>{w.useState(!1);const[t,a]=k.useState({availEvents:[],assignedEvents:[],clientEvents:[],clientAssignedEvents:[],deleteEvents:[],isLoadingSkeleton:!1}),[s,r]=w.useState(!1),[i,n]=w.useState(!1),[l,o]=w.useState(!1),c=k.useRef(0),d="selected",u=e=>e.sort(((e,t)=>{const a=e.eventName.toUpperCase(),s=t.eventName.toUpperCase();return a<s?-1:a>s?1:0}));w.useEffect((()=>{var s,r,i;if(e.eventsData){const n=JSON.parse(null==(s=e.eventsData)?void 0:s.notifysettingJson),l=[],o=JSON.stringify(null==n?void 0:n.assignedEvents)||"";null==(i=null==(r=e.eventsData)?void 0:r.webappevents)||i.map((e=>{(null==o?void 0:o.includes(e.eventId))||l.push(e)}));let c={...t,availEvents:u(l),assignedEvents:u((null==n?void 0:n.assignedEvents)||[])};a(c),e.newState(c)}else a({...t,isLoadingSkeleton:!0}),e.newState(t)}),[e.eventsData]);const h=(e,s,r)=>{let i=c.current;const n=[...t[s]],l=n.findIndex((t=>t===e.dataItem));e.nativeEvent.shiftKey||(c.current=i=l),e.nativeEvent.ctrlKey||n.forEach((e=>e.selected=!1));const o=!e.dataItem.selected;for(let t=Math.min(i,l);t<=Math.max(i,l);t++)n[t].selected=o;a({...t,[s]:u(n)})},f=e=>{a({...t,draggedItem:e.dataItem})},m=e=>{let s=Ms(t.availEvents,t.assignedEvents,t.draggedItem,e.dataItem,"eventName");a({...t,availEvents:u(s.listBoxOneData),assignedEvents:u(s.listBoxTwoData)})},p=e=>{if((i||l)&&(i&&"transferTo"===e.toolName||l&&"transferFrom"===e.toolName)){let s=e.toolName||"",r=Ls(t.availEvents,t.assignedEvents,s,d);n(!1),o(!1),a({...t,availEvents:u(r.listBoxOneData),assignedEvents:u(r.listBoxTwoData)})}};return y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"d-flex justify-content-between mb20",children:[y.jsx("h3",{children:"Events"}),y.jsx(ke,{icon:"icon-rs-pencil-edit-medium",tooltip:"Edit events",onClick:()=>{r(!s)}})]}),y.jsx("div",{className:"chips-container com-set",children:y.jsx("div",{className:"chips-box",children:y.jsx("div",{className:"no-search multi-events-max",children:t.assignedEvents&&y.jsx(X,{placeholder:"Add events",disabled:!0,textField:"eventName",dataItemKey:"eventId",onChange:s=>{let r={...t},i=(e=>{let a=t.assignedEvents,s=[];return a.map((t=>{0===e.filter((e=>t.eventId===e.eventId)).length&&(t.selected=!1,s.push(t))})),u(s)})(s.target.value);r.availEvents.push(i[0]),r.assignedEvents=s.target.value,a(r),e.newState(r)},value:t.assignedEvents,allowCustom:!1})})})}),y.jsx(y.Fragment,{children:y.jsxs(Da,{show:s,size:"lg",centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:"Add events"})}),y.jsx(Da.Body,{children:y.jsx(y.Fragment,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"justify-content-between mb20 listbox-toolbox",children:[y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Available events"}),t.availEvents&&y.jsx(Ns,{style:{height:240,width:"100%"},data:t.availEvents,textField:"eventName",selectedField:i?d:"",onItemClick:e=>{n(!0),h(e,"availEvents")},onDragStart:f,onDrop:m,toolbar:()=>y.jsx(_s,{tools:["transferTo","transferFrom"],data:t.availEvents,dataConnected:t.assignedEvents,onToolClick:p})})]}),y.jsxs(ka,{children:[y.jsx("h4",{className:"mb10",children:"Assigned events"}),t.availEvents&&y.jsx(Ns,{style:{height:240,width:"100%"},data:t.assignedEvents,textField:"eventName",selectedField:l?d:"",onItemClick:e=>{o(!0),h(e,"assignedEvents")},onDragStart:f,onDrop:m})]})]})})})}),y.jsx(Da.Footer,{children:y.jsx("div",{className:"btn-container d-flex justify-content-end",children:y.jsx(fe,{onClick:()=>{r(!s),e.newState(t)},children:"Close"})})})]})})]})},Zf="selected",Qf=["transferTo","transferFrom"];class em extends k.Component{constructor(){super(...arguments),x(this,"state",{rightColumnValues:this.props.rightColumnValues,leftColumnValues:this.props.leftColumnValues,draggedItem:{},isOpen:this.props.isOpen}),x(this,"handleItemClick",((e,t,a)=>{this.setState({[t]:this.state[t].map((t=>(t.name===e.dataItem.name?t[Zf]=!t[Zf]:e.nativeEvent.ctrlKey||(t[Zf]=!1),t))),[a]:this.state[a].map((e=>(e[Zf]=!1,e)))})})),x(this,"handleToolBarClick",((e,t,a)=>{let s=Ls(this.state[t],this.state[a],e.toolName,Zf);this.setState({[t]:s.listBoxOneData,[a]:s.listBoxTwoData})})),x(this,"handleDragStart",(e=>{e.dataItem.dataCollection=e.target.props.name,this.setState({draggedItem:e.dataItem})})),x(this,"handleDrop",(e=>{let t=this.state.draggedItem.dataCollection,a=e.target.props.name,s=Ms(this.state[t],this.state[a],this.state.draggedItem,e.dataItem,"name");this.setState({[t]:s.listBoxOneData,[a]:s.listBoxTwoData})}))}componentDidMount(){this.setState({rightColumnValues:this.props.rightColumnValues,leftColumnValues:this.props.leftColumnValues,isOpen:this.props.isOpen})}render(){return y.jsxs(Da,{show:this.state.isOpen,size:"lg",centered:!0,children:[y.jsx(Da.Header,{children:y.jsx("h2",{children:this.props.modalTitle})}),y.jsx(Da.Body,{children:y.jsx(wa,{children:y.jsx("div",{className:"well-cover btop p0",children:y.jsxs(Ta,{className:"justify-content-between mb20",children:[y.jsxs(ka,{children:[y.jsxs("h6",{children:[this.props.leftColumnTitle," "]}),y.jsx(Ns,{style:{height:150,width:"100%"},data:this.state.leftColumnValues,textField:"name",selectedField:Zf,onItemClick:e=>this.handleItemClick(e,"leftColumnValues","rightColumnValues"),onDragStart:this.handleDragStart,onDrop:this.handleDrop,name:"leftColumnValues",toolbar:()=>y.jsx(_s,{tools:Qf,data:this.state.leftColumnValues,dataConnected:this.state.rightColumnValues,onToolClick:e=>this.handleToolBarClick(e,"leftColumnValues","rightColumnValues")})})]}),y.jsxs(ka,{children:[y.jsx("h6",{children:this.props.rightColumnTitle}),y.jsx(Ns,{style:{height:150,width:"100%"},data:this.state.rightColumnValues,textField:"name",selectedField:Zf,onItemClick:e=>this.handleItemClick(e,"rightColumnValues","leftColumnValues"),onDragStart:this.handleDragStart,onDrop:this.handleDrop,name:"rightColumnValues"})]})]})})})}),y.jsx(Da.Footer,{children:y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{this.setState({isOpen:!this.state.isOpen}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),y.jsx(fe,{onClick:()=>{this.setState({isOpen:!this.state.isOpen}),this.props.onChangeIsOpen(!1);const e=this.state.rightColumnValues.map((e=>e.name));this.props.onSaveButtonClicked(e,this.state.leftColumnValues,this.state.rightColumnValues)},children:"Save"})]})})]})}}const tm=e=>{const t=w.useContext(le),a=T(),[s,r]=w.useState(null),[i,n]=w.useState(null),[l,o]=w.useState([]),[c,d]=k.useState([]),[u,h]=k.useState(null),[f,m]=w.useState(null),[p,v]=k.useState(am);w.useState(0),w.useState(11);const[g,b]=w.useState(null),[x,S]=w.useState(null),[D,C]=w.useState(!1),[E,N]=w.useState(""),[A,I]=w.useState(""),[j,_]=w.useState(""),[L,F]=w.useState([]),[M,R]=w.useState([]),[P,U]=w.useState(!1),[B,G]=w.useState(null),[V,W]=w.useState(!1),[H,z]=w.useState(!1);w.useEffect((()=>{window.scroll(0,0);const a={onBoardingId:e.appPermissionData.onBoardingId,webGuid:e.appPermissionData.webGuid};ce({path:da,params:a,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{e.status?Y(e.data):(U(!0),G((null==e?void 0:e.message)||Ce))},fail:e=>{}})}),[]);const Y=e=>{r(e),K(e),$(e)},K=e=>{var t,a;let s=(null==(t=JSON.parse(null==e?void 0:e.notifysettingJson))?void 0:t.appPermission)||(null==e?void 0:e.webPermissionclientnew)||[];if((null==s?void 0:s.length)>0){let e=null==s?void 0:s.filter((e=>"SDK"===e.accessName));(null==e?void 0:e.length)>0&&z((null==(a=e[0])?void 0:a.isActive)||!1)}o(s)},$=e=>{const t=JSON.parse(null==e?void 0:e.notifysettingJson);h(null==t?void 0:t.inboxClassifyStatus),d(null==t?void 0:t.inboxClassify)},q=(e,t)=>e>t?"limit exsits":"";return y.jsxs(Na,{children:[y.jsx(wa,{fluid:!0,className:"main-heading-wrapper mb0",children:y.jsxs(wa,{className:"mhw-container",children:[y.jsx("div",{className:"mhwc-left",children:y.jsx("h1",{children:y.jsx("div",{className:"mh-wrapper",children:y.jsx("span",{className:"mh-text",children:"Settings"})})})}),y.jsx("div",{className:"mhwc-right",children:y.jsxs("div",{className:"back-text",onClick:()=>{var t,s,r,i,n,l,o;if(!0===(null==(s=null==(t=null==a?void 0:a.location)?void 0:t.state)?void 0:s.isCampaign)){const e=O.parse(null==(r=null==a?void 0:a.location)?void 0:r.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,c=null==(l=null==(n=null==(i=null==window?void 0:window.location)?void 0:i.search)?void 0:n.slice(1))?void 0:l.replace(s,"");return void a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${c}`,state:null==(o=null==a?void 0:a.location)?void 0:o.state})}const c=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:c},"",c),e.cb(!1)},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})})]})}),y.jsx(wa,{fluid:!0,className:"page-header",children:y.jsxs(wa,{children:[y.jsxs("div",{className:me()?"click-off":"",children:[null!==i&&y.jsxs(y.Fragment,{children:[y.jsx("h3",{className:"marginY25",children:"Limits"}),y.jsx("div",{className:"marginL15",children:y.jsx(qf,{limits:i,limitsDropDown:s.webPushLimits,frequency:s.frequency,onValueChanged:(e,t)=>{const a=[...i],s=i.indexOf(e);a[s]={...e},a[s].limitvalue=t,a[s].errMessage=null,""!==q(parseInt(t),parseInt(e.availableLimit))&&(a[s].limitvalue=0,a[s].errMessage="Limits volume exceeds"),n(a)},onDropDownValueChanged:(e,t)=>{const a=[...i],r=i.indexOf(e);a[r]={...e},a[r].freqName=t.freqName,a[r].frequency=t.frequency;let l=s.webPushLimits.filter((a=>a.lId===e.limitId&&a.frequency===t.frequency));if(l.length>0){let e=l[0].availableLimit;a[r].errMessage=null,""!==q(parseInt(a[r].limitvalue),parseInt(e))&&(a[r].limitvalue=0,a[r].errMessage="Limits volume exceeds"),a[r].availableLimit=e}n(a)}})})]}),y.jsx(ga,{className:"mb30",children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsxs("div",{className:"box-design",children:[y.jsxs(Ta,{children:[y.jsx(ka,{md:3,children:y.jsx("h3",{className:"mb10",children:"SDK "})}),y.jsx(ka,{children:y.jsx("div",{className:"mb10 float-end",children:y.jsx(La,{onChange:e=>{let t=[...l];t.map(((t,a)=>{t.isActive=e.target.value})),o(t),z(e.target.value)},checked:H})})})]}),y.jsx("div",{className:"sdk-settings-border",children:(null==l?void 0:l.length)?y.jsx(Oa,{gridClassName:"table-alert-notify SDKTableListCSS",data:l,column:[{field:"accessName",filter:"text",title:"Access name",cell:e=>{var t;return y.jsx("td",{children:y.jsx("span",{children:null==(t=e.dataItem)?void 0:t.accessName})})}},{field:"action",title:"Action",width:"120",cell:e=>y.jsx(sm,{...e,onCheckedChange:t=>{let a=[...l];0===e.dataIndex?a.map(((e,a)=>{e.isActive=t})):a[e.dataIndex].isActive=t,o(a)}})}],settings:{total:null==l?void 0:l.length},pageable:!1,config:{take:100,skip:0}}):y.jsx(Ia,{count:6,isError:!l})})]})}),y.jsx(ka,{md:6,children:y.jsx("div",{className:"box-design",children:(null==s?void 0:s.webAttributesdefaults)?y.jsx(Jf,{attrData:s,newState:e=>b(e)}):y.jsxs("div",{style:{height:311},children:[y.jsx("div",{className:"d-flex justify-content-between mb20",children:y.jsx("h3",{children:"Attributes"})}),y.jsx("div",{className:"posr",children:y.jsx(ls,{})})]})})})]})}),y.jsx(ga,{className:"mb30",children:y.jsxs(Ta,{children:[y.jsx(ka,{md:6,children:y.jsx("div",{className:"box-design",children:y.jsx(Xf,{eventsData:s,newState:e=>S(e)})})}),y.jsxs(ka,{md:6,className:"d-none",children:[y.jsx("h3",{className:"mb10",children:"Whitelisting & throttling"}),y.jsx("div",{className:"chips-container com-set",children:y.jsxs("div",{className:"chips-box",children:[y.jsx("h6",{children:"FCM IP whitelist"}),y.jsx("div",{className:"no-close multi-whitelist-max",children:y.jsx(X,{value:p,allowCustom:!1,disabled:!0,onChange:e=>{v(e.target.value)}})}),y.jsx("div",{className:"dotted-line my10 marginX-10"}),y.jsxs("div",{className:"d-flex justify-content-between",children:[y.jsx("h6",{children:"Notification delivery throttle"}),y.jsx("div",{children:"1,000,000 / Minute"})]})]})})]}),y.jsx(ka,{md:6,children:y.jsxs("div",{className:"position-releative",children:[f?y.jsx("div",{className:"validation-message multi-select-valid-msg",style:{left:15,top:0},children:f}):null,y.jsxs("div",{className:"box-design",children:[y.jsxs("div",{className:"d-flex align-items-center justify-content-between mb20",children:[y.jsx("h3",{children:"Inbox classification"}),y.jsx(La,{onChange:()=>h(!u),checked:u})]}),y.jsx("div",{className:"chips-container com-set "+(u?"":"click-off"),children:y.jsx("div",{className:"chips-box",children:y.jsx("div",{className:"no-search inbox-classification-max",children:y.jsx(se,{noDropdown:!0,noinput:!0,textField:"classifyName",placeholder:"Enter inbox classification",disabled:V,onChange:e=>{const t=e.target.value.reduce(((e,t)=>e.find((e=>e.classifyName===t.classifyName))?e:e.concat([t])),[]);if(e.target.value.length,t.length,t.length>10)return m("Limit exceed"),void setTimeout((()=>{m(null)}),3e3);d(t)},value:c,allowCustom:!0})})})})]})]})})]})})]}),y.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[y.jsx(he,{onClick:()=>{var t,s,r,i,n,l,o;if(!0!==(null==(s=null==(t=null==a?void 0:a.location)?void 0:t.state)?void 0:s.isCampaign)){var c=window.location.protocol+"//"+window.location.host+window.location.pathname;window.history.pushState({path:c},"",c),e.cb(!1)}else{const e=O.parse(null==(r=null==a?void 0:a.location)?void 0:r.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,c=null==(l=null==(n=null==(i=null==window?void 0:window.location)?void 0:i.search)?void 0:n.slice(1))?void 0:l.replace(s,"");a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${c}`,state:null==(o=null==a?void 0:a.location)?void 0:o.state})}},children:"Cancel"}),y.jsx(fe,{className:me()?"click-off":"",onClick:()=>{if(!0===me()){e.cb(!1);const t=`${window.location.origin}${window.location.pathname}`;return void window.history.pushState({path:t},"",t)}const s={onBoardingId:e.appPermissionData.onBoardingId,webGuid:e.appPermissionData.webGuid,limits:[],appPermission:l,assignedAttrs:g?g.assignedAttr:[],assignedEvents:x?x.assignedEvents:[],whitelisting:[],inboxClassify:c,inboxClassifyStatus:u};ce({path:ua,params:s,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{var s,r,i,n,l,o,c;if(t.status){if(!0===(null==(r=null==(s=null==a?void 0:a.location)?void 0:s.state)?void 0:r.isCampaign)){const e=O.parse(null==(i=null==a?void 0:a.location)?void 0:i.search);let t=void 0!==e.cId?e.cId:0;if(void 0!==localStorage.getItem(`camp_${t}`)&&null!==localStorage.getItem(`camp_${t}`)){let e=Ee(localStorage.getItem(`camp_${t}`));e.notifyData.mode="edit",localStorage.setItem(`camp_${t}`,Ne(e))}let s=`cId=${t}`,r=null==(o=null==(l=null==(n=null==window?void 0:window.location)?void 0:n.search)?void 0:l.slice(1))?void 0:o.replace(s,"");return void a.push({pathname:"/campaign/creation-notification",search:`?cId=${t}&${r}`,state:null==(c=null==a?void 0:a.location)?void 0:c.state})}e.cb(!1);const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t)}else U(!0),G((null==t?void 0:t.message)||Ce)},fail:e=>{}})},children:"Save"})]}),!0===D?y.jsx(em,{isOpen:D,onChangeIsOpen:e=>{C(e)},modalTitle:E,leftColumnTitle:A,leftColumnValues:L,rightColumnTitle:j,rightColumnValues:M,onSaveButtonClicked:(e,t,a)=>{}}):null,!0===P&&y.jsx(ja,{headerTitle:"Sorry",subtitle:B,primaryButtonText:"OK",buttonClicked:e=>{U(!1)}})]})})]})},am=["162.134.21.152","192.201.91.35","192.189.221.135"],sm=e=>y.jsx("td",{children:y.jsx("div",{className:"float-end",children:y.jsx(La,{onChange:t=>{e.onCheckedChange(t.target.value)},checked:e.dataItem.isActive})})}),rm=e=>{const[t,a]=w.useState([]),[s,r]=w.useState(!0),i=w.useContext(le),n=cs.useHistory();return w.useEffect((()=>{const e={clientId:Ct(),userId:Tt()};ce({path:ha,params:e,loading:i.globalStateData.setIsLoadingData,sessionOut:i.globalStateData.setSessionOutData,ok:e=>{e.status&&Array.isArray(e.data)?(a(e.data),r(!1)):r(!1)},fail:e=>{r(!1)}})}),[]),y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"justify-content-end d-flex mt10 mb10",children:y.jsx(ke,{shadow:!0,tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",size:"lg",onClick:()=>{n.push("/preferences/ChannalBenchMark")}})}),t.length>0?y.jsx(Oa,{config:{take:5,skip:0},data:t,settings:{total:t.length},pageable:!0,column:[{title:"Name",field:"benchMarkName",cell:e=>{var t;return y.jsx("td",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.benchMarkName)||"N/A"})}},{title:"Business Type",field:"businessType",cell:e=>{var t;return y.jsx("td",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.businessType)||"N/A"})}},{title:"Communication Attribute",field:"attributeName",filter:"text",cell:e=>{var t;return y.jsx("td",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.attributeName)||"N/A"})}},{title:"Country",field:"country",filter:"text",cell:e=>{var t;return y.jsx("td",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.country)||"N/A"})}},{title:"Industry",field:"industryName",filter:"text",cell:e=>{var t;return y.jsx("td",{children:(null==(t=null==e?void 0:e.dataItem)?void 0:t.industryName)||"N/A"})}},{title:"Action",field:"customEventName",width:"240",cell:e=>y.jsx("td",{children:y.jsx(_e,{className:"float-end",children:y.jsx(ke,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",onClick:()=>{(e=>{let t={attributeId:null==e?void 0:e.attributeId,benchMarkID:null==e?void 0:e.benchMarkID};null!=(null==t?void 0:t.attributeId)&&null!=(null==t?void 0:t.benchMarkID)&&n.push(`/preferences/ChannalBenchMark?attriID=${null==t?void 0:t.attributeId}&benchID=${null==t?void 0:t.benchMarkID}`)})(null==e?void 0:e.dataItem)}})})})}]}):s?y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsx("div",{})})}):y.jsx("div",{className:"box-design pb10",children:y.jsx(Ia,{count:5,isError:!0,children:y.jsxs("div",{className:"nodata-bar add-func",children:[y.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),y.jsx("p",{children:"No data available"})]})})})]})},im=e=>{cs.useHistory(),w.useState(null),w.useState(null),w.useState(0);const[t,a]=w.useState(0);w.useState(!1),w.useState("add"),w.useState(!0);const s=[y.jsx(rm,{changeHeader:t=>{null!=t&&(null==e||e.changeHeader(t),a(1))}}),y.jsx(ds,{})];return y.jsx(y.Fragment,{children:s[t]})},nm=({emailOnboard:e=!1,smtpData:t={},tabsData:a={},projectId:s="",accessToken:r="",accessId:i={clientId:"",userId:""},initialEmailFooterData:n=!1,initialUnsubData:l=!1,data:o=[],onSend:c,onLoading:d})=>{const u=A(),h=w.useContext(le),[f,m]=w.useState(o),[p,v]=w.useState(t),[g,b]=w.useState(a),[x,S]=w.useState(n),[k,D]=w.useState(l),[C,E]=w.useState([]),[N,I]=w.useState({clientId:0,userId:0}),[j,_]=w.useState(!0),O=T();return w.useEffect((()=>{(async()=>{try{const e=Oe();E(e||[])}catch(e){E([])}})()}),[]),w.useEffect((()=>{const e=M.parse(u.search);"true"===(null==e?void 0:e.isFooter)&&S(!0),"true"===(null==e?void 0:e.isUnsubscription)&&D(!0);const t=setTimeout((()=>{S(!1)}),2e3);return()=>clearTimeout(t)}),[u.search]),w.useEffect((()=>{try{const e=Ct(),s=Tt();I({clientId:e||0,userId:s||0}),m(o),v(t),b(a)}catch(e){}}),[o,t,a,n]),y.jsx(as,{emailOnboard:e,smtpData:p,tabsData:g,projectId:s,accessToken:r,accessId:N,onSend:e=>{try{null==c||c(e)}catch(t){}},LoadAPI:e=>{try{if(h.globalStateData.setIsLoadingData(e),e){const e=setTimeout((()=>{h.globalStateData.setIsLoadingData(!1)}),1e3);return()=>clearTimeout(e)}}catch(t){}},initialEmailFooter:x,MoveUnsubscription:k,moveEmailBuilder:e=>{try{null!=e&&O.push({pathname:"/preferences/emailbuilder",search:`?footerId=${null==e?void 0:e.footerId}&isEdit=${j}`,state:{footerData:e}})}catch(t){}},data:f,smtpFormData:C})},lm=localStorage.getItem("session"),om=JSON.parse(lm),cm=om?om.accessToken:"";class dm extends k.Component{constructor(){super(...arguments),x(this,"state",{index:parseInt(localStorage.getItem("cIndex"))||0,isAppPermission:!1,onboardingId:0,appPermisionDetails:null,mobilePermissionDetails:null,onBoadringScreenOpen:!1,hideWebOnboard:!1,CompanyListData:[],headerTabIndex:0,headerTabvalue:null,headerTag:"Channel settings",clientId:0,userId:0,accessToken:"",initialEmailFooterShow:!1,initialUnsubShow:!1,isReady:!1,tabsData:[{id:"smtp",text:"SMTP Settings",icon:y.jsx("i",{className:"icon-rs-smtp-large color-primary-white icons-lg"}),iconPosition:"top",width:"200px",height:"80px",active:!0},{id:"lifetime",text:"Lifetime Cap",icon:y.jsx("i",{className:"icon-rs-lifetime-cap-large color-primary-white icons-lg"}),iconPosition:"top",width:"200px",height:"80px",active:!1},{id:"subscription",text:"Subscription",icon:y.jsx("i",{className:"icon-rs-email-sub-unsub-large color-primary-white icons-lg"}),iconPosition:"top",width:"200px",height:"80px",active:!0},{id:"double-optin",text:"Double opt-in",icon:y.jsx("i",{className:"icon-rs-email-tick-large color-primary-white icons-lg"}),iconPosition:"top",width:"200px",height:"80px",active:!1},{id:"email-footer",text:"Email footer",icon:y.jsx("i",{className:"icon-rs-email-footer-large color-primary-white icons-lg"}),iconPosition:"top",width:"200px",height:"80px",active:!0}],smtpData:{domainData:[{smtpdomainSettingId:1,domainName:"id.resul.com3251148"},{smtpdomainSettingId:2,domainName:"id.resul.com3251149"}]}}),x(this,"tabs",[{text:"Mail",iconLeft:"icon-rs-email-large icons-lg",disable:!1},{text:"Web push",iconLeft:"icon-rs-web-notification-medium icons-lg",disable:!1},{text:"Mobile push",iconLeft:"icon-rs-mobile-notification-medium icons-lg",disable:!1},{text:"Web/Mobile",iconLeft:"icon-rs-notification-large icons-lg",disable:!1}]),x(this,"ComSettingsTabComponents",[y.jsx(nm,{emailOnboard:!0,smtpData:this.state.smtpData,tabsData:this.state.tabsData,projectId:"1",accessToken:cm,accessId:{clientId:this.state.clientId,userId:this.state.userId},onSend:e=>{},onLoading:e=>{},initialEmailFooterData:this.state.initialEmailFooterShow,initialUnsubData:this.state.initialUnsubShow,data:[{id:1,message:"Hello"}]}),y.jsx(yr,{ref:e=>this.childComponent2=e,onBoadringScreenOpen:this.state.onBoadringScreenOpen,hideOnboard:this.state.hideWebOnboard,cb:(e,t)=>this.setState({appPermisionDetails:t,isAppPermission:e})}),y.jsx(Bf,{cb:(e,t)=>{this.setState({mobilePermissionDetails:t,isAppPermission:e})}}),y.jsx(Kf,{})]),x(this,"ComSettingsPermissionComponents",[y.jsx(tm,{appPermissionData:this.state.appPermisionDetails,cb:e=>this.setState({isAppPermission:e})}),y.jsx(Vs,{appPermissionData:this.state.mobilePermissionDetails,onboardingId:this.state.onboardingId,cb:e=>this.setState({isAppPermission:e})}),y.jsx(Vs,{appPermissionData:this.state.mobilePermissionDetails,onboardingId:this.state.onboardingId,cb:e=>this.setState({isAppPermission:e})})]),x(this,"LoadPermissionComponent",(()=>(oe("permission",this.state.index),y.jsxs(y.Fragment,{children:[0===this.state.index&&y.jsx(tm,{appPermissionData:this.state.appPermisionDetails,cb:e=>this.setState({isAppPermission:e})}),1===this.state.index&&y.jsx(Vs,{appPermissionData:this.state.mobilePermissionDetails,onboardingId:this.state.onboardingId,cb:e=>this.setState({isAppPermission:e})}),2===this.state.index&&y.jsx(Vs,{appPermissionData:this.state.mobilePermissionDetails,onboardingId:this.state.onboardingId,cb:e=>this.setState({isAppPermission:e})})]})))),x(this,"tabsComponent",(e=>y.jsxs("div",{className:"tabs-wrapper",children:[y.jsx("div",{className:"tabs-vertical no-border-radius",children:y.jsx(Ua,{mainClass:"stricky-window vertical-notification",defaultSelectedItem:this.state.index,defaultClass:"",dynamicTab:"vertical-tabs",activeClass:"active",tabData:this.tabs,callBack:(e,t)=>{const a=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:a},"",a),localStorage.setItem("cIndex",t),this.setState({index:t})}})}),y.jsx("div",{className:"tab-vertical-content",children:this.ComSettingsTabComponents[this.state.index]})]}))),x(this,"backBtnClick",(e=>{this.context.globalStateData.setIsLoadingData(!0),this.setState({index:-1});const t=`${window.location.origin}${window.location.pathname}`;window.history.pushState({path:t},"",t),setTimeout((()=>{this.context.globalStateData.setIsLoadingData(!1),this.setState({index:e})}),1e3)})),x(this,"handleRemoveQueryParam",(()=>{const e=new URL(window.location.href);e.searchParams.delete("isBenchMark"),window.history.replaceState(null,"",e.toString())}))}componentDidMount(){var e,t,a,s,r,i,n,l,o,c,d,u,h,f,m,p,v,g,b,x,y,S,w,T,D,C,E,N,A,I,j,_,L,F,M,R,P,U,B,G,V,W,H,z,Y,K,$,q,J,X,Z,Q,ee,te,ae,se,re,ie;const ne=localStorage.getItem("session"),le=JSON.parse(ne),ce=le?le.accessToken:"";this.setState({clientId:Ct(),userId:Tt(),accessToken:ce}),this.webComponentRef=k.createRef(),this.mobileComponent=k.createRef();let de=O.parse(null==(t=null==(e=this.props.history)?void 0:e.location)?void 0:t.search);"true"==(null==de?void 0:de.isFooter)?this.setState({initialEmailFooterShow:!0,isReady:!0}):this.setState({isReady:!0}),"true"===(null==de?void 0:de.isUnsubscription)&&this.setState({initialUnsubShow:!0}),"true"==(null==de?void 0:de.isBenchMark)&&this.setState({headerTabIndex:1});let ue=O.parse(window.location.search);if((null==ue?void 0:ue.wa)&&(null==ue?void 0:ue.webGuid)&&ue.isAppPermission){const e={onBoardingId:null==ue?void 0:ue.wa,webGuid:null==ue?void 0:ue.webGuid};this.setState({appPermisionDetails:e}),this.setState({isAppPermission:!0,index:0})}else if((null==ue?void 0:ue.ma)&&(null==ue?void 0:ue.details)&&ue.isAppPermission){const e=Ee(null==ue?void 0:ue.details);this.setState({mobilePermissionDetails:e}),this.setState({isAppPermission:!0,index:1})}else{if("web"===(null==(i=null==(r=null==(s=null==(a=this.props)?void 0:a.history)?void 0:s.location)?void 0:r.state)?void 0:i.type)&&(0===(null==(o=null==(l=null==(n=this.props)?void 0:n.location)?void 0:l.state)?void 0:o.selectIndex)&&this.setState({onBoadringScreenOpen:!0,index:null==(h=null==(u=null==(d=null==(c=this.props)?void 0:c.history)?void 0:d.location)?void 0:u.state)?void 0:h.selectIndex}),null==(v=null==(p=null==(m=null==(f=this.props)?void 0:f.history)?void 0:m.location)?void 0:p.state)?void 0:v.webPermission)){const e={onBoardingId:null==(y=null==(x=null==(b=null==(g=this.props)?void 0:g.history)?void 0:b.location)?void 0:x.state)?void 0:y.onBoardingId,webGuid:null==(D=null==(T=null==(w=null==(S=this.props)?void 0:S.history)?void 0:w.location)?void 0:T.state)?void 0:D.webGuid};this.setState({appPermisionDetails:e}),oe("Comunication Settings",null==(N=null==(E=null==(C=this.props)?void 0:C.history)?void 0:E.location)?void 0:N.state),this.setState({isAppPermission:!0,index:0})}if("mobile"===(null==(_=null==(j=null==(I=null==(A=this.props)?void 0:A.history)?void 0:I.location)?void 0:j.state)?void 0:_.type)){if(null==(R=null==(M=null==(F=null==(L=this.props)?void 0:L.history)?void 0:F.location)?void 0:M.state)?void 0:R.appPermission){const e={mpid:null==(G=null==(B=null==(U=null==(P=this.props)?void 0:P.history)?void 0:U.location)?void 0:B.state)?void 0:G.onBoardingId,appGuId:null==(z=null==(H=null==(W=null==(V=this.props)?void 0:V.history)?void 0:W.location)?void 0:H.state)?void 0:z.appGuId,appName:null==(q=null==($=null==(K=null==(Y=this.props)?void 0:Y.history)?void 0:K.location)?void 0:$.state)?void 0:q.appDetails.appName};this.setState({mobilePermissionDetails:e}),oe("Comunication Settings",null==(Z=null==(X=null==(J=this.props)?void 0:J.history)?void 0:X.location)?void 0:Z.state),this.setState({isAppPermission:!0,index:1})}(null==(ae=null==(te=null==(ee=null==(Q=this.props)?void 0:Q.history)?void 0:ee.location)?void 0:te.state)?void 0:ae.mobileOnBoarding)&&(oe("Comunication Settings",null==(ie=null==(re=null==(se=this.props)?void 0:se.history)?void 0:re.location)?void 0:ie.state),this.setState({index:1}))}}Be(this.context,(e=>{}))}render(){return y.jsx(y.Fragment,{children:this.state.isAppPermission?y.jsx(this.LoadPermissionComponent,{}):y.jsxs(Na,{children:[y.jsx(wa,{fluid:!0,className:"main-heading-wrapper mb0",children:y.jsxs(wa,{className:"mhw-container",children:[y.jsx("div",{className:"mhwc-left",children:y.jsx("h1",{children:y.jsx("div",{className:"mh-wrapper",children:y.jsx("span",{className:"mh-text",children:this.state.headerTag})})})}),y.jsxs("div",{className:"mhwc-right",children:[y.jsx("div",{className:"marginR20",children:y.jsx(os,{onSelect:()=>{this.setState({index:0})}})}),y.jsxs("div",{className:"back-text",onClick:()=>{var e;const t=O.parse(null==(e=window.location)?void 0:e.search);let a=void 0!==(null==t?void 0:t.wa)&&t.wa,s=void 0!==(null==t?void 0:t.ma)&&t.ma;a?this.backBtnClick(0):s?this.backBtnClick(1):this.props.history.push("/preferences")},children:[y.jsx(ke,{icon:Ae,size:"sm"}),"Back"]})]})]})}),0==this.state.headerTabIndex&&y.jsx(wa,{fluid:!0,className:"page-header pc-my-profile",children:y.jsx(wa,{children:y.jsx(this.tabsComponent,{})})}),1==this.state.headerTabIndex&&y.jsx(wa,{fluid:!0,className:"page-header pc-my-profile",children:y.jsx(wa,{children:y.jsx(im,{changeHeader:e=>{null!=e&&this.setState({headerTag:e})}})})})]})})}}x(dm,"contextType",le);const um=S(dm),hm=e=>{let t=I(),a=T();return y.jsx(j,{children:y.jsxs(_,{exact:!0,path:`${t.url}/`,children:[" ",y.jsx(dm,{history:a}),"  "]})})};export{hm as CommunicationSettings1,um as default};
