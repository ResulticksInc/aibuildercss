import{j as e}from"./pdf-editor-e8cb7a76.js";import{L as t}from"./LayoutPageWrapper-ab434993.js";import{z as a,CB as s,B as n,E as i,M as l,CC as o,CD as r,fm as d,Y as c,aB as m,aC as u,ad as p,cF as h,cG as f,cI as x,a0 as j,ar as v,aS as g,U as S,aK as b,b6 as C,CE as D,CF as I,aJ as k,CG as y,Cu as w,CH as N,Cs as F,dh as T,dI as O,CI as E,az as R,cH as $,CJ as L}from"./index-23a09c37.js";import{i as P,q as B}from"./utils-16c7e021.js";import{r as M,w as z,i as U}from"./react-vendor-379f659a.js";import"./constants-82903eb8.js";import{S as q}from"./SkeletonTable-88398a63.js";import{M as A,S as G,g as H,p as K}from"./kendo-5d73125a.js";import{R as V}from"./RSDropdowns-e011803c.js";import{RSConfirmAlert as Y}from"./RSConfirmAlert-1017f59d.js";import"./RSKendoDropdown-32d89038.js";import{R as J}from"./RSCheckbox-b4d531b7.js";import"./style-a86a43a5.js";import{R as W}from"./RSPDateRangePicker-1dfa4fb5.js";import{b as _}from"./inputLimit-ce03b0f6.js";import{RSPTimer as X}from"./RSPTimer-a0b464f0.js";import{R as Z,a as Q,C as ee,M as te}from"./ui-f7791cf3.js";import{R as ae}from"./RSIcon-d18be5d2.js";import{K as se}from"./index-566d2b59.js";import{R as ne}from"./RTabbar-3aea29fd.js";import{C as ie}from"./Common-4110ec41.js";import{R as le}from"./RSFormGroup-ffdfb1d7.js";import{F as oe}from"./FormLabel-83e0741f.js";import{C as re}from"./CompanyListDropdown-1708bbf4.js";import"./drag-drop-2020d552.js";import"./get-4aa85b1a.js";const de=t=>{var m,u;const p=M.useContext(a),[h,f]=P({otpData:["Email id","Mobile no"],formChips:t.dropData,formsDdown:[],otpSent:!1,otp:"",otpToken:"",errMsg:"",scheduleSwitch:!1,clickOn:!1,tickIcon:!1}),[x,j]=M.useState(!1),[v,g]=M.useState(null),[S,b]=M.useState(!1),[C,D]=M.useState(!1);M.useState(!1);const[I,k]=M.useState(!1),[y,w]=M.useState(""),[N,F]=M.useState(""),[T,O]=M.useState(""),[E,R]=M.useState(""),[$,L]=M.useState(!1),[B,z]=M.useState(null),[U,q]=M.useState(null);M.useState(!1),M.useState(null==t?void 0:t.dropData),M.useEffect((()=>{}),[]);const H=(e,t)=>{l({path:o,params:{MobileNumber:"",source:"CSV",email:"",SendTo:e,recipientFormID:t},loading:p.globalStateData.setIsLoadingData,sessionOut:p.globalStateData.setSessionOutData,ok:e=>{!0===e.status?(j(!0),b(!0),O(null==e?void 0:e.data),L(!0),g("One time password sent successfully"),setTimeout((()=>{g(null)}),2e3)):(j(!1),b(!1),g("One time password sent failed"),setTimeout((()=>{g(null)}),2e3))},fail:e=>{j(!1),b(!1),g("One time password sent failed"),setTimeout((()=>{g(null)}),2e3)}})};return e.jsxs("div",{children:[!t.otp&&e.jsxs(e.Fragment,{children:[e.jsxs(Z,{children:[e.jsx(Q,{md:4,children:e.jsx("label",{className:"label-row",children:"Form fields"})}),e.jsx(Q,{md:8,className:`${0===(null==(m=h.formsDdown)?void 0:m.length)&&"click-off"}`,children:e.jsx(V,{value:{formGenerationColumnsID:-1,columnName:"-- Select --"},textField:"columnName",dataItemKey:"formGenerationColumnsID",data:h.formsDdown,onChange:e=>{let a=h.formsDdown.filter((t=>t.formGenerationColumnsID!==e.target.value.formGenerationColumnsID));f((t=>(t.formsDdown=a,t.formChips=[...h.formChips,e.value],t))),q(e.target.value),t.onSelectItem([...h.formChips,e.value])}})})]}),e.jsxs(Z,{className:"mb20",children:[e.jsx(Q,{md:4}),e.jsx(Q,{md:8,children:e.jsx(A,{value:h.formChips,allowCustom:!0,textField:"columnName",dataItemKey:"formGenerationColumnsID",onChange:e=>{let a=[...h.formsDdown];h.formChips.map((t=>{0===e.value.filter((e=>e.formGenerationColumnsID===t.formGenerationColumnsID)).length&&a.push(t)})),f({formChips:e.value,formsDdown:a}),t.onSelectItem(e.value)}})})]}),e.jsxs(Z,{className:"mb30",children:[e.jsx(Q,{md:4,children:e.jsx("label",{className:"label-row",children:"Communication name"})}),e.jsx(Q,{md:8,className:(null==(u=null==t?void 0:t.dropData1)?void 0:u.length)?"":"click-off",children:e.jsx(V,{data:null==t?void 0:t.dropData1,defaultItem:"-- Select --",className:"mb0"})})]}),e.jsxs(Z,{className:"mb20",children:[e.jsx(Q,{md:4,children:e.jsx("label",{className:"label-row",children:"Date"})}),e.jsx(Q,{md:8,children:e.jsx("div",{className:"mt5",children:e.jsx(W,{class:"float-start",senable:!0})})})]}),e.jsxs(Z,{className:"mb20 click-off",children:[e.jsx(Q,{md:4,children:e.jsx("label",{className:"label-row",children:"Schedule download"})}),e.jsx(Q,{md:8,children:e.jsx("div",{className:"mt7",children:e.jsx(G,{checked:h.scheduleSwitch,onChange:e=>{}})})})]})]}),!0===t.otp&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-10",children:"One-Time Password (OTP) will be sent to the Key contactâ€™s Email/Mobile no. Enter the OTP to process your request."}),e.jsxs(Z,{children:[e.jsx(Q,{md:5,children:e.jsx("label",{className:"label-row lh18",children:"Send OTP to"})}),e.jsx(Q,{md:7,children:e.jsx(V,{data:h.otpData,defaultItem:"-- Source --",onChange:e=>{var a;k(!1);let s="Email id"===e.value?"2":"1";w(e.value),H(s,null==(a=null==t?void 0:t.recipId)?void 0:a.recipientFormID)}})})]}),""!==y&&e.jsxs(Z,{children:[e.jsx(Q,{md:5}),e.jsxs(Q,{md:7,children:["Email id"===y&&e.jsx("label",{children:(()=>{var e;let t=(null==(e=c())?void 0:e.emailId)||"";if(t.length){let e="",a=t.split("@");for(let s=0;s<a[0].length;s++){let a=s/2;e+=0===s?t.charAt(s):s<5?"*":a%1==0?t.charAt(s):"*"}return e=e+"@"+a[1],e}return""})()}),"Mobile No"===y&&e.jsx("label",{children:(()=>{var e;const t=(null==(e=c())?void 0:e.phoneNo)||"";if(t.length){let e="";for(let a=0;a<t.length;a++)a<2||a>=t.length-3?e+=t.charAt(a):e+="*";return e}return""})()})]})]}),e.jsxs(Z,{className:"mt16",children:[e.jsx(Q,{md:5,children:e.jsx("label",{className:"label-row lh17",children:"Enter OTP"})}),e.jsxs(Q,{md:7,children:[e.jsx(J,{required:!0,disabled:!0===$?"":"click-off",name:"otp",iconPlaceholder:!0,iconName:B?"icon-rs-circle-tick-medium icons-md green paddingL15":"",isLoading:C,placeholder:s,max:_,keyboardType:"number",val:N,errorMessage:E,cb:e=>{if(""===e||/^[0-9\b.]+$/.test(e)){let a=e.length>0?"":"Enter one time password";F(e),R(a),6===e.length&&(t=e,D(!0),l({path:d,params:{otpToken:T,otp:t},ok:e=>{!0===e.status?(D(!1),z(!0)):(D(!1),R("Enter valid one time password"),z(!1))},fail:e=>{D(!1)}}))}var t},ob:e=>{6===e.length?F(e):(R("Enter one time password"),z(!1))},onClickIcon:()=>{z(null),F(""),R("")}}),x&&!B?e.jsxs(e.Fragment,{children:[!0===x&&!0===S?e.jsxs("small",{className:"input-desc ml11 mt5",children:["One time password is valid for 5 minutes"," ",e.jsx(X,{onComplete:()=>{g("One time password Expired"),setTimeout((()=>{g(null)}),2e3),k(!0),b(!1)}})]}):!0===I?e.jsx("small",{className:"input-desc red ml12",children:"One time password expired"}):null,I?e.jsx("small",{className:"input-desc-right d-flex justify-content-end mr10",children:e.jsx("label",{className:"rs-link orange-medium",onClick:()=>{var e;k(!1),H("Email id"===y?"2":"1",null==(e=null==t?void 0:t.recipId)?void 0:e.recipientFormID)},children:"Resend?"})}):null]}):null]})]}),!1===I&&null!==v&&e.jsxs(Z,{children:[e.jsx(Q,{md:5}),e.jsx(Q,{md:7,children:e.jsx("label",{className:`rs-link ${!0===x?"green-medium":"red-medium"} fs15 mt20`,children:"One time password sent successfully"})})]}),e.jsxs("div",{className:"btn-container d-flex justify-content-end "+(!1===I&&null!==v?"mt10":"mt30"),children:[e.jsx(n,{onClick:()=>{t.cancelButton()},children:"Cancel"}),e.jsx(i,{className:B?"":"click-off",onClick:()=>{var e,a,s;if(""===E&&""!==N){let n=null==(e=null==t?void 0:t.dataSet)?void 0:e.map((e=>null==e?void 0:e.columnName)),i=null==n?void 0:n.join(", ").replace(/\s/g,"");s=null==(a=null==t?void 0:t.recipId)?void 0:a.recipientFormID,l({path:r,params:{Selectedcolumnlist:`${i},CreatedDate`,FormID:s,DateType:0,Isschedule:!1,FrequencyType:"D",campaignid:0,Frequencycondition:"-",ConditionWeeks:"",FilterDate:"All+time",OTP:N},loading:p.globalStateData.setIsLoadingData,sessionOut:p.globalStateData.setSessionOutData,ok:e=>{!0===e.status&&t.thanksPop(!0)},fail:e=>{}})}else R("Enter one time password")},children:"Confirm"})]})]})]})},ce=t=>{var s,n;const i=M.useContext(a),o=U(),[r,d]=M.useState(!1);M.useState(!1);const[c,m]=M.useState(!1),[p,h]=M.useState(!1);return M.useEffect((()=>{let e=!1,t=!1,a=!1;const s=u("Form generator");e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(t=!0),m(t),d(e),1==(null==s?void 0:s.accessUpdateData)&&(a=!0),h(a)}),[]),e.jsx("td",{children:e.jsxs(R,{className:"float-end",children:[e.jsx(v,{mainClass:`${"Brand owned form"===t.dataItem.formType?"click-on":""} ${p?"click-on":"click-off"}`,tooltip:"Edit",icon:"icon-rs-pencil-edit-medium",onClick:()=>{var e,a,s,n;"Brand owned form"!==t.dataItem.formType?o.push({pathname:"/preferences/form-generation",search:`?recipientFormID=${null==(a=null==t?void 0:t.dataItem)?void 0:a.recipientFormID}&formName=${null==(s=null==t?void 0:t.dataItem)?void 0:s.formName}&formType=${null==(n=null==t?void 0:t.dataItem)?void 0:n.formType}`}):o.push({pathname:"/preferences/brand-own-form",search:"cId="+(null==(e=null==t?void 0:t.dataItem)?void 0:e.recipientFormID)+"&isEdit=true"})}}),e.jsx(v,{mainClass:`${!0===b()&&"click-off"} ${"Brand owned form"===t.dataItem.formType?"click-off":""} ${p?"click-on":"click-off"}`,tooltip:"Duplicate",icon:"icon-rs-duplicate-medium",onClick:()=>{!1===x(t.length)?t.duplicate():t.duplicateGenerator(null==t?void 0:t.dataItem)}}),e.jsx(v,{mainClass:!0===b()?"click-off":t.dataItem.formDataCount>0?"":"click-off",tooltip:"Download CSV",icon:"icon-rs-csv-medium",onClick:()=>{var e;t.csvDownload(!0),t.dataItemValue(t.dataItem),e=t.dataItem.recipientFormID,l({path:L,params:{recipientFormID:e,type:"T"},loading:i.globalStateData.setIsLoadingData,sessionOut:i.globalStateData.setSessionOutData,ok:e=>{var a,s,n;if(!0===e.status){let i=null==(a=e.data)?void 0:a.getFormSelectedColumn,l=null==(n=null==(s=e.data)?void 0:s.getFormcampaignUsed)?void 0:n.map((e=>e.getFormcampaignUsed));t.formFieldData(i),t.formCampaignName(l)}},fail:e=>{}})}}),e.jsx(v,{mainClass:t.dataItem.formType.toLowerCase().includes("brand")?"click-off":"",tooltip:"Publish",icon:"icon-rs-share-publish-large",onClick:()=>{var e;const a={recipientFormID:(null==(e=null==t?void 0:t.dataItem)?void 0:e.recipientFormID)||""};l({path:$,params:a,loading:i.globalStateData.setIsLoadingData,sessionOut:i.globalStateData.setSessionOutData,ok:e=>{e.status&&t.publishForm(e.data)},fail:e=>{}})}}),e.jsx(v,{tooltip:"Embed",icon:"icon-rs-code-editor-medium "+("Survey Tell a friend Subscription".includes(t.dataItem.formType)?"":"click-off"),onClick:()=>{t.onClickEmbed(t.dataItem)}}),e.jsx(v,{tooltip:"Settings",icon:`${!0===b()&&"click-off"} icon-rs-settings-medium ${"Survey Tell a friend Subscription".includes(t.dataItem.formType)?"":"click-off"}`,onClick:()=>{t.onClickedSettings(t.dataItem)}}),e.jsx(v,{tooltip:"Delete",icon:`icon-rs-delete-medium  ${!0===b()&&"click-off"} ${c?"click-on":"click-off"} ${(null==(n=null==(s=null==t?void 0:t.dataItem)?void 0:s.getFormcampaignUsed)?void 0:n.length)>0?"click-off":"click-on"}`,onClick:()=>{t.deleteForm(t.dataItem.recipientFormID)}})]})})},me=(e,t)=>({result:K(t.slice(0),e),dataState:e}),ue=z((s=>{var o;const r=U(),d=M.useContext(a),[c,D]=M.useState([]);M.useState(!1);const[I,F]=M.useState(!1),[T,O]=M.useState(null),[E,R]=M.useState(null),[$,L]=M.useState(me({skip:0,take:5},[]).dataState),[B,z]=M.useState(null),[A,G]=M.useState(!1),[K,V]=M.useState(!1),[W,_]=M.useState(!1),[X,Z]=M.useState(!1),[Q,ne]=M.useState(!1),[ie,le]=M.useState([]),[oe,ue]=M.useState([]),[fe,xe]=M.useState(!1),[je,ve]=M.useState([]),[ge,Se]=M.useState(!1),[be,Ce]=M.useState(0),[De,Ie]=M.useState(0),[ke,ye]=M.useState(null),[we,Ne]=M.useState(!1),[Fe,Te]=M.useState(!1),[Oe,Ee]=P({isOpen:!1,formName:"",errMsg:null,recipientFormId:""}),Re=M.useContext(m);M.useState([]);const[$e,Le]=M.useState(!1),[Pe,Be]=M.useState(!1),[Me,ze]=M.useState(!1),[Ue,qe]=M.useState("null");M.useEffect((()=>{Ge(),Ae()}),[]);const Ae=()=>{let e=!1,t=!1,a=!1;const s=u("Form generator");1==(null==s?void 0:s.get_AddAccessData)&&(e=!0),null==s||s.accessUpdateData,t=!0,(null==s?void 0:s.accessDeleteData)&&(a=!0),Be(e),ze(a),Le(t)},Ge=()=>{const e={clientId:p(),tenentId:h()};l({path:f,params:e,sessionOut:d.globalStateData.setSessionOutData,ok:e=>{if(e.status)if(e.data.length){let t=me({take:5,skip:0},null==e?void 0:e.data);L(t.dataState),O(t.result),D(null==e?void 0:e.data),F(!1),Ve(e.data.length)}else D([]),F(!0),Ve(0);else D([]),F(!0),Ve(0)},fail:e=>{D([]),F(!0),Ve(0)}})},He=()=>{V(!1),xe(!1)},Ke=()=>{_(!1),xe(!1)},Ve=e=>{!1===x(e)&&j(localStorage.getItem("pconfig")).planId,Te(!0)};return e.jsxs(t,{children:[e.jsx(ee,{fluid:!0,className:"main-heading-wrapper mb0",children:e.jsxs(ee,{className:"mhw-container",children:[e.jsx("div",{className:"mhwc-left",children:e.jsx("h1",{children:e.jsx("div",{className:"mh-wrapper",children:e.jsx("span",{className:"mh-text",children:"Form builder"})})})}),e.jsxs("div",{className:"mhwc-right",children:[e.jsx("div",{className:"marginR20",children:e.jsx(re,{onSelect:()=>Ge()})}),e.jsxs("div",{onClick:()=>{r.push("/preferences")},className:"back-text",children:[e.jsx(v,{icon:g,size:"sm"}),"Back"]})]})]})}),e.jsx(ee,{className:"page-header",children:e.jsxs(e.Fragment,{children:[X?e.jsx(pe,{dataItem:ke,onClose:()=>Z(!1)}):null,Q&&e.jsx(he,{dataItem:ke,onClose:()=>ne(!1)}),!0===K&&ie.length>0?e.jsxs(te,{backdrop:"static",show:K,centered:!0,onHide:He,size:"lg",children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"Select form fields to download as CSV"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{He()}})]}),e.jsx(te.Body,{children:e.jsx("div",{children:e.jsx(de,{dropData:ie,dropData1:je,recipId:ke,onSelectItem:e=>{ue(e)}})})}),e.jsx(te.Footer,{children:e.jsx("div",{className:"mt15",children:e.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[e.jsx(n,{onClick:()=>{He()},children:"Cancel"}),e.jsx(i,{onClick:()=>{_(!0),He()},children:"Proceed"})]})})})]}):null,!0===W&&e.jsxs(te,{backdrop:"static",show:W,centered:!0,onHide:Ke,children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"CSV download"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{_(!1)}})]}),e.jsx(te.Body,{children:e.jsx("div",{children:e.jsx(de,{otp:!0,recipId:ke,dataSet:oe,cancelButton:()=>{Ke()},onSelectItem:e=>{},thanksPop:e=>{Ke(),xe(e)}})})}),e.jsx(te.Footer,{})]}),!0===fe&&e.jsxs(te,{backdrop:"static",show:fe,centered:!0,onHide:He,size:"md",children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"Confirmation"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{xe(!1)}})]}),e.jsx(te.Body,{children:e.jsx("div",{children:"Thank you for your request! We have received it and will send the download link to your registered email id shortly."})}),e.jsx(te.Footer,{children:e.jsx("div",{className:"mt15",children:e.jsx("div",{className:"btn-container d-flex justify-content-end",children:e.jsx(i,{onClick:()=>{Ke()},children:"Back to forms list"})})})})]}),!0===A&&e.jsx(Y,{size:"md",headerTitle:"Form builder",para:Ue,pClass:"text-center mb0",primaryButtonText:"OK",secondaryButtonText:"Cancel",buttonClicked:e=>{G(!1),!0===e&&(e=>{l({path:y,params:{recipientFormID:e},sessionOut:d.globalStateData.setSessionOutData,ok:e=>{if(e.status)if(e.data.length){let t=me({take:5,skip:0},null==e?void 0:e.data);L(t.dataState),O(t.result),D(null==e?void 0:e.data),F(!1),Ve(e.data.length)}else D([]),F(!0),Ve(0);else Ge()},fail:e=>{}})})(B)}}),4===De&&e.jsx(te,{show:!0,centered:!0,onHide:()=>Ie(0),children:e.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[e.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),e.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>Ie(0)})]})}),!0===ge&&5!=be&&e.jsx(Y,{size:"md",headerTitle:"Forms",para:1==be?"You've reached your form limit. Upgrade your package to create more forms.":2==be?"You've reached your form limit. Upgrade to Premier or Ultimate to create more forms.":3==be?"You've reached your form limit. Upgrade to Ultimate to create more forms.":null,primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:e=>{Se(!1),!0===e&&r.push("/subscription")}}),!0===ge&&5==be&&e.jsx(Y,{size:"md",headerTitle:"Forms",para:"You've reached your form limit. Contact support for assistance.",primaryButtonText:"Ok",buttonClicked:e=>{Se(!1)}}),e.jsxs("div",{className:(Pe?"click-on":"click-off")+" d-flex justify-content-between mt15 mb15",children:[e.jsx("div",{}),e.jsx(S,{className:"pl15",text:"Create form",position:"top",children:e.jsx("div",{className:"d-flex align-items-center",children:e.jsx(H,{className:"header-dropdown height33 "+(b()?"click-off":""),items:[{text:"SmartDX form"},{text:"Brand owned form"}],dir:"rtl",popupSettings:{animate:!0,popupClass:"ic-dropdown arrow-start"},text:e.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer icon-shadow-blue"}),icon:"icon-plus-fill-medium color-primary-blue cursor-pointer",onItemClick:e=>{if(!1===x(c.length))Se(!0),Ce(c.length);else if(e.item.text.toLowerCase().includes("smartdx"))r.push({pathname:"/preferences/form-generation"});else{let e=Math.floor(100*Math.random());r.push({pathname:"/preferences/brand-own-form",search:"cId="+e})}}})})})]}),e.jsxs(te,{show:Oe.isOpen,centered:!0,onHide:()=>Ie(0),children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"Form Name"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{Ee((e=>(e.isOpen=!e.isOpen,e.errMsg=null,e.formName="",e)))}})]}),e.jsx(te.Body,{children:e.jsx("div",{className:"position-relative",children:e.jsx(J,{required:!0,max:50,cls:"mb0",placeholder:"Form name",errorMessage:Oe.errMsg?Oe.errMsg:null,val:Oe.formName,cb:e=>{Ee((t=>(t.formName=e,t.errMsg=null,t)))},ob:e=>{e.length||Ee((e=>(e.errMsg="Enter form name",e)))}})})}),e.jsx(te.Footer,{children:e.jsx("div",{className:"mt15",children:e.jsx("div",{className:"btn-container d-flex justify-content-end "+(Oe.formName.length?"":"click-off"),children:e.jsx(i,{onClick:()=>{var e;Oe.formName.length?(e=Oe.formName,l({path:w,params:{formName:e},sessionOut:Re.apiStateData.setSessionOutData,loading:d.globalStateData.setIsLoadingData,ok:e=>{e.status?Ee((t=>(t.errMsg=(null==e?void 0:e.message)||"Form name already exists SRS",t))):(()=>{const e={recipientFormID:Oe.recipientFormId,formName:Oe.formName};l({path:N,params:e,loading:d.globalStateData.setIsLoadingData,sessionOut:d.globalStateData.setSessionOutData,ok:e=>{Ee((e=>(e.isOpen=!e.isOpen,e.errMsg=null,e.formName="",e))),Ge()},fail:e=>{Ee((e=>(e.isOpen=!e.isOpen,e.errMsg=null,e.formName="",e))),Ge()}})})()},fail:e=>{Ee((t=>(t.errMsg=JSON.stringify(e)||"Something went wrong SRS",t)))}})):Ee((e=>(e.errMsg="Enter form name",e)))},children:"Save"})})})})]}),E&&e.jsxs(te,{show:!0,centered:!0,size:"lg",children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"Publish form"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{R(null)}})]}),e.jsx(te.Body,{children:e.jsx("p",{children:E})}),e.jsxs("div",{className:"d-flex justify-content-end align-items-center",children:[we?e.jsx("div",{className:"mr10",children:"Copied"}):null,e.jsx(C,{onClick:()=>{navigator.clipboard.writeText(E),Ne(!0),setTimeout((()=>{Ne(!1)}),1e3)},variant:"outline-success",children:"Copy"}),e.jsx(i,{onClick:()=>{window.open(E,"_blank"),R(null)},variant:"outline-success",children:"Open link in new tab"})]})]}),c.length?e.jsx(e.Fragment,{children:e.jsx(se,{data:null==T?void 0:T.data,column:[{title:"Name",field:"formName"},{title:"Type",field:"formType"},{title:"Total records",field:"formDataCount",cell:t=>{var a;const s=(null==(a=null==t?void 0:t.dataItem)?void 0:a.formDataCount)||0;return e.jsx("td",{children:e.jsx("div",{className:"float-end",children:s})})}},{title:"Actions",field:"Actions",width:"280",cell:t=>e.jsx(ce,{refreshFormList:()=>Ge(),duplicateGenerator:e=>{Ee((t=>(t.isOpen=!t.isOpen,t.recipientFormId=e.recipientFormID,t)))},duplicate:()=>{let e=k();null===e||4!==(null==e?void 0:e.planId)?Se(!0):Ie(e.planId)},length:c.length,...t,deleteForm:e=>{var a,s;qe((null==(s=null==(a=null==t?void 0:t.dataItem)?void 0:a.getFormTemplateUsed)?void 0:s.length)>0?"This form is being used in a template. Are you sure you want to delete it?":"Are you sure want to delete?"),z(e),G(!0)},onClickEmbed:e=>{Z(!X),ye(e)},onClickedSettings:e=>{ne(!Q),ye(e)},csvDownload:e=>{V(e)},formFieldData:e=>{le(e),ue(e)},formCampaignName:e=>{ve(e)},dataItemValue:e=>{ye(e)},publishForm:e=>{R(e)}})}],settings:{total:null==(o=null==T?void 0:T.data)?void 0:o.length},pageable:!0,isDataStateRequired:!0})}):e.jsxs("div",{className:"box-design pb10 position-relative",children:[e.jsx(q,{count:5}),I?e.jsxs("div",{className:`nodata-bar add-func ${b()&&"click-off"}`,onClick:()=>{r.push({pathname:"/preferences/form-generation"})},children:[e.jsx("i",{className:`icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5 ${b()&&" click-off"}`}),e.jsx("p",{children:"Create"})]}):null]})]})})]})})),pe=({dataItem:t,onClose:a})=>{const s="Tell a friend",[n,i]=M.useState(null),[o,r]=M.useState(0),[d,m]=M.useState(t.formType),u=M.useCallback((()=>{const e={recipientFormID:t.recipientFormID};l({path:F,params:e,ok:e=>{var t;i(JSON.parse(null==(t=null==e?void 0:e.data)?void 0:t.jsondata))},fail:e=>{}})}));return M.useEffect((()=>{t.formType!==s&&u()}),[]),e.jsxs(te,{show:!0,centered:!0,className:"modal-top-fixed",size:"xl",children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:(null==t?void 0:t.formName)||"Form"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{a()}})]}),e.jsxs(te.Body,{children:[e.jsx(ne,{defaultSelectedItem:o,defaultClass:"",dynamicTab:"tabs-filled-component",activeClass:"active",tabData:d===s?[{id:"0001",text:"Generate"},{id:"0002",text:"Embed"}]:[{id:"0001",text:"Generate"},{id:"0002",text:"Embed"},{id:"0003",text:"API"}],callBack:(e,t)=>{r(t)}}),(a=>{var i;const l=c(),o=l.clientDetailsLocalization.tenantId+""+(window.location.hostname.includes("run.smartdx.co")||window.location.hostname.includes("app.smartdx.co")?"-P":"-U");B.parse(null==(i=null==history?void 0:history.location)?void 0:i.search);let r=window.location.hostname.includes("localhost")?"https://sit.smartdx.co":"https://"+window.location.hostname;switch(a){case 0:return t.formType===s?e.jsx(ie,{value:be(t.recipientFormID,o)}):e.jsx(ie,{value:fe(t.recipientFormID,o,r,!0)});case 1:return t.formType===s?e.jsx(ie,{value:be(t.recipientFormID,o)}):e.jsx(ie,{value:fe(t.recipientFormID,o,r)});case 2:return e.jsxs(e.Fragment,{children:[e.jsx(ie,{value:je(t.recipientFormID,l.clientDetailsLocalization.tenantId,n)}),e.jsx(ie,{value:ve(t.recipientFormID,l.clientDetailsLocalization.tenantId,n)}),e.jsx(ie,{value:ge(t.recipientFormID,l.clientDetailsLocalization.tenantId,n)})]})}})(o)]})]})},he=({dataItem:t,onClose:s})=>{const[o,r]=M.useState(null),[d,m]=M.useState(null==t?void 0:t.postBackURL),[u,p]=M.useState(null);M.useState(null==t?void 0:t.tafKey);const h=M.useContext(a),f=M.useCallback((()=>{const e={recipientFormID:t.recipientFormID};l({path:F,params:e,ok:e=>{var t;r(JSON.parse(null==(t=null==e?void 0:e.data)?void 0:t.jsondata))},fail:e=>{}})}));M.useEffect((()=>{f()}),[]);const x=(e,t,a)=>a?`${JSON.stringify(Se(e,t,a))}`:"",j=(e,t,a)=>{let s={formid:e,apikey:t};return`${JSON.stringify(s)}`},v=e=>{if(T(e)){if(!e.includes("https://"))return void p("Your site is not secure");if(!O(e))return void p("Enter valid end point");(e=>{let t=new AbortController,a=!1;fetch(e,{method:"GET",signal:t.signal}).then((e=>{e.status<=226?((void 0).setState({smartlinkWebLoading:!1}),!1===a&&(a=!0,!1==={status:!0,message:"Valid"}.status&&p("Enter valid end point"))):((void 0).setState({smartlinkWebLoading:!1}),!1===a&&(a=!0))})).catch((e=>{}))})(e)}else p("Enter valid end point")};return e.jsxs(te,{show:!0,centered:!0,className:"modal-top-fixed",size:"lg",children:[e.jsxs(te.Header,{children:[e.jsx("h2",{children:"Settings"}),e.jsx(ae,{mainClass:"close",size:"md",handleClose:()=>{s()}})]}),e.jsx(te.Body,{children:e.jsxs(le,{className:"mb0",children:[e.jsxs(Z,{className:"mb25",children:[e.jsx(Q,{md:3,children:e.jsx(oe,{label:"End point",right:!0})}),e.jsx(Q,{md:5,children:e.jsx(J,{required:!0,placeholder:"Enter end point",val:d,errorMessage:u,cb:e=>{let t=e.length>0?null:D;p(t),m(e.trim())},ob:e=>{(null==d?void 0:d.length)?(e=>{let t=e.trim();t.startsWith("https://")||(t="https://"+t),m(t),v(t)})(e):p(D)}})})]}),e.jsx(Z,{children:(()=>{var a;const s=c(),n=s.clientDetailsLocalization.tenantId+""+(window.location.hostname.includes("run.smartdx.co")||window.location.hostname.includes("app.smartdx.co")?"-P":"-U");switch(B.parse(null==(a=null==history?void 0:history.location)?void 0:a.search),window.location.hostname.includes("localhost")||window.location.hostname,t.formType){case"Survey":case"Subscription":return e.jsx(ie,{value:x(t.recipientFormID,s.clientDetailsLocalization.tenantId,o)});case"Tell a friend":return e.jsx(ie,{value:j(t.recipientFormID,n)})}})()}),e.jsx(Z,{children:e.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mb",children:[e.jsx(n,{onClick:()=>{s()},children:"Cancel"}),e.jsx(i,{onClick:()=>{0!==(null==d?void 0:d.length)?null===u&&((null==d?void 0:d.length)<=8?p(D):(()=>{const e={recipientFormID:t.recipientFormID,postBackURL:d};l({path:E,params:e,loading:h.globalStateData.setIsLoadingData,sessionOut:h.globalStateData.setSessionOutData,ok:e=>{(null==e?void 0:e.status)&&(t.postBackURL=d,s())},fail:e=>{}})})()):p(D)},children:"Save"})]})})]})})]})},fe=(e,t,a,s=!1)=>`\n  ${s?xe(e,t):`<div id='SmartDX_Form' APIKEY='${e}-${t}'></div>`}\n\n  <script type="text/javascript" \n  src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">\n  <\/script>\n  <script type="text/javascript" src=${a}/scripts/ui-bootstrap.js"}><\/script>\n  <script type="text/javascript" src="${a}/scripts/form.js"}><\/script>\n  `,xe=(e,t)=>`\n  <html>\n  <div id='SmartDX_Form' APIKEY='${e}-${t}'></div>\n  </html>\n  `,je=(e,t,a)=>a?`\n  // API Request\n\n  https://slg.smardx.co/Subscription/IndexInsertAPI?${I(Se(e,t,a))}`:"",ve=(e,t,a)=>a?`\n  // SDK Request\n\n  var apiRequestParam = ${JSON.stringify(Se(e,t,a))}\n\n  var responseData = ReWebSDK.formSubmitSDK(apiRequestParam)\n  `:"",ge=(e,t,a)=>a?`\n  // Form Custom UI for Push Notifications\n\n  \x3c!-- Include the Formutility.js script --\x3e\n  <script src="https://sdk.smartdx.co/common/scripts/Formutility.js" defer><\/script>\n  \n  \x3c!-- Frame your request data below --\x3e\n  <script>\n    var contactFormData = {\n      "Name": "Value",                    // Replace with actual user input\n      "MobileNo": "Value",                // Replace with actual user input\n      "EmailID": "Value",                 // Replace with actual user input\n      "formid": "${e}",\n      "apikey": "${t}"  // Ensure apikey is enclosed in quotes\n    };\n  \n    // Example function calls using provided methods from Formutility.js\n    onSubmit(contactFormData);   // Function to submit the form\n    onClose(contactFormData);    // Function to close the popup\n    onCancel(contactFormData);   // Function to cancel the popup\n  <\/script>\n  `:"",Se=(e,t,a)=>{let s={formid:e,apikey:t};return{...null==a?void 0:a.reduce(((e,t)=>{var a;let s=null==(a=null==t?void 0:t.fieldMapToNew)?void 0:a.attributeName;return t.fieldMapToNew&&!"defaultCaptcha defaultConsentcheckbox defaultSubmitButton".includes(s)&&(e[s]="Value"),e}),{}),...s}},be=(e,t)=>`\n        <div id="Classicdiv">\n\n            <input type="hidden" value="Subscription/TellFriendInsert/dbId=${t}/formid=${e}" id="hdnq">\n            <form method="Post" id="search-form" action="Subscription/TellFriendInsert/${t}/${e}">\n                <input class="sp-input" type="hidden" name="groupiconcount" id="groupiconcount" value="0">\n                <input class="sp-input" type="hidden" name="rid" id="rid" value="0">\n                <input class="sp-input" type="hidden" name="cid" id="cid" value="0">\n                <input class="sp-input" type="hidden" name="pagereferrerurl" id="hdnpagereferrerurl" value="https://run.resulticks.com/Recipients/FormList">\n                <input class="sp-input" type="hidden" name="shortcode" id="hdnshortcode">\n                <input class="sp-input" type="hidden" name="SourceURL" id="hdnSourceURL" value="https://run.resulticks.com/">\n                <div id="divformcreation">\n\n                </div>\n            </form>\n        </div>\n        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"><\/script>\n        <script src="https://apig.smartdx.co/Scripts/Form/TellFriendJS.js"><\/script>\n    `;export{ue as default,fe as generateEmbedHtml,je as getApiHtml,ve as postApiHtml,be as tellAFriendGenerateEmbed};
