import{j as e}from"./pdf-editor-8270ab34.js";import{r as s,u as t,i as a}from"./react-vendor-379f659a.js";import{z as c,M as r,DH as l,b6 as i,E as n,DI as d}from"./index-74701706.js";import{L as o}from"./LayoutPageWrapper-4f1f1143.js";import"./RSKendoDropdown-01650470.js";import{R as m}from"./RSCheckbox-2fef59cb.js";import"./style-a86a43a5.js";import"./RSDropdowns-57ad4a66.js";import{F as u}from"./FormLabel-e5a81960.js";import{K as p}from"./index-21f205f2.js";import{c as h}from"./inputLimit-ce03b0f6.js";import{RSConfirmAlert as x}from"./RSConfirmAlert-deac68bb.js";import{C as j,R as A,a as f}from"./ui-e848d714.js";import"./utils-16c7e021.js";import"./kendo-5d73125a.js";import"./drag-drop-a86b0275.js";import"./get-4aa85b1a.js";import"./RSIcon-70da13ba.js";const g=[{FeatureID:9,FeatureName:"Account settings"},{FeatureID:19,FeatureName:"Alerts notifications"},{FeatureID:4,FeatureName:"Analytics"},{FeatureID:2,FeatureName:"Audience"},{FeatureID:50,FeatureName:"Audience - Dynamic list"}],v=()=>{const[v,y]=s.useState(g.map((e=>({featureID:e.FeatureID,featureName:e.FeatureName,addAccess:!1,viewAccess:!1,updateAccess:!1,deleteAccess:!1})))),[N,I]=s.useState(null),[b,k]=s.useState(null),[w,D]=s.useState(null);s.useState(!1);const[S,C]=s.useState(null),[F,R]=s.useState(!1),[P,L]=s.useState(!1),[T,E]=s.useState(""),U=t(),z=a(),G=s.useContext(c);s.useEffect((()=>{const e=parseInt((s=U.search,new URLSearchParams(s)).get("id"),10);var s;isNaN(e)||(R(!0),D(e),M(e))}),[U]);const K=(e,s)=>{const t=[...v];t[e][s]=!t[e][s];const a=t.map((e=>({...e,addAccess:e.addAccess?1:0,viewAccess:e.viewAccess?1:0,updateAccess:e.updateAccess?1:0,deleteAccess:e.deleteAccess?1:0})));y(a)},M=e=>{try{r({path:l,loading:G.globalStateData.setIsLoadingData,params:{id:e},ok:e=>{if(!0===e.status){const s=e.data.permission.map((e=>({featureID:e.featureID,featureName:e.featureName||"Unknown",addAccess:1===e.addAccess,viewAccess:1===e.viewAccess,updateAccess:1===e.updateAccess,deleteAccess:1===e.deleteAccess})));y(s),I(e.data.securityGroupName||"")}else C(e.message),setTimeout((()=>{C(null)}),2e3)},fail:e=>{C("Failed to fetch permissions. Please try again later."),setTimeout((()=>{C(null)}),2e3)}})}catch(s){C("Error fetching permissions. Please try again later."),setTimeout((()=>{C(null)}),2e3)}};return e.jsxs(o,{children:[e.jsx(j,{fluid:!0,className:"main-heading-wrapper mb0",children:e.jsx(j,{className:"mhw-container",children:e.jsx("div",{className:"mhwc-left",children:e.jsx("h1",{children:e.jsx("div",{className:"mh-wrapper",children:e.jsx("span",{className:"mh-text",children:"Roles & Permission"})})})})})}),e.jsx(j,{className:"page-header box-bottom-space",children:e.jsxs("div",{children:[P&&e.jsx(x,{size:"md",para:T,pClass:"text-center mb0",primaryButtonText:"OK",buttonClicked:e=>{L(!1)}}),e.jsxs(A,{className:"d-flex align-items-center justify-content-center",children:[e.jsx(f,{className:"d-flex align-items-center justify-content-end",md:2,children:e.jsx(u,{label:"Role name"})}),e.jsx(f,{md:3,className:"pl30 pr0 list-name",children:e.jsx(m,{required:!0,label:"Role name",placeholder:0===(null==N?void 0:N.length)?"Enter role name":"Role name",errorMessage:b,val:N,max:h,cb:e=>{if(!e.includes("'")&&(""===e||/^[' 'A-Za-z0-9_-]*$/.test(e))){let s=e.replace(/\s+/g," ");I(s)}},ob:e=>{if(null!=b)return;let s=0===e.length?"Enter role name":null;k(s)}})})]}),null!=S&&e.jsxs("p",{style:{color:"red",marginTop:"5px"},children:[" ",S," "]})]})}),e.jsxs(j,{children:[e.jsx("div",{children:e.jsx(p,{config:{take:5,skip:0},pageable:!0,data:v,settings:{total:v.length},column:[{field:"featureName",filter:"text",title:"Access privileges",cell:s=>e.jsx("td",{children:s.dataItem.featureName})},{field:"addAccess",title:"Create",cell:s=>e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:s.dataItem.addAccess,onChange:()=>K(s.dataIndex,"addAccess")})})},{field:"viewAccess",title:"Read",cell:s=>e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:s.dataItem.viewAccess,onChange:()=>K(s.dataIndex,"viewAccess")})})},{field:"updateAccess",title:"Update",cell:s=>e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:s.dataItem.updateAccess,onChange:()=>K(s.dataIndex,"updateAccess")})})},{field:"deleteAccess",title:"Delete",cell:s=>e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:s.dataItem.deleteAccess,onChange:()=>K(s.dataIndex,"deleteAccess")})})}]})}),e.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[e.jsx(i,{onClick:()=>{z.push("/preferences/roles-permissions")},children:"Cancel"}),e.jsx(n,{onClick:()=>{(()=>{if(!N.trim())return void k("Enter role name");let e=N.trim();if(1==["admin","super user","user"].includes(null==e?void 0:e.toLowerCase()))return E("Please change the role name"),void L(!0);if(1==v.every((e=>!(e.addAccess||e.viewAccess||e.updateAccess||e.deleteAccess))))return E("Please select any one checkbox is mandatory"),void L(!0);const s=[...v].map((e=>({...e,addAccess:e.addAccess?1:0,viewAccess:e.viewAccess?1:0,updateAccess:e.updateAccess?1:0,deleteAccess:e.deleteAccess?1:0})));try{let e={securityGroupID:w||0,securityGroupName:N,permission:s};r({path:d,loading:G.globalStateData.setIsLoadingData,params:e,ok:e=>{!0===e.status?z.push("/preferences/roles-permissions"):(C(e.message),setTimeout((()=>{C(null)}),2e3))},fail:e=>{C("Please try again later."),setTimeout((()=>{C(null)}),2e3)}})}catch(t){C("Please try again later."),setTimeout((()=>{C(null)}),2e3)}})()},children:F?"Update":"Save"})]})]})]})};export{v as default};
