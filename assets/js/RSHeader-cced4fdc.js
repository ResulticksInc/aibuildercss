import{j as e}from"./pdf-editor-e8cb7a76.js";import{r as i,i as t,k as a,u as n}from"./react-vendor-379f659a.js";import{z as o,bX as s,Y as r,be as l,M as c,Bw as d,U as m,fH as u,ar as g,ev as p,av as h,Bx as f,By as b}from"./index-23a09c37.js";import{R as v}from"./RSBrandLogo-65b6c00a.js";import{h as j}from"./utils-16c7e021.js";import{RSConfirmAlert as x}from"./RSConfirmAlert-1017f59d.js";import"./constants-82903eb8.js";import{S as y}from"./SkeletonTable-88398a63.js";import{t as C}from"./index-cbd12d4f.js";import{l as S}from"./CompanyListConstants-7b0ff909.js";import"./ui-f7791cf3.js";import"./kendo-5d73125a.js";import"./drag-drop-2020d552.js";import"./RSIcon-d18be5d2.js";let w=0;const N=g=>{const b=i.useContext(o),[y,N]=i.useState(null),[D,I]=i.useState(!1),[L,A]=i.useState(null),[M,O]=i.useState(0),[B,E]=i.useState(!1),[F,T]=i.useState(0),[P,U]=i.useState(!1),q=t();a();let z=n();const K=s().slice(0,-1);var H=z.pathname.length>1?z.pathname.split("/"):[];H=H.filter(Boolean),window.addEventListener("myCustomEvent",(function(e){0===w&&(w+=1,V(),setTimeout((()=>{w=0}),2e3))})),H.includes("preferences")&&H.includes("companyuser-list")&&(H=H.map((e=>"companyuser-list"===e?"Company user list":e))),i.useEffect((()=>{const e=r();1==(null==e?void 0:e.isAgency)&&U(!0),0==(null==e?void 0:e.isAgency)&&T(null==e?void 0:e.licensingTypeId),V(),Y()}),[]);const Y=()=>{const e={userId:l()};c({path:p,params:e,ok:e=>{var i;h("profile image",e.data),N(null==(i=e.data)?void 0:i.profilePath)},fail:e=>{}})},$=e=>{var i=new Date(e),t=""+(i.getMonth()+1),a=""+i.getDate();return[i.getFullYear(),t,a].join("-")},V=()=>{let e={userId:l(),startDate:$(j(new Date).format("DD MMM yyyy")),endDate:$(j(new Date).format("DD MMM yyyy"))};c({path:f,params:e,ok:e=>{var i,t,a,n;if(e.status&&(null==(t=null==(i=e.data)?void 0:i.alertNotifications)?void 0:t.length)){let i=null==(n=null==(a=e.data)?void 0:a.alertNotifications)?void 0:n.sort(((e,i)=>e.notificationID>i.notificationID?1:-1)).reverse();A(i);let t=e.data.alertNotifications.filter((e=>"Unread"===e.status));O(t.length)}},fail:e=>{}})},W=()=>{switch(window.location.pathname){case"/subscription":default:return!0;case"/thanks":case"/payment":case"/features":case"/qasonboarding1":case"/preferences/addPushBuilder":return!1}},X=()=>{for(var e in localStorage.removeItem("isAuth"),localStorage.removeItem("session"),localStorage.removeItem("lsCampaignMaster"),localStorage.removeItem("lsUserData"),localStorage.removeItem("MobileApp"),localStorage.removeItem("pdetails"),localStorage.removeItem("projectId"),localStorage.removeItem("lsConfig"),localStorage.removeItem("btype"),localStorage.removeItem("ccreate"),localStorage.removeItem("companyvalue"),localStorage.removeItem("isAgency"),localStorage.removeItem("parentcompany"),localStorage)e.includes("camp_")&&localStorage.removeItem(e);b.toggleAuth(!1),window.sdxcache={},q.push("/")};window.addEventListener("logoutEvent",X);const _=()=>"/preferences/addPushBuilder"===window.location.pathname?(b.globalStateData.setFooter(!1),!1):!1!==b.globalStateData.getHeader&&(b.globalStateData.setFooter(!0),!0);return e.jsx(e.Fragment,{children:"/thanks"===window.location.pathname.toLowerCase()||"/qasonboarding1"===window.location.pathname.toLowerCase()||"///preferences/addpushbuilder"===window.location.pathname.toLowerCase()?null:e.jsxs("div",{className:"header-component",children:[_()&&e.jsxs("div",{className:"header-wrapper",children:[e.jsx("div",{className:"cursor-pointer",onClick:()=>{let e=r();if(null===(null==e?void 0:e.payStatus)||void 0===(null==e?void 0:e.payStatus)){let i=(null==e?void 0:e.licensingTypeId)||1;return d(i),void q.push("/features")}b.globalStateData.setBodyNameData(""),b.toggleAuth(!0),q.push("/")},children:e.jsx(v,{inner:!0})}),W()&&g.children,e.jsxs("div",{className:"header-nav-right position-relative",children:[e.jsx("span",{className:"tag-account",children:P?e.jsx("img",{src:C,alt:"Agency License"}):e.jsx("img",{src:S(F)})}),e.jsxs("ul",{className:"header-nav-right-list",children:[W()&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:e.jsx(m,{className:"tooltip-head-icon",text:"Notifications",position:"bottom",children:e.jsx("div",{className:"head-ico-wrap h-notify",children:e.jsx("i",{className:"icon-rs-list-bar-medium icons-md white cursor-pointer "+(D?"click-off":""),onClick:()=>{I(!D)},children:M>0&&e.jsx("span",{className:"label",children:`${M}`})})})})}),e.jsx("li",{children:e.jsx(m,{className:"tooltip-head-icon",text:"My profile",position:"bottom",children:e.jsx("div",{className:"head-ico-wrap",children:e.jsx("div",{className:"h-profile cursor-pointer",onClick:()=>{q.push("/preferences/my-profile")},children:e.jsx("img",{id:"pimage",src:y?K+y:"https://cdn.jsdelivr.net/gh/ResulticksInc/aibuildercss/assets/png/profile-pic-53dba3d1.png",alt:"profileImg",onError:e=>e.target.style.display="none"})})})})})]}),2==localStorage.getItem("projectId")?null:e.jsx("li",{children:e.jsx(m,{className:"tooltip-head-icon",text:"Logout",position:"bottom",children:e.jsx("div",{className:"head-ico-wrap",children:e.jsx("i",{onClick:()=>{E(!0)},className:"icon-rs-logout-medium icons-md white cursor-pointer"})})})})]})]})]}),!0===B&&e.jsx(x,{size:"md",para:"Are you sure you want to logout?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:e=>{E(!1),!0===e&&c({path:u,isCache:!1,loading:b.globalStateData.setIsLoadingData,ok:e=>{X()},fail:e=>{X()}})}}),D?e.jsx(k,{onChangeOpen:e=>{I(e)},notificationList:L,onReceiveReadCount:e=>O(e)}):null,_()&&e.jsx("div",{className:"breadcrumbs",children:e.jsx("div",{className:"container",children:e.jsxs("ul",{className:"breadcrumb",children:[H.length>0&&H.map(((i,t)=>{let a=i.replace(/-/g," "),n=e=>e.charAt(0).toUpperCase()+e.slice(1);return e.jsx("li",{className:t===H.length-1?"active":"",onClick:()=>{4===H.length?q.push("/"+H[1]+"/"+H[2]):3===H.length&&0!=t?q.push("/"+H[0]+"/"+H[1]):t<H.length-1&&q.push("/"+n(a))},children:""===a?"Dashboard":R[a.toLowerCase()]||("Features"===n(a)?"Subscription Plan":n(a))},t)})),0===H.length&&e.jsx("li",{className:"active",children:"Dashboard"})]})})})]})})},k=a=>{const[n,o]=i.useState(null),[s,r]=i.useState(!1),d=i.useRef(null),m=t();var u;u=d,i.useEffect((()=>{function e(e){u.current&&!u.current.contains(e.target)&&a.onChangeOpen(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[u]),i.useEffect((()=>{(null==a?void 0:a.notificationList)?o(null==a?void 0:a.notificationList):g()}),[]);const g=()=>{let e={userId:l()};c({path:f,params:e,ok:e=>{var i,t,n,s,l,c;if(e.status&&(null==(t=null==(i=e.data)?void 0:i.alertNotifications)?void 0:t.length)){let i=null==(s=null==(n=e.data)?void 0:n.alertNotifications)?void 0:s.sort(((e,i)=>e.notificationID>i.notificationID?1:-1)).reverse();o(i);let t=null==(c=null==(l=e.data)?void 0:l.alertNotifications)?void 0:c.filter((e=>"Unread"===e.status));a.onReceiveReadCount(t.length)}else r(!0)},fail:e=>{r(!0)}})},p=(e,i)=>{0===i.length&&a.onReceiveReadCount(0);const t={userId:l(),notificationId:e||0};c({path:b,isCache:!1,params:t,ok:t=>{if(0===i.length)a.onReceiveReadCount(0);else{n.map((i=>{i.notificationID===e&&(i.status="Read")}));let i=n.filter((e=>"Unread"===e.status));0===i.length?a.onReceiveReadCount(0):a.onReceiveReadCount(i.length)}},fail:e=>{}})};return e.jsxs("div",{ref:d,className:"header-notis",children:[e.jsx(D,{count:null==n?void 0:n.length,onChangeOpen:e=>{a.onChangeOpen(e)}}),n?e.jsxs("div",{children:[e.jsx("div",{className:"notis-list-scroll css-scrollbar",children:e.jsx("ul",{className:"header-notis-list",style:{height:n.length>4?283:70*n.length},children:null==n?void 0:n.map((i=>e.jsx(L,{item:i,onChangeOpen:e=>{p(i.notificationID,n),m.push({pathname:"/preferences/notification-details",state:{notificationList:n}}),a.onChangeOpen(e)}})))})}),e.jsx(I,{readAllStatus:()=>p(0,[]),onChangeOpen:e=>{a.onChangeOpen(e)},notificationList:n})]}):e.jsxs("div",{className:"mt15 mx10",children:[e.jsx(y,{count:4,isError:s,message:"Notification not found"})," "]})]})},D=i=>{let a=t();return e.jsxs("div",{className:"header-notis-head",children:[e.jsxs("p",{className:"mb0 color-primary-blue",children:["Notifications ",void 0!==i.count&&null!==i.count?"("+i.count+")":null]}),e.jsx(m,{text:"Settings",position:"bottom",children:e.jsx("i",{className:"icon-rs-settings-medium icons-md color-primary-blue cursor-pointer",onClick:()=>{a.push({pathname:"/preferences/alert-notification"}),i.onChangeOpen(!1)}})})]})},I=i=>{const a=t();return e.jsxs("div",{className:"header-notis-footer",children:[e.jsx("p",{className:"rs-button mr15 rs-button-tertiary cursor-pointer",onClick:()=>{i.readAllStatus(),i.onChangeOpen(!1)},children:"Mark all as read"}),e.jsx("p",{className:"rs-button rs-button-quaternary",onClick:()=>{a.push({pathname:"/preferences/notification-details",state:{notificationList:i.notificationList}}),i.onChangeOpen(!1)},children:"View more"})]})},L=i=>{var t,a,n;new Date(i.item.createdDate);let o=j.utc(i.item.createdDate).local().toString(),s=j(o).fromNow();s.match(/\d+/g),"an hour ago"===s?s="1 "+s.substr(3):"a day ago"===s&&(s="1 day ago");const r=null==(t=null==i?void 0:i.item)?void 0:t.createdDate,l=new Date(r),c=new Date-l,d=Math.floor(c/864e5),m=Math.floor(c%864e5/36e5),u=Math.floor(c%36e5/6e4);return 0===d&&0===m?s=u+" minutes ago":d>0?s=d+" days ago":m>0&&(s=m+" hours ago"),e.jsxs("li",{onClick:()=>{i.onChangeOpen(!1)},children:[e.jsx("div",{className:"notify-icon",children:e.jsx(g,{icon:(null==(a=A[i.item.notificationTypeID])?void 0:a.icon)||"icon-rs-alert-medium",size:"md",color:"white",mainClass:`box-view-icon bv-md ${(null==(n=A[i.item.notificationTypeID])?void 0:n.bg)||"bg-status-scheduled"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"",children:i.item.description}),e.jsx("small",{children:s})]})]})},A={1:{icon:"icon-rs-tick-medium",bg:"bg-primary-green"},2:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},3:{icon:"icon-rs-tick-medium",bg:"bg-primary-green"},4:{icon:"icon-rs-circle-time-medium",bg:"bg-primary-orange"},5:{icon:"icon-rs-circle-time-medium"},6:{icon:"icon-rs-tick-medium",bg:"bg-primary-green"},7:{icon:"icon-rs-tick-medium",bg:"bg-primary-green"},8:{icon:"icon-rs-tick-medium",bg:"bg-primary-green"},9:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},10:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},11:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},12:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},13:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},14:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},15:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},16:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},17:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},18:{icon:"icon-rs-circle-time-medium",bg:"bg-primary-orange"},19:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"},20:{icon:"icon-rs-circle-tick-medium",bg:"bg-primary-green"}},R={campaign:"Communication","creation smartlink":"Create smart link",alert:"Alerts",audience:"Audience-Dynamic lists",adduser:"Add a new user","web sdk":"Web SDK document",tabsdata:"Mobile SDK document","creation notification":"Create communication",assignrole:"Assign user role",slcompletion:"Sl completion","brand own form":"Brand owned form",subscription:"Subscription plan",preferences:"Preferences","form generator":"Form builder","form generation":"Form builder","communication settings":"Channel settings",analytics:"Communication analytics","alert notification":"Alerts",addpushbuilder:"Add push builder",pushbuilder:"Push builder"};export{N as RSHeader};
