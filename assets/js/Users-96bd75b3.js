var e=Object.defineProperty,t=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{j as s}from"./pdf-editor-8270ab34.js";import{w as a,r as i,R as l}from"./react-vendor-379f659a.js";import{p as n,q as r,o,e as d,f as c,S as u}from"./kendo-5d73125a.js";import{L as h}from"./LayoutPageWrapper-4f1f1143.js";import{S as p,b as m,a as j,A as v}from"./CompanyUserList-e2a58016.js";import{aB as x,Y as I,av as g,aC as f,M as S,ad as D,ap as y,eK as N,eJ as C,aK as b,ar as A,aJ as k,B as w,E as U,aS as L,eH as R}from"./index-74701706.js";import"./constants-82903eb8.js";import{S as F}from"./SkeletonTable-8cb486e7.js";import{R as T}from"./RSIcon-70da13ba.js";import{K as $}from"./index-21f205f2.js";import{S as B}from"./constantObject-ca27cf51.js";import{M as E,C as M}from"./ui-e848d714.js";import"./RSDropdowns-57ad4a66.js";import"./style-a86a43a5.js";import"./RSKendoDropdown-01650470.js";import"./get-4aa85b1a.js";import"./RSCheckbox-2fef59cb.js";import"./RSPhoneInput-a9f550fd.js";import"./inputLimit-ce03b0f6.js";import"./RSConfirmAlert-deac68bb.js";import"./utils-16c7e021.js";import"./drag-drop-a86b0275.js";import"./RSFormGroup-183a553e.js";import"./FormListWrapper-7a45a553.js";import"./FormLabel-e5a81960.js";import"./FormFieldIcon-f423e4de.js";import"./RSSwitch-89e88c7d.js";class P extends i.Component{constructor(){super(...arguments),t(this,"createDataState",((e,t)=>({result:n(t.slice(0),e),dataState:e}))),t(this,"state",{skip:0,take:10,currentIndex:0,checked:!0,jsonData:null,result:null,dataState:null,listError:!1,addButton:!1,isAddusers:!1,isSeconduser:!1,planId:0,userLoad:!0,companyDropdownSelectedItem:null,logIn_UserId:null,CompanyListData:[],isAgency:!1,issupportUser:!1,roleList:[],getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1}),t(this,"componentDidMount",(e=>{this.getRoleList(),this.getAccessData();let t=I(),s=localStorage.getItem("companyvalue");if(null!=s){let e=JSON.parse(s);this.setState({issupportUser:null==t?void 0:t.isSupportUser,companyDropdownSelectedItem:e})}null!=t&&(this.setState({isAgency:null==t?void 0:t.isAgency}),this.setState({logIn_UserId:null==t?void 0:t.userId}),null!=(null==t?void 0:t.clientLists)&&this.setState({CompanyListData:null==t?void 0:t.clientLists})),this.getUserList(),g("this.props.location",this.props.history.location)})),t(this,"getAccessData",(()=>{let e=!1,t=!1,s=!1;const a=f("Users");1==(null==a?void 0:a.get_AddAccessData)&&(e=!0),t=1==(null==a?void 0:a.accessUpdateData),(null==a?void 0:a.accessDeleteData)&&(s=!0),this.setState({getAddAccessData:e,getUpdateAccessData:t,getDeleteAccessData:s})})),t(this,"componentDidCatch",(e=>{})),t(this,"componentDidUpdate",(()=>{this.context.apiStateData.getIsReloadData&&(this.context.apiStateData.setIsReloadData(!1),this.getUserList())})),t(this,"getRoleList",(()=>{S({path:R,ok:e=>{var t;1==(null==e?void 0:e.status)&&(null==(t=null==e?void 0:e.data)?void 0:t.length)>0&&this.setState({roleList:null==e?void 0:e.data})},error:e=>{}})})),t(this,"getUserList",(()=>{let e=I(),t=D();null!=(null==e?void 0:e.parentClientId)&&null!=(null==e?void 0:e.parentClientId)&&0!=(null==e?void 0:e.parentClientId)&&(t=null==e?void 0:e.parentClientId);const s={clientId:t};this.setState({jsonData:[],userLoad:!0}),S({path:y,params:s,sessionOut:this.context.apiStateData.setSessionOutData,ok:e=>{if(this.setState({isAddusers:e.status,userLoad:!1}),e.status)if(e.data.length){var t=e.data;t.map((e=>{var t;null!==e.role&&""!==e.role&&void 0!==e.role||(e.role="User"),3e3===e.roleId&&(e.role="Need assign role"),4===e.userTypeID&&(e.role="Admin admin user");let s=null==(t=this.state.roleList)?void 0:t.find((t=>t.securityGroupId===e.roleId));return s&&(e.role=s.securityGroupName),e}));let s=this.createDataState({take:5,skip:0},t);this.setState({jsonData:t||[],result:s.result,dataState:s.dataState,listError:!0,addButton:!(t.length>4)})}else this.setState({jsonData:[],listError:!0,addButton:!1});else this.setState({jsonData:[],userLoad:!1,listError:!0,addButton:!1,isAddusers:!0})},fail:e=>{this.setState({jsonData:[],userLoad:!1,listError:!0})}})})),t(this,"handleChange",((e,t)=>{e.checked=t,this.forceUpdate()})),t(this,"changeUserStatus",((e,t)=>{S({path:N,params:{userId:e,status:t?"Active":"Inactive"},method:"POST",sessionOut:this.context.apiStateData.setSessionOutData,ok:e=>{const t=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)},fail:e=>{}})})),t(this,"StatusCellComponent",(e=>s.jsx(p,{...e,changeUserStatus:this.changeUserStatus,cb:(e,t)=>{this.props.history.push({pathname:"adduser",search:`userId=${t}&path=preferences`,state:{userId:t}})}}))),t(this,"updateIndex",(e=>{this.setState({currentIndex:e})})),t(this,"dataStateChange",(e=>{let t=this.createDataState(e.dataState,this.state.jsonData);this.setState({result:t.result,dataState:t.dataState})})),t(this,"NameComponent",(e=>{var t,a,i,l,n;const r=()=>{if(!0===b())return!1;let t=I();return!0===(null==t?void 0:t.isAgency)&&2===(null==t?void 0:t.userTypeId)||(!0===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?"4"===(null==t?void 0:t.roleId)||"6"===(null==t?void 0:t.roleId)||"2"===(null==t?void 0:t.roleId)||"5"===(null==t?void 0:t.roleId)||"7"!==(null==t?void 0:t.roleId)&&e.dataItem.userId===t.userId:!1===(null==t?void 0:t.isAgency)&&4===(null==t?void 0:t.userTypeId)||(!1===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?e.dataItem.userId===t.userId||"4"===(null==t?void 0:t.roleId)||"6"!==(null==t?void 0:t.roleId)&&"5"!==(null==t?void 0:t.roleId):(null==t?void 0:t.userId)===e.dataItem.userId))};return s.jsx("td",{className:"",children:s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs("span",{className:`marginB0  ${r()&&"text-underline-h cp"}`,onClick:()=>{var t;if(!1===r())return;let s=I();(null==(t=null==e?void 0:e.dataItem)?void 0:t.userId)!==(null==s?void 0:s.userId)?4!==e.dataItem.userTypeID&&this.props.history.push({pathname:"adduser",search:`userId=${e.dataItem.userId}&path=preferences`}):this.props.history.push({pathname:"/preferences/my-profile"})},children:[0===(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.firstName)?void 0:a.length)&&B,`${e.dataItem&&e.dataItem.firstName||""} ${e.dataItem&&e.dataItem.lastName||""} ${4===e.dataItem.userTypeID?(null==(l=null==(i=null==e?void 0:e.dataItem)?void 0:i.firstName)?void 0:l.length)>0?"(Admin)":"Account user":(()=>{let t=I();return e.dataItem.userId===t.userId?"(You)":""})()}`]}),(null==(n=null==e?void 0:e.dataItem)?void 0:n.isKeyPerson)?s.jsx("i",{className:"icon-rs-crown-fill-medium orange icons-md"}):null]})})})),t(this,"JobFunction",(e=>{var t,a,i,l;return s.jsx("td",{className:"",children:s.jsx("div",{className:"d-flex justify-content-between",children:s.jsx("span",{className:"marginB0",onClick:()=>{4!==e.dataItem.userTypeID&&this.props.history.push({pathname:"adduser",search:`userId=${e.dataItem.userId}&path=preferences`,state:{userId:e.dataItem.userId}})},children:`${4===e.dataItem.userTypeID?(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.jobFunctionName)?void 0:a.length)>0?null==(i=null==e?void 0:e.dataItem)?void 0:i.jobFunctionName:"Account manager":null==(l=null==e?void 0:e.dataItem)?void 0:l.jobFunctionName}`})})})})),t(this,"ColumnMenu",(e=>s.jsx("div",{children:s.jsx(m,{dropdownData:z,enable:!0,jusBool:!0,propsData:e,dataa:this.state.jsonData,onDataUpdate:e=>{this.setState({result:e.Data})},onClearDataUpdate:e=>{let t=this.createDataState(this.state.dataState,e.Data);this.setState({result:t.result.data})}})}))),t(this,"RenderComponent",(()=>{var e,t,a;switch(this.state.currentIndex){case 0:return s.jsxs(s.Fragment,{children:[void 0===this.props.isAccountSetting||null===this.props.isAccountSetting?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"d-flex justify-content-between mt15 mb15",children:[s.jsx("h4",{className:"mb0 add-title",children:"User details"}),s.jsx("div",{className:`d-flex align-items-center ${!0===this.state.userLoad?"click-off":"click-on"} ${!1===C(null==(e=this.state.jsonData)?void 0:e.length)?"click-on":"on"} ${!0===b()&&"click-off"}`,children:this.state.isAddusers?s.jsx("div",{className:this.state.issupportUser?"click-off":"",children:s.jsx(A,{tooltip:"Add user",size:"lg",shadow:!0,icon:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer "+(this.state.getAddAccessData?"click-on":"click-off"),onClick:()=>{if(this.state.isAgency)this.props.history.push({pathname:"adduser",search:"userId=0&path=preferences",state:{userId:0}});else if(!1===C(this.state.jsonData.length)){let e=k();if(null!==e&&4===(null==e?void 0:e.planId))return void this.setState({planId:e.planId});this.setState({isSeconduser:!0})}else this.props.history.push({pathname:"adduser",search:"userId=0&path=preferences",state:{userId:0}})}})}):null})]})}):null,(null==(t=this.state.jsonData)?void 0:t.length)>0?s.jsx(s.Fragment,{children:s.jsx($,{config:{take:5,skip:0},settings:{total:null==(a=this.state.jsonData)?void 0:a.length},data:this.state.jsonData,isDataStateRequired:!1,pageable:!0,column:[{title:"Name",...this.columnProps("firstName"),filter:"text",cell:this.NameComponent},{title:"Job function",...this.columnProps("jobFunctionName"),filter:"text",cell:this.JobFunction},{title:"Role",...this.columnProps("role"),filter:"text",cell:e=>{var t,a;return s.jsx("td",{children:4===(null==(t=null==e?void 0:e.dataItem)?void 0:t.userTypeID)?"Account admin user":(null==(a=null==e?void 0:e.dataItem)?void 0:a.role)||"User"})}},{title:"Actions",field:"status",width:"200",cell:this.StatusCellComponent}]})}):s.jsx("div",{className:"box-design pb10",children:s.jsx(F,{count:5,isError:this.state.listError,children:s.jsxs("div",{className:`nodata-bar add-func ${b()&&"click-off"}`,onClick:()=>{if(!1===C(this.state.jsonData.length)){let e=k();if(null!==e&&4===(null==e?void 0:e.planId))return void this.setState({planId:e.planId});this.setState({isSeconduser:!0})}else this.props.history.push({pathname:"adduser",search:"userId=0&path=preferences",state:{userId:0}})},children:[s.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5"}),s.jsx("p",{children:"Create"})]})})}),!0===this.state.isSeconduser&&s.jsxs(E,{show:this.state.isSeconduser,centered:!0,size:"md",children:[s.jsxs(E.Header,{children:[s.jsx("h2",{children:"Users"}),s.jsx(T,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isSeconduser:!1})}})]}),s.jsx(E.Body,{children:s.jsx("p",{children:"Users limit exceeded, please upgrade your plan."})}),s.jsxs("div",{className:"d-flex justify-content-end marginT30",children:[s.jsx(w,{onClick:()=>{this.setState({isSeconduser:!1})},children:"Cancel"}),s.jsx(U,{onClick:()=>{this.props.history.push("/subscription")},children:"Proceed"})]})]}),4===this.state.planId&&s.jsx(E,{show:!0,centered:!0,onHide:()=>this.setState({planId:0}),children:s.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[s.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),s.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>this.setState({planId:0})})]})})]});case 1:return s.jsx("div",{className:"portlet-box-theme",children:s.jsx(v,{cb:e=>this.updateIndex(e)})});case 2:return s.jsx("div",{className:"portlet-box-theme paddingT15 paddingB0",children:s.jsx(j,{cb:e=>{this.updateIndex(e),this.getUserList()}})});default:return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex justify-content-between mt15 mb15",children:[s.jsx("h4",{className:"mb0 add-title",children:"User details"}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer icon-shadow-blue",onClick:()=>{this.setState({currentIndex:1})}})})]}),s.jsxs(d,{data:this.state.jsonData.slice(this.state.skip,this.state.take+this.state.skip),total:this.state.jsonData.length,scrollable:"none",className:"grid-pagenation",pageable:{type:"input",pageSizes:[5,10,15],previousNext:!0},children:[s.jsx(c,{columnMenu:this.ColumnMenu,field:"name",title:"Name"}),s.jsx(c,{columnMenu:this.ColumnMenu,field:"jobFunctionName",title:"Job function"}),s.jsx(c,{columnMenu:this.ColumnMenu,field:"role",title:"Role"}),s.jsx(c,{cell:e=>s.jsx("td",{children:s.jsx("div",{children:s.jsx(u,{className:"mt0",onChange:t=>this.handleChange(e.dataItem,t.target.value),checked:e.dataItem.checked})})})})]})]})}}))}columnProps(e){return{field:e,columnMenu:this.ColumnMenu,headerClassName:this.isColumnActive(e,this.state.dataState)?"active":""}}isColumnActive(e,t){return r.active(e,t.filter)||o.active(e,t.sort)}render(){return s.jsxs(h,{children:[s.jsx(M,{fluid:!0,className:"main-heading-wrapper mb0",children:s.jsxs(M,{className:"mhw-container",children:[s.jsx("div",{className:"mhwc-left",children:s.jsx("h1",{children:s.jsx("div",{className:"mh-wrapper",children:s.jsx("span",{className:"mh-text",children:J[this.state.currentIndex]})})})}),s.jsx("div",{className:"mhwc-right",children:s.jsxs("div",{className:"back-text",onClick:()=>this.props.history.push("/preferences"),children:[s.jsx(A,{icon:L,size:"sm"}),"Back"]})})]})}),s.jsx(M,{className:"page-header",children:s.jsx(this.RenderComponent,{})})]})}}t(P,"contextType",x);const O=a(P),J=["Users","Add a new user","Assign role to users"];class q extends l.Component{render(){return s.jsxs("div",{children:[s.jsx(o,{...this.props}),s.jsx(r,{...this.props,expanded:!0})]})}}var z=[{name:"Starts with"},{name:"Is equal to"},{name:"Is not equal to"},{name:"Contains"},{name:"Does not contains"},{name:"Ends with"}];export{q as TextColumnMenu,O as default};
