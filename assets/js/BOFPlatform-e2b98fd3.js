var e,i,t,s,l,a,r,n,d,o=Object.defineProperty,c=(e,i,t)=>(((e,i,t)=>{i in e?o(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t})(e,"symbol"!=typeof i?i+"":i,t),t);import{j as m}from"./pdf-editor-8270ab34.js";import{w as h,r as p}from"./react-vendor-379f659a.js";import{z as v,aj as u,U as x,az as j,ar as y,aK as f,CW as g,B as k,E as b,qx as T,dj as N}from"./index-74701706.js";import{F as A}from"./FieldTracking-ab36cd8c.js";import{R as L}from"./RSIcon-70da13ba.js";import{v as C,s as F}from"./BOFController-f105b6f3.js";import{R as S}from"./RSFormGroup-183a553e.js";import{R as D}from"./RSKendoDropdown-01650470.js";import{R as E}from"./RSCheckbox-2fef59cb.js";import"./style-a86a43a5.js";import"./RSDropdowns-57ad4a66.js";import{F as w}from"./FormLabel-e5a81960.js";import{F as M}from"./FormFieldIcon-f423e4de.js";import{q as I}from"./utils-16c7e021.js";import{K as B}from"./index-21f205f2.js";import{R,M as K,a as z,A as q,c as G}from"./ui-e848d714.js";class P extends p.Component{constructor(){super(...arguments),c(this,"state",{platFormTypes:["Android phone","Android Tablet","iPhone","iPad"],isFieldTrack:!1,commonMsg:null,deviceList:(null==(i=null==(e=null==this?void 0:this.props)?void 0:e.fullData)?void 0:i.length)>0?null==(t=this.props)?void 0:t.fullData:[{deviceType:null,mobileApp:null,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}],rrElementArray:(null==(l=null==(s=null==this?void 0:this.props)?void 0:s.fullData)?void 0:l.length)>0?null==(n=null==(r=null==(a=this.props)?void 0:a.fullData[0])?void 0:r.fieldList)?void 0:n.elementArray:[],fieldTrackData:null,deviceType:null,mobileApp:null,mobileAppList:[],activationKey:0,showFormNameComponent:!1,formName:null==(d=this.props)?void 0:d.formName,errFormName:null,isEdit:!1}),c(this,"createDeviceList",(()=>({deviceType:null,mobileApp:this.state.mobileApp,error:{errDeviceType:null,errMobileApp:null},fieldList:[]}))),c(this,"createError",(()=>({errPlayStoreUrl:null,errLanguage:null,errWebUrl:null,errDeviceType:null}))),c(this,"getPlatformTypes",(()=>{let e=this.state.platFormTypes,i=[];return e.map((e=>{0===this.state.deviceList.filter((i=>e===i.deviceType)).length&&i.push(e)})),i})),c(this,"addBtnClick",(()=>{let e=C(this.state.deviceList);if(e.error){let i=[...this.state.deviceList];1===e.errType?i[e.errIndex].error.errDeviceType=e.errMsg:2===e.errType?i[e.errIndex].error.errMobileApp=e.errMsg:3===e.errType&&(this.setState({commonMsg:e.errMsg}),setTimeout((()=>{this.setState({commonMsg:null})}),2e3)),this.setState({deviceList:i})}else{let e=[...this.state.deviceList];e.push(this.createDeviceList()),this.accordinChanges(e.length-1),this.setState({deviceList:e})}})),c(this,"removeBtnClick",(e=>{let i=[...this.state.deviceList];i.splice(e,1),this.setState({deviceList:i})})),c(this,"valueChange",((e,i,t,s,l)=>{let a=[...this.state.deviceList];a[e][i]=t,a[e].error[s]=l,this.setState({deviceList:a})})),c(this,"accordinChanges",(e=>{this.state.activationKey===e?this.setState({activationKey:"-1"}):this.setState({activationKey:e})})),c(this,"AddFormEvents",(e=>{var i,t,s,l,a,r,n,d;const o=I.parse(null==(t=null==(i=this.props.history)?void 0:i.location)?void 0:t.search);let c=void 0!==o.isEdit&&o.isEdit;return m.jsxs(R,{children:[(null==e?void 0:e.head)?m.jsxs("div",{className:"align-items-center d-flex mb10 mt40",children:[m.jsx("i",{className:"icon-rs-events-mini icon-sm color-primary-blue padding-R5"}),m.jsx("h4",{className:"mb-0 padding-L5",style:{paddingLeft:5},children:"Form fields"}),"true"===c&&m.jsx(x,{text:"Edit",children:m.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md color-primary-blue cursor-pointer ml15",onClick:()=>{var e,i;null==(e=this.state.deviceList[0].mobileApp)||e.appName,null==(i=this.state.deviceList[0].mobileApp)||i.appGuid,this.state.deviceList[0].deviceType,this.setState({isEdit:!0,isFieldTrack:!0,fieldTrackData:this.state.deviceList})}})})]}):"",(null==e?void 0:e.head)?"":m.jsx(m.Fragment,{children:(null==(a=null==(l=null==(s=this.state.deviceList[(null==e?void 0:e.index)||0])?void 0:s.fieldList)?void 0:l.elementArray)?void 0:a.length)>0&&(null==(d=null==(n=null==(r=this.state.deviceList[(null==e?void 0:e.index)||0])?void 0:r.fieldList)?void 0:n.elementArray)?void 0:d.map(((e,i)=>m.jsxs("div",{className:"event-tracking-list",children:[m.jsxs("div",{className:"event-actions mr15",children:[!0===e.eventTracking.markAsGoal&&m.jsx("span",{children:m.jsx(x,{text:"marked as submit",children:m.jsx("i",{className:"icon-rs-goal-achieved-medium icons-md blue"})})}),m.jsx("span",{children:m.jsx(x,{text:"Mandatory",children:m.jsx("i",{className:!0===e.eventTracking.mandadory?"icon-rs-asterisk-mini red icons-sm mand-field cursor-pointer":"icon-rs-asterisk-mini icons-sm mand-field cursor-pointer",onClick:()=>{let e=[...this.state.elementArray];e[i].eventTracking.mandadory=!e[i].eventTracking.mandadory,this.setState({elementArray:e})}})})}),m.jsx("span",{children:m.jsx(x,{text:"Delete",children:m.jsx("i",{className:"icon-rs-delete-medium icons-md color-primary-blue cursor-pointer",onClick:()=>{let i=[...this.state.elementArray];const t=i.indexOf(e);t>-1&&i.splice(t,1);let s=[...this.state.controlsArray];s.map((i=>{i.viewId===e.field.viewId&&(i.select=!1,i.click=!1)}));let l=[...this.state.selectControls];l.map((i=>{i.viewId===e.field.viewId&&(i.select=!1,i.click=!1)})),this.setState({elementArray:i,selectControls:l,controlsArray:s})}})})})]}),m.jsxs("div",{className:"event-section",children:[m.jsxs("div",{className:"event-row",children:[m.jsx("span",{className:"label-field",children:"Friendly name:"}),m.jsx("span",{className:"label-value",children:e.eventTracking.friendlyName})]}),m.jsxs("div",{className:"event-row",children:[m.jsx("span",{className:"label-field",children:"Attribute name:"}),m.jsx("span",{className:"label-value",children:e.eventTracking.trackingType.displayName})]})]})]}))))})]})})),c(this,"FriendlyNameCell",(e=>{var i,t;let s=(null==(t=null==(i=null==e?void 0:e.dataItem)?void 0:i.eventTracking)?void 0:t.friendlyName)||"";return m.jsx("td",{children:s})})),c(this,"TrackingActionCell",(e=>{var i,t,s;let l=(null==(s=null==(t=null==(i=null==e?void 0:e.dataItem)?void 0:i.eventTracking)?void 0:t.trackingType)?void 0:s.displayName)||"";return m.jsx("td",{children:l})})),c(this,"ActionCell",(e=>{var i,t,s,l;let a=(null==(t=null==(i=null==e?void 0:e.dataItem)?void 0:i.eventTracking)?void 0:t.markAsGoal)||!1,r=(null==(l=null==(s=null==e?void 0:e.dataItem)?void 0:s.eventTracking)?void 0:l.mandadory)||!1;return m.jsx(m.Fragment,{children:m.jsx("td",{children:m.jsxs(j,{className:"float-end",children:[!0===a&&m.jsx(y,{tooltip:"mark as submit",icon:"icon-rs-goal-achieved-mini icons-sm blue",size:"sm",iconClass:"",mainClass:"",onClick:()=>{}}),m.jsx(y,{tooltip:"Mandatory",icon:!0===r?"icon-rs-asterisk-mini red icons-sm":"icon-rs-asterisk-mini icons-sm",size:"sm",iconClass:"",mainClass:"",onClick:()=>{}}),m.jsx(y,{tooltip:"Delete",icon:"icon-rs-delete-mini",size:"sm",iconClass:"",mainClass:"",onClick:()=>{var i;let t=[...this.state.deviceList],s=[...this.state.rrElementArray];const l=null==e?void 0:e.dataIndex;l>-1&&(null==(i=t[0].fieldList)||i.elementArray.splice(l,1),s.splice(l,1));let a={...this.state.deviceList};a.elementArray=t,this.setState({fieldTrackData:t,fieldData:a,deviceList:t,rrElementArray:s})}})]})})})})),c(this,"AddFormEvents1",(e=>{var i,t;const s=I.parse(null==(t=null==(i=this.props.history)?void 0:i.location)?void 0:t.search);return void 0!==s.isEdit&&s.isEdit,m.jsx(R,{children:(null==e?void 0:e.head)?"":m.jsx(m.Fragment,{children:m.jsx(B,{config:{take:5,skip:0},data:this.state.rrElementArray,settings:{total:this.state.rrElementArray.length},isDataStateRequired:!1,pageable:!1,column:[{field:"Friendly name",title:"Friendly name",cell:this.FriendlyNameCell},{field:"attributeName",title:"Attribute name",cell:this.TrackingActionCell},{field:"Action",title:"Action",cell:this.ActionCell}]})})})}))}componentDidMount(){let e=u();null!==e&&null!==e.mobileAppsList&&this.setState({mobileAppList:e.mobileAppsList})}render(){var e,i,t,s;return m.jsxs("div",{className:!0===f()?"click-off":"",children:[this.state.showFormNameComponent&&m.jsxs(K,{show:this.state.showFormNameComponent,centered:!0,size:"md",children:[m.jsxs(K.Header,{children:[m.jsx("h2",{children:"Brand owned form"}),m.jsx(L,{mainClass:"close",size:"md",handleClose:()=>{this.setState({showFormNameComponent:!1})}})]}),m.jsx(K.Body,{children:m.jsx(S,{children:m.jsxs(R,{children:[m.jsxs(z,{md:4,children:[m.jsx(w,{label:"Form name"})," "]}),m.jsx(z,{md:8,children:m.jsx(E,{required:!0,className:"required",placeholder:0===this.state.formName.length?"Enter form name":"Form name",val:this.state.formName,errorMessage:this.state.errFormName,handleOnchange:e=>{let i=0===e.length?g:null;this.setState({formName:e,errFormName:i})},handleOnBlur:e=>{let i=0===e.length?g:null;this.setState({formName:e,errFormName:i})}})})]})})}),m.jsxs("div",{className:"d-flex justify-content-end",children:[m.jsx(k,{onClick:()=>{this.setState({showFormNameComponent:!1})},children:"Cancel"}),m.jsx(b,{className:(null==(e=this.state.formName)?void 0:e.length)>0?"":"click-off",onClick:()=>{let e={formName:this.state.formName,controls:this.state.deviceList,deviceType:this.state.deviceList[0].deviceType,appName:this.state.deviceList[0].mobileApp,fullData:this.state.deviceList};F(e,this.context,"mobile",(e=>{(null==e?void 0:e.status)?this.props.history.push("form-generator"):this.setState({errFormName:null==e?void 0:e.message})}))},children:"Save"})]})]}),1==this.state.isFieldTrack&&null!==this.state.fieldTrackData?m.jsxs(K,{show:this.state.isFieldTrack,fullscreen:!0,className:"modal-top-fixed fluid-container-modal field-track-mobile-modal",children:[m.jsxs(K.Header,{children:[m.jsx("h2",{children:"Brand owned form"}),m.jsx(L,{mainClass:"close",size:"md",handleClose:()=>{const e=new CustomEvent("socketClosed",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(e),this.setState({isFieldTrack:!1,isEdit:!1})}})]}),m.jsx(K.Body,{children:m.jsx(A,{isWebFieldTrack:!1,isForm:!0,isEdit:this.state.isEdit,fullData:this.props.fullData,fieldTrackData:this.state.fieldTrackData,saveBtnClicked:e=>{let i=[...this.state.deviceList];i[0].fieldList=e,this.setState({deviceList:i,rrElementArray:e.elementArray}),this.setState({isFieldTrack:!1,fieldTrackData:null,isEdit:!1})},cancelBtnClicked:()=>{this.setState({isFieldTrack:!1,fieldTrackData:null,isEdit:!1})}})})]}):null,m.jsx("div",{className:"position-relative",children:m.jsxs("div",{className:"rs-accordin-container",children:[m.jsxs("div",{className:"posr",children:[this.state.deviceList.map(((e,i)=>{var t,s;return m.jsxs("div",{className:"",children:[m.jsx(q,{className:"rs-accordin mb0",activeKey:this.state.activationKey,children:m.jsxs(G,{children:[m.jsx(G.Header,{children:m.jsxs("div",{className:"rs-accordin-header",onClick:()=>{this.accordinChanges(i)},children:[m.jsxs("div",{className:"d-flex",children:[m.jsx("i",{class:`icon-md ${i!==this.state.activationKey?"icons-md icon-rs-square-plus-fill-medium color-primary-blue marginR8":"icons-md icon-rs-square-minus-fill-medium grey-medium marginR8"} marginR8`}),m.jsxs("h3",{children:[void 0!==(null==e?void 0:e.deviceType)&&""!==(null==e?void 0:e.deviceType)&&null!==e.deviceType?null==e?void 0:e.deviceType:"Device type",""]})]}),0!==i?m.jsx("i",{className:"icon-rs-circle-minus-fill-edge-medium icons-md red cursor-pointer",onClick:()=>{this.removeBtnClick(i)}}):null]})}),m.jsx(q.Collapse,{eventKey:i,children:m.jsx(G.Body,{children:m.jsx("div",{className:"rs-accordin-panel",children:m.jsxs(m.Fragment,{children:[m.jsx(S,{children:m.jsxs(R,{children:[m.jsx(z,{md:3,children:m.jsx(w,{label:"Device type"})}),m.jsx(z,{md:5,children:m.jsx(D,{required:!0,label:"Device type",data:this.getPlatformTypes(),errorMessage:e.error.errDeviceType,value:null===this.state.deviceList[i].deviceType?"-- Select device type --":this.state.deviceList[i].deviceType,onChange:e=>{let t=0===e.target.value.length?"Select device":null;this.valueChange(i,"deviceType",e.target.value,"errDeviceType",t)}})})]})}),""!==(null==(t=null==e?void 0:e.deviceType)?void 0:t.toLowerCase())&&"web"!==(null==(s=null==e?void 0:e.deviceType)?void 0:s.toLowerCase())&&m.jsx(S,{children:m.jsxs(R,{children:[m.jsx(z,{md:3,children:m.jsx(w,{label:"Mobile app"})}),m.jsx(z,{md:5,children:m.jsx(D,{required:!0,label:(this.state.deviceList[0].mobileApp,"Mobile app"),data:this.state.mobileAppList,errorMessage:e.error.errMobileApp,textField:"appName",dataItemKey:"appGuid",value:null===this.state.deviceList[0].mobileApp?{appName:"-- Select mobile app --",appGuid:0}:this.state.deviceList[0].mobileApp,onChange:e=>{this.setState({mobileApp:event.target.value});let t=[...this.state.deviceList];t[i].mobileApp=e.target.value,t[i].error.errMobileApp=null,this.setState({deviceList:[t[i]]})}})}),m.jsx(z,{md:1,children:m.jsx(M,{children:m.jsxs(j,{children:[this.state.rrElementArray.length>0&&m.jsx(y,{icon:T,iconColor:"blue",iconSize:"md",tooltip:"Edit",color:"blue",onClick:()=>{var e,t;let s=[...this.state.deviceList],l={appName:null==(e=s[i].mobileApp)?void 0:e.appName,appId:null==(t=s[i].mobileApp)?void 0:t.appGuid,deviceType:s[i].deviceType,mode:"add"};this.setState({isFieldTrack:!0,fieldTrackData:l,isEdit:!0})}}),m.jsx(y,{icon:N,iconColor:"blue",iconSize:"md",tooltip:"Field tracking",color:"blue",onClick:()=>{var e,t;let s=[...this.state.deviceList],l={appName:null==(e=s[i].mobileApp)?void 0:e.appName,appId:null==(t=s[i].mobileApp)?void 0:t.appGuid,deviceType:s[i].deviceType,mode:"add"};if(this.setState({fieldTrackData:l}),null!==this.state.deviceList[0].deviceType&&null!==this.state.deviceList[0].mobileApp)this.setState({isFieldTrack:!0});else{let e=null===this.state.deviceList[0].deviceType?"Select device":null,i=null===this.state.deviceList[0].mobileApp?"Select mobile app":null,t=[...this.state.deviceList];t[0].error.errDeviceType=e,t[0].error.errMobileApp=i,this.setState({deviceList:t})}}})]})})})]})})]})})})})]})}),this.state.rrElementArray.length>0&&m.jsx(R,{children:m.jsx(z,{md:12,children:m.jsx(this.AddFormEvents1,{index:0,head:!1})})})]})})),this.state.deviceList.length<5?m.jsx("div",{className:"pos-icon-2 d-none",children:m.jsx(x,{text:"Add",position:"top",children:m.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer icon-shadow "+(5===this.state.deviceList?"click-off":""),onClick:()=>{this.addBtnClick()}})})}):null]}),m.jsxs("div",{className:"btn-container d-flex justify-content-end marginT30",children:[m.jsx(k,{onClick:()=>{this.props.history.push("form-generator")},children:"Cancel"}),m.jsx(b,{className:(null==(s=null==(t=null==(i=this.state.deviceList[0])?void 0:i.fieldList)?void 0:t.elementArray)?void 0:s.length)>0?"":"click-off",onClick:()=>{this.setState({showFormNameComponent:!0})},children:"Save"})]})]})})]})}}c(P,"contextType",v);const O=h(P);export{O as B};
