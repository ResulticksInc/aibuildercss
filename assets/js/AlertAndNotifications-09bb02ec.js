var t=Object.defineProperty,a=(a,e,s)=>(((a,e,s)=>{e in a?t(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s})(a,"symbol"!=typeof e?e+"":e,s),s);import{j as e}from"./pdf-editor-8270ab34.js";import{w as s,r as i}from"./react-vendor-379f659a.js";import{c as r,o,a as n,b as l}from"./mobx-e1586d6a.js";import{L as c}from"./LayoutPageWrapper-4f1f1143.js";import{M as d,DE as m,DF as h,aB as p,ar as f,aS as u,aC as j,aK as x}from"./index-74701706.js";import{RSErrorPopup as g}from"./RSConfirmAlert-deac68bb.js";import"./constants-82903eb8.js";import{S}from"./SkeletonTable-8cb486e7.js";import{K as v}from"./index-21f205f2.js";import{C as N}from"./CompanyListDropdown-7d8b4e2c.js";import{C as D}from"./ui-e848d714.js";import{S as k}from"./kendo-5d73125a.js";import"./utils-16c7e021.js";import"./drag-drop-a86b0275.js";import"./RSIcon-70da13ba.js";import"./get-4aa85b1a.js";const A=new class{constructor(){a(this,"skip",0),a(this,"take",5),a(this,"resData",null),a(this,"listError",!1),a(this,"saveError",!1),a(this,"dataState",null),a(this,"handleChange",((t,a,e)=>{const s={alertNotificationId:t,isAlert:a};this.changeAlertsAndNotificationsStatus(s,e)})),a(this,"getAlertsAndNotificationsFromServer",(t=>{d({path:m,params:{},sessionOut:t,ok:t=>{var a,e,s,i;null==(e=null==(a=t.data)?void 0:a.alertNotifications)||e.sort(((t,a)=>t.alertNotificationId>a.alertNotificationId?1:-1)).reverse();let r=null==(i=null==(s=t.data)?void 0:s.alertNotifications)?void 0:i.sort(((t,a)=>t.isAlert?-1:1)).reverse();this.resData=r||null,this.listError=!1},fail:t=>{this.listError=!0}})})),a(this,"changeAlertsAndNotificationsStatus",((t,a)=>{d({path:h,params:t,loading:a.apiStateData.setIsLoadingData,ok:a=>{if(a.status){let a=[...A.resData];a.filter((a=>a.alertNotificationId===t.alertNotificationId))[0].isAlert=t.isAlert,this.resData=a}else this.saveError=!0},fail:t=>{}})})),a(this,"getClickOffStatus",(t=>"forms"===t.dataItem.alertNotification.toLowerCase()||"audience import and segmentation"===t.dataItem.alertNotification.toLowerCase()?"click-off":"click-on")),r(this,{skip:o,take:o,resData:o,listError:o,saveError:o,dataState:o,handleChange:n,getAlertsAndNotificationsFromServer:n})}};class C extends i.Component{constructor(){super(...arguments),a(this,"state",{CompanyListData:[]}),a(this,"componentDidMount",(()=>{this.initialLoad()})),a(this,"initialLoad",(()=>{A.getAlertsAndNotificationsFromServer(this.context.apiStateData.setSessionOutData)})),a(this,"componentDidUpdate",(()=>{this.context.apiStateData.getIsReloadData&&(this.context.apiStateData.setIsReloadData(!1),A.getAlertsAndNotificationsFromServer(this.context.apiStateData.setSessionOutData))})),a(this,"StatusCellComponent",(t=>e.jsx(I,{...t,changeUserStatus:(t,a)=>A.handleChange(t,a,this.context)}))),a(this,"MainGrid",l((()=>{const t={take:A.take,skip:A.skip};return A.resData?e.jsx(v,{config:t,data:A.resData,pageable:!0,isDataStateRequired:!1,settings:{total:A.resData.length},column:[{field:"Name",cell:t=>e.jsxs("td",{children:[" ",t.dataItem.alertNotification," "]}),width:"240"},{field:"Action",cell:this.StatusCellComponent,width:"240"}]}):e.jsx("div",{className:"box-design pb10",children:e.jsx(S,{count:5,isError:A.listError})})})))}render(){return e.jsxs(c,{children:[e.jsx(D,{fluid:!0,className:"main-heading-wrapper mb0",children:e.jsxs(D,{className:"mhw-container",children:[e.jsx("div",{className:"mhwc-left",children:e.jsx("h1",{children:e.jsx("div",{className:"mh-wrapper",children:e.jsx("span",{className:"mh-text",children:"Alerts"})})})}),e.jsxs("div",{className:"mhwc-right",children:[e.jsx("div",{className:"marginR20",children:e.jsx(N,{onSelect:()=>{this.initialLoad()}})}),e.jsxs("div",{className:"back-text",onClick:()=>this.props.history.push("/preferences"),children:[e.jsx(f,{icon:u,size:"sm"}),"Back"]})]})]})}),e.jsxs(D,{className:"page-header box-bottom-space",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"marginY15",children:"Manage your preferences for receiving the following alerts"}),e.jsx(this.MainGrid,{})]}),e.jsx("div",{children:A.saveError&&e.jsx(g,{headerTitle:"Sorry",para:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:t=>A.saveError=!1})})]})]})}}a(C,"contextType",p);const b=s(C),I=t=>{const[a,s]=i.useState(t.dataItem.isAlert);i.useState(!1),i.useState(!1);const[r,o]=i.useState(!1);return i.useEffect((()=>{s(t.dataItem.isAlert)})),i.useEffect((()=>{let t=!1;const a=j("Alerts & notifications");1==(null==a?void 0:a.accessUpdateData)&&(t=!0),o(t)}),[]),e.jsx("td",{className:`text-end  ${!0===x()?"click-off":"click-on"} ${r?"click-on":"click-off"}`,children:e.jsx(k,{className:"mt0",checked:a,onChange:a=>{s(a.value),t.dataItem.isAlert=a.value,t.changeUserStatus(t.dataItem.alertNotificationId,a.value)}})})};export{I as StatusCell,b as default};
