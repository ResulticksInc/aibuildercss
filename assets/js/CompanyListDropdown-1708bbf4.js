import{j as t}from"./pdf-editor-e8cb7a76.js";import{r as e,i as l}from"./react-vendor-379f659a.js";import{M as a,fw as o,z as n,Y as i,ft as s,a0 as d,eL as u,fu as c,fv as r,aa as g,ab as m,eu as v,ai as I,bo as S,bP as p}from"./index-23a09c37.js";import{RSConfirmAlert as f}from"./RSConfirmAlert-1017f59d.js";import{h as y,D as h}from"./ui-f7791cf3.js";const b=b=>{const{data:D,onSelect:N,defaultItem:w,className:j,fontSize:L,fieldKey:x,alignRight:k,image:C}=b,A=e.useContext(n),O=l(),[T,$]=e.useState(""),[_,J]=e.useState(null),[E,q]=e.useState("Select companylist"),[z,F]=e.useState([]);e.useState({pathName:"/",search:""});const[P,U]=e.useState(null),[B,R]=e.useState(!1),[W,G]=e.useState(null),[H,K]=e.useState(null);e.useState(0);const M=j||"",Y=L||"";function Q(t){const e=i();if(!1===(null==e?void 0:e.isAgency))return;let l={clientId:null==e?void 0:e.parentClientId,userId:null==e?void 0:e.userId,departmentId:0};a({path:s,params:l,ok:t=>{var e,l;if(t.status&&(null==(e=null==t?void 0:t.data)?void 0:e.length)>0){let e=i();if(null!=(null==e?void 0:e.clientId)){let t=null==(l=null==e?void 0:e.clientLists)?void 0:l.filter(((t,l)=>(null==t?void 0:t.clientId)==(null==e?void 0:e.clientId)));null==t||t.length}F(null==t?void 0:t.data)}},fail:t=>{}})}e.useEffect((()=>{var t,e;let l=i();if(!1===(null==l?void 0:l.isAgency))return;window.addEventListener("updateCompanyDetails",Q),Q(),U({clientId:null==l?void 0:l.clientId,clientName:null==l?void 0:l.clientName});let a=l;if(null!=a){if(J(null==a?void 0:a.userId),null!=(null==a?void 0:a.clientId)){let e=null==(t=null==a?void 0:a.clientLists)?void 0:t.filter(((t,e)=>(null==t?void 0:t.clientId)==(null==a?void 0:a.clientId)));null==e||e.length}if(null==(e=null==l?void 0:l.clientLists)||e.length,null!==localStorage.getItem("companyvalue")&&void 0!==localStorage.getItem("companyvalue")){let t=JSON.parse(localStorage.getItem("companyvalue"));X(t),$(null==t?void 0:t.clientName),q(null==t?void 0:t.clientName)}}}),[]);const V=(t,e)=>{R(!1),G(null),K(null);let l=i(),a={userId:null==l?void 0:l.userId,clientId:t};u.backgroundConnectServer({path:c,params:a,ok:t=>{t.status&&t.isOnboarded?e({status:!0}):(A.globalStateData.setIsLoadingData(!1),e({status:!1}))},fail:t=>{A.globalStateData.setIsLoadingData(!1),e({status:!1})}})},X=t=>{null!==localStorage.getItem("cli_"+(null==t?void 0:t.clientId))&&void 0!==localStorage.getItem("cli_"+(null==t?void 0:t.clientId))&&(null==t?void 0:t.clientId)==localStorage.getItem("cli_"+(null==t?void 0:t.clientId))||(A.globalStateData.setIsLoadingData(!0),V(null==t?void 0:t.clientId,(e=>{e.status?Z(t,(e=>{A.globalStateData.setIsLoadingData(!1),(null==e?void 0:e.status)&&localStorage.setItem("cli_"+(null==t?void 0:t.clientId),null==t?void 0:t.clientId)})):(A.globalStateData.setIsLoadingData(!1),R(!0),G(r),K(1))})))},Z=(t,e)=>{let l=i(),n={userId:(null==l?void 0:l.userId)||_,clientId:null==t?void 0:t.clientId};A.globalStateData.setIsLoadingData(!0),((t,e,l,n)=>{a({path:o,params:e,sessionOut:t.globalStateData.sessionOut,ok:t=>{l(t)},fail:t=>{n()}})})(A,n,(t=>{var l,a;if(null==t?void 0:t.status){if(localStorage.setItem("backlsUserData",localStorage.getItem("lsUserData")),t.data.isAgency=!0,localStorage.setItem("lsUserData",g(null==t?void 0:t.data)),t.data.accessToken&&t.data.accessToken.length>0){const o={isAuth:!0,accessToken:t.data.accessToken};localStorage.setItem("session",JSON.stringify(o));const n={sdc:!0,etc:!0,mp:!0,wp:!0,sl:!0,fs:!0,tmb:!0,ld:!0};if(localStorage.setItem("lsConfig",JSON.stringify(n)),m(t),null==(null==(l=t.data)?void 0:l.payStatus)){null==(a=t.data)||a.paymentTerms;let l=v(1);l.addons=[];let o=g(l);return localStorage.setItem("pconfig",o),A.toggleAuth(!0),A.globalStateData.setBodyNameData(""),R(!0),G("We observed that you have not completed your payment setup. Please complete your payment setup to continue."),K(2),void e({status:!1})}e({status:!0})}}else A.globalStateData.setIsLoadingData(!1)}),(t=>{A.globalStateData.setIsLoadingData(!1),e({status:!1})}))},tt=i();return t.jsx(t.Fragment,{children:!1===(null==tt?void 0:tt.isAgency)?t.jsx(t.Fragment,{}):t.jsxs(t.Fragment,{children:[B&&t.jsx(f,{size:"md",headerTitle:"Alert",para:W,primaryButtonText:"Setup",buttonClicked:t=>{if(R(!1),G(null),K(null),!0===t){if(1===H){if(null!==localStorage.getItem("qclogin")&&void 0!==localStorage.getItem("qclogin")){let t=i(),e=(null==t?void 0:t.userId)+"_"+(null==P?void 0:P.clientId),l=window.btoa(e),a=d(localStorage.getItem("qclogin")),o=window.btoa(null==a?void 0:a.passwd);A.toggleAuth(!1),O.push(`/qasonboarding?smartdxid=${l}&pwc=${o}&ST=G&package=0&risAgency=true`)}return}if(2===H)return void O.push("/features?isAgency=true")}else window.location.reload()}}),t.jsx(y,{varient:"",id:"dropdown-basic-buttons",className:`rs-dropdown ${M} ${Y||"test"} ${k?"align-right":""}${C?`dd-img-${C}`:""}`,title:E,children:t.jsx("div",{className:"css-scrollbar overflow-dropdown",children:z.map(((e,l)=>t.jsx("div",{children:"object"==typeof e?t.jsx(h.Item,{onClick:()=>{if(null!==localStorage.getItem("companyvalue")&&void 0!==localStorage.getItem("companyvalue")){let t=JSON.parse(localStorage.getItem("companyvalue"));if((null==t?void 0:t.clientId)===(null==e?void 0:e.clientId))return}A.globalStateData.setIsLoadingData(!0),V(null==e?void 0:e.clientId,(t=>{U(e),t.status?Z(e,(t=>{if(!1===(null==t?void 0:t.status))return A.globalStateData.setIsLoadingData(!1),R(!0),G("We observed that you have not completed your payment setup. Please complete your payment setup to continue."),void K(2);for(var l in $(null==e?void 0:e.clientName),localStorage)l.includes("cli_")&&localStorage.removeItem(l);localStorage.setItem("cli_"+(null==e?void 0:e.clientId),null==e?void 0:e.clientId),q(null==e?void 0:e.clientName);let a={clientId:null==e?void 0:e.clientId,clientName:null==e?void 0:e.clientName};localStorage.setItem("companyvalue",JSON.stringify(a)),I(A,(t=>{})),S(A,(t=>{p(A,(t=>{}))}));const o=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(o),N&&N(),setTimeout((()=>{A.globalStateData.setIsLoadingData(!1),window.location.reload();let t={clientId:null==e?void 0:e.clientId,clientName:null==e?void 0:e.clientName};localStorage.setItem("companyvalue",JSON.stringify(t))}),2e3)})):(R(!0),G(r),K(1))}))},children:null==e?void 0:e.clientName},l):t.jsx(h.Item,{onClick:()=>{$(e),N(e,l)},children:e},l)},l)))})})]})})};export{b as C};
