var t,e;e=function(t){function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}e(t=t?t._modules:{},"Extensions/DownloadURL.js",[t["Core/Globals.js"]],(function(t){var e=t.isSafari,a=t.win,o=a.document,n=a.URL||a.webkitURL||a,i=t.dataURLtoBlob=function(t){if((t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&a.Blob&&n.createObjectURL){var e=a.atob(t[3]),o=new a.ArrayBuffer(e.length);o=new a.Uint8Array(o);for(var i=0;i<o.length;++i)o[i]=e.charCodeAt(i);return t=new a.Blob([o],{type:t[1]}),n.createObjectURL(t)}};return t=t.downloadURL=function(t,n){var r=a.navigator,s=o.createElement("a");if("string"==typeof t||t instanceof String||!r.msSaveOrOpenBlob){if(t=""+t,r=/Edge\/\d+/.test(r.userAgent),(e&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||r||2e6<t.length)&&!(t=i(t)||""))throw Error("Failed to convert to blob");if(void 0!==s.download)s.href=t,s.download=n,o.body.appendChild(s),s.click(),o.body.removeChild(s);else try{if(null==a.open(t,"chart"))throw Error("Failed to open window")}catch(l){a.location.href=t}}else r.msSaveOrOpenBlob(t,n)},{dataURLtoBlob:i,downloadURL:t}})),e(t,"Extensions/ExportData.js",[t["Core/Axis/Axis.js"],t["Core/Chart/Chart.js"],t["Core/Renderer/HTML/AST.js"],t["Core/Globals.js"],t["Core/DefaultOptions.js"],t["Core/Utilities.js"],t["Extensions/DownloadURL.js"]],(function(t,e,a,o,n,i,r){function s(t,e){var a=c.navigator,o=-1<a.userAgent.indexOf("WebKit")&&0>a.userAgent.indexOf("Chrome"),n=c.URL||c.webkitURL||c;try{if(a.msSaveOrOpenBlob&&c.MSBlobBuilder){var i=new c.MSBlobBuilder;return i.append(t),i.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new c.Blob(["\ufeff"+t],{type:e}))}catch(r){}}var l=o.doc,p=o.seriesTypes,c=o.win;o=n.getOptions,n=n.setOptions;var h=i.addEvent,d=i.defined,u=i.extend,m=i.find,f=i.fireEvent,x=i.isNumber,g=i.pick,b=r.downloadURL;n({exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}),h(e,"render",(function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&!this.dataTableDiv&&this.viewData()})),e.prototype.setUpKeyToAxis=function(){p.arearange&&(p.arearange.prototype.keyToAxis={low:"y",high:"y"}),p.gantt&&(p.gantt.prototype.keyToAxis={start:"x",end:"x"})},e.prototype.getDataRows=function(e){var a,o=this.hasParallelCoordinates,n=this.time,i=this.options.exporting&&this.options.exporting.csv||{},r=this.xAxis,s={},l=[],p=[],c=[],h=this.options.lang.exportData,u=h.categoryHeader,b=h.categoryDatetimeHeader,v=function(a,o,n){if(i.columnHeaderFormatter){var r=i.columnHeaderFormatter(a,o,n);if(!1!==r)return r}return a?a instanceof t?a.options.title&&a.options.title.text||(a.dateTime?b:u):e?{columnTitle:1<n?o:a.name,topLevelColumnTitle:a.name}:a.name+(1<n?" ("+o+")":""):u},y=function(t,e,a){var o={},n={};return e.forEach((function(e){var i=(t.keyToAxis&&t.keyToAxis[e]||e)+"Axis";i=x(a)?t.chart[i][a]:t[i],o[e]=i&&i.categories||[],n[e]=i&&i.dateTime})),{categoryMap:o,dateTimeValueAxisMap:n}},w=[],D=0;for(T in this.setUpKeyToAxis(),this.series.forEach((function(t){var l,h=t.xAxis,d=t.options.keys||function(t,e){return t.data.filter((function(t){return void 0!==t.y&&t.name})).length&&e&&!e.categories&&!t.keyToAxis?t.pointArrayMap&&t.pointArrayMap.filter((function(t){return"x"===t})).length?(t.pointArrayMap.unshift("x"),t.pointArrayMap):["x","y"]:t.pointArrayMap||["y"]}(t,h),u=d.length,f=!t.requireSorting&&{},x=r.indexOf(h),b=y(t,d);if(!1!==t.options.includeInDataExport&&!t.options.isInternal&&!1!==t.visible){for(m(w,(function(t){return t[0]===x}))||w.push([x,D]),l=0;l<u;)a=v(t,d[l],d.length),c.push(a.columnTitle||a),e&&p.push(a.topLevelColumnTitle||a),l++;var T={chart:t.chart,autoIncrement:t.autoIncrement,options:t.options,pointArrayMap:t.pointArrayMap};t.options.data.forEach((function(e,a){o&&(b=y(t,d,a));var r={series:T};t.pointClass.prototype.applyOptions.apply(r,[e]),e=r.x;var p=t.data[a]&&t.data[a].name;for(l=0,(!h||"name"===t.exportKey||!o&&h&&h.hasNames&&p)&&(e=p),f&&(f[e]&&(e+="|"+a),f[e]=!0),s[e]||(s[e]=[],s[e].xValues=[]),s[e].x=r.x,s[e].name=p,s[e].xValues[x]=r.x;l<u;)p=r[a=d[l]],s[e][D+l]=g(b.categoryMap[a][p],b.dateTimeValueAxisMap[a]?n.dateFormat(i.dateFormat,p):null,p),l++})),D+=l}})),s)Object.hasOwnProperty.call(s,T)&&l.push(s[T]);var T=e?[p,c]:[c];for(D=w.length;D--;){var C=w[D][0],A=w[D][1],S=r[C];l.sort((function(t,e){return t.xValues[C]-e.xValues[C]})),h=v(S),T[0].splice(A,0,h),e&&T[1]&&T[1].splice(A,0,h),l.forEach((function(t){var e=t.name;S&&!d(e)&&(S.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),e=n.dateFormat(i.dateFormat,t.x)):e=S.categories?g(S.names[t.x],S.categories[t.x],t.x):t.x),t.splice(A,0,e)}))}return T=T.concat(l),f(this,"exportData",{dataRows:T}),T},e.prototype.getCSV=function(t){var e="",a=this.getDataRows(),o=this.options.exporting.csv,n=g(o.decimalPoint,","!==o.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),i=g(o.itemDelimiter,","===n?";":","),r=o.lineDelimiter;return a.forEach((function(t,o){for(var s,l=t.length;l--;)"string"==typeof(s=t[l])&&(s='"'+s+'"'),"number"==typeof s&&"."!==n&&(s=s.toString().replace(".",n)),t[l]=s;e+=t.join(i),o<a.length-1&&(e+=r)})),e},e.prototype.getTable=function(t){var e=function(t){if(!t.tagName||"#text"===t.tagName)return t.textContent||"";var a=t.attributes,o="<"+t.tagName;return a&&Object.keys(a).forEach((function(t){o+=" "+t+'="'+a[t]+'"'})),o+=">",o+=t.textContent||"",(t.children||[]).forEach((function(t){o+=e(t)})),o+="</"+t.tagName+">"};return t=this.getTableAST(t),e(t)},e.prototype.getTableAST=function(t){var e=0,a=[],o=this.options,n=t?1.1.toLocaleString()[1]:".",i=g(o.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(i);var r=i?t.shift():null,s=t.shift(),l=function(t,e,a,o){var i=g(o,"");return e="text"+(e?" "+e:""),"number"==typeof i?(i=i.toString(),","===n&&(i=i.replace(".",n)),e="number"):o||(e="empty"),{tagName:t,attributes:a=u({class:e},a),textContent:i}};!1!==o.exporting.tableCaption&&a.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:g(o.exporting.tableCaption,o.title.text?o.title.text:"Chart")});for(var p=0,c=t.length;p<c;++p)t[p].length>e&&(e=t[p].length);a.push(function(t,e,a){var n=[],r=0;a=a||e&&e.length;var s,p=0;if(s=i&&t&&e){t:if(s=t.length,e.length===s){for(;s--;)if(t[s]!==e[s]){s=!1;break t}s=!0}else s=!1;s=!s}if(s){for(s=[];r<a;++r){var c=t[r],h=t[r+1];c===h?++p:p?(s.push(l("th","highcharts-table-topheading",{scope:"col",colspan:p+1},c)),p=0):(c===e[r]?o.exporting.useRowspanHeaders?(h=2,delete e[r]):(h=1,e[r]=""):h=1,c=l("th","highcharts-table-topheading",{scope:"col"},c),1<h&&c.attributes&&(c.attributes.valign="top",c.attributes.rowspan=h),s.push(c))}n.push({tagName:"tr",children:s})}if(e){for(s=[],r=0,a=e.length;r<a;++r)void 0!==e[r]&&s.push(l("th",null,{scope:"col"},e[r]));n.push({tagName:"tr",children:s})}return{tagName:"thead",children:n}}(r,s,Math.max(e,s.length)));var h=[];return t.forEach((function(t){for(var a=[],o=0;o<e;o++)a.push(l(o?"td":"th",null,o?{}:{scope:"row"},t[o]));h.push({tagName:"tr",children:a})})),a.push({tagName:"tbody",children:h}),a={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:a}},f(this,"aftergetTableAST",a),a.tree},e.prototype.downloadCSV=function(){var t=this.getCSV(!0);b(s(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},e.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";b(s(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+c.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},e.prototype.viewData=function(){this.toggleDataTable(!0)},e.prototype.hideData=function(){this.toggleDataTable(!1)},e.prototype.toggleDataTable=function(t){(t=g(t,!this.isDataTableVisible))&&!this.dataTableDiv&&(this.dataTableDiv=l.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv&&(this.dataTableDiv.style.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=a.emptyHTML,new a([this.getTableAST()]).addToDOM(this.dataTableDiv),f(this,"afterViewData",this.dataTableDiv))),this.isDataTableVisible=t,t=this.exportDivElements;var e=this.options.exporting,o=e&&e.buttons&&e.buttons.contextButton.menuItems;e=this.options.lang,v&&v.menuItemDefinitions&&e&&e.viewData&&e.hideData&&o&&t&&(t=t[o.indexOf("viewData")])&&a.setElementHTML(t,this.isDataTableVisible?e.hideData:e.viewData)};var v=o().exporting;v&&(u(v.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),v.buttons&&v.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),p.map&&(p.map.prototype.exportKey="name"),p.mapbubble&&(p.mapbubble.prototype.exportKey="name"),p.treemap&&(p.treemap.prototype.exportKey="name")})),e(t,"masters/modules/export-data.src.js",[],(function(){}))},(t={exports:{}}).exports?(e.default=e,t.exports=e):e("undefined"!=typeof Highcharts?Highcharts:void 0);
