import{j as e}from"./pdf-editor-8270ab34.js";import{i as t,u as a,r as s,q as n,j as o}from"./react-vendor-379f659a.js";import{z as r,Y as i,et as c,aj as l,bo as m,eu as u,aa as p,bP as d}from"./index-74701706.js";import{q as g}from"./utils-16c7e021.js";import{L as f}from"./LayoutPageWrapper-4f1f1143.js";import"./ui-e848d714.js";import"./kendo-5d73125a.js";import"./drag-drop-a86b0275.js";const h=({isAuth:g,component:h,...b})=>{const j=t(),y=a(),k=s.useContext(r);s.useEffect((()=>{x(),v()}),[]),s.useEffect((()=>{S()}),[g]),s.useEffect((()=>{const e=j.listen(((e,t)=>{const a=e.pathname.includes("/preferences/addPushBuilder");if(["/preferences/form-generation","/campaign/creation-notification"].includes(e.pathname)||a||(sessionStorage.removeItem("pbcampdata"),sessionStorage.removeItem("tmldata"),sessionStorage.removeItem("pbstore")),e.pathname.includes("/audience")||e.pathname.includes("/campaign/planning")||(window.sdxDetails={campaignDetails:null}),e.pathname.includes("new-dynamic-list")||sessionStorage.removeItem("dl_live_top_screen"),["features","payment","thanks","login","subscription"].some((t=>e.pathname.includes(t))))return void k.globalStateData.setPaymentMessage("");const s=i();w(s)}));return()=>e()}),[k.globalStateData,j]);const x=s.useCallback((()=>{c((e=>{let t=e.status?u(e.data.licenseTypeId||1):u(1);t.addons=e.status&&e.data.addOns||[],localStorage.setItem("pconfig",p(t))}))}),[]),v=s.useCallback((()=>{const e=l(),t=Array.isArray(null==e?void 0:e.engagementList)&&e.engagementList.length>0,a=Array.isArray(null==e?void 0:e.conversionTypeList)&&e.conversionTypeList.length>0;t&&a||m(k,(()=>{d(k,(()=>{}))}))}),[k]),S=s.useCallback((()=>{window.DpMessengerOptions={showLauncherButton:!0,show:!0};const e=document.createElement("script");e.type="module",e.src="https://ca.resulticks.com/deskpro-messenger-init/web.js",e.setAttribute("data-deskpro-url","https://ca.resulticks.com/deskpro-messenger/5158749c-7245-4584-a877-261146784fbe"),e.setAttribute("data-messenger-id","01K17RN7RF3XJN1VVD2KWZH6SS"),e.async=!0,document.body.appendChild(e)}),[g]),w=s.useCallback((e=>{if(!e||!e.dueDate)return;if("/client-list"===y.pathname)return;const t=new Date(e.dueDate);new Date<=t?k.globalStateData.setPaymentMessage(""):k.globalStateData.setPaymentMessage("payment")}),[k.globalStateData,y.pathname]),D=s.useCallback((t=>{if(!g)return e.jsx(n,{to:{pathname:"/login",state:{from:t.location}}});const a=i();return!1===(null==a?void 0:a.isAgency)&&null===a.payStatus&&"/features"!==y.pathname?e.jsx(n,{to:{pathname:"/features"}}):e.jsx(s.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(h,{...t})})}),[h,g,y.pathname]);return e.jsx(o,{...b,render:D})},b=({isAuth:c,component:l,...m})=>{const u=t(),p=a();s.useContext(r),s.useEffect((()=>{}),[]),s.useEffect((()=>{const e=u.listen(((e,t)=>{"POP"===t&&u.goForward()}));return()=>e()}),[u]),s.useCallback((()=>{const e=document.getElementById("rscrisp");e&&(e.remove(),window.location.reload())}),[]);const d=s.useCallback((t=>{const a=g.parse(p.search);if("/qasonboarding"===p.pathname&&a.isAgency,c){const a=i();return(null==a?void 0:a.isAgency)?e.jsx(n,{to:{pathname:"/preferences",state:{from:t.location}}}):e.jsx(n,{to:{pathname:"/",state:{from:t.location}}})}return e.jsx(l,{...t})}),[l,c,p]);return e.jsx(o,{...m,render:d})};export{b as NonProtectedRoute,h as default};
