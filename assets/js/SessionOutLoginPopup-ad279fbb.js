import{j as e}from"./pdf-editor-5df4b936.js";import{r as a,i as s}from"./react-vendor-379f659a.js";import{z as t,a0 as o,a1 as l,a2 as i,a3 as n,a4 as r,a5 as d,a6 as c,a7 as m,a8 as g,a9 as u,aa as p,ab as h,E as S,ac as j,B as x,ad as f,M as w,ae as b,af as k,F as v,ag as D,ah as I}from"./index-7d59e1e4.js";import"./RSKendoDropdown-e93f1389.js";import{R as N,a as L}from"./RSCheckbox-31e7b177.js";import"./style-a86a43a5.js";import O from"./RSPLoader-0af8545b.js";import{M as y,a as E,b as C}from"./inputLimit-ce03b0f6.js";import{RSPTimer as T}from"./RSPTimer-af842117.js";import{RSErrorPopup as R}from"./RSConfirmAlert-56ae520e.js";import{R as M}from"./RSFormGroup-02fd3241.js";import"./RSDropdowns-d68fa550.js";import{S as A}from"./SmallText-624a260a.js";import{R as H,a as B,M as F}from"./ui-9ddcca8e.js";import{R as P}from"./RSIcon-9079b0f0.js";import"./utils-16c7e021.js";import"./kendo-5d73125a.js";import"./drag-drop-bc3ac7ea.js";import"./get-4aa85b1a.js";import"./charts-f2096496.js";const U=s=>{const S=a.useContext(t),[j,x]=a.useState(""),[k,v]=a.useState(""),[D,I]=a.useState(!1),[C,T]=a.useState(!1),[R,A]=a.useState(""),[H,B]=a.useState(!1),[F,P]=a.useState({email:null,passwd:null});return a.useEffect((()=>{let e=localStorage.getItem("login");if(null!==e){let a=o(e);x(a.email),v(a.passwd),I(a.checked)}}),[]),e.jsxs("div",{className:"form-login-cam mt10",children:[H?e.jsx(O,{className:"login-loader"}):null,e.jsxs("div",{children:[e.jsx(M,{children:e.jsx(N,{name:"email",disabled:j.length>0,placeholder:l,val:j,iconPlaceholder:!0,iconName:i,nocp:!0,errorMessage:F.email,max:y,handleOnBlur:e=>{n(e)?P({...F,email:null}):P({...F,email:r})},handleOnchange:e=>{let a=d(e);P({...F,email:null}),a.length<=100?x(a):P({...F,email:c})}})}),e.jsx(M,{className:"mb15",children:e.jsx(N,{viewEye:!0,name:"password",type:"password",placeholder:m,val:k,required:"false",errorMessage:F.passwd,max:E,cb:e=>{let a=g(e);d(e).length<=16?(v(a),u(a),P({...F,passwd:null}),P({...F,email:null})):P({...F,passwd:c})}})}),e.jsx("div",{className:"mb20",children:e.jsx(L,{className:"font-sm",checked:D,cb:e=>I(e),lbl:"Stay signed in"})}),e.jsx(q,{isHideLoader:s.isHideLoader,email:j,passwd:k,checked:D,setIsShowSpinner:e=>B(e),isOtpRequiredData:e=>{A(e),T(!0)},setLoginErrMsg:e=>{P({...F,...e})},setErrorMessage:e=>{P({...F,...e})},isLogin:e=>{if(e.data.accessToken&&e.data.accessToken.length>0){const a={isAuth:!0,accessToken:e.data.accessToken};localStorage.setItem("session",JSON.stringify(a)),localStorage.setItem("lsUserData",p(e.data)),localStorage.setItem("lsConfig",JSON.stringify($)),h(e),S.globalStateData.setLoggedInUserData(e.data),S.globalStateData.setEmailIdData(s.email),S.toggleAuth(!0),S.globalStateData.setSessionOutData(!1),window.location.reload(),(()=>{let e={clientId:f()};w({path:b,params:e,ok:e=>{},fail:e=>{}})})()}}}),e.jsx("p",{className:"text-orange font-xs text-center text-underline-none mb0",children:"Your session expired. Sign in to continue"})]}),C?e.jsx(J,{setIsShowSpinner:e=>B(e),close:()=>T(!1),mobData:R,isOtpShow:e=>T(e),email:j,passwd:k,isHideLoader:s.isHideLoader}):null]})},q=s=>{const{checked:o,email:l,passwd:i,setLoginErrMsg:d,setIsShowSpinner:c}=s,g=a.useContext(t);return e.jsx("div",{className:"text-center mb15",children:e.jsx(S,{className:"",onClick:()=>{if(0===s.email.length)return void s.setErrorMessage({email:r});if(!n(s.email))return void s.setErrorMessage({email:r});if(0===s.passwd.length)return void s.setErrorMessage({passwd:m});s.setErrorMessage({email:""});let e={email:l,passwd:i,checked:o};localStorage.setItem("qclogin",p(e)),o?z(l,i,o):localStorage.removeItem("login"),(()=>{let e=I();const a={emailId:l,password:i,sourceType:e};a.userAgent=navigator.userAgent,c(!0),w({path:k,params:a,loading:s.isHideLoader?null:g.globalStateData.setIsLoadingData,ok:e=>{c(!1),e.status&&e.message.toLowerCase().includes("otp")?s.isOtpRequiredData(e.data):e.status&&e.message.toLowerCase().includes("login")?s.isLogin(e):s.setLoginErrMsg({email:e.message})},fail:e=>{c(!1),g.toggleAuth(!1),d({email:"Unexpected error. Try again later"})}})})()},children:"Sign In"})})},z=(e,a,s)=>{let t={email:e,passwd:a,checked:s};localStorage.setItem("login",p(t))},J=o=>{const[l,i]=a.useState(""),[n,r]=a.useState(o.mobData),[d,c]=a.useState(null),[m,g]=a.useState(!1),[u,h]=a.useState(!0),[I,L]=a.useState(!1),[O,y]=a.useState(!1),[E,F]=a.useState(!1),P=a.useContext(t);s();return e.jsxs("div",{className:"forgot-password-modal",children:[e.jsx("h2",{className:"primary-color mb23",children:"Enter one time password"}),e.jsx(M,{children:e.jsx("p",{className:"mb0",children:j})}),e.jsxs(M,{children:[e.jsx(H,{children:e.jsx(B,{children:e.jsx(N,{name:"email",placeholder:"Enter your one time password",val:l,isLoading:E,iconPlaceholder:!0,iconName:`${m?"icon-rs-circle-tick-medium green icons-md":""} ${d?"icon-rs-circle-close-medium red cp icons-md":""}`,errorMessage:d,keyboardType:"number",max:C,cb:e=>{let a=e.length?null:"Enter valid one time password";var s;c(a),(""===e||/^[0-9\b.]+$/.test(e))&&(6===e.length&&(F(!0),v(s=e)||v(o.mobData)?c("Enter valid one time password"):w({path:D,params:{otpToken:n,Otp:s},loading:o.isHideLoader?null:P.globalStateData.setIsLoadingData,ok:e=>{if(o.setIsShowSpinner(!1),e.status){if(F(!1),w({path:b,params:{clientId:f()},ok:e=>{},fail:e=>{}}),(null==(s=(a=null==e?void 0:e.data).data)?void 0:s.dateFormat)&&(null==(t=a.data)?void 0:t.timeZoneName)||(null==(i=null==(l=a.data)?void 0:l.clientDetailsLocalization)?void 0:i.dateFormat)&&(null==(r=null==(n=a.data)?void 0:n.clientDetailsLocalization)||r.timeZoneName),g(e.status),o.isOtpShow(!1),e.data.accessToken&&e.data.accessToken.length>0){const a={isAuth:!0,accessToken:e.data.accessToken};localStorage.setItem("session",JSON.stringify(a)),localStorage.setItem("lsUserData",p(e.data)),localStorage.setItem("lsConfig",JSON.stringify($)),P.globalStateData.setLoggedInUserData(e.data),P.globalStateData.setEmailIdData(o.email),P.toggleAuth(!0),P.globalStateData.setSessionOutData(!1),window.location.reload()}}else F(!1),o.setIsShowSpinner(!1),c(null==e?void 0:e.message);var a,s,t,l,i,n,r},fail:e=>{F(!1),c(e.message),o.setEmailErr(e.message)}})),i(e))}})})}),e.jsxs(H,{children:[e.jsx(B,{md:8,children:m||I?null:e.jsxs(A,{className:"wsp",children:["One time password is valid for 5 minutes"," ",e.jsx(T,{onComplete:()=>{L(!0)}})]})}),e.jsx(B,{md:4,children:!m&&I?e.jsx(A,{right:!0,children:e.jsx("label",{className:"rs-link orange-medium",onClick:()=>{L(!1),i(""),c("One time password resent successfully"),setTimeout((()=>{c("")}),5e3),(()=>{h(!1);const e={emailId:o.email,password:o.passwd};w({path:k,params:e,ok:e=>{e.status?(r(e.data),h(!0)):y(!0)},fail:e=>{h(!0)}})})()},children:"Resend?"})}):null})]})]}),e.jsx("div",{children:!0===O&&e.jsx(R,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:e=>{y(!1)}})}),e.jsxs("div",{className:"mt30 d-flex justify-content-end",children:[e.jsx(x,{onClick:()=>{o.close()},children:"Cancel"}),e.jsx(S,{className:!1===m?"click-off":"click-on",onClick:()=>{P.toggleAuth(!0),P.globalStateData.setSessionOutData(!1),window.location.reload()},children:"Confirm"})]})]})},$={sdc:!0,etc:!0,mp:!0,wp:!0,sl:!0,fs:!0,tmb:!0,ld:!0},Z=s=>{const[t,o]=a.useState(!1);return a.useEffect((()=>{o(s.sessionOut)}),[s.sessionOut]),e.jsxs(F,{backdrop:"static",show:t,centered:!0,className:"logged-in-otp",onHide:s.handleSessionOut&&s.handleSessionOut,children:[e.jsxs(F.Header,{children:[e.jsx("h2",{children:"Login"}),e.jsx(P,{mainClass:"close",size:"md",handleClose:()=>{localStorage.removeItem("isAuth"),localStorage.removeItem("session"),window.location.reload(),o(!1),s.handleSessionOut&&s.handleSessionOut}})]}),e.jsx(F.Body,{children:e.jsx("div",{className:"d-flex align-items-center justify-content-between",children:e.jsx(U,{isShowForgotButton:!0,isHideLoader:!0})})})]})};export{Z as default};
