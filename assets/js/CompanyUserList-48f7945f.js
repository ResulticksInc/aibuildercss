var e=Object.defineProperty,t=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{j as s}from"./pdf-editor-5df4b936.js";import{r as a,i as l,R as i,w as n}from"./react-vendor-379f659a.js";import{D as r,o,q as d,p as c,e as u,f as h,S as m}from"./kendo-5d73125a.js";import{L as p}from"./LayoutPageWrapper-ce9c32da.js";import{B as v,E as f,z as g,Y as I,bK as x,a0 as j,M as S,ev as D,av as y,ar as N,aS as b,ew as w,ex as C,c4 as k,a2 as L,a3 as _,ey as A,a5 as U,ez as F,eA as T,F as M,eB as E,eC as P,a7 as R,a9 as B,eD as O,ad as q,aK as G,eE as $,eF as Y,eG as z,eH as K,ap as H,X as J,aA as V,az as W,U as X,eI as Z,aC as Q,aB as ee,eJ as te,aJ as se,eK as ae,eL as le,ae as ie,eu as ne,eM as re}from"./index-7d59e1e4.js";import{R as oe}from"./RSDropdowns-d68fa550.js";import{a as de,R as ce}from"./RSKendoDropdown-e93f1389.js";import{R as ue,a as he}from"./RSCheckbox-31e7b177.js";import{R as me}from"./RSPhoneInput-27c4c111.js";import{q as pe,r as ve,M as fe}from"./inputLimit-ce03b0f6.js";import{RSErrorPopup as ge}from"./RSConfirmAlert-56ae520e.js";import{R as Ie}from"./RSFormGroup-02fd3241.js";import{F as xe}from"./FormListWrapper-3b32fca3.js";import{h as je,q as Se}from"./utils-16c7e021.js";import{C as De,R as ye,a as Ne,M as be}from"./ui-9ddcca8e.js";import"./style-a86a43a5.js";import{F as we}from"./FormLabel-9e1cd976.js";import{F as Ce}from"./FormFieldIcon-9ca22afa.js";import"./constants-82903eb8.js";import{S as ke}from"./SkeletonTable-9a18ea3e.js";import{R as Le}from"./RSIcon-9079b0f0.js";import{K as _e}from"./index-b70e15a0.js";import{R as Ae}from"./RSSwitch-5e272b97.js";import{S as Ue}from"./constantObject-ca27cf51.js";const Fe=e=>{const[t,l]=a.useState(e.dropdownData),[i,n]=a.useState(""),[o,d]=a.useState();a.useState(e.dataa);const[c,u]=a.useState(!1);let h=e.propsData.column.filter;const m=()=>{let t=h,s={[t]:"startDate"===h?o:i};e.onDataUpdate(s)};return s.jsxs("div",{children:[s.jsx(oe,{data:(p=h,"startDate"===p?e.dropdownDataDate:"converted"===p||"clicked"===p?e.dropDataInt:e.dropdownData),textField:"name",defaultItem:{name:"-- Select --"},onChange:e=>{l(e.target.value)}}),"startDate"===h?null:s.jsx("input",{onChange:e=>{let t=e.target.value;(null==t?void 0:t.length)?u(!0):u(!1),n(e.target.value)},value:i,placeholder:"Filter",type:"text",className:"sp-input"}),"startDate"===h?s.jsx(r,{format:"MMM dd, yyyy",toggleButton:de,onChange:e=>{d(e.target.value),u(!0)},value:o,placeholder:"Select date",className:"required"}):null,s.jsxs("div",{className:"grid-filter-btn",children:[s.jsx(v,{onClick:()=>{e.jusBool?(()=>{let t={};t.Data=e.dataa,e.onClearDataUpdate(t)})():(n(""),m())},children:"Clear"}),s.jsx(f,{onClick:()=>{if(c)if(e.jusBool){if("starts with"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&e[h].toLowerCase().startsWith(t)));let a={};a.Data=s,e.onDataUpdate(a)})();if("contains"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&e[h].toLowerCase().includes(t)));let a={};a.Data=s,e.onDataUpdate(a)})();if("does not contains"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&!e[h].toLowerCase().includes(t)));let a={};a.Data=s,e.onDataUpdate(a)})();if("is equal to"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&e[h].toLowerCase()===t));let a={};a.Data=s,e.onDataUpdate(a)})();if("is not equal to"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&e[h].toLowerCase()!=t));let a={};a.Data=s,e.onDataUpdate(a)})();if("ends with"===t.name.toLowerCase())return(()=>{const t=i.toLowerCase(),s=e.dataa.filter((e=>"string"==typeof e[h]&&e[h].toLowerCase().endsWith(t)));let a={};a.Data=s,e.onDataUpdate(a)})();if("less than or equal to"===t.name.toLowerCase())return(()=>{let t=new Date(o);t.setDate(t.getDate()+parseInt(1));let s=t.toISOString(),a=je(s).utc().format("YYYY-MM-DD"),l=e.dataa.filter((t=>je(t[e.propsData.column.field]).utc().format("YYYY-MM-DD")<=a)),i={};i.Data=l,e.onDataUpdate(i)})();if("greater than or equal to"===t.name.toLowerCase())return(()=>{let t=new Date(o);t.setDate(t.getDate()+parseInt(1));let s=t.toISOString(),a=je(s).utc().format("YYYY-MM-DD"),l=e.dataa.filter((t=>je(t[e.propsData.column.field]).utc().format("YYYY-MM-DD")>=a)),i={};i.Data=l,e.onDataUpdate(i)})();if("less than"===t.name.toLowerCase())return(()=>{const t=parseInt(i);let s=e.dataa.filter((s=>parseInt(s[e.propsData.column.field])<t)),a={};a.Data=s,e.onDataUpdate(a)})();if("equal to"===t.name.toLowerCase())return(()=>{const t=parseInt(i);let s=e.dataa.filter((s=>parseInt(s[e.propsData.column.field])===t)),a={};a.Data=s,e.onDataUpdate(a)})();if("greater than"===t.name.toLowerCase())return(()=>{const t=parseInt(i);let s=e.dataa.filter((s=>parseInt(s[e.propsData.column.field])>t)),a={};a.Data=s,e.onDataUpdate(a)})()}else m(),(()=>{let s="starts with"===t.name.toLowerCase()?Te[0]:"is equal to"===t.name.toLowerCase()?Te[1]:"is not equal to"===t.name.toLowerCase()?Te[2]:"less than or equal to"===t.name.toLowerCase()?Te[3]:"greater than or equal to"===t.name.toLowerCase()?Te[4]:null;e.onConditionUpdate(s)})()},children:"Filter"})]})]});var p};let Te=[{id:1,name:"Starts with"},{id:2,name:"Is equal to"},{id:3,me:"Is not equal to"},{id:4,me:"Less than or equal to"},{id:5,me:"Greater than or equal to"}];const Me=e=>{const t=a.useContext(g),i=l(),[n,r]=a.useState(null),[o,d]=a.useState(""),[c,u]=a.useState(""),[h,m]=a.useState(""),[K,H]=a.useState(""),[J,V]=a.useState(65),[W,X]=a.useState("us"),[Z,Q]=a.useState(""),[ee,te]=a.useState("password"),[se,ae]=a.useState(0),[le,ie]=a.useState(""),[ne,re]=a.useState({jobfunctionId:0,jobfunctionName:"-- Select Job function --"}),[oe,de]=a.useState([]),[je,be]=a.useState(""),[we,Ce]=a.useState(!1),[ke,Le]=a.useState(!1),[_e,Ae]=a.useState(""),[Ue,Fe]=a.useState(""),[Te,Me]=a.useState(""),[Ee,Pe]=a.useState(""),[Re,Be]=a.useState(""),[Oe,qe]=a.useState(""),[Ge,$e]=a.useState(!1);a.useState(""),a.useState(""),a.useState(""),a.useState(!1),a.useState(!1),a.useState(!1);const[Ye,ze]=a.useState(!1),[Ke,He]=a.useState(null),[Je,Ve]=a.useState(!1),[We,Xe]=a.useState(!1);a.useEffect((()=>{var e,t;let s=I();Xe(null==s?void 0:s.isSupportUser);let a=Se.parse(window.location.search);"true"==(null==a?void 0:a.add)?Ve(!1):Object.keys(a).length>0&&0!=(null==a?void 0:a.clientId)&&null!=(null==a?void 0:a.clientId)&&Ve(!0),a&&Object.keys(a).length>0&&(null==a?void 0:a.userId)>0&&Ve(!0),null==(t=null==(e=null==i?void 0:i.location)?void 0:e.state)||t.userId;const l=x();null!==l&&(l.jobFunction.sort(((e,t)=>e.jobfunctionName>t.jobfunctionName?1:-1)),de(l.jobFunction)),void 0!==(null==a?void 0:a.userId)&&0!=(null==a?void 0:a.userId)&&Qe(null==a?void 0:a.userId);let n=Ze();if(null!==n){let e=null==n?void 0:n.country_calling_code;V(e)}}),[t.globalStateData.getIsReloadData]);const Ze=()=>{let e=null;return null!==localStorage.getItem("bdetails")&&(e=j(localStorage.getItem("bdetails"))),e},Qe=e=>{S({path:D,params:{userId:e},loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{e.status?et(e.data):($e(!0),He((null==e?void 0:e.message)||"Please try again"))},fail:e=>{y("My profile response error",e.message)}})},et=e=>{const t=x();Q("Itkt@1234"),null!==t&&de(t.jobFunction),H(e.phoneNo||""),V(e.countryCodeMobile||65),X(e.countryCode||"us"),d(e.email||""),r(!1),be((null==e?void 0:e.welcomeText)||""),u(e.firstName||""),m(e.lastName||""),Ce(e.enforceOtp||!1),ie(e.roleID||"");let s=t.jobFunction.filter((t=>t.jobfunctionId===e.jobFunctionId));s.length>0&&re(s[0])},tt=()=>{let e=Se.parse(window.location.search),t=(null==e?void 0:e.userId)||0;return parseInt(t)},st=()=>{var e;let t=Se.parse(window.location.search);delete t.add;const s=Se.stringify(t);let a=(null==t?void 0:t.clientId)?null==t?void 0:t.clientId:0;parseInt(a)>0?i.push({pathname:"/preferences/companyuser-list",search:`?${s}`}):(null==(e=null==t?void 0:t.path)?void 0:e.length)>0?i.push("/preferences/users"):i.location.search.length>0?i.push({pathname:"/preferences/account-settings",search:i.location.search}):i.push("/preferences/users")};return s.jsxs(p,{children:[s.jsx(De,{fluid:!0,className:"main-heading-wrapper mb0",children:s.jsxs(De,{className:"mhw-container",children:[s.jsx("div",{className:"mhwc-left",children:s.jsx("h1",{children:s.jsx("div",{className:"mh-wrapper",children:s.jsx("span",{className:"mh-text",children:Je?"Edit user":"Add a new user"})})})}),s.jsx("div",{className:"mhwc-right",children:s.jsxs("div",{className:"back-text",onClick:()=>st(),children:[s.jsx(N,{icon:b,size:"sm"}),"Back"]})})]})}),s.jsx(De,{className:"page-header",children:s.jsxs("div",{className:"",children:[s.jsx("div",{className:(We?"click-off":"")+" box-design rs-box-min-height py40 ",children:s.jsxs(ye,{children:[s.jsxs(Ne,{md:8,children:[s.jsxs(ye,{children:[s.jsx(Ne,{md:6,children:s.jsx(Ie,{children:s.jsx(ue,{name:"firstName",placeholder:"First name",min:4,max:pe,disabled:0!==tt(),val:c,required:!0,errorMessage:Ue,cb:e=>{let t=e.trimStart();/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)||e.length<100&&(u(e),Fe(null))},ob:e=>{let t=e.length>=4?null:w;0===e.length&&(t=E),u(e),Fe(t)}})})}),s.jsx(Ne,{md:6,children:s.jsx(Ie,{children:s.jsx(ue,{name:"lastName",placeholder:"Last name",max:ve,val:h,errorMessage:Te,required:!0,cb:e=>{let t=e.trimStart();/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)||e.length<50&&(m(e),Me(null))},ob:e=>{let t=e.length>0?null:C;m(e),Me(t)}})})})]}),s.jsxs(ye,{children:[s.jsx(Ne,{md:6,children:s.jsx(Ie,{children:s.jsx("div",{className:"position-relative "+(0!==tt()?"click-off":"click-on"),children:s.jsx(me,{required:!0,label:"Mobile number",value:J+K,disabled:0!==tt(),errorMessage:Ee,onChange:(e,t,s)=>{var a;let l=null==e?void 0:e.slice(null==(a=null==t?void 0:t.dialCode)?void 0:a.length);X(t.countryCode),V(t.dialCode);let i=l.length>0?null:k;H(l),Pe(i)},onBlur:e=>{let t=e.target.value,s=(null==t?void 0:t.slice(3)).length>0?null:k;Pe(s)}})})})}),s.jsx(Ne,{md:6,children:s.jsx(Ie,{children:s.jsx(ue,{name:"email address",placeholder:"Email ID",val:o,max:fe,errorMessage:_e,disabled:0!==tt(),required:!0,iconPlaceholder:!Ye,iconName:L,isLoading:Ye,ob:e=>{e.length>0&&_(e)?(ze(!0),S({path:Y,params:{emailId:o},retry:2,retryTime:5e3,ok:e=>{ze(!1),r(e.status),e.status&&Ae(null==e?void 0:e.message)},fail:e=>{ze(!1),Ae("Unexpected happened. Try again later")}})):Ae(A)},cb:e=>{let t=e.trimStart();/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)||(d(U(e)),Ae(null))}})})})]}),s.jsxs(ye,{children:[oe.length>0&&s.jsx(Ne,{md:6,children:s.jsx(ce,{data:oe,value:0===ne.jobfunctionId?{jobfunctionId:0,jobfunctionName:"-- Select Job function --"}:ne,required:!0,label:"Job function",errorMessage:Oe,textField:"jobfunctionName",dataItemKey:"jobfunctionId",onChange:e=>{let t=e.target.value.jobfunctionName.length>0?null:F;re(e.target.value),qe(t)}})}),s.jsxs(Ne,{md:6,className:Je?"click-off":"",children:[s.jsx(ue,{type:"password",viewEye:!0,meter:!0,val:Z,errorMessage:Re,placeholder:"Password",required:!0,disabled:0!==tt(),cb:e=>{ae(T(e)),Q(e),Le(!1),ke||Be(null)},ob:e=>{ae(T(e));let t="";t=e.length?B(e)?null:O:R,Q(e),ke||Be(t)}}),s.jsxs("div",{className:"d-flex align-content-center mt3",style:{zoom:.8},children:["Min. 8 characters",s.jsx("div",{className:"ml8 ",children:s.jsx(N,{tooltip:"Min. 8 characters including numbers, special characters\n                                   and a mix of capital and small letters",icon:"icon-rs-circle-question-mark-medium",size:"md",iconClass:"",mainClass:"",onClick:()=>{}})})]})]})]})]}),s.jsxs(Ne,{md:4,children:[s.jsx(ye,{children:s.jsx(Ne,{children:s.jsx("textarea",{placeholder:"Enter a message welcoming the user",value:je,onBlur:e=>be(e.target.value),onChange:e=>{let t=e.target.value.trimStart();/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)||be(t)},maxLength:"250"})})}),s.jsx(Ie,{children:s.jsxs(xe,{children:[s.jsx(ye,{children:s.jsx(Ne,{children:s.jsx(he,{className:"",lbl:"Enforce one time password to login",checked:we,cb:e=>Ce(e)})})}),s.jsx(ye,{children:s.jsx(Ne,{children:s.jsx(he,{lbl:"Generate password",checked:ke,className:"marginT10 "+(0!==tt()?"d-none":""),disabled:0!==tt(),cb:e=>{ae(!0===e?100:0),Le(e),(e=>{var t="123456789",s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a="abcdefghijklmnopqrstuvwxyz",l="!@#$%^&*()",i=Math.floor(5*z(0,1))+1,n=t.substr(i,2),r=Math.floor(13*z(0,1))+1,o=s.substr(r,2),d=Math.floor(13*z(0,1))+1,c=a.substr(d,2),u=Math.floor(5*z(0,1))+1,h=(l.substr(u,2),"");for(let m=1;m<=3;m++)i=Math.floor(5*z(0,1))+1,n=t.substr(i,1),r=Math.floor(13*z(0,1))+1,o=s.substr(r,1),d=Math.floor(13*z(0,1))+1,c=a.substr(d,1),u=Math.floor(5*z(0,1))+1,h=h+o+n+l.substr(u,1)+c;e?(Q(h),te("text"),Be("")):(Q(""),te("password"))})(e)}})})})]})})]})]})}),s.jsxs("div",{className:"btn-container d-flex justify-content-end mb0",children:[s.jsx(v,{onClick:()=>{st()},children:"Cancel"}),s.jsx(f,{className:We?"click-off":"",onClick:()=>{var e,s,a;if(M(c))return void Fe(E);if(c.length<4)return void Fe(w);if(M(h))return void Me(C);if(M(ne.jobfunctionName)||ne.jobfunctionName.toLowerCase().includes("select"))return void qe(F);if(M(o))return void Ae(P);if(!_(o))return void Ae(A);if(null===n||!0===n)return void Ae("Email id already exists");if(M(K))return void Pe(k);if(Je);else{if(M(Z))return void Be(R);if(!B(Z))return void Be(O)}var l=Je?"Buvanesh@1990":Z;let r="sit";!0===window.location.href.includes("sit")?r="sit":!0===window.location.href.includes("app")?r="app":!0===window.location.href.includes("run")&&(r="run");let d=Se.parse(null==(e=window.location)?void 0:e.search),u=0;if(null!==(null==d?void 0:d.clientId)&&void 0!==(null==d?void 0:d.clientId))u=d.clientId;else{let e=I();u=null!=(null==e?void 0:e.parentClientId)&&null!=(null==e?void 0:e.parentClientId)&&0!=(null==e?void 0:e.parentClientId)?null==e?void 0:e.parentClientId:q()}var m={clientId:parseInt(u),firstName:c,lastName:h,email:o,userId:(null==d?void 0:d.userId)||0,password:l,jobFunctionId:ne.jobfunctionId,phoneNo:K,welcomeText:je,countryCode:W,countryCodeMobile:J,otpEnableForClient:we,platformName:r};!0!==G()?S({path:$,params:m,loading:t.globalStateData.setIsLoadingData,sessionOut:t.globalStateData.setSessionOutData,ok:e=>{var t,s;const a=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(a),e.status?i.push({pathname:"assignrole",search:i.location.search,state:{userId:(null==(s=null==(t=null==i?void 0:i.location)?void 0:t.state)?void 0:s.userId)||0,role:le}}):($e(!0),He((null==e?void 0:e.message)||"Please try again"))},fail:e=>{const t=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)}}):i.push({pathname:"assignrole",search:window.location.search,state:{userId:(null==(a=null==(s=null==i?void 0:i.location)?void 0:s.state)?void 0:a.userId)||0,role:le}})},children:Je?"Update user":"Add user"})]}),s.jsx("div",{children:!0===Ge&&s.jsx(ge,{headerTitle:"User",para:Ke,primaryButtonText:"OK",buttonClicked:e=>{$e(!1)}})})]})})]})},Ee=Object.freeze(Object.defineProperty({__proto__:null,AddNewUser:Me,default:Me},Symbol.toStringTag,{value:"Module"}));var Pe=[];class Re extends i.Component{constructor(){super(...arguments),t(this,"selectList",[]),t(this,"state",{assignList:[],formFields:"",newData:[],saveError:!1,errMsg:null,keyPerson:!1,iconBool:!1,cliendId:null,filterClientName:null,CompanyListData:[],fullUserList:[],assingPopUp:!1,userRemoveData:null,userId:0,roleList:[{securityGroupId:1,securityGroupName:"Admin"},{securityGroupId:2,securityGroupName:"Super user"},{securityGroupId:3,securityGroupName:"User"}],userRoleValue:null}),t(this,"componentDidMount",(()=>{this.getUserListFromServer(),this.getRoleList()})),t(this,"getRoleList",(()=>{S({path:K,loading:this.context.globalStateData.setIsLoadingData,ok:e=>{var t;1==(null==e?void 0:e.status)&&(null==(t=null==e?void 0:e.data)?void 0:t.length)>0&&this.setState((t=>({roleList:[...t.roleList,...null==e?void 0:e.data]})))},error:e=>{}})})),t(this,"getUserListFromServer",(()=>{var e,t;let s,a=Se.parse(window.location.search),l=null==a?void 0:a.clientId;if(this.setState({cliendId:l}),null!=l){let t=I(),s=null==(e=null==t?void 0:t.clientLists)?void 0:e.filter((e=>(null==e?void 0:e.clientId)==l));(null==s?void 0:s.length)>0&&this.setState({filterClientName:s[0]})}else{let e=I();null!=e&&(null==(t=null==e?void 0:e.clientLists)?void 0:t.length)>0&&this.setState({CompanyListData:null==e?void 0:e.clientLists})}"false"===(null==a?void 0:a.isAgency)&&(s=q()),s=q();let i=I();null!=(null==i?void 0:i.parentClientId)&&null!=(null==i?void 0:i.parentClientId)&&0!=(null==i?void 0:i.parentClientId)&&(s=null==i?void 0:i.parentClientId),null!=(null==a?void 0:a.clientId)&&0!=(null==a?void 0:a.clientId)&&(s=null==a?void 0:a.clientId),S({path:H,params:{clientId:s},loading:this.context.globalStateData.setIsLoadingData,ok:e=>{var t,s,a,l;if(e.status){let i=[],n=[];e.data.map((e=>{var t,s;if(4!==e.userTypeID){let a={...e},l=I(),r=null==l?void 0:l.userId;if(0==r){let e=Se.parse(window.location.search);r=(null==e?void 0:e.userId)?null==e?void 0:e.userId:0}if(e.userId==r)return a.className="",a.role="",a.obj=null==(t=e.firstName)?void 0:t.replace(/ /g,"_"),n.push(a),void(!0===e.isKeyPerson&&this.setState({keyPerson:!0}));a.className="",a.role="",a.obj=null==(s=e.firstName)?void 0:s.replace(/ /g,"_"),i.push(a)}})),this.setState({fullUserList:null==e?void 0:e.data}),null==(l=null==(a=null==(s=null==(t=this.props)?void 0:t.history)?void 0:s.location)?void 0:a.state)||l.userId;{n.filter((e=>!0===e.isKeyPerson));const e=i.filter((e=>3e3!==e.roleId)),t=i.filter((e=>3e3==e.roleId));this.setState({assignList:t,newData:e})}}else this.setState({saveError:!0,errMsg:(null==e?void 0:e.message)||J})},error:e=>{}})})),t(this,"AssignList",(()=>{const e=(e,t)=>!0===(null==t?void 0:t.isSelect)?"#0000ff":e%2==0?"#f0f8ff":"white";return s.jsx(s.Fragment,{children:s.jsx("ul",{className:"grid-style",children:this.state.assignList.map(((t,a)=>""===t.className?s.jsx("li",{style:{backgroundColor:e(a,t),color:(null==t?void 0:t.isSelect)?"white":"black"},list:a,onClick:e=>{let t=[...this.state.assignList];t[a].isSelect=!t[a].isSelect,this.setState({assignList:t})},children:s.jsx("span",{title:`${t.firstName}`,children:t.firstName})},a):""))})})})),t(this,"AssignListNoData",(()=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"nodata-bar",children:[s.jsx(N,{icon:V,size:"md",color:"orange-medium",mainClass:"mr5"}),s.jsx("p",{children:"No data available"})]})}))),t(this,"addRow",((...e)=>{Pe=[...this.state.assignList],e[0].currentTarget.classList.contains("active")?(e[0].currentTarget.classList.remove("active"),this.selectList=this.selectList.filter((t=>t!==e[2])),Pe[e[1]].className=""):(e[0].currentTarget.classList.add("active"),this.setState({iconBool:!0},(()=>{this.selectList.push(e[2]),Pe[e[1]].className="active"})))})),t(this,"addInputs",(()=>{const e=this.state.assignList.map((e=>({...e,roleId:3e3})));let t=e.filter((e=>!1===e.isSelect||void 0===e.isSelect||null===e.isSelect)),s=[...this.state.newData,...e.filter((e=>!0===e.isSelect))];this.setState({assignList:t,newData:s})})),t(this,"removeRole",(e=>{null!=e&&(null==e?void 0:e.userId)==this.state.userId&&this.setState({userId:0});let t=[...this.state.assignList];const s=this.state.newData.filter((t=>t!==e));this.selectList=s,this.setState({newData:[]}),this.setState({newData:this.selectList}),null!=e&&(e.className=""),t=t.map((e=>(e.className="",e.isSelect=!1,e))),null!=e&&(e.isSelect=!1,t.push(e));const a=t.map((e=>({...e,roleId:3e3,isKeyPerson:!1})));this.setState({assignList:a})})),t(this,"dropDownValueChanges",((e,t)=>{e.role=null==t?void 0:t.securityGroupName,e.roleId=0,"Admin"===(null==t?void 0:t.securityGroupName)?e.roleId=1:"Super user"===(null==t?void 0:t.securityGroupName)?e.roleId=2:"User"===(null==t?void 0:t.securityGroupName)?e.roleId=3:null!=(null==t?void 0:t.securityGroupName)&&(e.roleId=null==t?void 0:t.securityGroupId),this.forceUpdate()})),t(this,"pageNavigation",(()=>{var e;let t=Se.parse(null==(e=window.location)?void 0:e.search);null==t.clientId?"preferences"!==(null==t?void 0:t.path)?this.props.history.push({pathname:"/preferences/account-settings",search:this.props.history.location.search}):this.props.history.push("/preferences/users"):this.props.history.push({pathname:"/preferences/companyuser-list",search:`?clientId=${null==t?void 0:t.clientId}`})})),t(this,"selectUserRole",(e=>{var t;return(null==(t=this.state.roleList)?void 0:t.find((t=>(null==t?void 0:t.securityGroupId)===(null==e?void 0:e.roleId))))||{}}))}render(){var e,t,a,l,i;return s.jsxs(p,{children:[s.jsx(De,{fluid:!0,className:"main-heading-wrapper mb0",children:s.jsxs(De,{className:"mhw-container",children:[s.jsx("div",{className:"mhwc-left",children:s.jsx("h1",{children:s.jsx("div",{className:"mh-wrapper",children:s.jsx("span",{className:"mh-text",children:"Assign user role"})})})}),s.jsxs("div",{className:"mhwc-right",children:[this.state.assingPopUp?s.jsx(ge,{size:"md",headerTitle:"Remove user role",para:"This action will remove the assigned user role. Please confirm.",primaryButtonText:"Ok",secondaryButtonText:"Cancel",buttonClicked:e=>{1==e?(this.setState({assingPopUp:!1}),this.removeRole(this.state.userRemoveData)):this.setState({assingPopUp:!1}),this.setState({})}}):null,s.jsxs("div",{className:"back-text",onClick:()=>{let e=Se.parse(window.location.search);"true"==(null==e?void 0:e.brandAdd)||"true"==(null==e?void 0:e.add)?this.props.history.push({pathname:"/preferences/companyuser-list",search:`?clientId=${null==e?void 0:e.clientId}`}):this.props.history.push("/preferences/users")},children:[s.jsx(N,{icon:b,size:"sm"}),"Back"]})]})]})}),s.jsx(De,{className:"page-header",children:s.jsxs(De,{children:[s.jsxs("div",{className:"page-header settings-container",children:[s.jsxs("div",{className:"well-cover btop",children:[s.jsx(ye,{className:"marginB10 d-none",children:s.jsx(Ne,{xs:7,style:{textAlign:"right",width:"100%"},children:s.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer icon-shadow",onClick:()=>{this.props.history.push("users")}})})}),s.jsxs(ye,{children:[s.jsx(Ne,{md:12}),s.jsx(Ne,{md:3,children:s.jsxs("div",{className:"user-grid-list",children:[0!=(null==(e=this.state.assignList)?void 0:e.length)&&s.jsx(this.AssignList,{}),0==(null==(t=this.state.assignList)?void 0:t.length)&&s.jsx(this.AssignListNoData,{})]})}),s.jsx(Ne,{md:1,style:{height:"100%",textAlign:"center"},children:s.jsx("div",{className:(null==(l=null==(a=this.state.assignList)?void 0:a.filter((e=>!0===e.isSelect)))?void 0:l.length)>0?"grid-style-arrow text-center":"grid-style-arrow text-center click-off",onClick:()=>this.addInputs(),children:" "})}),s.jsx(Ne,{md:8,children:s.jsxs("div",{className:"sec-list",children:[s.jsx(ye,{className:"mb40 mt5",children:s.jsxs(Ne,{md:3,className:"d-flex align-items-end",children:[s.jsx(we,{label:"Company",right:!0,className:"mr5"}),s.jsx(N,{tooltip:"\r\n                                  User - Accesses communication analytics and performance.\r\n                                ___________________________________\r\n                                  Super user - Import audience, sets up communications and views reports.                 \r\n                                ___________________________________\r\n                                  Admin - Manages account settings and module configurations. \r\n                                  ",icon:"icon-rs-circle-question-mark-medium",size:"md",position:"right",iconClass:"",mainClass:"",onClick:()=>{}})]})}),0==(null==(i=this.state.newData)?void 0:i.length)&&s.jsx(this.AssignListNoData,{}),this.state.newData.map(((e,t)=>{var a;return s.jsx(Ie,{className:"mt40",children:s.jsxs(ye,{children:[s.jsx(Ne,{md:3,children:s.jsx(we,{label:e.firstName,right:!0})}),s.jsx(Ne,{md:6,children:s.jsx(s.Fragment,{children:s.jsx(ce,{errorMessage:e.userId==this.state.userId?"Select role":null,required:!0,label:"Role",data:(null==(a=this.state.roleList)?void 0:a.length)>0?this.state.roleList:[{securityGroupId:0,securityGroupName:"Select your role"}],textField:"securityGroupName",value:1===e.roleId?{securityGroupId:1,securityGroupName:"Admin"}:2===e.roleId?{securityGroupId:2,securityGroupName:"Super user"}:3===e.roleId?{securityGroupId:3,securityGroupName:"User"}:0===(null==e?void 0:e.roleId)||3e3==(null==e?void 0:e.roleId)?{securityGroupId:0,securityGroupName:"Select your role"}:this.selectUserRole(e),onChange:e=>{let s=[...this.state.newData];s[t].roleId=e.target.value.securityGroupId,s[t].securityGroupName=e.target.value.securityGroupName,this.setState({newData:s}),this.setState({userId:0})}})})}),s.jsx(Ne,{md:2,children:s.jsx(Ce,{children:s.jsxs(W,{children:[0!==e.roleId&&3!==e.roleId&&s.jsx(N,{children:s.jsx(X,{text:!0===this.state.keyPerson?"You are keyperson for this account":"Key contact",position:"top",children:s.jsx("i",{className:"icon-rs-crown-fill-medium icons-md cursor-pointer "+(!0===e.isKeyPerson?"orange ":"grey"),onClick:()=>{var s;if(!0===this.state.keyPerson)return;if(!1===e.isKeyPerson){let e=[...this.state.assignList,...this.state.newData];if(1===(null==(s=null==e?void 0:e.filter((e=>!0===e.isKeyPerson)))?void 0:s.length))return}let a=[...this.state.newData];a[t].isKeyPerson=!e.isKeyPerson,this.setState({newData:a})}})})}),s.jsx(N,{children:s.jsx(X,{text:"Remove",position:"top",children:s.jsx("i",{className:"icon-rs-circle-minus-fill-edge-medium icons-md red cursor-pointer",onClick:()=>{3e3==(null==e?void 0:e.roleId)?(this.setState({iconBool:!1}),this.removeRole(e)):this.setState({iconBool:!1,userRemoveData:e,assingPopUp:!0})}})})})]})})})]})})}))]})})]})]}),s.jsx("div",{className:"btn-container d-flex justify-content-end box-bottom-space",children:s.jsx(f,{className:`${0===this.state.newData.length&&"click-off"}`,onClick:()=>{var e;if(this.context.globalStateData.getIsPrototype)return void this.props.cb(0);if(!0===G())return void this.pageNavigation();let t=null==(e=this.state.newData)?void 0:e.find((e=>3e3===(null==e?void 0:e.roleId)));if(t)return void this.setState({userId:null==t?void 0:t.userId});let s=[...this.state.newData,...this.state.assignList];S({path:Z,params:{userRoleList:s},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(e.status){const e=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(e),this.pageNavigation()}else this.setState({saveError:!0})},fail:e=>{}})},children:"Save"})})]}),s.jsx("div",{children:!0===this.state.saveError&&s.jsx(ge,{headerTitle:"Sorry",para:this.state.errMsg||J,primaryButtonText:"OK",buttonClicked:e=>{this.setState({saveError:!1})}})})]})})]})}}t(Re,"contextType",g);const Be=n(Re),Oe=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"})),qe=(e,t)=>({result:c(t.slice(0),e),dataState:e}),Ge=e=>{const t=l(),n=a.useContext(g),r=a.useContext(ee),[o,d]=i.useState(null),[c,u]=i.useState(null),[h,m]=a.useState([]),[p,x]=a.useState(!1),[j,D]=a.useState(!1),[y,N]=a.useState(!1),[b,w]=a.useState(!0),[C,k]=a.useState(!1),[L,_]=a.useState(0),[A,U]=a.useState(!1),[F,T]=a.useState(!1),[M,E]=a.useState(!1),[P,R]=a.useState(!1);a.useEffect((()=>{let e=!1,t=!1,s=!1,a=!1;const l=Q("Users");e=1==(null==l?void 0:l.accessUpdateData),U(e),(null==l?void 0:l.get_AddAccessData)&&(t=!0),1==(null==l?void 0:l.accessUpdateData)&&(s=!0),1==(null==l?void 0:l.accessViewData)&&(a=!0),T(t),E(s),R(a)}),[]),a.useEffect((()=>{r.apiStateData.setIsReloadData(!1);let e=I(),t=q();null!=(null==e?void 0:e.parentClientId)&&null!=(null==e?void 0:e.parentClientId)&&0!=(null==e?void 0:e.parentClientId)&&(t=null==e?void 0:e.parentClientId);const s={clientId:t};N(!1),w(!0),S({path:H,params:s,sessionOut:n.globalStateData.setSessionOutData,ok:e=>{if(e.status){x(!1);let t=e.data;if(t.map((e=>(null!==e.role&&void 0!==e.role&&""!==e.role||(e.role="User"),4===e.userTypeID&&(e.role="Account admin user"),e))),m(t||[]),t.length){let e=qe({take:5,skip:0},t);d(e.result),u(e.dataState),w(!1)}else m([]),x(!0),w(!1)}else m([]),x(!0),w(!1);N(!0)},fail:e=>{N(!0),m([]),x(!0)}})}),[r.apiStateData.getIsReloadData,j]);const B=(e,t)=>{S({path:ae,params:{userId:e,status:t?"Active":"Inactive"},method:"POST",sessionOut:n.globalStateData.setSessionOutData,ok:e=>{const t=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)},fail:e=>{const t=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)}})},O=e=>{let t=qe(e.page,h);u(t.dataState),d(t.result)};return s.jsxs("div",{className:"settings-container",children:[s.jsxs("div",{className:"d-flex align-items-center justify-content-between "+(!0===b?"click-off":"click-on"),children:[s.jsx("h4",{className:"mb0",children:"User details "}),s.jsx("div",{className:F?"click-on":"click-off",children:s.jsx(X,{text:"Add user",position:"top",children:s.jsx("i",{className:`icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue float-end cursor-pointer icon-shadow-blue ${!0===G()&&" click-off"}`,onClick:()=>{if(!1===te(null==h?void 0:h.length)){let e=se();if(null!==e&&4===(null==e?void 0:e.planId))return void _(null==e?void 0:e.planId);k(!0)}else t.push({pathname:"adduser",search:"userId=0&c=0"})}})})})]}),y&&h.length>0?s.jsx("div",{className:"marginT15 marginB25 w-100",children:s.jsx(_e,{config:c,data:h,settings:{total:h.length},isDataStateRequired:!1,pageable:!0,onDataStateChange:e=>{O(e)},pageStateChange:e=>{O(e)},column:[{field:"firstName",title:"Name",filter:"text",cell:a=>s.jsx($e,{permissionUpdate:M,...a,cb:(e,s)=>{A&&t.push({pathname:"adduser",search:`c=0&isAgency=false&userId=${s}`,state:{userId:s}})},updateUserId:t=>{e.updateUserId(t)}})},{field:"jobFunctionName",title:"Job function",filter:"text",cell:Ye},{field:"role",title:"Role",filter:"text",cell:e=>{var t,a;return s.jsx("td",{children:4===(null==(t=null==e?void 0:e.dataItem)?void 0:t.userTypeID)?"Account admin user":(null==(a=null==e?void 0:e.dataItem)?void 0:a.role)||"User"})}},{field:"status",title:"Actions",width:"200",cell:e=>s.jsx(ze,{...e,cb:(e,s)=>{t.push({pathname:"adduser",search:"c=0&userId="+s,state:{userId:s}})},changeUserStatus:B})}]})}):s.jsx("div",{className:"marginT15",children:s.jsx(ke,{count:8,isError:p,message:"No users found"})}),!0===C&&s.jsxs(be,{show:C,centered:!0,size:"md",children:[s.jsxs(be.Header,{children:[s.jsx("h2",{children:"Users"}),s.jsx(Le,{mainClass:"close",size:"md",handleClose:()=>{k(!1)}})]}),s.jsx(be.Body,{children:s.jsx("p",{children:"Users limit exceeded, please upgrade your plan."})}),s.jsxs("div",{className:"d-flex justify-content-end marginT30",children:[s.jsx(v,{onClick:()=>{k(!1)},children:"Cancel"}),s.jsx(f,{onClick:()=>{t.push("/subscription",{userId:0})},children:"Proceed"})]})]}),4===L&&s.jsx(be,{show:!0,centered:!0,onHide:()=>_(0),children:s.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[s.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),s.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>_(0)})]})})]})},$e=e=>{var t,i,n,r,o;a.useState(!1);const d=l();let c=I();const u=()=>{if(!0===G())return!1;let t=I();return!0===(null==t?void 0:t.isAgency)&&2===(null==t?void 0:t.userTypeId)||(!0===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?"4"===(null==t?void 0:t.roleId)||"6"===(null==t?void 0:t.roleId)||"2"===(null==t?void 0:t.roleId)||"5"===(null==t?void 0:t.roleId)||"7"!==(null==t?void 0:t.roleId)&&e.dataItem.userId===t.userId:!1===(null==t?void 0:t.isAgency)&&4===(null==t?void 0:t.userTypeId)||(!1===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?e.dataItem.userId===t.userId||"4"===(null==t?void 0:t.roleId)||"6"!==(null==t?void 0:t.roleId)&&"5"!==(null==t?void 0:t.roleId):(null==t?void 0:t.userId)===e.dataItem.userId))};return s.jsx("td",{children:s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs("span",{className:`marginB0 ${u()&&"text-underline-h cp"}`,onClick:()=>{var t;!1!==u()&&0!=(null==e?void 0:e.permissionUpdate)&&((null==(t=null==e?void 0:e.dataItem)?void 0:t.userId)!==(null==c?void 0:c.userId)?4!==e.dataItem.userTypeID&&e.cb(1,e.dataItem.userId):d.push({pathname:"/preferences/my-profile"}))},children:[" ",0===(null==(i=null==(t=null==e?void 0:e.dataItem)?void 0:t.firstName)?void 0:i.length)&&Ue,`${e.dataItem&&e.dataItem.firstName||""} ${e.dataItem&&e.dataItem.lastName||""} ${4===e.dataItem.userTypeID?(null==(r=null==(n=null==e?void 0:e.dataItem)?void 0:n.firstName)?void 0:r.length)>0?"(Admin)":"Account user":(()=>{let t=I();return e.dataItem.userId===t.userId?"(You)":""})()}`]}),(null==(o=null==e?void 0:e.dataItem)?void 0:o.isKeyPerson)?s.jsx("i",{className:"icon-rs-crown-fill-medium orange icons-md cursor-pointer"}):null]})})},Ye=e=>{var t,a,l,i;return s.jsx("td",{children:s.jsx("div",{className:"d-flex justify-content-between",children:s.jsx("span",{className:"marginB0",children:`${4===e.dataItem.userTypeID?(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.jobFunctionName)?void 0:a.length)>0?null==(l=null==e?void 0:e.dataItem)?void 0:l.jobFunctionName:"Account manager":null==(i=null==e?void 0:e.dataItem)?void 0:i.jobFunctionName}`})})})},ze=e=>{a.useContext(g);const[t,i]=a.useState(1===e.dataItem.statusId),n=l(),[r,o]=a.useState(null);a.useState(!1);const[d,c]=a.useState(!1),[u,h]=a.useState(!1),[m,p]=a.useState(!1);return a.useEffect((()=>{i(1===e.dataItem.statusId)})),a.useEffect((()=>{let e=I();o(e);let t=!1,s=!1,a=!1;const l=Q("Users");(null==l?void 0:l.get_AddAccessData)&&(t=!0),1==(null==l?void 0:l.accessUpdateData)&&(s=!0),1==(null==l?void 0:l.accessViewData)&&(a=!0),c(t),h(s),p(a)}),[]),y("StatusCell1",e.dataItem),s.jsx("td",{children:s.jsx("div",{className:"float-end",children:s.jsx("div",{className:"camp-icon",children:s.jsxs("ul",{className:"camp-icon-pannel",children:[s.jsx("li",{className:u?"click-on":"click-off",children:s.jsx(X,{placement:"top",text:"Edit",children:s.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue \n                  "+(!0===(null==e?void 0:e.isCompany)||(()=>{if(!0===G())return!1;let t=I();return!0===(null==t?void 0:t.isAgency)&&2===(null==t?void 0:t.userTypeId)||(!0===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?"4"===(null==t?void 0:t.roleId)||"6"===(null==t?void 0:t.roleId)||"2"===(null==t?void 0:t.roleId)||"5"===(null==t?void 0:t.roleId)||"7"!==(null==t?void 0:t.roleId)&&e.dataItem.userId===t.userId:!1===(null==t?void 0:t.isAgency)&&4===(null==t?void 0:t.userTypeId)||(!1===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)?e.dataItem.userId===t.userId||"4"===(null==t?void 0:t.roleId)||"6"!==(null==t?void 0:t.roleId)&&"5"!==(null==t?void 0:t.roleId):(null==t?void 0:t.userId)===e.dataItem.userId))})()?"click-on":"click-off"),onClick:()=>{var t;let s=I();(null==(t=null==e?void 0:e.dataItem)?void 0:t.userId)!==(null==s?void 0:s.userId)?e.cb(1,e.dataItem.userId):n.push({pathname:"/preferences/my-profile"})}})})}),s.jsx("li",{className:` ${u?"click-on":"click-off"} ${!0===(null==e?void 0:e.isCompany)||(()=>{if(!0===G())return!1;let t=I();if((null==t?void 0:t.userId)===e.dataItem.userId)return!1;if(!0===(null==t?void 0:t.isAgency)&&2===(null==t?void 0:t.userTypeId))return!0;if(!0===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)){if(e.dataItem.userId===t.userId)return!1;if("4"===(null==t?void 0:t.roleId)||"6"===(null==t?void 0:t.roleId)||"2"===(null==t?void 0:t.roleId)||"5"===(null==t?void 0:t.roleId))return!0;if("7"===(null==t?void 0:t.roleId))return!1}if(!1===(null==t?void 0:t.isAgency)&&4===(null==t?void 0:t.userTypeId))return!0;if(!1===(null==t?void 0:t.isAgency)&&3===(null==t?void 0:t.userTypeId)){if(e.dataItem.userId===t.userId)return!1;if("4"===(null==t?void 0:t.roleId))return!0;if("6"===(null==t?void 0:t.roleId)||"5"===(null==t?void 0:t.roleId))return!1}return(null==t?void 0:t.userId)===e.dataItem.userId})()?"click-on":"click-off"}`,children:s.jsx(Ae,{className:"mt0",checked:t,onChange:t=>{i(t.value),e.dataItem.statusId=t.value?1:0,e.changeUserStatus(e.dataItem.userId,t.value)}})})]})})})})};i.Component;class Ke extends a.Component{constructor(){super(...arguments),t(this,"createDataState",((e,t)=>({result:c(t.slice(0),e),dataState:e}))),t(this,"state",{skip:0,take:10,currentIndex:0,checked:!0,jsonData:null,result:null,dataState:null,listError:!1,addButton:!1,isAddusers:!1,isSeconduser:!1,planId:0,userLoad:!0,cliendId:null,clientPlan:null,issupportUser:!1,getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1}),t(this,"componentDidMount",(e=>{var t;let s=I(),a=Se.parse(null==(t=window.location)?void 0:t.search);this.setState({cliendId:null==a?void 0:a.clientId,issupportUser:null==s?void 0:s.isSupportUser}),this.getPlanData(),this.getAccessData()})),t(this,"getAccessData",(()=>{let e=!1,t=!1,s=!1;const a=Q("Users");1==(null==a?void 0:a.get_AddAccessData)&&(e=!0),t=1==(null==a?void 0:a.accessUpdateData),(null==a?void 0:a.accessDeleteData)&&(s=!0),this.setState({getAddAccessData:e,getUpdateAccessData:t,getDeleteAccessData:s})})),t(this,"componentDidCatch",(e=>{})),t(this,"componentDidUpdate",(()=>{})),t(this,"getPlanData",(e=>{this.setState({jsonData:[],userLoad:!0});let t=Se.parse(window.location.search),s=(null==t?void 0:t.clientId)||q(),a=I();le.backgroundConnectServer({path:ie,accessToken:e,params:{clientId:s,userId:null==a?void 0:a.userId},ok:e=>{var t,s;if(e.status){let a=ne((null==(t=null==e?void 0:e.data)?void 0:t.licenseTypeId)||1);a.addons=(null==(s=null==e?void 0:e.data)?void 0:s.addOns)||[],this.setState({clientPlan:a}),this.getUserList()}else{let e="";e=window.location.search.length>0?window.location.search+"&isAgency=true":"?isAgency=true",this.props.history.push({pathname:"/features",search:e})}},fail:e=>{}})})),t(this,"getUserList",(()=>{let e=Se.parse(window.location.search);const t={clientId:(null==e?void 0:e.clientId)||q()};this.setState({jsonData:[],userLoad:!0}),S({path:H,params:t,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(this.setState({isAddusers:e.status,userLoad:!1}),e.status)if(this.context.globalStateData.setIsLoadingData(!1),e.data.length){var t=e.data;t.map((e=>(null!==e.role&&""!==e.role&&void 0!==e.role||(e.role="User"),4===e.userTypeID&&(e.role="Admin admin user"),e)));let s=this.createDataState({take:5,skip:0},t);this.setState({jsonData:t||[],result:s.result,dataState:s.dataState,listError:!0,addButton:!(t.length>4)})}else this.setState({jsonData:[],listError:!0,addButton:!1});else this.context.globalStateData.setIsLoadingData(!1),this.setState({jsonData:[],userLoad:!1,listError:!0,addButton:!1,isAddusers:!0})},fail:e=>{this.context.globalStateData.setIsLoadingData(!1),this.setState({jsonData:[],userLoad:!1,listError:!0})}})})),t(this,"handleChange",((e,t)=>{e.checked=t,this.forceUpdate()})),t(this,"changeUserStatus",((e,t)=>{S({path:ae,params:{userId:e,status:t?"Active":"Inactive"},method:"POST",sessionOut:this.context.apiStateData.setSessionOutData,ok:e=>{const t=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t)},fail:e=>{}})})),t(this,"CompanyStatusCell",(e=>s.jsx("td",{children:s.jsx("div",{className:"float-end",children:s.jsx("div",{className:"camp-icon",children:s.jsxs("ul",{className:"camp-icon-pannel",children:[s.jsx("li",{children:s.jsx(X,{placement:"top",text:"Edit",children:s.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue \n                    "+(!0===G()?"click-off":"click-on"),onClick:()=>{4!==e.dataItem.userTypeID?e.cb(1,e.dataItem.userId):history.push({pathname:"/preferences/my-profile"})}})})}),s.jsx("li",{className:"click-on",children:s.jsx(Ae,{className:"mt0",checked:checked,onChange:t=>{e.dataItem.statusId=t.value?1:0,e.changeUserStatus(e.dataItem.userId,t.value)}})})]})})})}))),t(this,"StatusCellComponent",(e=>s.jsx(ze,{...e,changeUserStatus:this.changeUserStatus,isCompany:!0,cb:(t,s)=>{let a=window.location.search;a.length>0?a+=`&userId=${s}`:a=`?userId=${s}`;let l=new URLSearchParams(window.location.search);l.set("userId",e.dataItem.userId),l.set("brandAdd",!0),this.props.history.push({pathname:"adduser",search:`?${l.toString()}`,state:{userId:e.dataItem.userId}})}}))),t(this,"updateIndex",(e=>{this.setState({currentIndex:e})})),t(this,"dataStateChange",(e=>{let t=this.createDataState(e.dataState,this.state.jsonData);this.setState({result:t.result,dataState:t.dataState})})),t(this,"NameComponent",(e=>{var t,a,l,i,n;return s.jsx("td",{className:"",children:s.jsxs("div",{className:"d-flex justify-content-between",children:[s.jsxs("span",{className:`marginB0  ${4!==e.dataItem.userTypeID&&"text-underline-h cp"}`,onClick:()=>{if(4!==e.dataItem.userTypeID){let t=new URLSearchParams(window.location.search);t.set("userId",e.dataItem.userId),t.set("brandAdd",!0),this.state.getUpdateAccessData&&this.props.history.push({pathname:"adduser",search:`?${t.toString()}`,state:{userId:e.dataItem.userId}})}},children:[0===(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.firstName)?void 0:a.length)&&Ue,`${e.dataItem&&e.dataItem.firstName||""} ${e.dataItem&&e.dataItem.lastName||""} ${4===e.dataItem.userTypeID?(null==(i=null==(l=null==e?void 0:e.dataItem)?void 0:l.firstName)?void 0:i.length)>0?"(Admin)":"Account user":(()=>{let t=I();return e.dataItem.userId===t.userId?"(You)":""})()}`]}),(null==(n=null==e?void 0:e.dataItem)?void 0:n.isKeyPerson)?s.jsx("i",{className:"icon-rs-crown-fill-medium orange icons-md"}):null]})})})),t(this,"JobFunction",(e=>{var t,a,l,i;return s.jsx("td",{className:"",children:s.jsx("div",{className:"d-flex justify-content-between",children:s.jsx("span",{className:"marginB0",onClick:()=>{4!==e.dataItem.userTypeID&&this.props.history.push({pathname:"adduser",search:window.location.search,state:{userId:e.dataItem.userId}})},children:`${4===e.dataItem.userTypeID?(null==(a=null==(t=null==e?void 0:e.dataItem)?void 0:t.jobFunctionName)?void 0:a.length)>0?null==(l=null==e?void 0:e.dataItem)?void 0:l.jobFunctionName:"Account manager":null==(i=null==e?void 0:e.dataItem)?void 0:i.jobFunctionName}`})})})})),t(this,"ColumnMenu",(e=>s.jsx("div",{children:s.jsx(Fe,{dropdownData:We,enable:!0,jusBool:!0,propsData:e,dataa:this.state.jsonData,onDataUpdate:e=>{this.setState({result:e.Data})},onClearDataUpdate:e=>{let t=this.createDataState(this.state.dataState,e.Data);this.setState({result:t.result.data})}})}))),t(this,"RenderComponent",(()=>{var e,t,a,l,i,n;switch(this.state.currentIndex){case 0:return s.jsxs(s.Fragment,{children:[void 0===this.props.isAccountSetting||null===this.props.isAccountSetting?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"d-flex justify-content-between mt15 mb15",children:[s.jsx("h4",{className:"mb0 add-title",children:"User details"}),s.jsx("div",{className:`d-flex align-items-center ${!0===this.state.userLoad?"click-off":"click-on"} ${!1===te(this.state.jsonData.length)?"click-on":"on"}`,children:this.state.isAddusers?s.jsx("div",{className:this.state.issupportUser?"click-off":"",children:s.jsx(N,{tooltip:"Add user",size:"lg",shadow:!0,icon:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer "+(this.state.getAddAccessData?"click-on":"click-off"),onClick:()=>{if(!1===re(this.state.clientPlan,this.state.jsonData.length)){let e=this.state.clientPlan;if(null!==e&&4===(null==e?void 0:e.planId))return void this.setState({planId:e.planId});this.setState({isSeconduser:!0})}else this.props.history.push({pathname:"adduser",search:`?clientId=${this.state.cliendId}&add=true`,state:{userId:0}})}})}):null})]})}):null,(null==(e=this.state.jsonData)?void 0:e.length)>0?s.jsx(s.Fragment,{children:s.jsx(_e,{config:{take:5,skip:0},settings:{total:null==(t=this.state.jsonData)?void 0:t.length},data:this.state.jsonData,isDataStateRequired:!1,pageable:!0,column:[{title:"Name",...this.columnProps("firstName"),filter:"text",cell:this.NameComponent},{title:"Job function",...this.columnProps("jobFunctionName"),filter:"text",cell:this.JobFunction},{title:"Role",...this.columnProps("role"),filter:"text",cell:e=>{var t,a;return s.jsx("td",{children:4===(null==(t=null==e?void 0:e.dataItem)?void 0:t.userTypeID)?"Account admin user":(null==(a=null==e?void 0:e.dataItem)?void 0:a.role)||"User"})}},{title:"Actions",field:"status",width:"200",cell:this.StatusCellComponent}]})}):s.jsx("div",{className:"box-design pb10",children:s.jsx(ke,{count:5,isError:this.state.listError,children:s.jsxs("div",{className:`nodata-bar add-func ${G()&&"click-off"}`,onClick:()=>{var e,t;if(!1===te(null==(t=null==(e=this.state)?void 0:e.jsonData)?void 0:t.length)){let e=se();if(null!==e&&4===(null==e?void 0:e.planId))return void this.setState({planId:e.planId});this.setState({isSeconduser:!0})}else this.props.history.push({pathname:"adduser",search:`?clientId=${this.state.cliendId}&add=true`,state:{userId:0}})},children:[s.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5"}),s.jsx("p",{children:"Create"})]})})}),!0===this.state.isSeconduser&&s.jsxs(be,{show:this.state.isSeconduser,centered:!0,size:"md",children:[s.jsxs(be.Header,{children:[s.jsx("h2",{children:"Users"}),s.jsx(Le,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isSeconduser:!1})}})]}),s.jsx(be.Body,{children:s.jsx("p",{children:"Users limit exceeded, please upgrade your plan."})}),s.jsxs("div",{className:"d-flex justify-content-end marginT30",children:[s.jsx(v,{onClick:()=>{this.setState({isSeconduser:!1})},children:"Cancel"}),s.jsx(f,{onClick:()=>{this.props.history.push("/subscription")},children:"Proceed"})]})]}),4===this.state.planId&&s.jsx(be,{show:!0,centered:!0,onHide:()=>this.setState({planId:0}),children:s.jsxs("div",{className:"d-flex align-items-center justify-content-start",children:[s.jsx("label",{className:"py10",children:"You have reached the maximum limit"}),s.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top5 right5 position-absolute",onClick:()=>this.setState({planId:0})})]})})]});case 1:return s.jsx("div",{className:"portlet-box-theme",children:s.jsx(Me,{cb:e=>this.updateIndex(e)})});case 2:return s.jsx("div",{className:"portlet-box-theme paddingT15 paddingB0",children:s.jsx(Be,{cb:e=>{this.updateIndex(e),this.getUserList()}})});default:return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"d-flex justify-content-between mt15 mb15",children:[s.jsx("h4",{className:"mb0 add-title",children:"User details"}),s.jsx("div",{className:"d-flex align-items-center",children:s.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-lg color-primary-blue cursor-pointer icon-shadow-blue",onClick:()=>{this.setState({currentIndex:1})}})})]}),s.jsxs(u,{data:null==(l=null==(a=this.state)?void 0:a.jsonData)?void 0:l.slice(this.state.skip,this.state.take+this.state.skip),total:null==(n=null==(i=this.state)?void 0:i.jsonData)?void 0:n.length,scrollable:"none",className:"grid-pagenation",pageable:{type:"input",pageSizes:[5,10,15],previousNext:!0},children:[s.jsx(h,{columnMenu:this.ColumnMenu,field:"name",title:"Name"}),s.jsx(h,{columnMenu:this.ColumnMenu,field:"jobFunctionName",title:"Job function"}),s.jsx(h,{columnMenu:this.ColumnMenu,field:"role",title:"Role new"}),s.jsx(h,{cell:e=>s.jsx("td",{children:s.jsx("div",{children:s.jsx(m,{className:"mt0",onChange:t=>this.handleChange(e.dataItem,t.target.value),checked:e.dataItem.checked})})})})]})]})}}))}columnProps(e){return{field:e,columnMenu:this.ColumnMenu,headerClassName:this.isColumnActive(e,this.state.dataState)?"active":""}}isColumnActive(e,t){return d.active(e,t.filter)||o.active(e,t.sort)}render(){return s.jsxs(p,{children:[s.jsx(De,{fluid:!0,className:"main-heading-wrapper mb0",children:s.jsxs(De,{className:"mhw-container",children:[s.jsx("div",{className:"mhwc-left",children:s.jsx("h1",{children:s.jsx("div",{className:"mh-wrapper",children:s.jsx("span",{className:"mh-text",children:Je[this.state.currentIndex]})})})}),s.jsx("div",{className:"mhwc-right",children:s.jsxs("div",{className:"back-text",onClick:()=>this.props.history.push("/preferences/company-list"),children:[s.jsx(N,{icon:b,size:"sm"}),"Back"]})})]})}),s.jsx(De,{className:"page-header",children:s.jsx(this.RenderComponent,{})})]})}}t(Ke,"contextType",g);const He=n(Ke),Je=["Users","Add a new user","Assign role to users"];class Ve extends i.Component{render(){return s.jsxs("div",{children:[s.jsx(o,{...this.props}),s.jsx(d,{...this.props,expanded:!0})]})}}var We=[{name:"Starts with"},{name:"Is equal to"},{name:"Is not equal to"},{name:"Contains"},{name:"Does not contains"},{name:"Ends with"}];const Xe=Object.freeze(Object.defineProperty({__proto__:null,TextColumnMenu:Ve,default:He},Symbol.toStringTag,{value:"Module"}));export{Me as A,He as C,ze as S,Ge as U,Be as a,Fe as b,Ee as c,Oe as d,Xe as e};
