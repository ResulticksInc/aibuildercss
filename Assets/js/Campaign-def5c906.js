var t,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O,q,V,z,$,H,G,W,_,J,Z,K,Y,X,Q,tt,et,it,st,at,nt,lt,ot,rt,ct,dt,pt,ht,ut,mt,vt,yt,gt,bt,ft,xt,St,Ct,jt,Tt,It,kt,Dt,At,wt,Nt,Lt,Et,Bt,Mt,Pt,Ft,Ut,Rt,Ot,qt,Vt,zt,$t,Ht,Gt,Wt,_t,Jt,Zt,Kt,Yt,Xt,Qt,te,ee,ie,se,ae,ne,le,oe,re,ce,de,pe,he,ue,me,ve,ye,ge,be,fe,xe,Se,Ce,je,Te,Ie,ke,De,Ae,we,Ne,Le,Ee,Be,Me,Pe,Fe,Ue,Re,Oe,qe,Ve,ze,$e,He,Ge,We,_e,Je,Ze,Ke,Ye,Xe,Qe,ti,ei,ii,si,ai,ni,li,oi,ri,ci,di,pi,hi,ui,mi,vi,yi,gi,bi,fi,xi,Si,Ci=Object.defineProperty,ji=(t,e,i)=>(((t,e,i)=>{e in t?Ci(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i);import{j as Ti,c as Ii,a as ki}from"./pdf-editor-be9d2bd2.js";import{r as Di,i as Ai,w as wi,R as Ni,u as Li,k as Ei,S as Bi,j as Mi}from"./react-vendor-379f659a.js";import{R as Pi,a as Fi}from"./RTabbar-119e28fb.js";import{L as Ui}from"./LayoutPageWrapper-c659fc07.js";import{p as Ri,e as Oi,f as qi,P as Vi,j as zi,k as $i,g as Hi,l as Gi,S as Wi,m as _i}from"./kendo-5d73125a.js";import{z as Ji,aC as Zi,al as Ki,bh as Yi,az as Xi,ar as Qi,aa as ts,aK as es,bi as is,F as ss,B as as,E as ns,be as ls,M as os,bj as rs,X as cs,bk as ds,bl as ps,bm as hs,bn as us,aj as ms,aB as vs,ai as ys,bo as gs,bp as bs,Y as fs,bq as xs,aL as Ss,aJ as Cs,aA as js,br as Ts,av as Is,a0 as ks,bs as Ds,bt as As,U as ws,a_ as Ns,a8 as Ls,bu as Es,bv as Bs,bw as Ms,bx as Ps,by as Fs,bz as Us,bA as Rs,bB as Os,bC as qs,bD as Vs,b6 as zs,bE as $s,bF as Hs,bG as Gs,bH as Ws,bI as _s,bJ as Js,bK as Zs,bL as Ks,Z as Ys,bM as Xs,bN as Qs,bO as ta,a$ as ea,bP as ia,aS as sa,bQ as aa,bR as na,bS as la,bT as oa,bU as ra,bV as ca,bW as da,bX as pa,bY as ha,bZ as ua,b_ as ma,b$ as va,c0 as ya,c1 as ga,ax as ba,c2 as fa,c3 as xa,c4 as Sa,c5 as Ca,c6 as ja,c7 as Ta,c8 as Ia,c9 as ka,ca as Da,cb as Aa,cc as wa,cd as Na,ce as La,cf as Ea,cg as Ba,ch as Ma,ci as Pa,cj as Fa,ck as Ua,cl as Ra,cm as Oa,cn as qa,co as Va,cp as za,cq as $a,cr as Ha,cs as Ga,ct as Wa,cu as _a,ad as Ja,aG as Za,cv as Ka,cw as Ya,au as Xa,aM as Qa,cx as tn,cy as en,cz as sn,cA as an,cB as nn,cC as ln,cD as on,cE as rn,cF as cn,cG as dn,cH as pn,cI as hn,cJ as un,cK as mn,cL as vn,cM as yn,cN as gn,cO as bn,cP as fn,cQ as xn,cR as Sn,cS as Cn,cT as jn,cU as Tn,cV as In,cW as kn,cX as Dn,cY as An,cZ as wn,c_ as Nn,c$ as Ln,d0 as En,d1 as Bn,aR as Mn,d2 as Pn,d3 as Fn,d4 as Un,d5 as Rn,d6 as On,d7 as qn,d8 as Vn,d9 as zn,da as $n,db as Hn,dc as Gn,dd as Wn,de as _n,df as Jn,dg as Zn,dh as Kn,di as Yn,am as Xn,dj as Qn,dk as tl,dl as el,dm as il,dn as sl,dp as al,dq as nl,dr as ll,ds as ol,dt as rl,du as cl,dv as dl,dw as pl,dx as hl,dy as ul,dz as ml,dA as vl,dB as yl,dC as gl,dD as bl,bg as fl}from"./index-75225e0a.js";import{c as xl,i as Sl,j as Cl,k as jl,l as Tl}from"./inputLimit-ce03b0f6.js";import{RSErrorPopup as Il,RSConfirmAlert as kl}from"./RSConfirmAlert-c9e1da8b.js";import{c as Dl,C as Al,a as wl,g as Nl,s as Ll,b as El,d as Bl,p as Ml,e as Pl}from"./CampaignListDetailComponent-fc98d88c.js";import{c as Fl,R as Ul,d as Rl,a as Ol}from"./RSKendoDropdown-89bac735.js";import{R as ql,a as Vl}from"./RSCheckbox-6c51a528.js";import"./style-a86a43a5.js";import{R as zl}from"./RSIcon-40715e67.js";import{R as $l}from"./RSFormGroup-2e23951f.js";import{R as Hl,a as Gl}from"./RSDropdowns-9012b9eb.js";import{S as Wl}from"./constantObject-ca27cf51.js";import{M as _l,R as Jl,a as Zl,C as Kl,L as Yl,d as Xl,e as Ql,A as to,c as eo}from"./ui-a5a97ebf.js";import{g as io,R as so}from"./RSPDateRangePicker-68a13ef6.js";import{h as ao,q as no}from"./utils-16c7e021.js";import"./constants-82903eb8.js";import{S as lo}from"./SkeletonCampaignList-1c72fe74.js";import{S as oo}from"./SkeletonTable-f73684ed.js";import{R as ro}from"./RSPAdvancedCampaignSearch-0c844ae8.js";import{m as co,b as po}from"./mobx-e1586d6a.js";import{a as ho,S as uo,M as mo}from"./index-ea0ef9a3.js";import{L as vo}from"./ListView-669adc45.js";import{C as yo,a as go}from"./Skeleton-e3c7c022.js";import{N as bo}from"./NPreview-1e4e2d37.js";import{K as fo}from"./IconDropdown-19f04dbc.js";import{F as xo}from"./FormFieldIcon-388bc468.js";import{C as So}from"./CompanyListDropdown-aceaadaa.js";import{P as Co,S as jo,C as To,p as Io,a as ko,b as Do}from"./CampaignCompletion-4b9f2492.js";import{F as Ao}from"./FormLabel-7c8c6237.js";import{F as wo}from"./FormListWrapper-0cd539ec.js";import{U as No,E as Lo,a as Eo,b as Bo}from"./main-deb74f02.js";import{F as Mo}from"./FormLabelIcon-f96ecad7.js";import{S as Po}from"./SmallText-769b7f67.js";import{R as Fo}from"./RSDatePicker-bf1e95a8.js";import{$ as Uo,d as Ro}from"./interactive-8d7fd0b1.js";import{R as Oo}from"./NewAttribute-c47792e6.js";import{R as qo}from"./RSSwitch-b5eda9e2.js";import{R as Vo}from"./RSDatetimePicker-f9438f81.js";import{r as zo,C as $o,Z as Ho,P as Go,a as Wo,s as _o,R as Jo}from"./Preference-7a793070.js";import{R as Zo}from"./RSPTemplateList-b850a8da.js";import{r as Ko}from"./react-router-dom.min-6f8d67fa.js";import{B as Yo}from"./BootstrapDropdown-f79019e1.js";import"./index-44141e50.js";import{f as Xo,i as Qo,F as tr}from"./FieldTracking-406ae247.js";import{P as er,a as ir,E as sr,C as ar,b as nr,c as lr,d as or,e as rr,S as cr,f as dr}from"./PreferenceAnalyticks-94f3aae0.js";import{s as pr}from"./rsp-email-library.es-ad77ae30.js";import"./Features.styled-9337e765.js";import"./Engagement-e8cd642c.js";import hr from"./RSBanner-2c94f2e5.js";import"./drag-drop-4af74c4a.js";import"./Tooltip-c6e1c4bf.js";import"./styles-acfba09e.js";import"./charts-f2096496.js";import"./index-c56b47e9.js";import"./HPIconDropdownComponent-98e04ced.js";import"./get-4aa85b1a.js";import"./index-8cac4852.js";import"./tslib.es6-1635a32f.js";import"./CompanyUserList-6f3010b3.js";import"./RSPhoneInput-a07ff6f4.js";import"./ChannelGoalsData-c96a6d6b.js";import"./BOFController-1a1b9fda.js";import"./NewCharts-e0e49dc6.js";import"./Colors-8a9fdcf2.js";import"./map-99306e6f.js";const ur=t=>{var e;const[i,s]=Di.useState(!1),[a,n]=Di.useState(""),[l,o]=Di.useState(""),[r,c]=Di.useState(null),[d,p]=Di.useState(!1),[h,u]=Di.useState(null),[m,v]=Di.useState(!1),[y,g]=Di.useState(!1),[b,f]=Di.useState(!1),[x,S]=Di.useState(!1),C=Ai(),j=Di.useContext(Ji);Di.useState(!1);const[T,I]=Di.useState(!1),[k,D]=Di.useState(!1),[A,w]=Di.useState(!1);Di.useEffect((()=>{let t=!1,e=!1,i=!1;const s=Zi("Communications");(null==s?void 0:s.accessViewData)&&(t=!0),e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(i=!0),I(t),D(e),w(i)}),[]);const N=()=>{var e,i,s,a;return 8===(null==(e=null==t?void 0:t.dataItem)?void 0:e.jobStatusId)||6===(null==(i=null==t?void 0:t.dataItem)?void 0:i.jobStatusId)||0===(null==(s=null==t?void 0:t.dataItem)?void 0:s.jobStatusId)?mr(t.dataItem.campaignStatusId):yr(null==(a=null==t?void 0:t.dataItem)?void 0:a.jobStatusId)};return Ti.jsxs(Ti.Fragment,{children:[!0===d&&Ti.jsx(Il,{headerTitle:"Sorry",para:h,primaryButtonText:"OK",buttonClicked:t=>{p(!1)}}),m&&Ti.jsx(Il,{size:"md",headerTitle:"Communication",para:"Communication limit exceeded, please upgrade your plan.",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:t=>{v(!1),!0===t&&C.push("/subscription")}}),Ti.jsx("td",{children:Ti.jsxs("div",{className:`rs-communication-list campaign-analytics-list ${N().className} `,children:[Ti.jsxs("div",{className:"communication-content",children:[Ti.jsx("span",{className:"badge",children:window.btoa(t.dataItem.campaignId)}),Ti.jsxs("small",{children:["Created by: ",""===(null==(e=null==t?void 0:t.dataItem)?void 0:e.userFirstName)?Wl:t.dataItem.userFirstName&&t.dataItem.userFirstName,", on: ",Ki(t.dataItem.createdDate,!1)]}),Ti.jsx("p",{className:"py5",children:null==t?void 0:t.dataItem.campaignName}),null!==t.dataItem.tags&&""!==t.dataItem.tags&&Ti.jsxs("span",{className:"rsclc-tags d-flex align-items-end",children:[Ti.jsx("i",{className:`${Yi} icon-md`}),t.dataItem.tags]})]}),Ti.jsxs("div",{className:"communication-content",children:[Ti.jsx("small",{children:t.dataItem.deliveryType}),Ti.jsx("p",{title:`${t.dataItem.campaignType}`,children:t.dataItem.campaignType})]}),Ti.jsxs("div",{className:"communication-content",children:[Ti.jsx("small",{children:"Total audience"}),Ti.jsx("p",{children:0===t.dataItem.numberOfRecipients||"Event trigger"===t.dataItem.deliveryType?"NA":t.dataItem.numberOfRecipients})]}),Ti.jsxs("div",{className:"communication-content",children:[Ti.jsx("div",{className:`communication-status ${N().className}`,children:Ti.jsx("small",{children:`${N().title}`})}),Ti.jsx("div",{className:"rs-communication-icon",children:Ti.jsxs(Xi,{children:[Ti.jsx(Qi,{tooltip:"Edit",icon:"icon-rs-pencil-edit-medium "+(k?"click-on":"click-off"),size:"md",mainClass:"ml10",onClick:()=>{localStorage.setItem("cId",t.dataItem.campaignId);let e={mode:"edit",isSmartlinkCampaign:"N"!==t.dataItem.isSmartLinkCampaign,campaignName:t.dataItem.campaignName,statusId:t.dataItem.campaignStatusId,status:mr(t.dataItem.campaignStatusId).title,campaignId:t.dataItem.campaignId};ts(e),t.navigation.push({pathname:"campaign/planning",search:`?cId=${t.dataItem.campaignId}&sl=${"N"!==t.dataItem.isSmartLinkCampaign}&cs=${t.dataItem.campaignStatusId}`,state:{mode:"edit",isSmartlinkCampaign:"N"!==t.dataItem.isSmartLinkCampaign,campaignName:t.dataItem.campaignName,statusId:t.dataItem.campaignStatusId,status:mr(t.dataItem.campaignStatusId).title,jobStatusId:t.dataItem.jobStatusId}})}}),3!==t.dataItem.campaignStatusId&&4!==t.dataItem.campaignStatusId&&Ti.jsx(Qi,{tooltip:"Report",icon:`icon-rs-analytics-medium ${7===t.dataItem.campaignStatusId||52===t.dataItem.campaignStatusId||6===t.dataItem.campaignStatusId||0===t.dataItem.campaignStatusId?"click-off":""} ${T?"click-on":"click-off"}`,size:"md",iconName:7===t.dataItem.campaignStatusId||52===t.dataItem.campaignStatusId||6===t.dataItem.campaignStatusId||0===t.dataItem.campaignStatusId?"click-off":"",onClick:()=>{t.navigation.push({pathname:"analytics/detail-analytics",state:{deliveryType:t.dataItem.deliveryType,campaignId:t.dataItem.campaignId,guiId:t.dataItem.campaignGuid,isSmartlink:"Y"===t.dataItem.isSmartLinkCampaign}})}}),"event trigger"===t.dataItem.deliveryType.toLowerCase()?Ti.jsx(Qi,{disabled:!0===es()||0!==t.dataItem.campaignStatusId&&6!==t.dataItem.campaignStatusId&&9!==t.dataItem.campaignStatusId,tooltip:"Duplicate",icon:"icon-rs-duplicate-medium "+(k?"click-on":"click-off"),size:"md",mainClass:"ml10 ",iconName:`${!0===es()&&"click-off"}`,onClick:()=>{!1!==is(t.monthlyCount)?(o(t.dataItem.campaignId),n(t.dataItem.campaignName+"_Copy"),s(!0)):v(!0)}}):null,"single dimension"===t.dataItem.deliveryType.toLowerCase()?Ti.jsx(Qi,{disabled:!0===es(),tooltip:"Duplicate",icon:"icon-rs-duplicate-medium",size:"md",iconName:`${!0===es()&&"click-off"}`,onClick:()=>{!1!==is(t.monthlyCount)?(o(t.dataItem.campaignId),n(t.dataItem.campaignName+"_Copy"),s(!0)):v(!0)}}):null]})})]}),Ti.jsx("div",{className:`expand-plus ${N().className}`,children:Ti.jsx("ul",{className:"camp-icon-pannel",children:Ti.jsx("li",{children:Ti.jsx("i",{className:"k-icon k-i-plus"})})})})]})}),i&&Ti.jsxs(_l,{show:i,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Duplicate communication"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{s(!1),c(null)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:12,children:Ti.jsx(ql,{placeholder:0===a.length?"Enter communication name":"Communication name",val:a,max:xl,icon:y?"icon-rs-circle-tick-medium icons-md green":"",required:!0,errorMessage:r,isLoading:b,cb:t=>{let e=t.length>0?null:"Enter communication name";c(e),t.includes("'")||(""===t||/^[' 'A-Za-z0-9_-]*$/.test(t))&&(n(t),c(null))},ob:t=>{let e=t.length>0?null:"Enter communication name";c(e),t.includes("'")||(f(!0),Dl(t,j,(t=>{f(!1),!0===t[0]?(S(!0),c(t[1]),g(!1)):(S(!1),g(!0))})))}})})})}),Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{xs:12,children:Ti.jsx("div",{style:{padding:"5px",marginBottom:"5px",backgroundColor:"#fffbeb",border:"1px solid #fcd34d",borderRadius:"6px"},children:Ti.jsxs("div",{style:{display:"flex"},children:[Ti.jsx("div",{style:{flexShrink:0,marginTop:10},children:Ti.jsx("svg",{style:{height:"20px",width:"20px",color:"#f59e0b"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:Ti.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),Ti.jsx("div",{style:{marginLeft:"8px"},children:Ti.jsx("div",{style:{marginTop:"8px",fontSize:"14px",color:"#a16207"},children:Ti.jsx("p",{children:"Note : For communication with dynamic zones, the authoring content will reset on duplication."})})})]})})})})})]}),Ti.jsx(_l.Footer,{children:Ti.jsx("div",{className:"m0",children:Ti.jsxs("div",{className:"btn-container d-flex justify-content-end mb0 "+(ss(a)?"click-off":"click-on"),children:[Ti.jsx(as,{onClick:()=>{s(!1),c(null)},children:"Cancel"}),Ti.jsx("div",{className:x?"click-off":"click-on",children:Ti.jsx(ns,{onClick:()=>{if(S(!0),ss(a)||0===a.trim().length)return c("Enter communication name"),void n(a.trim());f(!0),Dl(a,j,(e=>{f(!1),!0===e[0]?(c(e[1]),g(!1)):(g(!0),t.isCampaignDublicate(t.dataItem),((e,i)=>{t.context.apiStateData.setIsReloadData(!0);let s={userId:ls(),campaignId:e,campaignName:i,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:rs,params:s,sessionOut:t.context.apiStateData.setSessionOutData,loading:t.context.apiStateData.setIsReloadData,ok:e=>{if(t.context.apiStateData.setIsReloadData(!1),e.status){let i=(null==e?void 0:e.data)||[];t.callback(i)}else p(!0),u((null==e?void 0:e.message)||cs)},fail:e=>{t.context.apiStateData.setIsReloadData(!1)}})})(l,a))}))},children:"Save"})})]})})})]})]})},mr=t=>vr[t],vr={0:{title:"Draft",className:"status-draft",icon:"icon-rs-form-edit-large",id:0},5:{title:"In progress",className:"status-inprogress",icon:"icon-rs-in-progress-large",id:5},52:{title:"Alert",className:"status-alert",icon:"icon-rs-alert-large",id:52},9:{title:"Completed",className:"status-completed",icon:"icon-rs-tick-large",id:9},7:{title:"Scheduled",className:"status-scheduled",icon:"icon-rs-circle-time-large",id:7},20:{title:"Multi status",className:"status-multistatus",icon:"icon-rs-multi-status-large",id:20},6:{title:"Draft",className:"status-draft",icon:"icon-rs-form-edit-large",id:6}},yr=t=>gr[t],gr={6:{title:"",className:"",icon:"",id:0},0:{title:"",className:"",icon:"",id:0},9:{title:"Paused",className:"status-inprogress-et-pause",icon:"icon-rs-in-progress-large",id:5},10:{title:"Stopped",className:"status-inprogress-et-stopped",icon:"icon-rs-alert-large",id:52},20:{title:"Multi status",className:"status-multistatus",icon:"icon-rs-multi-status-large",id:20}},br=new class{constructor(){ji(this,"campaignPlan",{timeZoneId:64,userId:3366,industryId:1,marketId:1,regionId:1,customerTypeId:1,brandAffinityId:1,regionName:"sng",clientDateTimeFormat:1,departmentId:"1",databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409",isSmartlink:!1,campaignId:0,clientId:4807,clientName:"Smartdx codes",campaignType:"S",campaignName:"RR_11Nov_SDC_Test1",campaignAttributeId:8,productCategoryId:2,primaryTargetCode:"Reach",primaryTargetValue:"3.20",conversionType:"S",isCampaignGroup:"N",startDate:"2024-11-11 12:00:00",endDate:"2024-11-14 12:00:00",isFrquenencyEnabled:!1,dynamicListId:0,dynamicListName:"-- Select your dynamic list  --",channelType:["Web push","Mobile push"],socialMedia:[],paidAds:[],goalType:{conversionName:"-- Select goal type --",conversionTypeId:-1},analyticsType:["Web","App"],frequency:{frequency:"",data:{}},timeZone:"(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi ",daylightSavings:!1,tags:["AI Campaign"],secondaryTargetCode:"",secondaryTargetValue:"",secondadoryGoalType:null}),ji(this,"smartlinkGeneration",{campaignId:"1832",goalNo:1,smartCode:"",domainUrl:"https://slg.smartdx.co/",smartAdaptive:"",smartUrl:"https://run.smartdx.co",data:{web:{url:"https://run.smartdx.co",queryString:"",mobileAdaptiveUrl:"",customParameters:[],IsCheckedAndroid:!1,IsCheckedIos:!1,IsCheckedAll:!1,errorMessage:{errUrl:null,errAdaptive:null},parameter:[]},mobilePlatform:[{deviceType:"Android phone",appId:"",appName:{appName:"Power maxz",appGuid:"d2777428-7407-47af-a813-c8a1b4710c36",mpId:"1",playstoreURL:[{fcmserverKey:!0,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"1"},{fcmserverKey:!1,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"3"},{fcmserverKey:!0,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"1"},{fcmserverKey:!0,url:"https://appstoreconnect.apple.com/WebObjects/iTunesConnect.woa/ra/ng/app/1495969772/testflight?section=build&subsection=testers&id=13ef02fa-df56-47f6-b777-9e76b2618d4a",platformId:"3"}],appId:"d2777428-7407-47af-a813-c8a1b4710c36"},isDeeplinkEnabled:!0,mainScreenName:{displayName:"LauncherActivity",activityName:"com.visionretail.view.activity.LauncherActivity",deepLinkUrl:"intent://launcher/#Intent;scheme=launcheractivity;package=com.interakt.visionretail",storeUrl:"https://play.google.com/store/apps/details?id=com.interakt.visionbank"},activityDisplayName:"",subScreenName:"DashboardFragment",IsCheckedAll:!1,utmparameter:!1,customParameters:[],IsCheckedAndroid:!1,androidUTMClicked:!1,iOSUTMClicked:!1,IsCheckedIos:!1,errorMessage:{errDeviceType:null,errMobileApp:null,errMainScreen:null,errSubScreen:null},parameter:[]},{deviceType:"iPhone",appId:"d2777428-7407-47af-a813-c8a1b4710c36",appName:{appId:"d2777428-7407-47af-a813-c8a1b4710c36",appName:"Power maxz"},isDeeplinkEnabled:!0,mainScreenName:{displayName:"Test1",activityName:"Test1",storeUrl:"https://play.google.com/store/apps/details?id=com.interakt.visionbank"},activityDisplayName:"",subScreenName:null,IsCheckedAll:!1,utmparameter:!1,customParameters:[],IsCheckedAndroid:!1,androidUTMClicked:!1,iOSUTMClicked:!1,IsCheckedIos:!1,errorMessage:{errDeviceType:null,errMobileApp:"",errMainScreen:null,errSubScreen:""},parameter:[]}]}}),ji(this,"channelCreation",{web:{campaignId:"1832",isDuplicate:"false",domainLevel:"-- Select push type --",domainLevelId:0,weburl:"https://visiontel.qa.smartdx.co/",domainName:{fcmserverKey:!0,onBoardingId:6,domainId:"0e848a24-0869-4376-b1ea-7f66de8e7b71",domainName:"VI-_",domainUrl:"https://visiontel.qa.smartdx.co/"},deliveryTypeValue:"Alert / Rich push",deliveryTypeId:1,inboxClassification:"Loans",inboxClassificationId:16,pushLayoutValue:"-- Select push layout --",pushLayoutId:0,positionValue:"-- Select position --",positionId:0,isCarousel:!1,isSplit:!1,secure:!1,pushNotifyChannelDetailID:8,testPushCampaignEmailAddress:null,statusId:6,requestForApproval:{isWorkflowEnabled:!1,matchType:"",matchCount:"",approvarList:[{approvarId:"",approvarName:"",flag:!1}]},content:[{splitType:"",title:"RR_Test1",shortDesc:"",titleColor:"",bgColor:"",makeAlert:!1,subTitle:"",body:"RR_Test1",bodyTextColor:"",bodyBgColor:"",contentType:"R",htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",timezone:"",timezoneId:64,makeAsAlert:!0,isInteractivebuttonEnabled:!0,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"Dismiss",interActivityButton2Name:"",interActivity:[{actionName:"Dismiss",actionId:2,actionType:"dismiss",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""}],hashTag:["#Test1"],edmUrl:"",url:"",titlePosition:8,bodyPosition:8,localScheduleTime:""}]},mobile:{campaignId:"1832",isDuplicate:"false",domainLevel:"",domainLevelId:0,weburl:"",domainName:null,deliveryTypeValue:"Alert / Rich push",deliveryTypeId:1,inboxClassification:"",inboxClassificationId:0,pushLayoutValue:"Default",pushLayoutId:5,positionValue:"-- Select position --",positionId:0,isCarousel:!1,isSplit:!1,secure:!1,pushNotifyChannelDetailID:14,testPushCampaignEmailAddress:null,requestForApproval:{isWorkflowEnabled:!1,matchType:"",matchCount:"",approvarList:[{approvarId:"",approvarName:"",flag:!1}]},content:[{splitType:"A",title:"RR_Mobile_Test1",edmUrl:"",titleColor:"",bgColor:"",subTitle:"RR_Mobile_Test1",body:"<p>RR_Mobile_Test1</p>",url:"",bodyTextColor:"",bodyBgColor:"",contentType:"R",htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",localScheduleTime:"",makeAsAlert:!0,isInteractivebuttonEnabled:!0,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"-- Select alert sound --",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"Dismiss",interActivityButton2Name:"SmartLink1",interActivity:[{actionName:"Dismiss",actionId:2,actionType:"dismiss",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""}],timezone:"Select time zone",timezoneId:64,hashTag:["#Mobile"],isAutoSplit:!0,splitDuration:8,splitInterval:"Hours",recipientsPercentage:10,titlePosition:0,subTitlePosition:15,htmlBody:"<p>RR_Mobile_Test1</p>"}],appId:"d2777428-7407-47af-a813-c8a1b4710c36",mpId:"1",appName:"Power maxz"}}),ji(this,"analyticsCreation",{web:{domainType:"SX",analyticsSettingId:3,campaignId:"1832",channelId:6,domainUrlList:[{domainNameURL:"https://run.smartdx.co"}]},mobile:{analyticsType:"RA",campaignId:"1832",mobileAppGuId:"d2777428-7407-47af-a813-c8a1b4710c36",mobileDataJson:[{deviceType:"Android phone",appId:"",appName:{appName:"Power maxz",appGuid:"d2777428-7407-47af-a813-c8a1b4710c36",mpId:"1",playstoreURL:[{fcmserverKey:!0,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"1"},{fcmserverKey:!1,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"3"},{fcmserverKey:!0,url:"https://play.google.com/store/apps/details?id=com.interakt.visionbank",platformId:"1"},{fcmserverKey:!0,url:"https://appstoreconnect.apple.com/WebObjects/iTunesConnect.woa/ra/ng/app/1495969772/testflight?section=build&subsection=testers&id=13ef02fa-df56-47f6-b777-9e76b2618d4a",platformId:"3"}],appId:"d2777428-7407-47af-a813-c8a1b4710c36"},isDeeplinkEnabled:!0,mainScreenName:{displayName:"LauncherActivity",activityName:"com.visionretail.view.activity.LauncherActivity",deepLinkUrl:"intent://launcher/#Intent;scheme=launcheractivity;package=com.interakt.visionretail",storeUrl:"https://play.google.com/store/apps/details?id=com.interakt.visionbank"},activityDisplayName:"",subScreenName:"DashboardFragment",IsCheckedAll:!1,utmparameter:!1,customParameters:[],IsCheckedAndroid:!1,androidUTMClicked:!1,iOSUTMClicked:!1,IsCheckedIos:!1,errorMessage:{errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null},parameter:[]},{deviceType:"iPhone",appId:"d2777428-7407-47af-a813-c8a1b4710c36",appName:{appId:"d2777428-7407-47af-a813-c8a1b4710c36",appName:"Power maxz"},isDeeplinkEnabled:!0,mainScreenName:{displayName:"Test1",activityName:"Test1",storeUrl:"https://play.google.com/store/apps/details?id=com.interakt.visionbank"},activityDisplayName:"",subScreenName:null,IsCheckedAll:!1,utmparameter:!1,customParameters:[],IsCheckedAndroid:!1,androidUTMClicked:!1,iOSUTMClicked:!1,IsCheckedIos:!1,errorMessage:{errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null},parameter:[]}],recipientFormID:"0"}}),ji(this,"saveCampaign",((t,e)=>{this.campaignPlan.campaignId=0,this.createPlan((t=>{if(null==t?void 0:t.status){let e=t.data.campaignId;this.smartlinkGeneration.campaignId=e,this.createSmartLink((t=>{(null==t?void 0:t.status)&&(this.channelCreation.web.campaignId=e,this.saveWebPush((t=>{(null==t?void 0:t.status)&&(this.channelCreation.mobile.campaignId=e,this.saveMobilePush((t=>{})))})))}))}}))})),ji(this,"saveMobilePush",(t=>{os({path:ds,params:this.channelCreation.mobile,ok:e=>{e.status?t(e):t({status:!1})},fail:e=>{t({status:!1})}})})),ji(this,"saveWebPush",(t=>{os({path:ps,params:this.channelCreation.web,ok:e=>{e.status?t(e):t({status:!1})},fail:e=>{t({status:!1})}})})),ji(this,"createSmartLink",(t=>{os({path:hs,params:this.smartlinkGeneration,ok:e=>{e.status?t(e):t({status:!1})},fail:e=>{t({status:!1})}})})),ji(this,"createPlan",(t=>{this.campaignPlan.campaignName=this.removeSpecialCharactersAndExtraSpaces(this.campaignPlan.campaignName),os({path:us,params:this.campaignPlan,ok:e=>{e.status?t(e):t({status:!1})},fail:e=>{t({status:!1})}})})),ji(this,"prepareWebNotificationData",((t,e,i,s)=>{var a,n;this.channelCreation.web.campaignId=t,this.channelCreation.web.weburl=null==(n=null==(a=null==e?void 0:e.data)?void 0:a.web)?void 0:n.url,this.channelCreation.web.domainName.onBoardingId=s.webId,this.channelCreation.web.domainName.domainUrl=s.weburl,this.channelCreation.web.content.map((t=>{t.title=s.title,t.body=s.body,t.url=i,t.interActivity=s.interActivity}))})),ji(this,"prepareMobileNotificationData",((t,e,i,s)=>{this.channelCreation.mobile.campaignId=t,this.channelCreation.mobile.appId=e.data.mobilePlatform[0].appName.appGuid,this.channelCreation.mobile.appName=e.data.mobilePlatform[0].appName.appName,this.channelCreation.mobile.content.map((t=>{t.title=s.title,t.body=s.body,t.url=i,t.subTitle=s.subTitle,t.htmlBody=s.htmlBody,t.interActivity=s.interActivity}))})),co(this)}removeSpecialCharactersAndExtraSpaces(t){return t.replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g," ")}},fr=t=>{const[e,i]=Di.useState(!0===(null==t?void 0:t.isRotate));Di.useEffect((()=>{const t=setTimeout((()=>{i(!1)}),1e4);return()=>clearTimeout(t)}),[]),Di.useEffect((()=>{!0===(null==t?void 0:t.isRotate)&&i(!0)}),[null==t?void 0:t.isRotate]);const s=()=>Ti.jsx("button",{className:"aibutton "+(e?"rotating":""),onClick:()=>t.onClick(),children:Ti.jsx("img",{src:ho,alt:"button-icon",className:"aibutton-image"})});return Ti.jsx(Ti.Fragment,{children:!0===(null==t?void 0:t.initialLoading)?Ti.jsx("div",{className:"aicontainer",children:Ti.jsxs("div",{className:"animated-text",children:[Ti.jsx("label",{style:{display:"flex",alignItems:"center"},children:"How can I help you today?"}),Ti.jsx(s,{})]})}):Ti.jsx(s,{})})},xr=["Dismiss","Maybe later","Unsubscribe","Custom action"],Sr=["Dismiss","Unsubscribe","Custom action"],Cr=["Minute(s)","Hour(s)","Day(s)"],jr=["Hour(s)","Day(s)"],Tr=[{pushLayoutValue:"Full screen",pushLayoutId:1},{pushLayoutValue:"Modal",pushLayoutId:3},{pushLayoutValue:"Carousel",pushLayoutId:4}],Ir=[{positionValue:"Top",positionId:1},{positionValue:"Bottom",positionId:2},{positionValue:"Center",positionId:3}],kr=["Notification","Emergency","-- Enter sound name --"],Dr=(t,e,i)=>{let s=null,a=0;return t.forEach((t=>{const n=t[i].toLowerCase(),l=e.toLowerCase();let o=0;for(let e=0;e<l.length;e++)n.includes(l[e])&&o++;o>a&&(a=o,s=t)})),s},Ar=()=>{var t,e,i,s,a,n,l,o,r;let c=JSON.parse(sessionStorage.getItem("companyDetails"))||null,d=ms();return`\n    Company Information for Marketing Campaign Generation:\n    ${null!==(null==c?void 0:c.clientName)&&void 0!==(null==c?void 0:c.clientName)&&`1. Company Details:\n        - Name: ${null==c?void 0:c.clientName}\n        - Industry: ${null==(e=null==(t=null==c?void 0:c.lstIndustry)?void 0:t.filter((t=>t.industryId===(null==c?void 0:c.industryId)))[0])?void 0:e.industryName}\n        full data ${JSON.stringify(c)}`}\n\n2. Available Products:\n ${null==(i=d.productCategorysList)?void 0:i.map((t=>`- ${t.categoryName} (ID: ${t.categoryId})`)).join("\n")}\n\n3.Campaign Attributes:\n    ${null==(s=d.campaignAttributeList)?void 0:s.map((t=>`- ${t.attributeName} (ID: ${t.campaignAttributeId})`)).join("\n")}\n\n4.Mobile Apps:\n    ${null==(a=d.mobileAppsList)?void 0:a.map((t=>`- ${t.appName} (GUID: ${t.appGuid})`)).join("\n")}\n\n 5. Goal Selection: ['Reach', 'Engagement', 'Conversion']\n\n    6. Engagement List:  ${null==(n=d.engagementList)?void 0:n.map((t=>`- ${t.conversionName} (ID: ${t.conversionTypeId})`)).join("\n")}\n\n    7. Conversion List:  ${null==(l=d.conversionTypeList)?void 0:l.map((t=>`- ${t.conversionName} (ID: ${t.conversionTypeId})`)).join("\n")}\n\n    8. ShortCode List: ${null==(o=d.shortCodeDomainList)?void 0:o.map((t=>`- ${t}`)).join("\n")}\n\n    9.Domain List:\n    ${null==(r=d.domainsList)?void 0:r.map((t=>`- ${t.domainUrl}`)).join("\n")}\n\n    10. Device type : ["Android phone","iPhone","Android Tablet","iPad"]\n\n\n11. Marketing Channels:\n- Mobile Push Notifications\n- Web Push Notifications\n\n12 . Interactivity Buttons:\n    12.1 Reach goal interactivity:  ${[{actionName:"Dismiss",actionId:2,actionType:"dismiss",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""},{actionName:"May be later",actionId:3,actionType:"maybelater",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"Minute(s)",interactivehours:0,reschedule:"",value:"2"}].map((t=>`- ${t.actionName} (ID: ${t.actionId})`)).join("\n")}\n    12.2 Engagement goal interactivity:  ${[{actionName:"",actionId:6,actionType:"samartlink 1",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""},{actionName:"",actionId:7,actionType:"smartlink 2",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"Minute(s)",interactivehours:0,reschedule:"",value:"2"}].map((t=>`- ${t.actionType} (ID: ${t.actionId})`)).join("\n")}\n    12.3 Conversion goal interactivity:  ${[{actionName:"",actionId:6,actionType:"samartlink 1",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""},{actionName:"",actionId:7,actionType:"smartlink 2",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"Minute(s)",interactivehours:0,reschedule:"",value:"2"}].map((t=>`- ${t.actionType} (ID: ${t.actionId})`)).join("\n")}\n\n\n\n\n\nInstructions:\n- Generate campaigns that align with these specifications\n- Ensure realistic and implementable marketing strategies\n- Focus on digital-first approach\n- Highlight unique product features\n- Target specified audience segments\n`},wr=po((({isOpen:t,onClose:e,initialContent:i,onGenerate:s,type:a="text"})=>{const[n,l]=Di.useState(i),[o,r]=Di.useState(!1),[c,d]=Di.useState(""),[p,h]=Di.useState(null);Di.useContext(Ji);const[u,m]=Di.useState(null),[v,y]=Di.useState(!1),[g,b]=Di.useState(null),[f,x]=Di.useState(""),[S,C]=Di.useState(!1),[j,T]=Di.useState(!0),[I,k]=Di.useState(!1);Di.useState(null);const[D,A]=Di.useState(null),[w,N]=Di.useState(null);if(Di.useEffect((()=>{let t=ms();m(t),setTimeout((()=>{T(!1)}),5e3)}),[]),!t)return null;const L=async()=>{if(!n.trim())return void d("Please enter a prompt");r(!0),d(""),C(!1),h(null),y(!v);let t=n;t=(t=>(t=>(t=>`\n    Generate a campaign plan in this exact JSON structure:\n    {\n        "communicationName": "Create a descriptive campaign name based on ${t} ignore the special characters of(:)",\n        "communicationType": {\n            "campaignAttributeId": "Select most appropriate ID for ${t}" // provide the integer value,\n            "attributeName": "Matching attribute name"\n        },\n        "productCategory": {\n            "categoryId": "Select most relevant ID for ${t}" // provide the integer value,\n            "categoryName": "Matching category name"\n        },\n        "goal": "Select most appropriate goal type for ${t}",  // available goal list\n        "engagementType":{\n            "conversionName": "Matching engagement name", // available engagement list\n            "conversionTypeId": "Select most appropriate ID for ${t}"\n        },\n        "conversionType": {\n            "conversionName": "Matching conversation name", // available conversion list\n            "conversionTypeId": "Select most appropriate ID for ${t}"\n        },\n        channelType: [Matching channel list name], // static content dont change\n        "tags":["AI Campaign"]\n        \n    }\n\n\n\n\n    Content Guidelines:\n    1. Campaign Type Selection:\n       - Analyze "${t}" to determine most appropriate campaign type\n       - Choose relevant product category based on campaign context\n       - Select channels based on target audience and message type\n\n    2. Content Creation:\n       - Titles: Create engaging, context-specific titles (max 60 characters)\n       - Descriptions: Write compelling copy that relates to ${t} (max 350 characters)\n       - Banner Images: Suggest relevant image URL campaign theme\n       - Each channel should have unique, platform-appropriate content\n\n    3. Technical Requirements:\n       - Use exact IDs and names from the provided options\n       - campaignAttributeId must be integer\n        "communicationType": {\n            "campaignAttributeId": integer,\n            "attributeName": "Matching attribute name"\n        }\n        "productCategory": {\n            "categoryId": integer,\n            "categoryName": "Matching category name"\n        },\n       - Include mobile app details only if Mobile Push is selected\n       - Format schedule date as "DD MM YYYY"\n       - Ensure all JSON fields are properly formatted\n       - If goal is "Conversion", include conversion type details\n       - If goal is "Engagement", include engagement type details\n       - Response must be a JSON object\n    \n\n    Generate content that is relevant, engaging, and appropriate for ${t}. Fill the output json and provide the API response like output json\n\n\n    \n    `)(t))(t))(t),x("AI is creating communication for your requirements ..."),x("Generating content for communication plan ..."),E(t,(t=>{B(t)}))},E=async(t,e)=>{(async(t,e)=>{let i=t,s={model:"gpt-4o",messages:[{role:"system",content:`You are a professional marketing strategist for a company below i attached company details ${Ar()}. Given the user's campaign prompt: ${i} `},{role:"user",content:i}],temperature:.1,max_tokens:1024,top_p:.95,frequency_penalty:0,presence_penalty:0,response_format:{type:"json_object"}};try{const t=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${{}.VITE_OPENAI_API_KEY}`},body:JSON.stringify({...s,response_format:{type:"json_object"},temperature:.1})});if(!t.ok)throw new Error("Failed to generate content");const i=await t.json();if(null!==i){const t=i.choices[0].message.content.trim();e(JSON.parse(t))}}catch(a){d(a.message)}})(t,(t=>{e(t)}))},B=t=>{var i,s,a,l,o,c,p,h,u,m,v,y;let g=ms();br.campaignPlan.campaignName=null==t?void 0:t.communicationName,br.campaignPlan.campaignAttributeId=null!==(null==(i=null==t?void 0:t.communicationType)?void 0:i.campaignAttributeId)?null==(s=null==t?void 0:t.communicationType)?void 0:s.campaignAttributeId:null==(a=g.campaignAttributeList[0])?void 0:a.campaignAttributeId,br.campaignPlan.productCategoryId=null!==(null==(l=null==t?void 0:t.productCategory)?void 0:l.categoryId)?null==(o=null==t?void 0:t.productCategory)?void 0:o.categoryId:(null==(c=g.productCategorysList[0])?void 0:c.categoryId)||0,br.campaignPlan.primaryTargetCode=null!==(null==t?void 0:t.goal)?null==t?void 0:t.goal:"R","engagement"===(null==(p=null==t?void 0:t.goal)?void 0:p.toLowerCase())&&(br.campaignPlan.goalType.conversionName=null==(h=null==t?void 0:t.engagementType)?void 0:h.conversionName,br.campaignPlan.goalType.conversionTypeId=null==(u=null==t?void 0:t.engagementType)?void 0:u.conversionTypeId),"conversion"===(null==(m=null==t?void 0:t.goal)?void 0:m.toLowerCase())&&(br.campaignPlan.goalType.conversionName=null==(v=null==t?void 0:t.conversionType)?void 0:v.conversionName,br.campaignPlan.goalType.conversionTypeId=null==(y=null==t?void 0:t.conversionType)?void 0:y.conversionTypeId);let f=io(1);ao(f).utc().set({date:12,hour:12,minute:0,second:0,millisecond:0}).format("YYYY-MM-DD HH:mm:ss");let S=io(4);ao(S).utc().set({date:12,hour:12,minute:0,second:0,millisecond:0}).format("YYYY-MM-DD HH:mm:ss"),br.campaignPlan.startDate=io(1),br.campaignPlan.endDate=io(4),r(!0),x("Generating communication smartlink  ...");let j=((t,e)=>{var i,s,a,n;let l=ms(),o=Dr(l.mobileAppsList,t,"appName");return`\n    Create a smart link for "${t}" using the following options and requirements:\n\n     Available Options:\n\n    1. Mobile Apps:\n    ${null==(i=l.mobileAppsList)?void 0:i.map((t=>`- ${t.appName} (GUID: ${t.appGuid})`)).join("\n")}\n\n    2. Domain List:\n    ${null==(s=l.domainsList)?void 0:s.map((t=>`- ${t.domainUrl} (ID: ${t.domainId})`)).join("\n")}\n\n    3. Device type : ["Android phone","iPhone","Android Tablet","iPad"]\n\n    4. ShortCode List: ${null==(a=l.shortCodeDomainList)?void 0:a.map((t=>`- ${t}`)).join("\n")}\n    \n    Generate a smartlink generation in this exact JSON structure:\n    \n    Expected output json\n     {\n            "campaignId": ${e},\n            "goalNo": 1,\n            "smartCode": "",\n            "domainUrl":  "https://slg.smartdx.co/", // static value dont change,\n            "smartAdaptive": "Generate adaptive URL based on ${t}",\n            "smartUrl": "Generate a unique smart code based on ${t}, Please refer the available options shortcode list",\n            "data": {\n                "web": {\n                    "url": "Generate smart URL based on ${t} Please refer the available options Domain List",\n                    "domainId": "Generate smart URL based on ${t} Please refer the available options Domain List",\n                    "queryString": "Generate relevant query string based on ${t}",\n                    "mobileAdaptiveUrl": "Generate mobile adaptive URL based on ${t}",\n                    "customParameters": [],\n                    "IsCheckedAndroid": false,\n                    "IsCheckedIos": false,\n                    "IsCheckedAll": false,\n                    "errorMessage": {\n                        "errUrl": null,\n                        "errAdaptive": null\n                    },\n                    "parameter": []\n                },\n                // mobilePlatform is an array that array is created based on Available Device Type  appName, appId are unique.\n\n\n                "mobilePlatform": [\n                    {\n                        "deviceType": "Fill the device Type based on ${t}",\n                        appName: {\n                        appName: ${null==o?void 0:o.appName} // static value dont change,\n                        appGuid: ${null==o?void 0:o.appGuid} // static value dont change\n                        mpId: "1",\n                        playstoreURL: ${null==o?void 0:o.playstoreURL} // static value dont change,\n                        appId: ${null==o?void 0:o.appGuid} // static value dont change\n                    }\n                        "isDeeplinkEnabled": true, // static value\n                        "mainScreenName": {\n                            "displayName": "Generate relevant screen name based on ${t} Available mobile app list",\n                            "activityName": "Generate relevant screen name based on ${t} available mobile app list like com.visionretail.view.activity.LauncherActivity",\n                            "deepLinkUrl": true,\n                            "storeUrl": ${(null==(n=null==o?void 0:o.playstoreURL)?void 0:n.length)>0?`"${null==o?void 0:o.playstoreURL[0].url}"`:"Generate deep link based on ${aiContent}"}                      }\n                        },\n                        "activityDisplayName": "Generate relevant screen name based on ${t} available mobile app list like com.visionretail.view.activity.LauncherActivity",\n                        "subScreenName": ""Generate relevant screen name based on ${t} available mobile app list like com.visionretail.view.activity.LauncherActivity"",\n                        "IsCheckedAll": false,\n                        "utmparameter": false,\n                        "customParameters": [],\n                        "IsCheckedAndroid": false,\n                        "androidUTMClicked": false,\n                        "iOSUTMClicked": false,\n                        "IsCheckedIos": false,\n                        "errorMessage": {\n                            "errDeviceType": null,\n                            "errMobileApp": null,\n                            "errMainScreen": null,\n                            "errSubScreen": null\n                        },\n                        "parameter": []\n                    }\n                ]\n            }\n        }\n\n\n    Content Guidelines:\n    1. Smartlink generation:\n       - Analyze the mobile and domain list and shortcode url fill the to determine most appropriate campaign type\n       - mobilePlatform appName and appId you did not find any relevant app in mobile list please fill the first object of the array\n       - Each device type have the only app mobile app\n       - Default create the web and mobile\n       - Mobile must have 2 device Type Android Phone and iPhone\n       \n\n    2. Technical Requirements:\n        - mobilePlatform app name and appId should be unique\n        - final response must be a expected output JSON Object\n\n    \n    - final response must be a expected output JSON Object\n    Generate content that is relevant, and appropriate for ${t}. fill the output json and provide the API response like output json.\n\n   `})(n,0),T="";E(j,(i=>{x("Generating image  ..."),(async(t,e)=>{var i;let s={prompt:{text:"A futuristic city at sunset"},image_config:{aspect_ratio:"16:9"}};s={prompt:t+"Generate the image for this content image must be a valid url format be a (.png,.jpeg)",n:1,size:"512x512",quality:"hd",style:"natural"};try{const t=await fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${{}.VITE_OPENAI_API_KEY}`},body:JSON.stringify(s)});if(!t.ok)throw new Error("Failed to generate image");const a=await t.json();a.data&&(null==(i=a.data[0])?void 0:i.url)?(b(a.data[0].url),e(a.data[0].url)):(d("Failed to generate image"),e(""))}catch(a){d(a.message),r(!1),e("")}})(n,(s=>{T=s,A(i),x("Campaign smartlink content creation completed"),x("Generating notification content creation  ...");let a=((t,e)=>{var i,s;let a=ms(),n=Dr(a.domainsList,t,"domainUrl");return`\n    Create a notification content for "${t}" using the following options and requirements:\n\n    Generate a notification generation in this exact JSON structure:\n\n   Interactivity Available options:\n   ${"reach"===(null==(i=null==e?void 0:e.goal)?void 0:i.toLowerCase())?[{actionName:"Dismiss",actionId:2,actionType:"dismiss",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""},{actionName:"May be later",actionId:3,actionType:"maybelater",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"Minute(s)",interactivehours:0,reschedule:"",value:"2"}]:[{actionName:"",actionId:6,actionType:"samartlink 1",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:""},{actionName:"",actionId:7,actionType:"smartlink 2",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"Minute(s)",interactivehours:0,reschedule:"",value:"2"}]}\n   \n   \n\n    Expected output json\n    {\n        weburl:${n.domainUrl},\n        webId:${n.domainId},\n        title: generate the title content based on ${t} max 60 char,\n        subTitle: generate the subtitle content based on ${t} max 60 char,\n        body: generate the body content based on ${t} max 350 char,\n        url: "generate the image link ${t} must be a png",\n        htmlBody: "<p>generate the title content based on ${t} max 350 char</p>", // add the relevant emoji make some bold text \n        ${"reach"===(null==(s=null==e?void 0:e.goal)?void 0:s.toLowerCase())?"// static content just fill the available options interactivity":"// just generate the actionName, actionType is smartlink 1 and 2"}\n        interActivity:[\n         {\n          "actionName": "" // fill the actionName with relevant content ,\n          "actionId": 2,\n          "actionType": "dismiss",\n          "fontColor": "",\n          "bgColor": "",\n          "url": "",\n          "maybeLaterTimeings": "",\n          "interactivehours": 0,\n          "reschedule": "",\n          "value": ""\n        }\n        ] // please refer the available options interactivity type array fill the actionName max 10 letters \n    },\n\n     Generate content that is relevant, engaging, and appropriate for ${t}. Fill the output json and provide the API response like output json\n\n\n   `})(n,t);E(a,(t=>{N(t),x("Notification content creation  completed"),((t,i,s,a)=>{x("Planning save ..."),br.createPlan((t=>{var n;if(!0===(null==t?void 0:t.status)){x("Planning saved successfully");let l=null==(n=null==t?void 0:t.data)?void 0:n.campaignId;i.campaignId=l,br.smartlinkGeneration=i,x("Smartlink save ..."),br.createSmartLink((t=>{!0===(null==t?void 0:t.status)?(x("Smartlink save sucessfully"),br.prepareWebNotificationData(l,i,a,s),x("Web channel save ..."),br.saveWebPush((t=>{!0===(null==t?void 0:t.status)?(x("Web channel save sucessfully"),br.prepareMobileNotificationData(l,i,a,s),x("Mobile channel save ..."),br.saveMobilePush((t=>{!0===(null==t?void 0:t.status)?(x("Mobile channel save sucessfully"),x("AI Campaign created successfully"),setTimeout((()=>{e()}),3e3)):(x("Failed to saveMobile channel"),C(!0))}))):(x("Failed to save web channel"),C(!0))}))):(x("Failed to save smartlink"),C(!0))}))}else x("Planning save failed"),C(!0)}))})(0,i,t,s)}))}))}))};return Ti.jsxs(_l,{show:t,onHide:()=>e(),centered:!0,className:"modal-bottom-fixed fluid-container-modal field-track-mobile-modal mt40",size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Genie"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>e()})]}),Ti.jsxs(_l.Body,{children:[!0===j&&Ti.jsx(fr,{isRotate:!1,style:{display:!1===j?"none":"flex"},initialLoading:j,onClick:()=>{L()}}),!1===j&&Ti.jsxs("div",{style:{marginBottom:"1rem"},children:[Ti.jsxs(Jl,{children:[Ti.jsxs(Zl,{md:10,children:[c&&Ti.jsx("p",{style:{fontSize:"0.875rem",color:"#EF4444"},children:c}),Ti.jsx("textarea",{value:n,onChange:t=>l(t.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",height:"4rem",border:"1px solid #D1D5DB",resize:"none"},placeholder:"Describe the content you want to generate..."})]}),Ti.jsx(Zl,{md:2,children:Ti.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1.75rem"},children:Ti.jsx("div",{className:"airrloading",children:Ti.jsx(fr,{isRotate:!1,onClick:()=>{L()}})})})})]}),!0===I&&Ti.jsx("div",{onClick:()=>{e()},children:Ti.jsx("label",{style:{color:"green"},children:"Campaign created successfully !!!"})}),!0===S&&Ti.jsx("label",{style:{color:"red"},children:f}),(null==f?void 0:f.length)>0&&!1===S&&0===c.length&&Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:7,children:Ti.jsx("div",{class:"rm-loader","data-content":f})})})]})]})]})})),Nr={skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]},Lr=t=>ao().add(t,"d").toDate();class Er extends Di.Component{constructor(){super(...arguments),ji(this,"tempList",[]),ji(this,"adsWidthContainer",Ni.createRef()),ji(this,"adsWidthLeft",Ni.createRef()),ji(this,"adsWidthCenter",Ni.createRef()),ji(this,"adsWidthRight",Ni.createRef()),ji(this,"state",{applyBtn:!1,showdateRange:!0,isShowDateRangePicker:!1,dataResult:null,dataState:Nr,campaignList:[],campaignName:"",listError:!1,dataItem:{},selectCampaignItem:null,pageCount:1,totalCount:0,startDate:Lr(-29),endDate:new Date,noData:!1,limitExceed:!1,fullWidth:0,periyaMenu:!1,monthlyCamapign:0,camapignLoad:!0,isSearchedDataStatus:!1,channelListErrMsg:null,campaignStatus:"",campStoped:0,campaignId:0,campaignAI:!1,getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1}),ji(this,"componentDidUpdate",(()=>{this.context.apiStateData.getIsReloadData&&(this.context.apiStateData.setIsReloadData(!1),this.getDataFromServerNew(this.getParams(void 0)));var t=document.getElementsByClassName("k-link k-pager-nav");Object.keys(t).map(((e,i)=>{t[i].title=""}))})),ji(this,"componentDidMount",(()=>{var t,e;window.scrollTo(0,0),localStorage.setItem("lsConfig",JSON.stringify({sdc:!0,etc:!0,mp:!0,wp:!0,sl:!0,fs:!0,tmb:!0,ld:!0})),void 0===localStorage.getItem("wcdetails")&&null===localStorage.getItem("wcdetails")||localStorage.removeItem("wcdetails"),void 0===localStorage.getItem("mcdetails")&&null===localStorage.getItem("mcdetails")||localStorage.removeItem("mcdetails"),this.setState({fullWidth:(null==(e=null==(t=this.adsWidthContainer)?void 0:t.current)?void 0:e.clientWidth)||0}),ys(this.context,(t=>{})),this.getDataFromServerNew(this.getParams(void 0)),this.getPermissionData()})),ji(this,"getPermissionData",(()=>{let t=!1,e=!1,i=!1;const s=Zi("Communications");1==(null==s?void 0:s.get_AddAccessData)&&(t=!0),e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(i=!0),this.setState({getAddAccessData:t,getUpdateAccessData:e,getDeleteAccessData:i})})),ji(this,"getCampaignAttributtes",(()=>{gs(this.context,(t=>{}))})),ji(this,"getParams",(t=>{var e,i,s,a,n,l,o;return{pagination:{PageSize:this.state.dataState.take,TotalCount:0,PageCount:this.state.pageCount},endDate:null===(null==(e=this.state)?void 0:e.endDate)?new Date:this.state.endDate,startDate:(null==(i=this.state)?void 0:i.startDate)||Lr(-29),campaignType:(null==(s=this.state)?void 0:s.campaignType)||null,deliveryType:(null==(a=this.state)?void 0:a.deliveryType)||"",productType:(null==(n=this.state)?void 0:n.productType)||null,channelType:(null==(l=this.state)?void 0:l.channelType)||null,createdBy:(null==(o=this.state)?void 0:o.createdBy)||null,campaignName:this.state.campaignName,isArchived:!1,campaignStatus:this.state.campaignStatus||""}})),ji(this,"retry",1),ji(this,"getDataFromServerNew",(t=>{this.setState({listError:!1,campaignList:[],noData:!1,camapignLoad:!0}),os({path:bs,params:t,sessionOut:this.context.apiStateData.setSessionOutData,retry:1,retryTime:5e3,ok:t=>{var e,i,s,a,n,l;if(!0===(null==(e=t.data)?void 0:e.status)&&(null==(s=null==(i=null==t?void 0:t.data)?void 0:i.campaignList)?void 0:s.length)>0){let e=[...null==(a=t.data)?void 0:a.campaignList];const i={skip:0,take:this.state.dataState.take,sort:[{field:"orderDate",dir:"desc"}]};let s=Ri(e,i);this.setState({camapignLoad:!1,monthlyCamapign:null==(n=t.data)?void 0:n.totalMonthlyCampaign,campaignList:null==(l=t.data)?void 0:l.campaignList,dataResult:Array.prototype.reverse.call(s),totalCount:t.data.totalNoRecord,noData:!(t.data.campaignList.length>0)})}else this.setState({camapignLoad:!1,campaignList:[],dataResult:[],totalCount:0,noData:!0})},fail:t=>{this.setState({camapignLoad:!1,campaignList:[],dataResult:[],totalCount:0,listError:!0})}})})),ji(this,"CampaignListRowComponent",(t=>Ti.jsx(ur,{...t,navigation:this.props.history,context:this.context,monthlyCount:this.state.monthlyCamapign,list:this.state.campaignList,isCampaignDublicate:t=>{this.setState({selectCampaignItem:t}),this.setState({listError:!1,campaignList:[],noData:!1})},callback:t=>{let e=[...this.state.dataResult.data];const i={skip:0,take:this.state.dataState.take,sort:[{field:"orderDate",dir:"desc"}]};let s={...this.state.selectCampaignItem},a=fs();s.campaignId=t.campaignId,s.campaignName=t.campaignName,t.deliveryType=s.deliveryType,t.campaignType=s.campaignType,t.createdDate=s.createdDate,t.createdBy=s.createdBy,t.userFirstName=(null==a?void 0:a.firstName)||(null==a?void 0:a.email)||"",e.unshift(t);let n=Ri(e,i);this.setState({campaignList:e,dataState:i,dataResult:n,totalCount:this.state.totalCount+1,monthlyCamapign:this.state.monthlyCamapign+1,pageCount:1})}}))),ji(this,"dataStateChange",(t=>{const{skip:e,take:i}=t.dataState,s=Math.floor(e/i+1);this.setState({dataResult:Ri(this.state.campaignList,t.dataState),dataState:t.dataState,pageCount:s},(()=>{this.getDataFromServerNew(this.getParams(void 0))}))})),ji(this,"expandChange",(t=>{const e=void 0===t.dataItem.expanded?t.dataItem.aggregates:t.dataItem.expanded;t.dataItem.expanded=!e||!1,1==!e&&(this.setState({campaignId:t.dataItem.campaignId}),this.getChannelDetails(t.dataIndex,t.dataItem.campaignId));const i={skip:0,take:this.state.dataState.take,sort:[{field:"orderDate",dir:"desc"}]};this.setState({dataResult:Array.prototype.reverse.call(Ri(this.state.campaignList,i))})})),ji(this,"getChannelDetails",((t,e)=>{const i={campaignId:e};this.setState({channelListErrMsg:null}),os({path:xs,params:i,loading:this.context.apiStateData.setIsLoadingData,sessionOut:this.context.apiStateData.setSessionOutData,ok:e=>{if(e.status){let i=[...this.state.campaignList];i[Math.floor(t%this.state.dataState.take)].info=e.data.channels,this.setState({data:i});let s=[...i];const a={skip:0,take:this.state.dataState.take,sort:[{field:"orderDate",dir:"desc"}]};this.setState({dataResult:Array.prototype.reverse.call(Ri(s,a))})}else this.setState({channelListErrMsg:"No data"})},fail:t=>{this.setState({channelListErrMsg:"No data"})}})})),ji(this,"closeDateRangePicker",((t,e)=>{let i={endDate:new Date(e.end),startDate:new Date(e.start),CampaignType:"",deliveryType:"",createdBy:"",campaignName:"",pagination:{PageSize:5,TotalCount:0,PageCount:1},campaignStatus:""};t||this.setState({startDate:new Date(e.start),endDate:new Date(e.end),dataState:{skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]},pageCount:1},(()=>{this.getDataFromServerNew(i)})),this.setState({isShowDateRangePicker:t})})),ji(this,"searchBarCallBack",(t=>{t||this.setState({dataState:{skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]}})})),ji(this,"searchDataReceived",((t,e)=>{if(void 0===e){if((!this.state.isSearchedDataStatus&&this.state.isSearchedDataStatus||null!==t)&&(this.state.isSearchedDataStatus||0!==Object.keys(t).length)&&this.state.isSearchedDataStatus&&0===Object.keys(t).length){this.setState({isSearchedDataStatus:!1});const t={skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]};this.setState({dataState:t,pageCount:1},(()=>{let t={...this.getParams(),campaignName:"",campaignType:null,deliveryType:null,productType:null,channelType:null,createdBy:null,startDate:null,endDate:null,isArchived:!1,campaignStatus:""};t.startDate=null===t.startDate?this.state.startDate:t.startDate,t.endDate=null===t.endDate?this.state.endDate:t.endDate,this.getDataFromServerNew(t)}))}}else{Object.keys(t).map((e=>{"startDate"===e||"endDate"===e?null!==t[e]&&this.setState({[e]:t[e]},(()=>{})):this.setState({[e]:t[e]},(()=>{}))}));const i={skip:0,take:5,sort:[{field:"orderDate",dir:"desc"}]};this.setState({dataState:i,pageCount:1,isSearchedDataStatus:!!e},(()=>{let e={...this.getParams(),...t};e.startDate=null===e.startDate?this.state.startDate:e.startDate,e.endDate=null===e.endDate?this.state.endDate:e.endDate,this.getDataFromServerNew(e)}))}})),ji(this,"HeaderView",(t=>Ti.jsxs(Jl,{children:[this.state.campaignAI&&Ti.jsx(wr,{type:"text",isOpen:!0,onClose:()=>{this.getDataFromServerNew(this.getParams()),this.setState({campaignAI:!1})},initialContent:"",onGenerate:t=>{this.setState({campaignAI:!1})}}),Ti.jsx(Zl,{children:Ti.jsxs("div",{ref:this.adsWidthContainer,className:`rs-ad-search-container marginB0 \n              ${this.state.periyaMenu?"advanced-search-opened":"advanced-search-closed"}\n              ${!0===this.state.camapignLoad?"click-off":"click-on"}`,children:[Ti.jsxs("div",{ref:this.adsWidthLeft,className:"advanceSearchLeft "+(this.state.periyaMenu?"periya-menu-enabled":"periya-menu-disabled"),children:[this.state.limitExceed&&Ti.jsx(Il,{size:"md",headerTitle:"Communication",para:"Communication limit exceeded, please upgrade your plan.",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:t=>{this.setState({limitExceed:!1}),!0===t&&this.props.history.push("/subscription")}}),Ti.jsx("div",{className:"click-on",children:Ti.jsx(so,{closeDateRangePicker:(t,e)=>this.closeDateRangePicker(t,e),cancelBtnClicked:()=>{this.setState({isShowDateRangePicker:!1})},applyBtnClicked:t=>{this.setState({applyBtn:t})},isShowDateRangePicker:this.state.isShowDateRangePicker,show:this.state.showdateRange,class:"marginR10",enable:!0})})]}),Ti.jsx("div",{ref:this.adsWidthCenter,className:"search-view-container "+(this.state.periyaMenu?"periya-menu-enabled":"periya-menu-disabled"),children:Ti.jsx(ro,{campListing:!0,fullWidth:this.state.fullWidth,onPeriyaMenuChange:t=>this.setState({periyaMenu:t}),onSearchDataReceived:(t,e)=>{this.setState({campaignStatus:null==t?void 0:t.CampaignStatus}),this.searchDataReceived(t,e)}})}),Ti.jsx("div",{ref:this.adsWidthRight,className:"advanceSearchRight ml15 "+(this.state.periyaMenu?"periya-menu-enabled":"periya-menu-disabled"),children:Ti.jsx("div",{className:`${!0===es()&&"click-off"}`,children:Ti.jsx("div",{className:"",children:Ti.jsx(Qi,{shadow:!0,icon:Ss,size:"lg",tooltip:"Create communication",onClick:()=>{var t,e,i,s;4===Cs().planId?null==(s=null==(i=this.props)?void 0:i.history)||s.push({pathname:"campaign/planning",state:{mode:"add"}}):!1===is(this.state.monthlyCamapign)?this.setState({limitExceed:!0}):null==(e=null==(t=this.props)?void 0:t.history)||e.push({pathname:"campaign/planning",state:{mode:"add"}})}})})})})]})})]}))),ji(this,"GridDetailsComponent",(t=>{var e;return Ti.jsx(Ti.Fragment,{children:(null==(e=null==t?void 0:t.dataItem)?void 0:e.info)?Ti.jsx(Al,{...t,full:this.state.campaignList,data:this.state.campaignList,navigation:this.props.history,context:this.context,onButtonClick:t=>{},deleteChannel:(t,e)=>{let i=[...this.state.campaignList],s=i.filter((e=>e.campaignId===t))[0].channels.filter((t=>t.channelId!==e));i.channels=s.length>0?s:[],i.info=s.length>0?s:[],this.setState({campaignList:i});let a=Ri(i,Nr);this.setState({dataResult:Array.prototype.reverse.call(a)})},isCampaignStoped:t=>{this.setState({campStoped:t})},callback:()=>{this.getDataFromServerNew(this.getParams(void 0))},jobStatusChange:(t,e)=>{this.getDataFromServerNew(this.getParams(void 0))}}):Ti.jsx("div",{className:"theme-space-m mb10",children:Ti.jsx(oo,{isError:!!this.state.channelListErrMsg,count:2})})})})),ji(this,"GridView",(t=>Ti.jsx(Jl,{children:Ti.jsx(Zl,{children:Ti.jsx("div",{className:"rs-grid-listing",children:Ti.jsx(Oi,{total:this.state.totalCount,className:"grid-pagenation rs-grid-listing",sortable:!1,scrollable:"none",groupable:!1,pageable:this.state.totalCount>5?{type:"numeric",info:!1,pageSizes:[5,10,20,50],previousNext:!0,buttonCount:4,className:"rs-kendo-pager"}:null,data:this.state.dataResult,...this.state.dataState,onDataStateChange:this.dataStateChange,detail:this.GridDetailsComponent,expandField:"expanded",onExpandChange:this.expandChange,children:Ti.jsx(qi,{field:"customerID",cell:this.CampaignListRowComponent})})})})})))}render(){return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(this.HeaderView,{}),this.state.listError?Ti.jsx("div",{className:"box-design pb10 mt15",children:Ti.jsx(lo,{isError:this.state.listError,children:Ti.jsxs("div",{className:"nodata-bar add-func",children:[Ti.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),Ti.jsx("p",{children:"Please try again"})]})})}):Ti.jsx(Ti.Fragment,{children:this.state.campaignList.length>0?Ti.jsx(this.GridView,{context:this.context}):this.state.isSearchedDataStatus&&0===this.state.campaignList.length?Ti.jsx("div",{className:"box-design pb10 mt15",children:Ti.jsx(lo,{isError:this.state.noData,children:Ti.jsxs("div",{className:"nodata-bar",children:[Ti.jsx(Qi,{icon:js,size:"md",color:"orange-medium",mainClass:"mr5"}),Ti.jsx("p",{children:"No data available"})]})})}):!1===this.state.applyBtn&&0===this.state.campaignName.length&&0===this.state.campaignList.length?Ti.jsx("div",{className:"box-design pb10 mt15",children:Ti.jsx(lo,{isError:this.state.noData,children:Ti.jsx("div",{className:`nodata-bar add-func ${es()&&"click-off"}`,onClick:()=>{!0!==es()&&this.props.history.push({pathname:"campaign/planning",state:{mode:"add"}})},children:Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("i",{className:"icon-rs-circle-plus-fill-edge-medium icons-md color-primary-blue cursor-pointer px5"}),Ti.jsx("p",{children:"Create"})]})})})}):this.state.applyBtn&&0===this.state.campaignName.length&&0===this.state.campaignList.length?Ti.jsx("div",{className:"box-design pb10 mt15",children:Ti.jsx(lo,{isError:this.state.noData,children:Ti.jsxs("div",{className:"nodata-bar",children:[Ti.jsx(Qi,{icon:js,size:"md",color:"orange-medium",mainClass:"mr5"}),Ti.jsx("p",{children:"No data available"})]})})}):null})]})}}ji(Er,"contextType",vs);const Br=wi(Er),Mr=[{text:"Edit"},{text:"Duplicate"}],Pr={skip:0,take:3,type:"input",buttonCount:3,info:!1,pageSizes:!0,previousNext:!0,responsive:!0},Fr=[{id:1001,text:"Web push"},{id:1002,text:"Mobile push"}],Ur={0:{title:"Draft",className:"status-draft",icon:"icon-rs-form-edit-medium",color:"grey"},5:{title:"In progress",className:"status-inprogress",icon:"icon-rs-circle-time-medium",color:"#66c8ec"},52:{title:"Alert",className:"status-alert",icon:"icon-rs-alert-medium",color:"#dfb82b"},9:{title:"Completed",className:"status-completed",icon:"icon-rs-circle-tick-medium",color:"#99cc03"},7:{title:"Scheduled",className:"status-scheduled",icon:"icon-rs-circle-time-medium",color:"#f56701"},20:{title:"Multistatus",className:"status-multistatus",icon:"icon-rs-multi-status-medium",color:"#9f65b7"},6:{title:"Draft",className:"status-draft",icon:"icon-rs-form-edit-medium",color:"#b8b8b8"}},Rr=({dataItem:t,history:e,context:i,updateIndex:s})=>{var a;const[n,l]=Di.useState(!1),[o,r]=Di.useState(!1),[c,d]=Di.useState(null);Di.useState(null);const[p,h]=Di.useState(null===(null==t?void 0:t.mediadata)||void 0===(null==t?void 0:t.mediadata)?null:JSON.parse(null==t?void 0:t.mediadata)||null),[u,m]=Di.useState("M"===(null==t?void 0:t.communicationChannel)?" Android":"Chrome"),[v,y]=Di.useState(0),g=Di.useMemo((()=>{const e=[...Mr];return"T"===t.campaignType||"T"===t.campaignType&&9===t.statusId?e.filter((t=>"Duplicate"!==t.text)):e}),[t.campaignType,t.statusId]),b=Di.useCallback((i=>{if("Edit"===i.item.text){let i=8;"m"===t.communicationChannel.toLowerCase()&&(i=14),localStorage.setItem("cId",t.campaignId);const s=Ur[t.statusId],a=s?s.title:"Draft",n=0!==t.campaignId&&"Scheduled"!==a&&"Draft"!==a&&"Alert"!==a;let l=localStorage.getItem(`camp_${t.campaignId}`),o={};null!=l?(o=ks(l),o.notifyData={mode:"edit",editClickOff:n,statusId:t.statusId,channelId:i}):o={notifyData:{mode:"edit",editClickOff:n,statusId:t.statusId,channelId:i}},localStorage.setItem(`camp_${t.campaignId}`,ts(o)),e.push({pathname:"/campaign/creation-notification",search:`?cId=${t.campaignId}&cs=${t.statusId}`,state:{mode:"edit"}})}else"Duplicate"===i.item.text&&f()}),[t,e]),f=Di.useCallback((()=>{const e={userId:ls(),campaignName:`${t.campaignName}_Copy`,campaignId:t.campaignId,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:rs,params:e,loading:i.globalStateData.setIsLoadingData,sessionOut:i.globalStateData.setSessionOutData,ok:t=>{t.status?s(0):r(!0)},fail:t=>{r(!0)}})}),[t,i,s]),x=Di.useCallback((t=>{l(!0);const e={CampaignId:t.campaignId,CampaignGuid:t.campaignGUID,Channel:"W"===t.communicationChannel?"WP":"MP",BlastGuid:t.blastScheduleGuid};os({path:Ds,params:e,loading:null,ok:t=>{t.status?d(t.data):r(!0)},fail:t=>{r(!0)}})}),[]),S=Di.useCallback((()=>{if(!p)return null;const t={...p};return t.push={},t.push.pushType={deliveryTypeId:null==p?void 0:p.deliveryTypeId,deliveryTypeValue:"Alert / inApp"},t.push.deliveryType={deliveryTypeId:null==p?void 0:p.deliveryTypeId,deliveryTypeValue:"Alert / inApp"},t}),[p]),C=Di.useCallback((()=>{var t;const e=S();return(null==(t=null==e?void 0:e.content)?void 0:t.length)>0?null==e?void 0:e.content[0]:null}),[S]),j=Di.useCallback((({type:t})=>{var e;return Ti.jsx(bo,{deviceType:u,isGallery:!0,type:t,data:S(),content:null==(e=null==p?void 0:p.content)?void 0:e[v]})}),[u,S,p,v]),T=Di.useCallback((({type:t})=>{var e;const[i,s]=Di.useState(null==(e=null==p?void 0:p.content)?void 0:e[(null==p?void 0:p.selectIndex)||0]),[a,n]=Di.useState(0),l=Di.useCallback((()=>{var t;0!==a&&(n(a-1),s(null==(t=null==p?void 0:p.content)?void 0:t[a-1]))}),[a,p]),o=Di.useCallback((()=>{var t,e;if(a===(null==(t=null==p?void 0:p.content)?void 0:t.length)-1)return;const i=a+1;s(null==(e=null==p?void 0:p.content)?void 0:e[i]),n(i);const l={...p};l.selectIndex=i,h(l)}),[a,p]);return Ti.jsx("div",{className:"gallery_split",children:Ti.jsx(bo,{deviceType:u,isGallery:!0,index:a,carousel:!0,type:t,data:S(),content:i,firstButtonClick:l,secondBtnClick:o})})}),[u,S,p]),I=Di.useCallback((({type:t})=>{const e=null==p?void 0:p.isSplit,i=null==p?void 0:p.isCarousel;return e?Ti.jsx(j,{type:t}):i?Ti.jsx(T,{type:t}):Ti.jsx(bo,{deviceType:u,isGallery:!0,type:t,data:S(),content:C()})}),[p,u,S,C,j,T]),k=Di.useCallback((t=>{m(t),l(!1)}),[]),D=Di.useCallback((()=>{m("Info"),x(t)}),[t,x]);return Ti.jsx(Zl,{md:4,children:Ti.jsxs("div",{className:`card-gallery-box ${"T"===t.campaignType&&9===t.statusId?new Date(null==t?void 0:t.endDate)<=new Date?Ur[9].className:Ur[5].className:(null==(a=Ur[t.statusId])?void 0:a.className)||Ur[0].className}`,children:[t&&Ti.jsxs("div",{className:"gallery-head",children:[Ti.jsxs("div",{className:"d-flex align-items-center justify-content-between",style:{marginBottom:"10px"},children:[Ti.jsxs("small",{className:"color-primary-grey",children:["Created on: ",Ki(t.createdDate)]}),Ti.jsx("div",{className:"d-flex",children:Ti.jsx(fo,{className:"marginR-5",dir:"rtl",data:g,icon:`${As} icons-md blue`,onItemClick:b})})]}),Ti.jsx("div",{className:"d-flex align-items-center",style:{marginBottom:"10px"},children:Ti.jsx(ws,{text:t.campaignName,position:"top",children:Ti.jsx("p",{className:"float-start truncate-240 mb0",children:t.campaignName})})})]}),t&&n?c?Ti.jsxs("div",{className:"gallery-body",children:[Ti.jsx("i",{onClick:()=>{l(!1),m("W"===(null==t?void 0:t.communicationChannel)?"Chrome":" Android")},className:"icon-rs-circle-close-medium icons-md color-primary-blue cp"}),Ti.jsxs("div",{className:"gallery-pophover",children:[Ti.jsxs("ul",{className:"borderB1",children:[Ti.jsx("li",{children:Ti.jsx("span",{className:"font-semi-bold",children:"Delivery method"})}),Ti.jsx("li",{children:"S"===c.campaignType?"Single dimension":"Trigger"}),Ti.jsx("li",{children:Ti.jsx("span",{className:"font-semi-bold",children:"Communication type"})}),Ti.jsx("li",{children:(null==c?void 0:c.campaignAttribute)||""})]}),Ti.jsxs("ul",{children:[Ti.jsxs("li",{children:[Ti.jsx("span",{className:"font-semi-bold",children:"Total sent:"})," ",c.noOfRecipientsCount||0]}),Ti.jsxs("li",{children:[Ti.jsx("span",{className:"font-semi-bold",children:"Reach:"})," ",c.reachCount||0]}),Ti.jsxs("li",{children:[Ti.jsx("span",{className:"font-semi-bold",children:"Engagement:"})," ",c.interactionCount||0]}),Ti.jsxs("li",{children:[Ti.jsx("span",{className:"font-semi-bold",children:"Conversion:"})," ",c.conversionCount||0]})]})]})]}):Ti.jsxs("div",{className:"gallery-body gl-skeleton",children:[Ti.jsx(oo,{height:25,count:4}),Ti.jsx("hr",{className:"marginB15"}),Ti.jsx(oo,{height:25,count:4})]}):n?Ti.jsx("div",{className:"img-bor-wrapper img-bor p10 pt15",children:Ti.jsx(oo,{count:5})}):Ti.jsx("div",{className:"gallery-body "+(t.communicationChannel,""),children:null!=p&&null!==C()?Ti.jsx("div",{className:"instant-preview",children:Ti.jsx(I,{type:"W"===t.communicationChannel?"web":"mobile"})}):Ti.jsx(oo,{count:5,isError:!0,children:Ti.jsxs("div",{className:"nodata-bar add-func",children:[Ti.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),Ti.jsx("p",{children:"No data available"})]})})}),o&&Ti.jsx(Il,{headerTitle:"Sorry",subtitle:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:()=>r(!1)}),Ti.jsx(xo,{className:"justify-content-end t20",children:Ti.jsxs(Xi,{children:["W"===(null==t?void 0:t.communicationChannel)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Qi,{mainClass:"Chrome"===u?"selected-gal-device-type":"",color:"Chrome"===u?"color-primary-blue":"color-primary-grey",tooltip:"Chrome",icon:"icon-rs-google-chrome-medium",size:"md",onClick:()=>k("Chrome")}),Ti.jsx(Qi,{mainClass:"Firefox"===u?"selected-gal-device-type":"",color:"Firefox"===u?"color-primary-blue":"color-primary-grey",tooltip:"Firefox",icon:"icon-rs-mozilla-firefox-medium",size:"md",onClick:()=>k("Firefox")})]}):Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Qi,{mainClass:" Android"===u?"selected-gal-device-type":"",color:" Android"===u?"color-primary-blue":"color-primary-grey",tooltip:"Android",icon:"icon-rs-android-medium",size:"md",onClick:()=>k(" Android")}),Ti.jsx(Qi,{mainClass:" iOS"===u?"selected-gal-device-type":"",color:" iOS"===u?"color-primary-blue":"color-primary-grey",tooltip:"iOS",icon:"icon-rs-ios-medium",size:"md",onClick:()=>k(" iOS")})]}),Ti.jsx(Qi,{mainClass:"Info"===u?"selected-gal-device-type":"",color:"Info"===u?"color-primary-blue":"color-primary-grey",tooltip:"Info",icon:"icon-rs-circle-info-medium",size:"md",onClick:D})]})})]})})},Or=()=>{const t=Di.useContext(Ji),e=Ai();Li(),Di.useState(!1),Di.useState(""),Di.useState(""),Di.useState([]),Di.useState(["Web push","Mobile push"]);const[i,s]=Di.useState("webpush"),[a,n]=Di.useState(!1);Di.useState(!1);const[l,o]=Di.useState([]),[r,c]=Di.useState(0),[d,p]=Di.useState(!1);Di.useState(!1),Di.useState(null);const[h,u]=Di.useState(""),[m,v]=Di.useState(""),[y,g]=Di.useState(!1),[b,f]=Di.useState(0);Di.useState(0);const[x,S]=Di.useState(Pr),[C,j]=Di.useState(null),[T,I]=Di.useState(!1),[k,D]=Di.useState(null);Di.useCallback((t=>Date.now()-24*t*3600*1e3),[]),Di.useCallback((t=>new Date(t).toISOString().slice(0,10)),[]);const A=Di.useCallback(((t,e,i,s,a)=>{j(!!a||null);let n=s;return 1!==s&&(n=i/e+1,n=0===n?1:n),{channel:t.channel.toLowerCase().includes("m")?"M":"W",endDate:a?"":h,startDate:a?"":m,CampaignType:null,DeliveryType:null,createdBy:null,CampaignName:(null==t?void 0:t.CampaignName)||"",pagination:{PageSize:e,PageCount:n}}}),[h,m]),w=Di.useCallback((e=>{g(!0),p(!1),os({path:Ts,params:e,sessionOut:t.globalStateData.setSessionOutData,ok:t=>{var e,i,s;Is("res data",t.data),t.status&&(null==(i=null==(e=null==t?void 0:t.data)?void 0:e.campaignsGalleryList)?void 0:i.length)>0?(o(null==(s=null==t?void 0:t.data)?void 0:s.campaignsGalleryList),c(t.totalRows),g(!1),I(!1)):(o([]),p(!0),g(!1),I(!0))},fail:t=>{p(!0),g(!1)}})}),[t.globalStateData.setSessionOutData]),N=Di.useCallback(((t,e)=>{Is("Date Start",e.start),Is("Date End",e.end);const s={channel:i.toLowerCase().includes("mobile")?"M":"W",from:e.start,to:e.end};if(Is("After Date Start",s.from),Is("After Date End",s.to),!t){const t={...x};t.take=3,t.skip=0,u(s.to),v(s.from),S(t),w(A(s,3,3,1))}n(t)}),[i,x,w,A]),L=Di.useCallback((()=>Ti.jsxs("div",{className:"d-flex justify-content-between marginB7",children:[Ti.jsx("div",{children:"..."}),Ti.jsxs("div",{className:"d-flex align-items-center",style:{height:40},children:[Ti.jsx(so,{initialDateData:C,isShowDateRangePicker:a,enable:!0,closeDateRangePicker:N,cancelBtnClicked:()=>n(!1),class:"marginR10"}),Fr.length>=0&&Ti.jsx(Pi,{style:{height:40},className:"fs18-btn top-1",defaultSelectedItem:b,defaultClass:"tabDefault",dynamicTab:"mini float-end mb0",activeClass:"tabDefault active",tabData:Fr,callBack:(t,e)=>{f(e),s(t.text),S({...Pr});const i={channel:t.text.toLowerCase().replace(/ /g,"")},a={...x};a.take=x.take,a.skip=x.skip,S(a),w(A(i,x.take,x.skip,1,!0))}})]})]})),[C,a,N,b,x,w,A]),E=Di.useCallback((({data:i,totalCount:s,...a})=>{const n=null==i?void 0:i.filter((t=>"m"===t.communicationChannel.toLowerCase()));return Ti.jsx(Ti.Fragment,{children:y?Ti.jsx("div",{className:"box-design-del",children:Ti.jsx(yo,{isError:!1})}):(null==n?void 0:n.length)>0?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(vo,{...a,className:"gallery-grid-view",data:n,type:"mobile",item:i=>Ti.jsx(Rr,{...i,history:e,context:t,updateIndex:t=>f(t)})}),Ti.jsx("div",{className:"grid-pagenation",children:s>3&&Ti.jsx(Vi,{className:"k-grid-pager",skip:x.skip,take:x.take,onPageChange:t=>{const{skip:e,take:i}=t,s={...x};s.take=i,s.skip=e,S(s),w(A({channel:0===b?"W":"M"},i,e,2))},total:s,type:x.type,info:x.info,buttonCount:x.buttonCount,pageSizes:x.pageSizes?[3,6,18]:void 0,previousNext:x.previousNext})})]}):Ti.jsx("div",{className:"box-design-del",children:Ti.jsx(yo,{isError:d})})})}),[y,d,x,b,w,A,e,t]),B=Di.useCallback((({data:i,totalCount:s,...a})=>{const n=null==i?void 0:i.filter((t=>"w"===t.communicationChannel.toLowerCase()));return Ti.jsx(Ti.Fragment,{children:y?Ti.jsx("div",{className:"box-design-del",children:Ti.jsx(yo,{isError:!1})}):(null==n?void 0:n.length)>0?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(vo,{className:"gallery-grid-view",type:"web",data:n,item:i=>Ti.jsx(Rr,{...i,history:e,context:t,updateIndex:t=>f(t)})}),Ti.jsx("div",{className:"grid-pagenation",children:s>3&&Ti.jsx(Vi,{className:"k-grid-pager",skip:x.skip,take:x.take,onPageChange:t=>{const{skip:e,take:i}=t,s={...x};s.take=i,s.skip=e,S(s),w(A({channel:0===b?"W":"M"},i,e,2))},total:s,type:x.type,info:x.info,buttonCount:x.buttonCount,pageSizes:x.pageSizes?[3,6,18]:void 0,previousNext:x.previousNext})})]}):Ti.jsx("div",{className:"box-design-del",children:Ti.jsx(yo,{isError:d})})})}),[y,d,x,b,w,A,e,t]);return Di.useEffect((()=>{const t={channel:i.toLowerCase().includes("mobile")?"M":"W"};D(t),w(A(t,3,3,1))}),[]),Di.useEffect((()=>{const t=document.getElementsByClassName("k-link k-pager-nav");Array.from(t).forEach((t=>{t.title=""}))})),Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Jl,{children:Ti.jsx(L,{})}),0===(null==l?void 0:l.length)?Ti.jsx(yo,{isError:d}):r>0?1===b?Ti.jsx(E,{callBack:()=>{},totalCount:r,data:l}):Ti.jsx(B,{callBack:()=>{},data:l,totalCount:r}):Ti.jsx(yo,{isError:d})]})},qr=()=>{const t=Di.useContext(Ji),[e,i]=Di.useState(0),[s,a]=Di.useState(null),[n,l]=Di.useState([]);return Di.useState(null),Di.useEffect((()=>{}),[]),Ti.jsxs(Ui,{children:[Ti.jsx(Kl,{fluid:!0,className:"main-heading-wrapper mb0",children:Ti.jsxs(Kl,{className:"mhw-container",children:[Ti.jsx("div",{className:"mhwc-left",children:Ti.jsx("h1",{children:Ti.jsx("div",{className:"mh-wrapper",children:Ti.jsx("span",{className:"mh-text",children:"Communication"})})})}),Ti.jsx("div",{className:"mhwc-right",children:Ti.jsx(So,{data:n,defaultItem:null==s?void 0:s.clientName,alignRight:!0,fieldKey:"clientName",onSelect:t=>{i(-1),setTimeout((()=>{i(0)}),10)}})})]})}),Ti.jsx(Kl,{fluid:!0,className:"bgWhite",children:Ti.jsx(Kl,{children:Ti.jsx(Pi,{fullWidth:6,defaultSelectedItem:e,defaultClass:"",dynamicTab:"tabs-filled-component",activeClass:"active",tabData:Vr,callBack:(t,e)=>{i(e)}})})}),Ti.jsx(Kl,{className:"page-header box-bottom-space",children:(e=>{switch(e){case 0:return Ti.jsx(Br,{context:t});case 1:return Ti.jsx(Or,{updateIndex:t=>i(t),context:t});default:return null}})(e)})]})},Vr=[{id:1001,text:"List"},{id:1002,text:"Gallery"}],zr=[{label:"Email",value:!1},{label:"SMS",value:!1},{label:"Web push",value:!1},{label:"Mobile push",value:!1},{label:"WhatsApp",value:!1}],$r=[{label:"Facebook",value:!1},{label:"X",value:!1},{label:"LinkedIn",value:!1},{label:"Pinterest",value:!1},{label:"Instagram",value:!1},{label:"Line",value:!1}],Hr=[{label:"Google ads",value:!1},{label:"Facebook ads",value:!1}],Gr=[{label:"Email",value:!1},{label:"SMS",value:!1},{label:"Web push",value:!1},{label:"Mobile push",value:!1},{label:"WhatsApp",value:!1}];class Wr extends Ni.Component{constructor(){super(...arguments),ji(this,"inputRef",Ni.createRef()),ji(this,"state",{isModalOpen:this.props.isOpen,isModalClose:this.props.isClose,tagsValue:this.props.values,keyword:"",tagName:"",tagError:null,isDisabled:!1,className:this.props.className})}render(){return Ti.jsxs(_l,{show:this.state.isModalOpen,centered:!0,onHide:this.props.isModalClose,className:this.state.className,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Tags"}),Ti.jsx(zl,{mainClass:"close",size:"md",tooltip:"Close",handleClose:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.closeBtnClicked()}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx("div",{className:"chips-container com-set campaign-tag",children:Ti.jsxs("div",{className:"chips-box position-relative",children:[this.state.tagError&&Ti.jsx("div",{className:"validation-message align-end left10 mt-35",children:this.state.tagError}),Ti.jsx(Fl,{noinput:!0,ref:this.inputRef,placeholder:"Enter your tag",value:this.state.tagsValue,allowCustom:!0,disabled:this.state.isDisabled,autoFocus:!this.state.isDisabled,onFilterChange:t=>null===this.state.tagError&&!1===this.state.isDisabled&&t.filter.value.length>75?(this.setState({tagError:Ns}),t.target._input.disabled=!0,t.target._input.value=t.filter.value.substring(0,74),t.filter.value=t.filter.value.substring(0,74),void setTimeout((()=>{t.target._input.disabled=!1,this.inputRef.current.focus()}),2e3)):t.filter.value.length<=75?(this.setState({tagError:null}),this.setState({tagName:t.target.value}),!1):void 0,onChange:t=>{if(t.target.value.length<=5){let e=[];if(t.target.value.reduce(((t,e)=>t.find((t=>t.toLowerCase()===e.toLowerCase()))?t:t.concat([e])),[]).map((t=>{!1===ss(Ls(t))&&Ls(t).length<=75&&e.push(t)})),e.toString().length>75)return void this.setState({tagError:"Total length must not exceed 75 characters."});this.setState({tagsValue:e})}}})]})}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{children:Ti.jsx(Mo,{children:Ti.jsx(Po,{style:{marginTop:10},children:"Enter a friendly name with comma separator. Maximum 5 friendly names allowed, with the limit of 75 characters."})})})})]}),Ti.jsx(_l.Footer,{children:Ti.jsx(ns,{className:"m0",onClick:()=>{this.state.tagsValue.toString().length>75?this.setState({tagError:"Total length must not exceed 75 characters."}):(this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen([!1,this.state.tagsValue]))},children:"OK"})})]})}}const _r=t=>{const[e,i]=Di.useState(!1),[s,a]=Di.useState(!1),[n,l]=Di.useState(null),o=Ai(),r=Li(),c=Di.useContext(Ji),[d,p]=Di.useState(0),[h,u]=Di.useState(null),[m,v]=Di.useState(null),[y,g]=Di.useState(null),[b,f]=Di.useState(null),[x,S]=Di.useState(null),[C,j]=Di.useState(null),[T,I]=Di.useState(null),[k,D]=Di.useState(null),[A,w]=Di.useState(null),[N,L]=Di.useState(null),[E,B]=Di.useState(null),[M,P]=Di.useState(null),[F,U]=Di.useState(""),[R,O]=Di.useState(""),[q,V]=Di.useState(t.json),[z,$]=Di.useState(null),[H,G]=Di.useState(!1),[W,_]=Di.useState(""),[J,Z]=Di.useState(null),[K,Y]=Di.useState(""),[X,Q]=Di.useState(""),[tt,et]=Di.useState(""),[it,st]=Di.useState(!1),[at,nt]=Di.useState(!1),[lt,ot]=Di.useState(!1),[rt,ct]=Di.useState(null),[dt,pt]=Di.useState([]),[ht,ut]=Di.useState([]),[mt,vt]=Di.useState(!1),[yt,gt]=Di.useState(null),[bt,ft]=Di.useState(Es(6));Di.useState(0);const xt=Di.useRef(),St=new Date,[Ct,jt]=Di.useState(Bs([{label:"Web",value:!1,info:"Analyze the behavior of visitors on your website.",disabled:!0},{label:"App",value:!1,info:"Analyze the behavior of visitors on your mobile app.",disabled:!0}]));Di.useEffect((()=>{xt.current=rt;const e={...q};e.primaryGoal=["Reach","Engagement","Conversion"],V(e);let i=[...Gr];Z(i);let s=ms();if(pt((null==s?void 0:s.conversionTypeList)||[]),ut((null==s?void 0:s.engagementList)||[]),0===t.campaignId){let t=wl(!0);t.campaignId=0,u(t)}else Tt()}),[]),Di.useEffect((()=>{const t=o.block((t=>!e||t.pathname===r.pathname||(a(!0),l(t.pathname),!1)));return()=>{t()}}),[e,o,r.pathname]);const Tt=()=>{Nl(t.campaignId,c,t.attributes,(e=>{var i;e.campaignId=t.campaignId;const s=no.parse(null==(i=null==o?void 0:o.location)?void 0:i.search);let a=void 0!==s.cs?parseInt(s.cs):0;ft(Es(a)),5!==a&&9!==a&&20!==a||G(!0),u(e)}))},It=()=>{var t,e,i,s,a,n,l,o;let r=!1;return ss(null==h?void 0:h.campaignName)||null!==m&&m.length>0?(v(Ms),r=!0,r):ss(null==(t=null==h?void 0:h.campaignAttribute)?void 0:t.attributeName)||(null==(s=null==(i=null==(e=null==h?void 0:h.campaignAttribute)?void 0:e.attributeName)?void 0:i.toLowerCase())?void 0:s.includes("select"))?(g(Ps),r=!0,r):ss(null==(a=null==h?void 0:h.productCategory)?void 0:a.categoryName)||(null==(o=null==(l=null==(n=null==h?void 0:h.productCategory)?void 0:n.categoryName)?void 0:l.toLowerCase())?void 0:o.includes("select"))?(f(Hs),r=!0,r):ss(h.goal)||h.goal.toLowerCase().includes("select")?(S(Gs),r=!0,r):"engagement"!==h.goal.toLowerCase()&&"conversion"!==h.goal.toLowerCase()||""!==h.goalType&&!0!==h.goalType.conversionName.toLowerCase().includes("select")?0===Math.abs(h.goalPercentage)?(j("Enter the goal percentage"),r=!0,r):ss(h.startDate.toString())||""!==h.startDate.toString()&&Ws(h.startDate,new Date)<0?(I(Fs),r=!0,r):ss(h.endDate.toString())||""!==h.endDate.toString()&&Ws(h.endDate,new Date)<0||""!==h.endDate.toString()&&Ws(h.endDate,new Date)<0?(D(Us),r=!0,r):[...h.nativeChannels,...h.socialMedia,...h.paidAds].length?("engagement"!==h.goal.toLowerCase()&&"conversion"!==h.goal.toLowerCase()||0!==h.analyticsType.length||(r=!0,L(Os)),r):(w(Rs),r=!0,r):($("Select goal type"),r=!0,r)},kt=(t,e)=>{if(!1===It())if(h.isSmartLink=!0,0===h.campaignId||6===h.campaignStatusId){let e=new Date(h.startDate);e.setHours(0,0,0,0);let i=new Date;i.setHours(0,0,0,0),e>i?Dt(t):nt(!0)}else Dt(t)},Dt=e=>{Ll(h,c,(i=>{if(i.status){c.channels=h.nativeChannels.concat(h.socialMedia,h.paidAds),h.allChannels=[...h.nativeChannels,...h.socialMedia,...h.paidAds];let s=i.data.campaignId;const a={name:h.campaignName,startDate:h.startDate.toString(),endDate:h.endDate.toString(),goal:h.goal,type:h.campaignAttribute.attributeName};if(0===e)o.push({pathname:"/campaign"});else{localStorage.setItem("cId",s);let e={plan:a,analyticsType:h.analyticsType,status:0===t.campaignId?6:bt.id,mode:0===t.campaignId?"add":"edit"};localStorage.setItem(`camp_${s}`,ts(e)),o.push({pathname:"/campaign/creation-smartlink",search:`?cId=${s}&sl=true`,state:{mode:0===t.campaignId?"add":"edit",campaignId:s,campaignHeader:a,status:0===t.campaignId?"Draft":bt.title,analyticsType:h.analyticsType}})}}else gt((null==i?void 0:i.message)||"Please try again later"),vt(!0)}))},At=()=>{var e,i;return Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx("div",{ref:xt,className:"posr zIndex2",children:Ti.jsx("div",{})}),Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication / Product type",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,id:"s_producttype",children:Ti.jsx(Ul,{ref:t=>ct(null==t?void 0:t.current),data:null==(e=null==t?void 0:t.attributes)?void 0:e.campaignAttributeList,value:void 0!==h.campaignAttribute&&""!==h.campaignAttribute.attributeName?h.campaignAttribute:"-- Select Target list  --",textField:"attributeName",dataItemKey:"campaignAttributeId",handleChange:e=>{t.onChange("camapaignTypes",e.target.value);let i={...h};i.campaignAttribute=e.target.value,u(i);let s=e.target.value.attributeName.length>0?null:Ps;g(s)},label:"Communication type",required:!0,errorMessage:y,disabled:H})}),Ti.jsx(Zl,{id:"s_productcategory",md:6,children:Ti.jsx(Ul,{data:null==(i=null==t?void 0:t.attributes)?void 0:i.productCategorysList,value:void 0!==h.productCategory&&""!==h.productCategory.categoryName?h.productCategory:"-- Select  --",textField:"categoryName",dataItemKey:"categoryId",handleChange:e=>{let i={...h};i.productCategory=e.target.value,u(i),t.onChange("productTypes",e.target.value);let s=e.target.value.categoryName.length>0?null:Ps;f(s)},label:"Product type",required:!0,errorMessage:b,disabled:H})})]})})]})})},wt=()=>Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Primary goal",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{id:"s_primarygoal",md:6,children:Ti.jsx(Ul,{ref:t=>ct(null==t?void 0:t.current),isLoading:lt,data:["Engagement","Conversion"],value:""!==h.goal?h.goal:"-- Goal --",handleChange:e=>{var i=0;let s={...h},a=0;"reach"===e.target.value.toLowerCase()?a=1:"engagement"===e.target.value.toLowerCase()?a=2:"conversion"===e.target.value.toLowerCase()&&(a=3);let n=e.target.value;n===q.primaryGoal[1]?q.engamentTypes[0]:q.conversationTypes[0],s.goal=e.target.value,s.goalType="",s.tPercentage="",s.goalPercentage="",u(s),ot(!0),El(c,s.productCategory.categoryId,a,(s=>{let a={...h};a.goal=n,ot(!1),a.goalType={conversionName:"-- Select goal type --",conversionTypeId:-1},i=s.status?"3.20":"reach"===a.goal.toLowerCase()?"1.70":"engagement"===a.goal.toLowerCase()?"5.20":"conversion"===a.goal.toLowerCase()?"10.45":"";let l=e.target.value.length>0?null:Gs;S(l),j(null),a.tPercentage=i,a.goalPercentage=i,u(a),t.onChange("goalPercentage",i),t.onChange("reachType",e.target.value)}))},label:"Primary goal",required:!0,errorMessage:x,disabled:H})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Zr,{editClickOff:H,campaignDetails:h,errGoalPercentage:C,setCampaignDetails:t=>{u(t),parseInt(t.goalPercentage)>0?j(null):j("Enter the goal percentage")},setErrGoalPercentage:t=>{}})})]})}),Ti.jsx(Zl,{md:1,className:"rs-sub-icons-wrapper ml-15",children:Ti.jsx(Ao,{className:"color-primary-grey fs16 posr top8",label:"%",disabled:H})})]})}),Nt=()=>Ti.jsx(Ti.Fragment,{children:""!==h.goal&&"Reach"!==h.goal&&0!==h.goalPercentage?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:h.goal+" type",right:!0})}),Ti.jsx(Zl,{id:"s_target",md:7,children:Ti.jsx(Ul,{data:h.goal===q.primaryGoal[1]?ht:dt,textField:"conversionName",dataItemKey:"conversionTypeId",value:""!==(null==h?void 0:h.goalType)?h.goalType:{conversionName:"-- Select goal type --",conversionTypeId:-1},handleChange:t=>{$(null);let e={...h};e.goalType=t.target.value,u(e)},label:h.goal+" type",required:!0,errorMessage:z,disabled:H})})]})}):null}),Lt=()=>Ti.jsx(Ti.Fragment,{children:Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication period",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,id:"s_startdate",children:Ti.jsx(Fo,{required:!0,placeholder:"Start date",errorMessage:T,disabled:H,value:""!==h.startDate?h.startDate:null,min:St,handleChange:t=>{h.endDate="",U(t.target.value);var e=t.target.value,i=e.setDate(e.getDate()+3);let s=new Date(i);_(s),h.startDate=t.target.value,h.endMindate=s;let a=null!==t.target.value?null:Fs;I(a)}})}),Ti.jsx(Zl,{id:"s_enddate",md:6,className:0===t.campaignId||"in progress"===(null==bt?void 0:bt.title.toLowerCase())||"draft"===(null==bt?void 0:bt.title.toLowerCase())?"click-on":H?"click-off-child-del click-off":"",children:Ti.jsx(Fo,{required:!0,placeholder:"End date",errorMessage:k,value:""!==h.endDate?new Date(h.endDate):null,min:h.endMindate,handleChange:t=>{O(t.target.value),h.endDate=t.target.value;let e=null!==t.target.value?null:Us;D(e)}})})]})})]})})}),Et=()=>{const t=Bs(zr);return Ti.jsx(Ti.Fragment,{children:Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Native channel",right:!0})}),Ti.jsx(Zl,{md:7,id:"s_channels",children:Ti.jsxs("div",{className:"d-flex "+(H?"click-off":"on"),children:[Ti.jsx("div",{className:"wsn",children:Ti.jsx(Rl,{lbl:"All",name:"NativeChannelmatchtype",labelId:"NativeChannelAll",className2:"mr7",checked:t.length===h.nativeChannels.length,cb:e=>{if("All"===e.target.value){let e={...h};e.nativeChannels=[],t.map(((t,i)=>{e.nativeChannels.push(t.label)})),u(e)}Y(e.target.value)}})}),Ti.jsx("div",{className:"marginT-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})}),Ti.jsx(wo,{disabled:H,children:t.map(((t,e)=>(h.nativeChannels.map(((e,i)=>{t.label.toLowerCase()===e.toLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{lbl:t.label,errorMessage:A,checked:t.value,disabled:null==t?void 0:t.disable,tootip:null==t?void 0:t.tooltip,onChange:e=>{let i={...h};if(!0===e)i.nativeChannels.push(t.label);else{let e=i.nativeChannels.filter((e=>e.toLowerCase()!==t.label.toLowerCase()));i.nativeChannels=e,Y("")}i.nativeChannels.length;let s=[...h.nativeChannels,...h.socialMedia,...h.paidAds];w(s.length?null:Rs),u(i),t.value=e,p(d+1)}})}))))})]})})]})})})},Bt=()=>(Bs(h.analyticsType),""!==h.goal?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Analytics type",right:!0})}),Ti.jsx(Zl,{id:"s_analyticstype",md:7,children:Ti.jsxs("div",{className:"d-flex "+(H?"click-off":"click-on"),children:[Ti.jsx("div",{className:"wsn",children:Ti.jsx(Rl,{lbl:"All",name:"Analyticstype",labelId:"analyticsAll",className2:"mr7",checked:2===h.analyticsType.length,cb:t=>{if("All"===t.target.value){let t={...h};t.analyticsType=[],Ct.map(((e,i)=>{t.analyticsType.push(e.label)})),u(t),L(null)}}})}),Ti.jsx("div",{className:"marginT-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})}),Ti.jsx(wo,{disabled:H,children:Ct.map(((t,e)=>(t.value=!1,h.analyticsType.map(((e,i)=>{t.label.toLocaleLowerCase()===e.toLocaleLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{lbl:t.label,isIcon:!0,iconPopover:t.info,errorMessage:N,checked:t.value,tootip:null==t?void 0:t.tooltip,onChange:e=>{let i={...h};if(!0===e)i.analyticsType.push(t.label);else{let e=i.analyticsType.filter((e=>e.toLocaleLowerCase()!==t.label.toLocaleLowerCase()));i.analyticsType=e}let s=i.analyticsType.length>0?null:Os;L(s),u(i)}})}))))})]})})]})}):null),Mt=()=>{const t=Bs($r);return Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Social media",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs("div",{className:"d-flex "+(H?"click-off":"click-on"),children:[Ti.jsx("div",{className:"wsn",children:Ti.jsx(Rl,{lbl:"All",name:"SocailMediamatchtype",labelId:"SocailMediaAll",className2:"mr7",checked:t.length===h.socialMedia.length,cb:e=>{if("All"===e.target.value){let e={...h};e.socialMedia=[],t.map(((t,i)=>{e.socialMedia.push(t.label)})),u(e)}Q(e.target.value)}})}),Ti.jsx("div",{className:"marginT-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})}),Ti.jsx(wo,{disabled:H,children:t.map(((t,e)=>(h.socialMedia.map(((e,i)=>{t.label.toLocaleLowerCase()===e.toLocaleLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{lbl:t.label,checked:t.value,onChange:e=>{let i={...h};if(e)i.socialMedia.push(t.label),Q("");else{let e=i.socialMedia.filter((e=>e.toLocaleLowerCase()!==t.label.toLocaleLowerCase()));i.socialMedia=e}t.value=e;let s=[...h.nativeChannels,...h.socialMedia,...h.paidAds];w(s.length?null:Rs),u(i);let a=i.socialMedia.length>0?null:qs;B(a)}})}))))})]})})]})})},Pt=()=>{const t=Bs(Hr);return Ti.jsx(Ti.Fragment,{children:Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Paid media",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs("div",{className:"d-flex "+(H?"click-off":"click-on"),children:[Ti.jsx("div",{className:"wsn",children:Ti.jsx(Rl,{lbl:"All",name:"PaidAddsmatchtype",labelId:"PaidAddsAll",className2:"mr7",checked:t.length===h.paidAds.length,cb:e=>{if("All"===e.target.value){let e={...h};e.paidAds=[],t.map(((t,i)=>{e.paidAds.push(t.label)})),u(e)}et(e.target.value)}})}),Ti.jsx("div",{className:"marginT-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})}),Ti.jsx(wo,{disabled:H,children:t.map(((t,e)=>(h.paidAds.map(((e,i)=>{t.label.toLocaleLowerCase()===e.toLocaleLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{lbl:t.label,checked:t.value,onChange:e=>{let i={...h};if(e)i.paidAds.push(t.label);else{let e=i.paidAds.filter((e=>e.toLocaleLowerCase()!==t.label.toLocaleLowerCase()));i.paidAds=e,et("")}t.value=e;let s=[...h.nativeChannels,...h.socialMedia,...h.paidAds];w(s.length?null:Rs),u(i);let a=i.paidAds.length>0?null:Vs;P(a)}})}))))})]})})]})})})},Ft=()=>Ti.jsx(Kl,{children:Ti.jsx(Jl,{children:Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mb",children:[Ti.jsx(as,{onClick:()=>{o.push({pathname:"/campaign"})},children:"Cancel"}),Ti.jsx(zs,{onClick:()=>{st(!0),H&&o.push({pathname:"/campaign"}),kt(0)},children:"Save"}),Ti.jsx(ns,{onClick:()=>{var e,i,s;let a=$s();if((0===a.id||6===a.id)&&!0===It())return;const n={name:(null==h?void 0:h.campaignName)||"Campaign name",startDate:(null==(e=null==h?void 0:h.startDate)?void 0:e.toString())||"Start name",endDate:(null==(i=null==h?void 0:h.endDate)?void 0:i.toString())||"End date",goal:(null==h?void 0:h.goal)||"Goal",type:(null==(s=null==h?void 0:h.campaignAttribute)?void 0:s.attributeName)||"Attributte name"};let l={plan:n,analyticsType:null==h?void 0:h.analyticsType,status:0===(null==t?void 0:t.campaignId)?6:bt.id,mode:0===(null==t?void 0:t.campaignId)?"add":"edit"};localStorage.setItem(`camp_${t.campaignId}`,ts(l)),st(!1),H?o.push({pathname:"/campaign/creation-smartlink",search:`?cId=${t.campaignId}&sl=true&cs=${a.id}`,state:{mode:t.campaignDetails.mode,campaignHeader:n,campaignId:t.campaignId,analyticsType:h.analyticsType}}):kt(1)},children:"Next"})]})})});return Ti.jsxs(Ti.Fragment,{children:[s&&Ti.jsx(No,{message:"Are you sure you want to leave?",onConfirm:()=>{a(!1),i(!1),setTimeout((()=>{o.push(n)}),100)},onCancel:()=>{a(!1)}}),!0===mt&&Ti.jsx(Il,{headerTitle:"Communication",para:yt,primaryButtonText:"OK",buttonClicked:t=>{vt(!1)}}),!0===at&&Ti.jsx(kl,{size:"lg",headerTitle:"Confirmation",para:"You have chosen today as the communication start date. Once you save the smartlinks, you will not be able to edit the communication. Please ensure that you have selected the required channels.",secondaryButtonText:"Cancel",primaryButtonText:"Proceed",buttonClicked:t=>{nt(!1),!0===t&&Dt(!0===it?0:1)}}),h&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"box-design bd-top-border",children:[Ti.jsx(Jr,{handleUnSavedChange:()=>{},onDisableChange:e=>{t.onDisableChange(e)},editClickOff:H,campaignDetails:h,context:c,errCampaignName:m,setCampaignDetails:t=>u(t),setErrCampaignName:t=>v(t)}),Ti.jsx(At,{}),Ti.jsx(wt,{}),Ti.jsx(Nt,{}),Ti.jsx(Lt,{}),Ti.jsxs("div",{id:"s_channels",children:[Ti.jsx(Et,{}),Ti.jsx(Mt,{}),Ti.jsx(Pt,{})]}),Ti.jsx(Bt,{})]}),Ti.jsx(Ft,{})]})]})},Jr=t=>{var e,i;const[s,a]=Di.useState(t.campaignDetails.campaignName),[n,l]=Di.useState(!1),[o,r]=Di.useState(!1),[c,d]=Di.useState(!1),[p,h]=Di.useState(!1);return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication name",right:!0})}),Ti.jsx(Zl,{md:7,id:"s_campaignname",className:!0===t.editClickOff?"click-off":"on",children:Ti.jsx(ql,{isLoading:p,iconPlaceholder:!0,iconName:o?"icon-rs-circle-tick-medium icons-md green":"",nocp:!0,required:!0,placeholder:"Communication name",val:s,max:100,errorMessage:t.errCampaignName,handleOnchange:e=>{t.handleUnSavedChange(),d(!0);let i=e.trimStart();if(r(!1),i.length<=100){if(i.includes("'"))return;if(""===i||/^[' 'A-Za-z0-9_-]*$/.test(i)){let e=i.replace(/\s+/g," ");a(e.trimStart());let s=i.length>0;s&&t.onDisableChange(s);let n=i.length>0?null:Ms;t.setErrCampaignName(n),t.campaignDetails}}else t.setErrCampaignName("Communication name exceeded the limit")},handleOnBlur:e=>{a(e.trim());let i={...t.campaignDetails};i.campaignName=e.trim(),t.setCampaignDetails(i),e.length>0&&c&&(h(!0),Dl(i.campaignName,t.context,(e=>{!0===e[0]?(t.setErrCampaignName(e[1]),r(!1),h(!1)):(r(!0),h(!1))})))}})}),Ti.jsx(Zl,{md:1,className:"rs-sub-icons-wrapper",children:Ti.jsx(xo,{disabled:t.editClickOff,children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Yi,tooltip:"Tags",color:`${(null==(i=null==(e=null==t?void 0:t.campaignDetails)?void 0:e.tags)?void 0:i.length)>0&&"blue"}`,onClick:()=>{l(!n)}})})})})]})}),n?Ti.jsx(Wr,{values:t.campaignDetails.tags,isOpen:n,className:"campaignTagsModalCSS",closeBtnClicked:()=>l(!1),onChangeIsOpen:e=>{l(e[0]);let i={...t.campaignDetails};i.tags=e[1],t.setCampaignDetails(i)}}):null]})},Zr=t=>{var e,i;const[s,a]=Di.useState((null==(i=null==(e=null==t?void 0:t.campaignDetails)?void 0:e.goalPercentage)?void 0:i.toString())||""),[n,l]=Di.useState(t.errGoalPercentage);return Ti.jsx("div",{id:"s_golapercentage",className:t.editClickOff?"click-off":"",children:Ti.jsx(ql,{disabled:""===t.campaignDetails.tPercentage,required:!0,placeholder:"Goal percentage",val:s,max:s.includes(".")?5:3,keyboardType:"number",handleOnchange:e=>{if(!(e.length>6)&&(""===e||/([0-9]*[.])?[0-9]+/.test(e))){a(e),t.campaignDetails;let i=e.length>0?null:"Enter the goal percentage";l(i)}},handleOnBlur:e=>{if(Math.abs(e)<=100){let i={...t.campaignDetails};i.goalPercentage=e,t.setCampaignDetails(i)}else{let e={...t.campaignDetails};e.goalPercentage="",t.setCampaignDetails(e),a(""),l("Limit exceed")}},errorMessage:n})})},Kr=t=>{var e;const[i,s]=Di.useState(0);Di.useState(t.campaignJson);const[a,n]=Di.useState(t.campaignDetails),[l,o]=Di.useState(null),[r,c]=Di.useState(t.dailyError);Di.useEffect((()=>{o(d()),c(t.dailyError)}),[]),Di.useEffect((()=>{c(t.dailyError)}),[t.dailyError]);const d=()=>{var t,e,i,s,n,l;if(void 0!==(null==(e=null==(t=null==a?void 0:a.frequency)?void 0:t.data)?void 0:e.frequency)){let t=null==(n=null==(s=null==(i=null==a?void 0:a.frequency)?void 0:i.data)?void 0:s.hourInterval)?void 0:n.map((t=>p(t)));return a.frequency.data.displayInterval=t,null==(l=null==a?void 0:a.frequency)?void 0:l.data}return{frequency:"Daily",dayInterval:"1",displayInterval:[""],hourInterval:[""]}},p=t=>{let e=new Date,[i,s]=t.split(" "),[a,n]=i.split(":");return"PM"===s&&"12"!==a?a=parseInt(a)+12:"AM"===s&&"12"===a&&(a=0),e.setHours(parseInt(a)),e.setMinutes(parseInt(n)),e.setSeconds(0),e.setMilliseconds(0),e};new Date((new Date).getTime()+18e5);const h={hour:1,minute:30,second:5};return null==(e=null==l?void 0:l.hourInterval)?void 0:e.map(((e,a)=>Ti.jsxs("div",{className:"rs-space-top",style:{display:"flex"},children:[Ti.jsxs("ul",{children:[" ",Ti.jsx("label",{children:"Every"})," "]}),Ti.jsx("ul",{className:"max-width100 ml15",children:Ti.jsx(ql,{required:!0,mainClass:"click-off",placeholder:"Day(s)",val:l.dayInterval,handleOnchange:a=>{e.days=a,s(i+1),t.onItemChanged(l)}})}),Ti.jsxs("ul",{className:"mx15",children:[" ",Ti.jsx("label",{children:"@"})," "]}),Ti.jsx("ul",{className:"max-width100",children:Ti.jsx("div",{className:`rs-kendo-datepicker-wrapper position-relative ${t.editClickOff?"click-off":""} ${r.errMsg?"color-primary-red":""}`,children:Ti.jsx(zi,{required:!0,label:`${r&&r.errMsg&&r.index===a?r.errMsg:"Hour interval"}`,steps:h,value:null==l?void 0:l.displayInterval[a],className:"required",format:"hh:mm a",onChange:e=>{const i=e.target.value.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});let s=new Date(e.target.value);Is("TimerComponent",e.target.value),s.getHours(),s.getMinutes(),s.getHours();let n={...l};n.hourInterval[a]=i,n.displayInterval[a]=e.target.value,o(n),t.onItemChanged(n),t.onChange(i)}})})})]})))},Yr=t=>{const[e,i]=Di.useState(t.campaignDetails),[s,a]=Di.useState(null),[n,l]=Di.useState(t.weeklyError);Di.useEffect((()=>{a(o())}),[]),Di.useEffect((()=>{l(t.weeklyError)}),[t.weeklyError]);const o=()=>{var t,i,s,a;if(void 0!==e.frequency.data.dayInterval){if(null==(i=null==(t=null==e?void 0:e.frequency)?void 0:t.data)?void 0:i.hourInterval){const t=new Date(null==(a=null==(s=null==e?void 0:e.frequency)?void 0:s.data)?void 0:a.displayInteval);e.frequency.data.displayInterval=t}return e.frequency.data}return{frequency:"Weekly",dayInterval:"",hourInterval:"",weekDays:[]}};return new Date((new Date).getTime()+18e5),Ti.jsx(Ti.Fragment,{children:null===s?null:Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{className:"rs-space-top",children:Ti.jsxs(wo,{children:[Ti.jsxs("li",{children:[" ",Ti.jsx("label",{children:"Every weeks on "})," "]}),Ti.jsx("li",{className:"ml15 "+(t.editClickOff?"click-off":""),children:Ti.jsx(ql,{placeholder:"Interval",required:!0,val:null==s?void 0:s.dayInterval,keyboardType:"number",handleOnchange:e=>{if("0"!==e)if(""===e){t.onChange("dayinterval",e);let i={...s};i.dayInterval=e,a(i)}else{if(""!==e&&parseInt(e)>99)return;if(""!==e&&_s(e)){t.onChange("dayinterval",e);let i={...s};i.dayInterval=e,a(i)}}},errorMessage:n.errDayInterval})}),Ti.jsxs("li",{className:"mx15",children:[" ",Ti.jsx("label",{children:"@"})," "]}),Ti.jsx("li",{children:Ti.jsx("div",{className:`rs-kendo-datepicker-wrapper position-relative ${t.editClickOff?"click-off":""} ${n&&n.errHourInterval?"errorContainer":""} `,children:Ti.jsx(zi,{label:`${n&&n.errHourInterval?n.errHourInterval:"Hours"}`,steps:{hour:1,minute:30,second:5},value:null==s?void 0:s.displayInterval,className:"required",onChange:e=>{const i=e.target.value.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});let n=new Date(e.target.value);Is("TimerComponent",e.target.value),n.getHours(),n.getMinutes(),n.getHours();let l={...s};l.displayInterval=e.target.value,l.hourInterval=i,a(l),t.onChange("hourinderval",i),t.displayInteval("displayInteval",e.target.value)}})})})]})}),Ti.jsx("div",{className:"position-relative",children:Ti.jsx(wo,{disabled:t.editClickOff,children:Xr.map(((e,i)=>(e.value=!1,s.weekDays.map(((t,i)=>{t.toLowerCase()===e.label.toLowerCase()&&(e.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{lbl:e.label,errorMessage:n&&n.errWeekDays&&n.errWeekDays,checked:e.value,onChange:i=>{let n={...s};if(!0===i)n.weekDays.push(e.label),a(n);else{let t=n.weekDays.filter((t=>t.toLowerCase()!==e.label.toLowerCase()));n.weekDays=t,a(n)}t.onChange("weekdays",n.weekDays)}})}))))})})]})})},Xr=[{label:"Sun",value:!1},{label:"Mon",value:!1},{label:"Tue",value:!1},{label:"Wed",value:!1},{label:"Thu",value:!1},{label:"Fri",value:!1},{label:"Sat",value:!1}],Qr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],tc=t=>{var e,i;const[s,a]=Di.useState(t.campaignJson);Di.useState(t.campaignDetails);const[n,l]=Di.useState(null),[o,r]=Di.useState(t.monthlyError);Di.useEffect((()=>{l(c())}),[]);const c=()=>{var e,i,a,n,l;if(void 0!==(null==(i=null==(e=null==t?void 0:t.campaignDetails)?void 0:e.frequency)?void 0:i.data)&&void 0!==t.campaignDetails.frequency.data.length&&void 0!==t.campaignDetails.frequency.data[0].frequency){let e=null==(l=null==(n=null==(a=null==t?void 0:t.campaignDetails)?void 0:a.frequency)?void 0:n.data)?void 0:l.map((t=>{if(!ss(t.hourInterval)){const e=ao(t.displayInterval).add(5,"days").toDate();t.displayInterval=e}return t}));return t.campaignDetails.frequency.data=e,t.campaignDetails.frequency.data}return s.frequency.filter((t=>"monthly"===t.frequency.toLowerCase()))};Di.useEffect((()=>{r(t.monthlyError)}),[t.monthlyError]),new Date((new Date).getTime()+18e5);const d={hour:1,minute:30,second:5};return(null==n?void 0:n.length)>0?Ti.jsx(Ti.Fragment,{children:null===n?null:Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{className:"rs-space-top",children:Ti.jsx(wo,{children:Ti.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[Ti.jsx("li",{className:t.editClickOff?"click-off":"",children:Ti.jsx(Rl,{lbl:"Day",name:"monthly",labelId:"day",checked:n[0].isDayEnable,cb:e=>{let i=[...n];i[0].isDayEnable=!0,i[1]={frequency:"Monthly",weekInterval:"",timeSubsetId:5,day:"",dayInterval:"",hourInterval:"",isDayEnable:!1},l(i),t.onItemChange(i)}})}),Ti.jsxs("div",{className:!0===n[0].isDayEnable?"click-on":"click-off",children:[Ti.jsx("li",{className:"max-width115 "+(t.editClickOff?"click-off":""),children:Ti.jsx(ql,{required:!0,placeholder:"Day(s)",val:n[0].dayInterval,keyboardType:"number",max:2,cb:e=>{if("0"!==e)if(""===e){let i=[...n];i[0].dayInterval=e,l(i),t.onChange("dayinterval",e),t.onItemChange(i)}else{if(""!==e&&parseInt(e)>99)return;if(""!==e&&_s(e)){let i=[...n];i[0].dayInterval=e,l(i),t.onChange("dayinterval",e),t.onItemChange(i)}}},errorMessage:n[0].isDayEnable&&o.errDayInterval})}),Ti.jsx("li",{className:"mx15",children:Ti.jsx("label",{children:"of every"})}),Ti.jsx("li",{className:"max-width115 "+(t.editClickOff?"click-off":""),children:Ti.jsx(ql,{required:!0,placeholder:"Month(s)",val:n[0].monthInterval,keyboardType:"number",max:2,cb:e=>{if("0"!==e)if(""===e){let i=[...n];i[0].monthInterval=e,l(i),t.onChange("monthinterval",e),t.onItemChange(i)}else{if(""!==e&&parseInt(e)>99)return;if(""!==e&&_s(e)){let i=[...n];i[0].monthInterval=e,l(i),t.onChange("monthinterval",e),t.onItemChange(i)}}},errorMessage:n[0].isDayEnable&&o.errMonthInterval})}),Ti.jsx("li",{className:"mx15",children:Ti.jsx("label",{children:"@"})}),Ti.jsx("li",{className:`rs-kendo-datepicker-wrapper position-relative ${t.editClickOff?"click-off":""} ${o&&o.errHourInterval?"errorContainer":""}`,children:Ti.jsx(zi,{steps:d,value:null==(e=n[0])?void 0:e.displayInterval,label:`${o&&o.errHourInterval&&n[0].isDayEnable?o.errHourInterval:"Hour(s)"}`,className:"required",onChange:e=>{const i=e.target.value.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});let s=[...n],a=new Date(e.target.value);a.getHours(),a.getMinutes(),a.getHours(),s[0].hourInterval=i,s[0].displayInterval=e.target.value,l(s),t.onChange("hourinterval",i),t.onItemChange(s)}})})]})]})})}),Ti.jsx(wo,{children:Ti.jsxs("div",{style:{display:"flex"},children:[Ti.jsx("li",{className:t.editClickOff?"click-off":"",children:Ti.jsx(Rl,{labelName:"The",name:"monthly",labelId:"the",checked:n[1].isDayEnable,cb:e=>{let i=[...n];i[0]={frequency:"Monthly",timeSubsetId:4,dayInterval:"",monthInterval:"",hourInterval:"",weekInterval:"",isDayEnable:!1},i[1].isDayEnable=!0,l(i),t.onItemChange(n)}})}),Ti.jsxs("div",{className:!0===n[0].isDayEnable?"click-off":"click-on",children:[Ti.jsx("li",{className:"width100",children:Ti.jsx(Ul,{disabled:t.editClickOff,data:["First","Second","Third","Fourth","Last"],value:void 0!==n[1].weekInterval&&""!==n[1].weekInterval?["First","Second","Third","Fourth","Last"][n[1].weekInterval-1]:"-- Select --",label:"Week",required:!0,errorMessage:o&&o.errWeekInterval&&n[1].isDayEnable?o.errWeekInterval:"",handleChange:e=>{let i=[...n],s=e.target.index+1;i[1].weekInterval=s,l(i),t.onChange("weekinterval",e.target.value),t.onItemChange(i)}})}),Ti.jsx("li",{className:"width120 ml15",children:Ti.jsx(Ul,{disabled:t.editClickOff,data:Qr,value:void 0!==n[1].day&&""!==n[1].day?Qr[n[1].day-1]:"-- Select --",label:"Day(s)",required:!0,errorMessage:o&&o.errDay&&n[1].isDayEnable?o.errDay:"",handleChange:e=>{let i=e.target.index+1,s=[...n];s[1].day=i,l(s),t.onChange("day",e.target.value),t.onItemChange(s)}})}),Ti.jsx("li",{className:"mx15",children:Ti.jsx("label",{children:"of every"})}),Ti.jsx("li",{className:"max-width115 "+(t.editClickOff?"click-off":""),children:Ti.jsx(ql,{required:!0,placeholder:"Month",val:n[1].dayInterval,keyboardType:"number",cb:e=>{if("0"!==e)if(""===e){let i=[...n];i[1].dayInterval=e,l(i),t.onChange("dayinterval",e),t.onItemChange(i)}else{if(""!==e&&parseInt(e)>99)return;if(""!==e&&_s(e)){let i=[...n];i[1].dayInterval=e,l(i),t.onChange("dayinterval",e),t.onItemChange(i)}}},errorMessage:n[1].isDayEnable&&o.errDayInterval})}),Ti.jsx("li",{className:"mx15",children:Ti.jsx("label",{children:"@"})}),Ti.jsx("li",{className:"max-width115",children:Ti.jsx("div",{className:"rs-kendo-datepicker-wrapper position-relative "+(t.editClickOff?"click-off":""),children:Ti.jsx(zi,{label:`${o&&o.errHourInterval&&n[1].isDayEnable?o.errHourInterval:"Hour(s)"}`,steps:d,value:null==(i=n[1])?void 0:i.displayInterval,className:"required",onChange:e=>{const i=e.target.value.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});let s=[...n],a=new Date(e.target.value);a.getHours(),a.getMinutes(),a.getHours(),s[1].hourInterval=i,s[1].displayInterval=e.target.value,l(s),t.onItemChange(s),t.onChange("hourinterval",i)}})})})]})]})})]})}):null},ec=Ni.memo((({data:t,onSearch:e,handleChange:i,value:s,valueCheck:a})=>{const[n,l]=Di.useState(""),[o,r]=Di.useState(!1),[c,d]=Di.useState(!1),p=t=>{!t.target.matches(".search-bar input")&&o&&(r(!1),d(!0))};Di.useEffect((()=>(document.addEventListener("click",p),()=>document.removeEventListener("click",p))),[o]);const h=t.filter((t=>{var e;return null==(e=null==t?void 0:t.dynamicListName)?void 0:e.toLowerCase().includes(null==n?void 0:n.toLowerCase())}));return Ti.jsxs("div",{className:"search-bar",children:[Ti.jsx("input",{placeholder:"Search the list",onChange:t=>{(t=>{l(t.target.value),r(!0)})(t)},className:"sp-input",value:o?n:s.dynamicListName,onClick:()=>{r(!o),l("")}}),Ti.jsx("hr",{style:{borderBottom:o?"0.2px solid #0000ff":0!=s.dynamicListId?"0.2px solid ##0000ff":"0.01px solid rgb(167 162 162)"}}),o&&Ti.jsx("div",{className:"audience-dropdown-list-container",children:Ti.jsx("ul",{className:"audience-dropdown-list",children:h.map((t=>Ti.jsx("li",{onClick:()=>(t=>{i(t),l(t.dynamicListName),r(!1),e&&e(t)})(t),children:Ti.jsx("span",{children:t.dynamicListName})},t.dynamicListId)))})})]})})),ic=t=>{var e,i,s;const[a,n]=Di.useState(1===(null==(e=null==t?void 0:t.data)?void 0:e.reccursOn)?"Hours":2===(null==(i=null==t?void 0:t.data)?void 0:i.reccursOn)?"Minutes":"Hours"),[l,o]=Di.useState((null==(s=null==t?void 0:t.data)?void 0:s.reccursEvery)||""),[r,c]=Di.useState(null);return Di.useEffect((()=>{var e;c((null==(e=null==t?void 0:t.shortlyError)?void 0:e.errMsg)||null)}),[null==t?void 0:t.shortlyError]),Ti.jsx("div",{className:"rs-space-top",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{required:!0,label:"Frequency",data:["Hours","Minutes"],value:a,onChange:e=>{n(e.target.value),o(""),null==t||t.onDataUpdate({reccursOn:"Hours"===e.target.value?1:2,reccursEvery:""})}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(ql,{required:!0,label:"Frequency value",placeholder:"Frequency value",max:2,val:l,errorMessage:r,onChange:e=>{let i=e.target.value.length>0?null:"Enter frequency value";c(i),o(e.target.value),null==t||t.onDataUpdate({reccursOn:"Hours"===a?1:2,reccursEvery:e.target.value})},onBlur:e=>{var i;if(!1===(""===(i=e.target.value)?(c("Enter frequency value"),!0):"Hours"===a?i>=1&&i<=24?(c(null),!0):(c("Enter frequency value"),setTimeout((()=>{c(null)}),2e3),!1):"Minutes"===a?i>=15&&i<=90?(c(null),!0):(c("Enter frequency value"),setTimeout((()=>{c(null)}),2e3),!1):void 0))return o(""),void(null==t||t.onDataUpdate({reccursOn:"Hours"===a?1:2,reccursEvery:""}))}})})]})})},sc=t=>{var e,i,s,a,n,l;let o=Ai();const r=Di.useContext(Ji),[c,d]=Di.useState(t.json.campaignDetails.startDate),[p,h]=Di.useState(t.json.campaignDetails.endDate),[u,m]=Di.useState(!1),[v,y]=Di.useState(!1),[g,b]=Di.useState(null),[f,x]=Di.useState(t.json);Di.useState(0);const[S,C]=Di.useState(!1),[j,T]=Di.useState(!1),[I,k]=Di.useState(null),[D,A]=Di.useState(!1),[w,N]=Di.useState(null),[L,E]=Di.useState(null),[B,M]=Di.useState(null),[P,F]=Di.useState(!1),[U,R]=Di.useState(!1),[O,q]=Di.useState(null),[V,z]=Di.useState(null),[$,H]=Di.useState(null),[G,W]=Di.useState(null),[_,J]=Di.useState(null),[Z,K]=Di.useState(null),[Y,X]=Di.useState(null),[Q,tt]=Di.useState(null),[et,it]=Di.useState(null),[st,at]=Di.useState(null),[nt,lt]=Di.useState(null),[ot,rt]=Di.useState(null),[ct,dt]=Di.useState({}),[pt,ht]=Di.useState({}),[ut,mt]=Di.useState({}),[vt,yt]=Di.useState({}),[gt,bt]=Di.useState(!1),[ft,xt]=Di.useState(""),[St,Ct]=Di.useState(0),[jt,Tt]=Di.useState(!1),[It,kt]=Di.useState(!1),[Dt,At]=Di.useState(0),[wt,Nt]=Di.useState([{text:"Immediate",id:4,disable:!1},{text:"Shortly",id:4,disable:!1},{text:"Daily",id:1,disable:!0},{text:"Weekly",id:2,disable:!0},{text:"Monthly",id:3,disable:!0}]),[Lt,Et]=Di.useState(!1),[Bt,Mt]=Di.useState([]),[Pt,Ft]=Di.useState(Bs([{label:"Web",value:!1,info:"Analyze the behavior of visitors on your website.",disabled:!0},{label:"App",value:!1,info:"Analyze the behavior of visitors on your mobile app.",disabled:!0}])),[Ut,Rt]=Di.useState([]),[Ot,qt]=Di.useState([]),[Vt,zt]=Di.useState(!1),[$t,Ht]=Di.useState(!1),[Gt,Wt]=Di.useState(null),[_t,Jt]=Di.useState(Es(6)),[Zt,Kt]=Di.useState(null),[Yt,Xt]=Di.useState(!1),[Qt,te]=Di.useState(null),[ee,ie]=Di.useState(null),[se,ae]=Di.useState(null),[ne,le]=Di.useState(new Date);Di.useEffect((()=>{var e,i,s,a;r.globalStateData.getMasterDropdownData;const n=Zs();at(null==n?void 0:n.timeZone);const l={...f};let o=["Reach"];l.primaryGoal.map((t=>{o.push(t)})),l.primaryGoal=o,x(l);let c=ms();if(Rt((null==c?void 0:c.conversionTypeList)||[]),qt((null==c?void 0:c.engagementList)||[]),t.campaignId<=0){let t=wl(!1);t.campaignId=0,t.isDuplicate=!1,(null==(e=null==window?void 0:window.sdxDetails)?void 0:e.campaignDetails)&&(t=window.sdxDetails.campaignDetails,t.campaignId=0,t.isDuplicate=!1,(null==(i=null==t?void 0:t.dynamicList)?void 0:i.dynamicListId)&&(null==(s=null==t?void 0:t.dynamicList)?void 0:s.dynamicListId)>0&&oe(null==(a=null==t?void 0:t.dynamicList)?void 0:a.dynamicListId,(t=>{}))),b(t),Mt(Bs([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!0}]))}else re()}),[]);const oe=(t,e,i)=>{ye(t,(t=>{let i=Bs([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!0}]),s=[...Pt];i.map((e=>{var i,a,n,l;null==(a=null==(i=null==t?void 0:t.data)?void 0:i.channels)||a.map((i=>{var s;e.channelId===i&&(e.disabled=!0,e.value=!1,e.tooltip="The selected dynamic list has already used to create communication using the same channel. Choose a different dynamic list or select another channel."),1==e.channelId&&"Email"===e.label&&(null==(s=null==t?void 0:t.data)?void 0:s.isFormEnabled)&&(e.disabled=!1,e.value=!1)})),s.map((i=>{var s;8==e.channelId&&"Web"===i.label||14==e.channelId&&"App"===i.label?(i.disabled=!0,i.value=!1):1==e.channelId&&"Email"===e.label&&(null==(s=null==t?void 0:t.data)?void 0:s.isFormEnabled)&&(e.disabled=!1,e.value=!1)})),null!==(null==(n=null==t?void 0:t.data)?void 0:n.geoFence)&&void 0!==(null==(l=null==t?void 0:t.data)?void 0:l.geoFence)&&8===e.channelId&&(e.disabled=!0,e.value=!1)})),be(t.data.isImmediate,null==t?void 0:t.data.geoFence,(i=>{setTimeout((()=>{var s;e(i,(null==(s=null==t?void 0:t.data)?void 0:s.geoFence)||null)}),1e3)})),Mt(i),Tt(i),Ft(s)}))},re=()=>{Nl(t.campaignId,r,t.attributes,(e=>{var i;e.campaignId=t.campaignId,e.endMindate,b(e),Mt([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!1}]),e.dynamicList.dynamicListId>0&&ye(e.dynamicList.dynamicListId,(t=>{var i,s,a;let n=[{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!1}],l=[...Pt];n.map((e=>{var i;null==(i=null==t?void 0:t.data)||i.channels.map((t=>{t===e.channelId&&(e.disabled=!0)}))})),e.channelTypes.map((t=>{n.map((e=>{t===e.label&&(e.disabled=!1,e.value=!0,e.tooltip="The selected dynamic list has already used to create communication using the same channel. Choose a different dynamic list or select another channel.")}))})),be(t.data.isImmediate,null==(i=null==t?void 0:t.data)?void 0:i.geoFence,(t=>{})),Ct(ce(e,null==(s=null==t?void 0:t.data)?void 0:s.geoFence)),Mt(n),Tt(n),Ft(l),ae((null==(a=null==t?void 0:t.data)?void 0:a.geoFence)||null)}));const s=no.parse(null==(i=null==o?void 0:o.location)?void 0:i.search);let a=void 0!==s.cs?parseInt(s.cs):0;Jt(Es(a)),Kt({...e}),te(a),5!==a&&9!==a&&20!==a||bt(!0),Ct(ce(g,null))}))},ce=(t,e)=>{let i=0,s=[...wt];return s.map(((s,a)=>{if(s.disable=!0,(t&&"immediate"===t.frequency.frequency.toLocaleLowerCase()||"shortly"===t.frequency.frequency.toLocaleLowerCase())&&("immediate"!==s.text.toLowerCase()&&"shortly"!==s.text.toLowerCase()||(s.disable=!1),"shortly"===s.text.toLowerCase()&&null!=e&&(s.disable=!0)),(t&&"daily"===t.frequency.frequency.toLocaleLowerCase()||"weekly"===t.frequency.frequency.toLocaleLowerCase()||"monthly"===t.frequency.frequency.toLocaleLowerCase())&&("daily"!==s.text.toLowerCase()&&"weekly"!==s.text.toLowerCase()&&"monthly"!==s.text.toLowerCase()||(s.disable=!1)),t&&t.frequency.frequency.toLocaleLowerCase()===s.text.toLocaleLowerCase())return i=a,void(s.disable=!1)})),Nt(s),i},de=(e,i,s)=>{var a,n,l;if(0===e)o.push({pathname:"/campaign"});else{localStorage.setItem("cId",i);let e=t.campaignId<=0?"add":"edit",r=localStorage.getItem(`camp_${i}`),c={};null!=r&&(c=ks(r)),c.notifyData={mode:e,editClickOff:gt,statusId:_t.id,channelTypes:g.channelTypes,analyticsType:g.analyticsType,campaignJson:JSON.stringify(g)},localStorage.setItem(`camp_${i}`,ts(c));let d=`cId=${i}`,p=null==(l=null==(n=null==(a=null==window?void 0:window.location)?void 0:a.search)?void 0:n.slice(1))?void 0:l.replace(d,"");o.push({pathname:"/campaign/creation-notification",search:`?cId=${i}&${p}`,state:{mode:e,campaignName:g.campaignName,editClickOff:gt,status:0===t.campaignId?"Draft":_t.title,Channeltype:g.channelTypes,AnalyticsType:g.analyticsType,mobileApp:{},campaignId:i,campaignHeader:s,channelId:0,statusId:_t.id}})}},pe=(t,e,i=!1)=>{var s,a;let n=!1;const l=no.parse(null==(s=null==o?void 0:o.location)?void 0:s.search);let d=void 0!==l.cs?parseInt(null==l?void 0:l.cs):0;if(5===d&&0===(null==(a=null==g?void 0:g.dynamicList)?void 0:a.dynamicListId))de(t,g.campaignId,e);else if(5===d)n=!1;else if(9===d)de(t,g.campaignId,e);else{let t=((t,e)=>{var i,s;let a=!1;return ss(t.campaignName)||null!==e&&e.length>0?(a=!0,{status:a,type:1,message:e||"Enter communication name"}):ss(t.campaignAttribute.attributeName)||t.campaignAttribute.attributeName.toLowerCase().includes("select")?(a=!0,{status:a,type:2,message:Ps}):ss(t.productCategory.categoryName)||t.productCategory.categoryName.toLowerCase().includes("select")?(a=!0,{status:a,type:3,message:Hs}):ss(t.goal)||t.goal.toLowerCase().includes("select")?(a=!0,{status:a,type:4,message:Gs}):"engagement"!==t.goal.toLowerCase()&&"conversion"!==t.goal.toLowerCase()||""!==t.goalType&&!0!==t.goalType.conversionName.toLowerCase().includes("select")?!t.isShowsecondaryGoal||t.secondaryGoal&&!t.secondaryGoal.toLowerCase().includes("select")?!0===t.isShowsecondaryGoal&&ss(t.secondaryGoalPercentage)?(a=!0,{status:a,type:12,message:"Enter secondadory goal percentage"}):!0!==t.isShowsecondaryGoal||"engagement"!==t.secondaryGoal.toLowerCase()&&"conversion"!==t.secondaryGoal.toLowerCase()||t.secondaryGoalType&&!0!==t.secondaryGoalType.conversionName.toLowerCase().includes("select")?!0===t.isShowsecondaryGoal&&(void 0!==t.secondaryGoal&&null!==t.secondaryGoal&&ss(t.secondaryGoal)||(null==(s=null==(i=t.secondaryGoal)?void 0:i.toLowerCase())?void 0:s.includes("select")))?(a=!0,{status:a,type:11,message:"Select secondadory goal"}):ss(t.goalPercentage)||0==Math.abs(t.goalPercentage)?(a=!0,{status:a,type:6,message:"Enter the goal percentage"}):ss(t.startDate.toString())?(a=!0,{status:a,type:7,message:Fs}):(t.startDate.toString(),ss(t.endDate.toString())||""!==t.endDate.toString()&&Ws(t.endDate,new Date)<0?(a=!0,{status:a,type:8,message:Us}):t.channelTypes.length<=0?(a=!0,{status:a,type:9,message:Js}):"reach"!==t.goal.toLowerCase()&&t.analyticsType.length<=0?(a=!0,{status:a,type:10,message:Os}):{status:a,type:0,message:"no error"}):{status:!0,type:13,message:"Select secondary goal type"}:{status:!0,type:11,message:"Select secondary goal"}:(a=!0,{status:a,type:5,message:"Select goal type"})})(g,I);if(!0===t.status)return((t,e)=>{const i={1:k,2:N,3:X,4:E,5:q,6:J,7:H,8:W,9:tt,10:it,11:M,12:K,13:z};if(6===t)return void J(e);const s=i[t];s&&s(e)})(t.type,t.message),void window.scrollTo({top:document.body.scrollHeight/4,behavior:"smooth"});let e=(t=>{var e,i,s,a,n,l;let o=!1;if(void 0!==t.dynamicList.dynamicListName&&!1===t.dynamicList.dynamicListName.toLowerCase().includes("select")&&void 0!==t.frequency.frequency&&"immediate"===t.frequency.frequency.toLowerCase()&&(t.frequency={frequency:"Immediate",frequencyId:4}),void 0!==t.dynamicList.dynamicListName&&!1===t.dynamicList.dynamicListName.toLowerCase().includes("select")&&"shortly"===(null==(i=null==(e=null==t?void 0:t.frequency)?void 0:e.frequency)?void 0:i.toLowerCase())){let e={};if(!1===/^\d*$/.test(null==(s=null==t?void 0:t.frequency)?void 0:s.reccursEvery)&&(e.errMsg="Enter frequency value",o=!0),o)return{status:o,type:4,data:e}}if(void 0!==t.dynamicList.dynamicListName&&!1===t.dynamicList.dynamicListName.toLowerCase().includes("select")&&"daily"===(null==(n=null==(a=null==t?void 0:t.frequency)?void 0:a.frequency)?void 0:n.toLowerCase())){let e={};if(Object.keys(t.frequency.data).length>0?t.frequency.data.hourInterval.length>0&&""===t.frequency.data.hourInterval[0]&&(e.errMsg="Select time",e.index=0,o=!0):(e.errMsg="Hour interval",e.index=0,o=!0),o)return{status:o,type:1,data:e};t.frequency.ferquencyId=1,t.frequency.reccursEvery=1,t.frequency.recurrsTime=t.frequency.data.hourInterval[0]}if(void 0!==t.dynamicList.dynamicListName&&!1===t.dynamicList.dynamicListName.toLowerCase().includes("select")&&"weekly"===t.frequency.frequency.toLowerCase()){if(!(Object.keys(t.frequency.data).length>0))return o=!0,{status:o,type:2,data:{errDayInterval:"Day interval"}};{let e=t.frequency.data,i={};if(ss(e.dayInterval))return i.errDayInterval="Day interval",o=!0,{status:o,type:2,data:i};if(ss(e.hourInterval))return i.errHourInterval="Hour interval",o=!0,{status:o,type:2,data:i};if(void 0===(null==e?void 0:e.weekDays)||null===(null==e?void 0:e.weekDays)||(null==(l=null==e?void 0:e.weekDays)?void 0:l.length)<=0)return o=!0,i.errWeekDays="Select week interval",{status:o,type:2,data:i};t.frequency.ferquencyId=2,t.frequency.reccursEvery=e.dayInterval,t.frequency.recurrsTime=e.hourInterval,t.frequency.isMonday=!1,t.frequency.isTuesday=!1,t.frequency.isWednesday=!1,t.frequency.isThrusday=!1,t.frequency.isFriday=!1,t.frequency.isSaturday=!1,t.frequency.isSunday=!1,e.weekDays.map((e=>{e.toLowerCase().includes("mon")?t.frequency.isMonday=!0:e.toLowerCase().includes("tue")?t.frequency.isTuesday=!0:e.toLowerCase().includes("wed")?t.frequency.isWednesday=!0:e.toLowerCase().includes("thu")?t.frequency.isThrusday=!0:e.toLowerCase().includes("fri")?t.frequency.isFriday=!0:e.toLowerCase().includes("sat")?t.frequency.isSaturday=!0:e.toLowerCase().includes("sun")&&(t.frequency.isSunday=!0)})),t.frequency.data=e}}if(void 0!==t.dynamicList.dynamicListName&&!1===t.dynamicList.dynamicListName.toLowerCase().includes("select")&&"monthly"===t.frequency.frequency.toLowerCase()){let e={};if(!(Object.keys(t.frequency.data).length>0))return o=!0,e.errDayInterval="Day interval",{status:o,type:3,data:e};{let e={},i=t.frequency.data;if(((t,e)=>{let i=t.filter((t=>!0===t.isDayEnable));i.length>0&&(e.frequency.reccursEvery=4===i[0].timeSubsetId?i[0].dayInterval:i[0].weekInterval,e.frequency.recurrsTime=i[0].hourInterval,e.frequency.reccursOn=4===i[0].timeSubsetId?i[0].monthInterval:i[0].dayInterval,e.frequency.timeSubsetId=i[0].timeSubsetId,e.frequency.isWeekEnd=4===i[0].timeSubsetId,e.frequency.isWeekDay=i[0].day,e.frequency.data=t,e.frequency.recurrsEveryTimeId=4===i[0].timeSubsetId?"":i[0].day,void 0!==i[0].day&&(e.frequency.isday=i[0].day))})(i,t),i.map(((t,i)=>{if(!0!==o)if(t.isDayEnable&&0===i)e=(t=>{let e=!1,i={};return ss(t.isDayEnable)?(e=!0,i.errDayInterval="Day interval",{status:e,type:3,data:i}):ss(t.monthInterval)?(e=!0,i.errMonthInterval="Month interval",{status:e,type:3,data:i}):ss(t.hourInterval)?(e=!0,i.errHourInterval="Hour interval",{status:e,type:3,data:i}):{status:e,type:3,data:null}})(t),!0===e.status&&(o=!0);else if(t.isDayEnable&&1===i&&(e=(t=>{let e=!1,i={};return ss(t.isDayEnable)?(e=!0,i.errDayInterval="Day interval",{status:e,type:3,data:i}):ss(t.weekInterval)?(e=!0,i.errWeekInterval="Weekly interval",{status:e,type:3,data:i}):ss(t.hourInterval)?(e=!0,i.errDayInterval="Hour interval",{status:e,type:3,data:i}):ss(t.day)?(e=!0,i.errDay="Day interval",{status:e,type:3,data:i}):ss(t.dayInterval)?(e=!0,i.errDayInterval="Enter day",{status:e,type:3,data:i}):void 0!==(null==t?void 0:t.errHourInterval)?(e=!0,i.errDayInterval="Select day",{status:e,type:3,data:i}):{status:e,type:3,data:null}})(t),!0===e.status))return void(o=!0)})),!0===e.status)return e}}return{status:o,type:0,errData:null}})(g);if(!0===e.status)return void((t,e)=>{const i={1:ht,2:mt,3:yt,4:dt}[t];i&&i(e)})(e.type,e.data);if(void 0!==g.dynamicList.dynamicListName&&!1===g.dynamicList.dynamicListName.toLowerCase().includes("select")&&(ss(g.timeZone.timezoneName)||g.timeZone.timezoneName.toLowerCase().includes("select")))return n=!0,void rt(Xs)}if(!1===i&&null!=se&&!1===(null==se?void 0:se.isAllTime)&&null!==(null==se?void 0:se.endDate)&&void 0!==(null==se?void 0:se.endDate)){let i=new Date(c),s=new Date(p),a=new Date(null==se?void 0:se.endDate);if(Qs(i,a))return window._sdxcplan={save:t,campaignHeader:e},void Ht(!0);if(ta(s,a))return window._sdxcplan={save:t,campaignHeader:e},void Ht(!0)}n||(r.channels=g.channelTypes,g.isSmartLink=!1,Ll(g,r,(i=>{if(!0===i.status){let s=i.data.campaignId;de(t,s,e)}else zt(!0),Wt(i.message)})))},he=t=>{const[e,i]=Di.useState(null==t?void 0:t.value),[s,a]=Di.useState(t.errGoalPercentage);return Ti.jsx(Ti.Fragment,{children:Ti.jsx(ql,{disabled:gt,required:!0,placeholder:"Goal percentage",val:e,keyboardType:"number",max:(null==e?void 0:e.includes("."))?5:3,errorMessage:s,handleOnchange:t=>{if(!(t.length>6))if(""===t||/([0-9]*[.])?[0-9]+/.test(t)){let e=t.length>0?null:"Enter the goal percentage";a(e),i(t)}else{let e=t.length>0?null:"Enter the goal percentage";a(e)}},handleOnBlur:e=>{let s=Math.abs(e),n={...t.campaignDetails};if(s<=100?(!1===(null==t?void 0:t.primaryGoal)&&(n.secondaryGoalPercentage=e),n.goalPercentage=e,t.setCampaignDetails(n)):(t.setCampaignDetails(n),n.goalPercentage="",!1===(null==t?void 0:t.primaryGoal)&&(n.secondaryGoalPercentage=""),i(""),a("Limit exceed")),0===s){let t=0===s?"Enter the goal percentage":null;a(t),n.errMsg=t}else if(e.length)n.errMsg=null;else{let t=e.length>0?null:"Enter the goal percentage";a(t),n.errMsg=t}t.setCampaignDetails(n)}})})},ue=()=>Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Primary goal",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{isLoading:P,data:["Reach","Engagement","Conversion"],value:""!==g.goal?g.goal:"-- Goal --",label:"Primary goal",required:!0,errorMessage:L,disabled:!!gt,handleChange:e=>{var i=0;let s={...g},a=0;"reach"===e.target.value.toLowerCase()?a=1:"engagement"===e.target.value.toLowerCase()?a=2:"conversion"===e.target.value.toLowerCase()&&(a=3);let n=e.target.value;n===f.primaryGoal[1]?f.engamentTypes[0]:f.conversationTypes[0],s.goal=e.target.value,s.goalPercentage="",s.tPercentage="",b(s),F(!0),At(0),El(r,s.productCategory.categoryId,a,(s=>{let a={...g};a.goal=n,a.goalType={conversionName:"-- Select goal type --",conversionTypeId:-1},F(!1),i=s.status?"3.20":"reach"===a.goal.toLowerCase()?"1.70":"engagement"===a.goal.toLowerCase()?"5.20":"conversion"===a.goal.toLowerCase()?"10.45":"";let l=e.target.value.length>0?null:Gs;E(l),J(null),a.goalPercentage=i,a.tPercentage=i,b(a),At(1),t.onChange("goalPercentage",i),t.onChange("reachType",e.target.value)}))}})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs("div",{style:{display:"flex",flexDieration:"row"},children:[Ti.jsx("div",{style:{width:"98%"},children:Ti.jsx(he,{primaryGoal:!0,value:g.goalPercentage,editClickOff:!!gt,campaignDetails:g,errGoalPercentage:_,setCampaignDetails:t=>{b(t),""===t.goalPercentage?J("Enter the goal percentage"):(null==t?void 0:t.errMsg)?J(t.errMsg):J(null)},setErrGoalPercentage:t=>J(t)})}),Ti.jsx("div",{style:{width:2,marginTop:-7},children:Ti.jsx(Ao,{className:"color-primary-grey fs16 posr top8",label:"%",disabled:gt})})]})})]})}),""!==g.goal&&Ti.jsx(Zl,{md:1,className:"rs-sub-icons-wrapper",children:Ti.jsx(xo,{disabled:gt,children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Ss,tooltip:"Add secondarory goal",color:"blue",iconClass:!0===g.isShowsecondaryGoal&&"click-off",onClick:()=>{let t={...g};t.isShowsecondaryGoal=!0,b(t)}})})})})]})}),me=()=>Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Secondary goal",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{isLoading:U,data:["Reach","Engagement","Conversion"].filter((t=>t!==g.goal)),value:""!==g.secondaryGoal?g.secondaryGoal:"-- Goal --",label:"Secondary goal",required:!0,errorMessage:B,disabled:!!gt,handleChange:e=>{var i=0;let s={...g},a=0;"reach"===e.target.value.toLowerCase()?a=1:"engagement"===e.target.value.toLowerCase()?a=2:"conversion"===e.target.value.toLowerCase()&&(a=3);let n=e.target.value;s.secondaryGoal=e.target.value,s.secondaryGoalPercentage="",s.tPercentage="",b(s),R(!0),M(null),At(0),El(r,s.productCategory.categoryId,a,(s=>{let a={...g};a.secondaryGoal=n,a.secondaryGoalType={conversionName:"-- Select goal type --",conversionTypeId:-1},R(!1),i=s.status?"3.20":"reach"===a.secondaryGoal.toLowerCase()?"1.70":"engagement"===a.secondaryGoal.toLowerCase()?"5.20":"conversion"===a.secondaryGoal.toLowerCase()?"10.45":"";let l=e.target.value.length>0?null:Gs;E(l),J(null),a.secondaryGoalPercentage=i,a.tPercentage=i,b(a),At(1),t.onChange("goalPercentage",i),t.onChange("reachType",e.target.value)}))}})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs("div",{style:{display:"flex",flexDieration:"row"},children:[Ti.jsx("div",{style:{width:"98%"},children:Ti.jsx(he,{primaryGoal:!1,value:g.secondaryGoalPercentage,editClickOff:!!gt,campaignDetails:g,errGoalPercentage:Z,setCampaignDetails:t=>{b(t),""===t.goalPercentage?K("Enter the goal percentage"):(null==t?void 0:t.errMsg)?K(t.errMsg):K(null)},setErrGoalPercentage:t=>K(t)})}),Ti.jsx("div",{style:{width:2,marginTop:-7},children:Ti.jsx(Ao,{className:"color-primary-grey fs16 posr top8",label:"%",disabled:gt})})]})})]})}),""!==g.goal&&Ti.jsx(Zl,{md:1,className:"rs-sub-icons-wrapper",children:Ti.jsx(xo,{disabled:gt,children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:ea,tooltip:"Remove",color:"red",onClick:()=>{let t={...g};t.isShowsecondaryGoal=!1,t.secondaryGoal="",t.secondaryGoalType="",t.secondaryGoalPercentage="",b(t)}})})})})]})}),ve=t=>{var e,i;let s=g.goal!==f.primaryGoal[0]&&g.goal.length>0,a=g.goal+" type",n=""!==(null==g?void 0:g.goalType)?g.goalType:{conversionName:"-- Select goal type --",conversionTypeId:-1},l=g.goal===f.primaryGoal[1]?Ot:Ut,o=O;return t.secondaroyGoal&&(s=g.secondaryGoal!==f.primaryGoal[0]&&(null==(e=g.secondaryGoal)?void 0:e.length)>0,a="Secondary goal "+(null==(i=g.secondaryGoal)?void 0:i.toLowerCase())+" type",n=""!==(null==g?void 0:g.secondaryGoalType)?g.secondaryGoalType:{conversionName:"-- Select goal type --",conversionTypeId:-1},l=g.secondaryGoal===f.primaryGoal[1]?Ot:Ut,o=V),s?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:`${a}`,right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{data:l,value:n,textField:"conversionName",dataItemKey:"conversionTypeId",label:`${a}`,required:!0,disabled:!!gt,errorMessage:o,handleChange:e=>{let i={...g};t.secondaroyGoal?(i.secondaryGoalType=e.target.value,z(null)):(q(null),i.goalType=e.target.value),b(i)}})})]})}):null},ye=(t,e)=>{let i;os({path:Ks,loading:r.globalStateData.setCampaignNameLoadingData,params:{dynamiclistId:t},ok:t=>{var s;t.status&&(i=t.data.isImmediate),be(i,null==(s=null==t?void 0:t.data)?void 0:s.geoFence,(t=>{})),t.status&&t.data&&t.data.channels&&t.data.channels.length>0?e(t):(Tt(ge(Bt)),kt(ge(Pt))),e(t)},fail:t=>{be(i,null,(t=>{})),Tt(ge(Bt)),kt(ge(Pt))}})},ge=t=>{null==t||t.map((t=>{t.disabled=!1,t.value=!1})),ie(!0)},be=(t,e,i)=>{wt.map((i=>{"Shortly"===i.text?(i.disable=!1,null!=e&&(i.disable=!0)):"Immediate"===i.text||"Shortly"===i.text?i.disable=!t:i.disable=!1!==t})),Nt(wt),t?(Ct(0),i(0)):(Ct(2),i(2))},fe=Ys("lsConfig");return Ti.jsxs(Ti.Fragment,{children:[!0===Vt&&Ti.jsx(Il,{headerTitle:"Communication",para:Gt,primaryButtonText:"OK",buttonClicked:t=>{zt(!1)}}),!0===$t&&Ti.jsx(Il,{headerTitle:"Communication",para:"The geofence date range is outside the communication end date. Are you sure you want to proceed?",primaryButtonText:"Proceed",secondaryButtonText:"Cancel",buttonClicked:t=>{Ht(!1),!0===t&&pe(window._sdxcplan.save,window._sdxcplan.campaignHeader,!0)}}),g&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"box-design bd-top-border",children:[Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication name",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(ql,{name:"communication name",nocp:!0,required:!0,placeholder:"Communication name",val:g.campaignName,errorMessage:I,disabled:!!gt,max:100,isLoading:D,iconPlaceholder:!0,iconName:Lt?"icon-rs-circle-tick-medium icons-md green paddingL15":"",handleOnchange:e=>{Xt(!0);let i=e.trimStart();if(Et(!1),i.length<=100){if(i.includes("'"))return;if(/^[' 'A-Za-z0-9_-]*$/.test(i)){let e=!(i.length>0);e||t.onDisableChange(e);let s=i.length>0?null:Ms;k(s);let a={...g},n=i.replace(/\s+/g," ");return a.campaignName=n.trimStart(),b(a),void(i.length>=100&&k("Communication name exceeded the limit"))}}},handleOnBlur:e=>{let i={...g};i.campaignName=e.trim(),b(i),t.onChange("ncampaingName",e),e.length>0&&Yt&&(A(!0),Dl(e.trim(),r,(t=>{if(!0===t[0]){let e=t[1];A(!1),k(e)}else A(!1),Et(!0)})))}})}),Ti.jsx(Zl,{md:1,className:"rs-sub-icons-wrapper",children:Ti.jsx(xo,{disabled:gt,children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Yi,tooltip:"Tags",color:`${g.tags.length>0&&"blue"}`,onClick:()=>{C(!S)}})})})})]})}),Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication / Product type",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{disabled:gt,data:null==(e=null==t?void 0:t.attributes)?void 0:e.campaignAttributeList,value:void 0!==g.campaignAttribute&&""!==g.campaignAttribute.attributeName?g.campaignAttribute:"-- Select --",textField:"attributeName",dataItemKey:"campaignAttributeId",label:"Communication type",required:!0,errorMessage:w,handleChange:e=>{let i={...g};i.campaignAttribute=e.target.value,b(i);let s=e.target.value.attributeName.length>0?null:Ps;N(s),t.onChange("camapaignTypes",e.target.value)}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{disabled:gt,data:null==(i=null==t?void 0:t.attributes)?void 0:i.productCategorysList,value:void 0!==g.productCategory&&""!==g.productCategory.categoryName?g.productCategory:"-- Select  --",textField:"categoryName",dataItemKey:"categoryId",label:"Product type",required:!0,errorMessage:Y,handleChange:e=>{let i={...g};i.productCategory=e.target.value,b(i),t.onChange("productTypes",e.target.value);let s=e.target.value.categoryName.length>0?null:Ps;X(s)}})})]})})]})}),Ti.jsx(ue,{}),Ti.jsx(ve,{}),g.isShowsecondaryGoal?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(me,{}),Ti.jsx(ve,{secondaroyGoal:!0})]}):null,Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Communication period",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Fo,{required:!0,placeholder:"Start date",errorMessage:$,disabled:gt,value:""!==g.startDate?g.startDate:null,min:ne,handleChange:t=>{d(t.target.value);var e=t.target.value,i=e.setDate(e.getDate()+3);let s=new Date(i);xt(s),g.endDate="",g.endMindate=s,g.startDate=t.target.value;let a=null!==t.target.value?null:Fs;H(a)}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Fo,{required:!0,placeholder:"End date",errorMessage:G,disabled:5===Qt?"":gt,value:""!==g.endDate?g.endDate:null,min:g.endMindate,handleChange:t=>{h(t.target.value),g.endDate=t.target.value;let e=null!==t.target.value?null:Us;W(e)}})})]})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Audience list",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx("div",{className:"wsn "+(!fe.sdc||!1===g.isDuplicate&&0!==g.campaignId&&g.dynamicList.dynamicListId>0?"click-off":""),children:Ti.jsx(Rl,{lbl:"All",name:"matchtype",labelId:"all",checked:!!g.dynamicList.dynamicListName.toLowerCase().includes("select"),cb:t=>{let e={...g};e.dynamicList={dynamicListId:0,dynamicListName:"-- Select your dynamic list --"},e.frequency.frequency="",e.dynamicListAll=!0,e.isFrquenencyEnabled=!1,Mt(Bs([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!0}])),b(e),Tt(ge(Bt)),kt(ge(Pt))}})}),u?null:Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"marginT-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})}),Ti.jsx("div",{className:"w100p "+(!1===g.isDuplicate&&parseInt(g.campaignId)>0&&0===parseInt(g.dynamicList.dynamicListId)||!0===g.isDuplicate&&0===parseInt(g.dynamicList.dynamicListId)?"click-off":""),children:Ti.jsx(Jl,{children:Ti.jsxs(Zl,{children:[Ti.jsx(Jl,{children:Ti.jsx(ec,{data:(null==(a=null==(s=null==t?void 0:t.attributes)?void 0:s.dynamicList)?void 0:a.length)>0?null==(n=null==t?void 0:t.attributes)?void 0:n.dynamicList:[{dynamicListName:"Create new dynamic list",dynamicListId:-10}],value:void 0!==(null==g?void 0:g.dynamicList)&&""!==(null==g?void 0:g.dynamicList.dynamicListName)?null==g?void 0:g.dynamicList:"-- Select Target list  --",valueCheck:ee,isOpen:!0,handleChange:t=>{if(-10===t.dynamicListId)return window.sdxDetails={campaignDetails:null},window.sdxDetails.campaignDetails=g,void o.push({pathname:"/audience/new-dynamic-list",search:"lId=0&bc=0&isCampaign=true"});oe(t.dynamicListId,((e,i)=>{const s=[{frequency:"Immediate",frequencyId:4,data:{}},{frequency:"Shortly",frequencyId:5,data:{}},{frequency:"Daily",frequencyId:1,data:{}},{frequency:"Weekly",frequencyId:2,data:{}},{frequency:"Monthly",frequencyId:3,data:{}}];let a={...g};a.frequency.frequency=s[e].frequency,a.frequency.frequencyId=s[e].frequencyId,a.dynamicList=t,a.channelTypes=[],ae(i),b(a),612==t.dynamicListId&&Mt([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!1}])}))}})}),Ti.jsx(Jl,{className:0===g.dynamicList.dynamicListId||void 0===g.dynamicList.dynamicListId||null===g.dynamicList.dynamicListId||!0===wt[0].disable?"click-off":"",children:Ti.jsx(Vl,{className:gt?"click-off":"",lbl:"Allow audience to be targeted at every assigned frequency",checked:g.isFrquenencyEnabled,onChange:e=>{let i={...g};i.isFrquenencyEnabled=e,b(i),t.onChange("ferquency",e),y(e)}})})]})})})]})]})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"mt-10",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Channel type",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(wo,{editClickOff:gt,children:Bt.length>0&&Bt.map(((t,e)=>(t.value=!1,t.disabled||g.channelTypes.map(((e,i)=>{t.label.toLocaleLowerCase()===e.toLocaleLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{className:t.disabled?"click-off":"",lbl:t.label,errorMessage:Q,checked:t.value,disabled:t.disable,tootip:t.tooltip,onChange:e=>{let i={...g};if(e){if(i.channelTypes.push(t.label),"engagement"===i.goal.toLowerCase()||"conversion"===i.goal.toLowerCase()){let e="";"Web push"===t.label&&(e="Web"),"Mobile push"===t.label&&(e="App"),i.analyticsType.push(e)}it(null)}else{let e=i.channelTypes.filter((e=>e.toLocaleLowerCase()!==t.label.toLocaleLowerCase())),s="";"Web push"===t.label&&(s="Web"),"Mobile push"===t.label&&(s="App");let a=i.analyticsType.filter((t=>t.toLocaleLowerCase()!==s.toLocaleLowerCase()));i.analyticsType=a,i.channelTypes=e}let s=i.channelTypes.length>0?null:Js;tt(s),b(i)}})}))))})})]})}),""!==g.goal?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Analytics type",right:!0})}),Ti.jsx(Zl,{md:8,children:Ti.jsx(wo,{editClickOff:gt,children:Pt.map(((t,e)=>(t.value=!1,t.disabled=!0,g.channelTypes.map((e=>{("Web"===t.label&&"Web push"===e||"App"===t.label&&"Mobile push"===e)&&(t.disabled=!1)})),t.disabled||g.analyticsType.map(((e,i)=>{t.label.toLocaleLowerCase()===e.toLocaleLowerCase()&&(t.value=!0)})),Ti.jsx("li",{children:Ti.jsx(Vl,{disabled:t.disabled,lbl:t.label,checked:t.value,errorMessage:et,isIcon:!0,iconPopover:t.info,onChange:e=>{let i={...g};if(e)i.analyticsType.push(t.label);else{let e=i.analyticsType.filter((e=>e.toLocaleLowerCase()!==t.label.toLocaleLowerCase()));if(i.analyticsType=e,"engagement"===i.goal.toLowerCase()||"conversion"===i.goal.toLowerCase()){let s=[];e.filter((t=>{"Web"===t?s.push("Web push"):"App"===t&&s.push("Mobile push")})),i.channelTypes=s,t.disabled=!0;let a=i.analyticsType.length>0?null:Os;it(a)}}b(i)}})}))))})})]})}):null,!1===g.dynamicList.dynamicListName.toLowerCase().includes("select")&&""!==(null==(l=null==g?void 0:g.frequency)?void 0:l.frequency)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Frequency",right:!0})}),Ti.jsxs(Zl,{className:gt?"click-off":"",children:[Ti.jsx(Pi,{miniWith:!0,defaultSelectedItem:St,defaultClass:"",dynamicTab:"rs-btn-tab",activeClass:"active",tabData:wt,callBack:(t,e)=>{let i={...g};i.frequency={};let s=[{frequency:"Immediate",frequencyId:4,data:{}},{frequency:"Shortly",frequencyId:5,data:{}},{frequency:"Daily",frequencyId:1,data:{}},{frequency:"Weekly",frequencyId:2,data:{}},{frequency:"Monthly",frequencyId:3,data:{}}];e>=0&&e<s.length&&(i.frequency.frequency=s[e].frequency,i.frequency.frequencyId=s[e].frequencyId,i.frequency.data=s[e].data),b(i),Ct(e)}}),(t=>{switch(t){case 1:return Ti.jsx(ic,{data:(null==g?void 0:g.frequency)||null,shortlyError:ct,onDataUpdate:t=>{let e={...g},i={frequency:"Shortly",frequencyId:5,reccursEvery:parseInt(t.reccursEvery),reccursOn:parseInt(t.reccursOn)};e.frequency=i,b(e)}});case 2:return Ti.jsx(Kr,{campaignDetails:g,campaignJson:f,dailyError:pt,onChange:t=>{let e={...pt};e.errMsg=t.toString().length>0?null:"Select a value",ht(e)},onItemChanged:t=>{let e={...g};e.frequency.data=t,b(e)}});case 3:return Ti.jsx(Yr,{campaignDetails:g,campaignJson:f,weeklyError:ut,onChange:(t,e)=>{let i={...ut},s={...g},a=s.frequency.data;"dayinterval"===t?(a.dayInterval=e,i.errDayInterval=e.length>0?null:"Day interval"):"hourinderval"===t?(a.hourInterval=e,i.errHourInterval=e.length>0?null:"Hour interval"):"weekdays"===t&&(a.weekDays=e,i.errWeekDays=e.length>0?null:"Select week interval"),b(s),mt(i)},displayInteval:(t,e)=>{let i={...g},s=i.frequency.data;"displayInteval"===t&&(s.displayInteval=e),b(i)}});case 4:return Ti.jsx(tc,{campaignDetails:g,campaignJson:f,monthlyError:vt,onChange:(t,e)=>{let i={...vt};"dayinterval"===t?i.errDayInterval=e.length>0?null:"Day interval":"hourinterval"===t?i.errHourInterval=e.length>0?null:"Hour interval":"monthinterval"===t?i.errMonthInterval=e.length>0?null:"Month interval":"weekinterval"===t?i.errWeekInterval=e.length>0?null:"Week interval":"day"===t&&(i.errDay=e.length>0?null:"Select week"),yt(i)},onItemChange:t=>{let e={...g};e.frequency.data=t,b(e)}});default:return null}})(St)]})]})}),Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"Time zone",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{data:st,disabled:gt,textField:"timezoneName",dataItemKey:"timezoneId",defaultItem:0!==g.timeZone.timezoneId?g.timeZone:{timezoneId:-1,timezoneName:"-- Select timezone --"},label:"Time zone",required:!0,errorMessage:ot,handleChange:e=>{let i=e.target.value.timezoneName.length>0?null:"Select time zone";rt(i),lt(e.target.value);let s={...g};s.timeZone=e.target.value,s.startDate="",s.endDate="",b(s),ao().format("DD-MM-YYYY"),ao().tz(e.target.value.timezoneValue);const a=ao().tz(e.target.value.timezoneValue).format("DD-MM-YYYY"),n=ao(a,"DD-MM-YYYY").toDate();le(n),t.onChange("timezone",e.target.value)}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:7,offset:4},children:Ti.jsx(Vl,{disabled:!(null==nt?void 0:nt.isDayLight),lbl:"Daylight savings",checked:g.daylightSavings,onChange:t=>{let e={...g};e.daylightSavings=t,b(e)}})})})]})]}):null]}),Ti.jsx(Kl,{children:Ti.jsx(Jl,{children:Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mb",children:[Ti.jsx(as,{onClick:()=>{o.push({pathname:"/campaign"})},children:"Cancel"}),Ti.jsx(zs,{onClick:()=>{var t;if(!0===es())return void o.push({pathname:"/campaign"});const e={name:g.campaignName,startDate:g.startDate,endDate:g.endDate,goal:g.goalType,type:(null==(t=null==g?void 0:g.campaignAttribute)?void 0:t.attributeName)||""};pe(0,e,!1)},children:"Save"}),Ti.jsx(ns,{onClick:()=>{var e;const i={name:g.campaignName,startDate:g.startDate,endDate:g.endDate,goal:g.goalType,type:(null==(e=null==g?void 0:g.campaignAttribute)?void 0:e.attributeName)||""};!0!==es()?pe(1,i,!1):o.push({pathname:"/campaign/creation-notification",search:`?cId=${g.campaignId}`,state:{mode:t.mode,campaignName:void 0!==t.mode?t.mode.campaignName:""}})},children:"Next"})]})})}),j?Ti.jsx(wr,{type:"text",isOpen:!0,onClose:()=>T(!1),initialContent:"",onGenerate:t=>{}}):null,S?Ti.jsx(Wr,{values:g.tags,isOpen:S,closeBtnClicked:()=>C(!1),onChangeIsOpen:t=>{C(t[0]);let e={...g};e.tags=t[1],b(e)}}):null]})]})};Bs([{label:"Web push",value:!1,channelId:8,disabled:!1},{label:"Mobile push",value:!1,channelId:14,disabled:!1},{label:"Email",value:!1,channelId:1,disabled:!1}]),Bs([{label:"Web",value:!1,info:"Analyze the behavior of visitors on your website.",disabled:!0},{label:"App",value:!1,info:"Analyze the behavior of visitors on your mobile app.",disabled:!0}]);const ac={campaignDetails:{isSmartlink:!0,campaignId:"",campaignName:"",campaignType:"",productType:"",goal:"",goalType:"",goalPercentage:"",startDate:"",endDate:"",isFrquenencyEnabled:!1,dynamicList:{dynamicListId:0,dynamicListName:"-- Select your dynamic list --"},nativeChannels:[],socialMedia:[],paidAds:[],channelTypes:[],analyticsType:[],frequency:{frequency:"Immediate"},timeZone:"",daylightSavings:!1},primaryGoal:["Engagement","Conversion"],engamentTypes:[],conversationTypes:[],campaignTypes:[],productTypes:[],dynamicList:[],timeZones:[],frequency:[{frequency:"Immediately"},{frequency:"Daily",dayInterval:"1",hourInterval:[""]},{frequency:"Weekly",dayInterval:"",hourInterval:"",displayInterval:"",weekDays:[]},{frequency:"Monthly",timeSubsetId:4,dayInterval:"",monthInterval:"",hourInterval:"",weekInterval:"",displayInterval:"",isDayEnable:!0},{frequency:"Monthly",weekInterval:"",timeSubsetId:5,day:"",dayInterval:"",hourInterval:"",displayInterval:"",isDayEnable:!1}]},nc=t=>{let e=Ai();const i=Di.useContext(Ji),[s,a]=Di.useState(-1),[n,l]=Di.useState(0),[o,r]=Di.useState(null),[c,d]=Di.useState(null),[p,h]=Di.useState(!1),[u,m]=Di.useState(null),[v,y]=Di.useState(!1),[g,b]=Di.useState({}),[f,x]=Di.useState([{status:"inProcess",steps:"1",steps_title:"Plan"},{status:"",steps:"2",steps_title:"Create"},{status:"",steps:"3",steps_title:"Analyze and execute"}]);Li(),Di.useEffect((()=>{let t=ms();void 0!==(null==t?void 0:t.engagementList)&&null!==(null==t?void 0:t.engagementList)&&(null==t?void 0:t.engagementList.length)>0&&void 0!==(null==t?void 0:t.conversionTypeList)&&null!==(null==t?void 0:t.conversionTypeList)&&(null==t?void 0:t.conversionTypeList.length)>0?S():gs(i,(t=>{ia(i,(t=>{S()}))}))}),[]);const S=()=>{var t,i,s,n;let o=ms();0!==(null==(t=null==o?void 0:o.productCategorysList)?void 0:t.length)&&0!==(null==(i=null==o?void 0:o.campaignAttributeList)?void 0:i.length)||y(!0),m(o);const c=Ys("lsConfig"),p=no.parse(null==(s=null==e?void 0:e.location)?void 0:s.search);let h=void 0!==p.cId?p.cId:0,u=void 0!==p.sl&&JSON.parse(p.sl),v=h;if(l(v),null==p?void 0:p.state){let t=ks(p.state);b(t),v=t.campaignId,u=t.isSmartlinkCampaign}else{let t=null==(n=null==e?void 0:e.location)?void 0:n.state;b(t)}let g=Bs(lc).map(((t,e)=>{var i,s;if(0===e){let e={...t};return e.disable=!c.sl,e}{let e={...t};return 0===(null==(i=null==o?void 0:o.mobileAppsList)?void 0:i.length)&&0===(null==(s=null==o?void 0:o.domainsList)?void 0:s.length)?e.disable=!0:e.disable=!(!c.wp||c.mp),e}}));const f=JSON.stringify(g);if(d(JSON.parse(f)),0===v)r(JSON.parse(JSON.stringify(ac))),a(-1);else if(r(JSON.parse(JSON.stringify(ac))),u){a(0);const t=JSON.stringify(g),e=JSON.parse(t);e[0].disable=!c.sl,e[1].disable=!0,d(e)}else{a(1);const t=JSON.stringify(g),e=JSON.parse(t);e[0].disable=!0,e[1].disable=!1,d(e)}},C=t=>{let e=[...c];t?(e[0].disable=!1,e[1].disable=!0,h(!0)):(e[0].disable=!0,e[1].disable=!1,h(!0)),d(e)},j=t=>Ti.jsx(Ti.Fragment,{children:Ti.jsx(Kl,{fluid:!0,className:"main-heading-wrapper mb0",children:Ti.jsxs(Kl,{className:"mhw-container",children:[Ti.jsx("div",{className:"mhwc-left",children:Ti.jsx("h1",{children:Ti.jsx("div",{className:"mh-wrapper",children:Ti.jsx("span",{className:"mh-text",children:"Communication creation"})})})}),Ti.jsx("div",{className:"mhwc-right",children:Ti.jsxs("div",{className:"back-text",onClick:()=>e.push("/campaign"),children:[Ti.jsx(Qi,{icon:sa,size:"sm"}),"Back"]})})]})})}),T=t=>Ti.jsx("div",{className:`campaign-progress-bar ${t.className?t.className:""}`,children:Ti.jsx(Co,{progressSteps:f})}),I=()=>"2"===(localStorage.getItem("projectId")||1)?(a(0),Ti.jsx(Ti.Fragment,{})):Ti.jsx("div",{className:"campaign-tab-bar",children:Ti.jsxs(Jl,{className:"custom-column-del smartlink-col-del d-flex align-items-center no-margin",children:[Ti.jsx(Zl,{md:-1==s?12:4,className:-1==s?"text-center":"text-end",children:Ti.jsx("div",{id:"c_delivery_method",className:"rs-camp-tabs-big",children:Ti.jsx("div",{className:"ctabs-big-label",children:Ti.jsx("h3",{children:-1==s?"Choose delivery method":"Delivery method"})})})}),Ti.jsxs(Zl,{md:-1==s?12:8,className:-1==s?"d-flex justify-content-center":"",children:[null===c?null:Ti.jsx(Fi,{id:c[s],"data-intro":c[s],defaultSelectedItem:s,defaultClass:"",dynamicTab:"marginB0 rs-tab-icon campaign-type-tab "+(-1==s?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:c,callBack:(t,e)=>{a(e);let i=[...f];i[2].steps_title="Analyze and execute",0===e&&(i[2].steps_title="Finish"),x(i)}}),p?Ti.jsx("div",{className:"refresh-icon",children:Ti.jsx(ws,{text:"Change communication type",position:"top",children:Ti.jsx("i",{className:"icon-rs-refresh-medium icons-md color-primary-blue cursor-pointer",onClick:()=>{let t=[...c];t[0].disable=!1;let e=ms();t[1].disable=!1,0===e.mobileAppsList.length&&0===e.domainsList.length&&(t[1].disable=!0),d(t),a(-1),h(!1)}})})}):null]})]})}),k=()=>Ti.jsxs("div",{style:{minHeight:"100vh",backgroundColor:"transprent",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:[Ti.jsx("div",{style:{width:"280px",height:"32px",backgroundColor:"#e2e8f0",borderRadius:"8px",marginBottom:"60px",animation:"pulse 1.5s ease-in-out infinite alternate"}}),Ti.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"30px",maxWidth:"800px",width:"100%"},children:[Ti.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"40px 30px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",minHeight:"250px",cursor:"pointer",transition:"all 0.2s ease",border:"2px solid transparent"},children:[Ti.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"#e2e8f0",borderRadius:"12px",marginBottom:"24px",animation:"pulse 1.5s ease-in-out infinite alternate"}}),Ti.jsx("div",{style:{width:"120px",height:"24px",backgroundColor:"#e2e8f0",borderRadius:"6px",animation:"pulse 1.5s ease-in-out infinite alternate",animationDelay:"0.2s"}})]}),Ti.jsxs("div",{style:{backgroundColor:"white",borderRadius:"16px",padding:"40px 30px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",minHeight:"250px",cursor:"pointer",transition:"all 0.2s ease",border:"2px solid transparent"},children:[Ti.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"#e2e8f0",borderRadius:"12px",marginBottom:"24px",animation:"pulse 1.5s ease-in-out infinite alternate",animationDelay:"0.4s"}}),Ti.jsx("div",{style:{width:"140px",height:"24px",backgroundColor:"#e2e8f0",borderRadius:"6px",animation:"pulse 1.5s ease-in-out infinite alternate",animationDelay:"0.6s"}})]})]}),Ti.jsx("style",{jsx:!0,children:"\n        @keyframes pulse {\n          0% {\n            opacity: 1;\n          }\n          100% {\n            opacity: 0.4;\n          }\n        }\n      "})]});return Ti.jsxs(Ui,{children:[Ti.jsx(j,{}),Ti.jsx(Kl,{className:"page-header",children:Ti.jsx("div",{className:"rs-camp-tabs-holder",children:Ti.jsxs("div",{className:"rs-tabs-with-heading "+(-1==s?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper"),children:[u?Ti.jsx(T,{className:-1==s?"d-none":""}):Ti.jsx(k,{}),u?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Ti.Fragment,{children:!0===v?Ti.jsxs("div",{style:{display:"flex",backgroundColor:"#ff0000c9",flexDirection:"column",borderRadius:5,margin:10},children:[Ti.jsx("label",{style:{color:"white",fontSize:18,margin:10},children:"You can not proceed to create the communication as account configuration in Account settings has not been completed. Please configure the following parameters on the account settings screen."}),Ti.jsx("label",{style:{color:"white",fontSize:16,margin:10},children:"1. Navigate to Preferences - Account settings - Go to Settings tab."}),Ti.jsx("label",{style:{color:"white",fontSize:16,margin:10},children:"2. Add your Communication types."}),Ti.jsx("label",{style:{color:"white",fontSize:16,margin:10},children:"3. Add your Conversion types."}),Ti.jsx("label",{style:{color:"white",fontSize:16,margin:10},children:"4. Add your Product categories."}),Ti.jsx(ns,{style:{marginTop:10,marginLeft:"42%",marginRight:"42%",marginBottom:10},onClick:()=>{null==e||e.push("/preferences/account-settings",{settings:!0})},children:"Configure now"})]}):Ti.jsx(I,{})}),(()=>{var t,i;if(null!==o&&null!==u)switch(s){case 0:return Ti.jsx(_r,{json:o,campaignId:n,onDisableChange:t=>C(t),campaignDetails:g,attributes:u,onChange:(t,e)=>{}});case 1:return Ti.jsx(sc,{json:o,campaignId:n,onDisableChange:t=>C(t),campaignDetails:e.location.state,attributes:u,statusId:(null==(i=null==(t=null==e?void 0:e.location)?void 0:t.state)?void 0:i.statusId)||0,onChange:(t,e)=>{}});default:return null}})()]}):null]})})})]})},lc=[{id:1001,eid:"c_smartlink_tabs",text:"Smart Link",description:"Setup and execute communications across multi-channels",iconLeft:"icon-rs-smart-link-large font-xxl d-block color-primary-blue",disable:!1},{id:1002,text:"Notifications",eid:"c_notification_tabs",description:"Setup and execute branching, multi-channel communications",iconLeft:"icon-rs-notification-large font-xxl d-block color-primary-blue",disable:!1}],oc=t=>{const e=Di.useRef(null);return Di.useEffect((()=>{const i=i=>{e.current&&!e.current.contains(i.target)&&t.emojiClose()};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}}),[e]),Ti.jsx(Ti.Fragment,{children:Ti.jsx($i,{anchor:t.anchor.current,show:t.show,popupClass:`popup-content emoji-popup-wrap emoji-popup-wrap-modal ${t.popupClass?t.popupClass:""}`,onOpen:t.onOpen,children:Ti.jsx("div",{className:"d-inline-block",ref:e,tabindex:t.tabindex,onFocus:t.onFocus,onBlur:t.onBlur,children:Ti.jsx(Uo,{data:Ro,theme:"light",showPreview:!1,searchPosition:"none",onEmojiSelect:e=>{t.onEmojiClick(e.native)}})})})})};class rc extends Ni.Component{constructor(){super(...arguments),ji(this,"state",{isModalOpen:this.props.isOpen,isDropDownOpen:!1,isWebPush:this.props.isWeb,isMobilePush:this.props.isMobile,selectedIndex:0,selectedHrefValue:"",selectedText:"",selectedIcon:"",images:[],errMsg:"Fill the details",deviceType:this.props.isWeb?"Firefox":"Android",mobileTypeList:["Android","iOS"],webTypeList:["Firefox","Google Chrome"]})}componentDidMount(){this.state.isWebPush?this.setState({selectedHrefValue:"#wp-windows-chrome",selectedText:"Windows chrome",selectedIcon:"icon-windows-small icons-md",images:browserImages}):this.setState({selectedHrefValue:"#preview-android",selectedText:"Android",selectedIcon:"icon-rs-android-medium icons-md",images:deviceImages})}render(){return Ti.jsx(Ti.Fragment,{})}}const cc=t=>{Di.useState(t.isUpload);const[e,i]=Di.useState("");Di.useState(!1);let s=Di.useContext(Ji);const[a,n]=Di.useState((t.deliveryTypeId,".png,.jpg")),[l,o]=Di.useState(!1);return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(ns,{onClick:e=>{document.getElementById("fileInput").click(),document.getElementById("fileInput").addEventListener("change",(function(){const e=this.files[0];if(!(e=>{let s=!1;return 1===t.deliveryTypeId?e.includes(".png")||e.includes(".PNG")||e.includes(".jpg")?i(null):(i("Only JPG, PNG files are allowed"),s=!0):e.includes(".png")||e.includes(".jpg")||e.includes(".mp4")||e.includes(".gif")||e.includes(".mp3")?i(null):(i("Only JPG, PNG, GIF, MP3 and MP4 files are allowed"),s=!0),s})(e.name)){const a=e;if(Math.round(a.size/1024)>1024){let e="Image size is more than 1 mb";return t.callback(e),void i("Image size is more than 1 mb")}aa(a,(a=>{((e,i)=>{let a=na;t.mobilePush&&(a=la),os({path:a,loading:s.globalStateData.setIsLoadingData,isCache:!1,params:{file:e},ok:t=>{t.status&&null!==t.data&&void 0!==t.data?i(t.data):i(null)},fail:t=>{i(null)}})})(a,(s=>{let a={fileName:e.name};if(null===s)a.status=!1,a.message="Upload error! ,  Try again ...",i("Upload error! ,  Try again ...");else{a.status=!0,a.message="File uploaded successfully";let t=s.substring(1);a.data=oa+t,o(!0),i(null),i("File uploaded successfully")}t.callback(a)}))}),(e=>{t.callback({fileName:"",status:!1,messaage:"Upload error! ,  Try again ..."})}))}}))},children:"Browse"}),Ti.jsx("input",{type:"file",id:"fileInput",accept:a,"aria-label":"File browser example",className:"sp-input d-none"})]})},dc=t=>{Di.useState(t.isUpload);const[e,i]=Di.useState("");Di.useState(!1);let s=Di.useContext(Ji);Di.useState((t.deliveryTypeId,".png,.jpg"));const[a,n]=Di.useState(!1);Di.useRef(null);return Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{onDragOver:t=>{t.preventDefault()},onDrop:e=>{e.preventDefault(),i(null);const a=e.dataTransfer.files[0];a&&(e=>{if(!(e=>{let s=!1;return 1===t.deliveryTypeId?e.includes(".png")||e.includes(".PNG")||e.includes(".jpg")?i(null):(i("Only JPG, PNG files are allowed"),s=!0):e.includes(".png")||e.includes(".jpg")||e.includes(".mp4")||e.includes(".gif")||e.includes(".mp3")?i(null):(i("Only JPG, PNG, GIF, MP3 and MP4 files are allowed"),s=!0),s})(e.name)){const a=e;if(Math.round(a.size/1024)>1024){let e="Image size is more than 1 mb";return t.callback(e),void i(e)}aa(a,(a=>{((e,i)=>{let a=t.mobilePush?la:na;os({path:a,loading:s.globalStateData.setIsLoadingData,isCache:!1,params:{file:e},ok:t=>{t.status&&null!==t.data&&void 0!==t.data?i(t.data):i(null)},fail:t=>{i(null)}})})(a,(s=>{let a={fileName:e.name};null===s?(a.status=!1,a.message="Upload error! Try again ...",i(a.message)):(a.status=!0,a.message="File uploaded successfully",a.data=oa+s.substring(1),n(!0),i(a.message)),t.callback(a)}))}),(e=>{t.callback({fileName:"",status:!1,message:"Upload error! Try again ..."})}))}})(a)},className:"drag-and-drop-communication",children:"Drag & Drop an image here"})})};class pc extends Ni.Component{constructor(){super(...arguments),ji(this,"state",{isModalOpen:this.props.isOpen,imageURL:"",errorImageURL:null,listModel:!1,imageUpload:!1,imageUploadStatus:null,imageStatusMessage:null,isShowEdit:!1,aiModal:!1,thoughts:""}),ji(this,"fileUpload",(t=>{})),ji(this,"validFileFormat",((t,e)=>{if(ss(t))return this.setState({errorImageURL:"Enter a valid URL"}),!0;const i=t.includes(".png")||t.includes(".jpg")||t.includes(".gif"),s=t.includes(".mp4")||t.includes(".mp3");let a,n=!0;if(1!==this.props.deliveryTypeId||i)if(i||s){let e=new Image;e.src=t,e.onload=()=>{Is("Image",e.height),this.context.globalStateData.setIsLoadingData(!1),e.height<=1024&&e.width<=1024?(this.setState({errorImageURL:null,imageURL:t,imageUploaded:!0,imageUploadStatus:!0,imageStatusMessage:"File uploaded successfully"}),setTimeout((()=>{this.setState({imageUploadStatus:null})}),2e3)):this.setState({errorImageURL:"Image max size: 1MB, dimensions < 1024x1024.",imageUploadStatus:null})},e.onerror=()=>{this.context.globalStateData.setIsLoadingData(!1),this.setState({errorImageURL:"Invalid image."}),n=!1}}else a="File type is not supported",n=!1;else a="Alert type only supports images",n=!1;return n||this.setState({errorImageURL:a}),!n})),ji(this,"setValidDropMessage",(t=>{t.status&&this.setState({imageUploaded:!0,imageURL:t.data}),null==this.state.errorImageURL&&null!=this.state.imageStatusMessage&&null!=this.state.imageUploadStatus&&this.setState({imageStatusMessage:t.message||t,imageUploadStatus:t.status}),setTimeout((()=>{this.setState({imageUploadStatus:null})}),2e3)})),ji(this,"setValidBrowseMessage",(t=>{this.state.errorImageURL,t.status&&this.setState({imageUploaded:!0,imageURL:t.data}),null==this.state.errorImageURL&&null!=this.state.imageStatusMessage&&null!=this.state.imageUploadStatus&&this.setState({imageStatusMessage:t.message||t,imageUploadStatus:t.status}),setTimeout((()=>{this.setState({imageUploadStatus:null})}),2e3)})),ji(this,"AIModalPopUp",(()=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs(_l,{show:this.state.aiModal,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Welcome to GenAI"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{}})]}),Ti.jsx(_l.Body,{children:Ti.jsxs(Jl,{style:{marginBottom:20},children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Your thoughts",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(ql,{required:!0,placeholder:"Enter your thoughts",max:Sl,handleOnBlur:t=>{},handleOnchange:t=>{t.length,this.setState({thoughts:t})},val:this.state.thoughts})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(ns,{onClick:()=>{},children:" Generate"})})]})}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.props.close()},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{this.props.confirmBtnClick()},children:"Confirm"})]})]})})))}render(){var t;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"mt5",children:[!0===this.state.aiModal&&Ti.jsx(this.AIModalPopUp,{isOpen:this.state.aiModal,close:()=>this.setState({aiModal:!1}),confirmBtnClick:()=>this.setState({aiModal:!1})}),Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:2,children:Ti.jsx(Ao,{label:"Image URL",right:!0})}),Ti.jsx(Zl,{md:10,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:8,children:Ti.jsx(ql,{required:!0,placeholder:this.state.imageURL.length>0?"Image URL":"Enter image URL",max:Sl,handleOnBlur:t=>{this.validFileFormat(t,!0)},handleOnchange:t=>{let e=t.length>0?null:ra;this.setState({errorImageURL:e,imageURL:t,imageUpload:!1})},val:this.state.imageURL,errorMessage:this.state.errorImageURL})}),Ti.jsx(Zl,{md:1,children:Ti.jsx("div",{className:"mt-5",children:Ti.jsx("div",{className:"choose-or choose-or-small",children:Ti.jsx("span",{children:"or"})})})}),Ti.jsx(Zl,{md:2,style:{display:"flex",justifyContent:"center"},children:Ti.jsx(ws,{text:"Image upload",position:"top",children:Ti.jsx(cc,{mobilePush:this.props.mobilepush,callback:t=>{this.validFileFormat(t.data,!0),this.setValidBrowseMessage(t)}})})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{mainClass:"marginR-5",icon:"icon-rs-circle-info-medium",iconClass:"position-relative top2",size:"md",color:"blue",tooltip:1===this.props.deliveryTypeId?"Accepted URL types are PNG, JPG.":"Accepted URL types are PNG, JPG & GIF.",onClick:()=>{this.setState({listModel:!0})}})})})})]})})]}),Ti.jsx(Jl,{className:"mt15",children:Ti.jsxs(Zl,{md:7,style:{display:"flex",alignItems:"baseline"},children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Drag Image",right:!0})}),Ti.jsx(Zl,{md:9,children:Ti.jsx(ws,{text:"Image upload",position:"top",children:Ti.jsx(dc,{mobilePush:this.props.mobilepush,callback:t=>{this.validFileFormat(t.data,!1),this.setValidDropMessage(t)}})})})]})})]})]}),null!==this.state.imageUploadStatus&&null==this.state.errorImageURL&&Ti.jsx("div",{style:{marginTop:-50,paddingLeft:130},children:Ti.jsx("label",{style:{color:!0===this.state.imageUploadStatus?"green":"red"},children:this.state.imageStatusMessage})}),Ti.jsxs("div",{className:"d-flex justify-content-end marginT30",children:[Ti.jsx(as,{onClick:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1,"")},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{if(!0===this.state.imageUpload)this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1,this.state.imageURL);else{if(null!==this.state.errorImageURL)return;this.validFileFormat(this.state.imageURL,!1)||(ss(this.state.imageURL)?this.setState({errorImageURL:ra}):(this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1,this.state.imageURL)))}},children:"Save"})]}),this.state.listModel&&Ti.jsxs(_l,{show:this.state.listModel,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Help text"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({listModel:!1})}})]}),(null==(t=this.props)?void 0:t.mobilePush)?Ti.jsx(_l.Body,{children:Ti.jsxs("ul",{className:"file-size-info-list",children:[Ti.jsx("li",{children:"Image sizes for Inapp view:"}),Ti.jsx("li",{children:"iPhone & Android - Modal (Top, Middle, Bottom) 1280x680."}),Ti.jsx("li",{children:"iPhone & Android - Full screen 1280x1920."}),Ti.jsx("li",{children:"iPad & Android tab - Modal (Top, Middle, Bottom) 1280x680."}),Ti.jsx("li",{children:"Image sizes for normal notification:"}),Ti.jsx("li",{children:"File format: PNG or JPEG file."}),Ti.jsx("li",{children:"Size: Minimum width and height of 300px. Avoid using images wider than 2000 pixels. Also make sure that your image is not bigger than 1MB."}),Ti.jsx("li",{children:"Aspect ratio: Use images in landscape format respecting a 2:1 ratio (e.g. 1000x500px)."})]})}):Ti.jsx(_l.Body,{children:Ti.jsxs("ul",{className:"file-size-info-list",children:[Ti.jsx("li",{children:"Recommended size for proper image appearance."}),Ti.jsx("li",{children:"Image should be in aspect ratio of 16:9."}),Ti.jsx("li",{children:"Minimum image size is 320 x 180."}),Ti.jsx("li",{children:"16:9 aspect ratio resolutions: 1024576, 1152648, 1280720, 1366768, 1600900, 19201080, 25601440 and 38402160."}),Ti.jsx("li",{children:"Mostly HD (1280720) or FULL HD (19201080) will be good."})]})})]})]})}}ji(pc,"contextType",Ji);const hc=ua;class uc extends Di.Component{constructor(t){super(t),ji(this,"state",{isShow:!1,clicked:0,isImagePickerModal:!1,isPreviewWeb:!1,bodyContent:this.props.bodyContent,bodyContentPosition:this.props.bodyContentPosition,isBrowser:!1,isUpload:!1,deliveryTypeId:0,getTextLength:0,bodyTextColor:"",bodyBgColor:"",errMsg:null,imgDrop:!1,personalizeChooseCount:0}),ji(this,"handleClickOutside",(t=>{this.setState({})})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!this.state.isShow})})),ji(this,"onOpen",(t=>{var e;null==(e=this.contentRef.current)||e.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"RRImageUpload",(()=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs(_l,{show:this.state.isImagePickerModal,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Image upload"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isImagePickerModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"camp-pannel-content",children:Ti.jsx(pc,{isOpen:this.state.isImagePickerModal,mobilepush:this.props.mobilepush,deliveryTypeId:this.props.deliveryTypeId,onChangeIsOpen:(t,e)=>{this.setState({isImagePickerModal:t}),e.length>0&&this.props.callBack("url",e)}})})})})]})}))),ji(this,"countBrackets",(t=>{let e=t.trim(),i=0;for(let s=0;s<e.length;s++){const t=e[s];("["===t||"]"===t)&&i++}return i})),ji(this,"getLengthCheck",(t=>{let e="";for(let a=0;a<t.length;a++){const i=t[a];" "!==i&&(e+=i)}let i=0,s=!1;for(let a=0;a<e.length;a++){const t=e[a];"["===t?s=!0:"]"===t?s=!1:s||"|"==t||i++}return this.setState({getTextLength:i}),i})),ji(this,"handleBodyOnBlur",(t=>{this.state;let e=!0;const i=t.target.value.split("|");for(const s of i){let t=0;for(const i of s)"["===i?t++:"]"===i&&t--,t<0&&(e=!1);0!==t&&(e=!1)}e?(this.props.callBack("onBlur",t),this.setState({bodyContentPosition:t.target.selectionStart,errMsg:null})):this.props.callBack("onBlur",t,"In correct type")})),Is("Editor",this.props.deliveryTypeId),this.setState({deliveryTypeId:this.props.deliveryTypeId}),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.anchor=Ni.createRef(),this.fontcoloranochor=Ni.createRef(),this.backgroundcoloranochor=Ni.createRef(),this.emojianochor=Ni.createRef()}componentDidMount(){var t,e;document.addEventListener("click",this.handleClickOutside,!0),this.setState({bodyTextColor:null==(t=this.props.notificationData)?void 0:t.bodyTextColor}),this.setState({bodyBgColor:null==(e=this.props.notificationData)?void 0:e.bodyBgColor})}componentDidUpdate(t){this.props}render(){var t,e,i,s;return Ti.jsxs("div",{className:"editor-view-container",children:[Ti.jsx("div",{children:Ti.jsxs(Yl,{horizontal:!0,className:"even",children:[Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.anchor,children:Ti.jsx("div",{className:"editor-ico",children:Ti.jsx(Hi,{className:"",items:hc,text:Ti.jsx(ws,{text:"Personalize",position:"top",show:!1,children:Ti.jsx("i",{className:"icon-rs-user-question-mark-edge-medium color-primary-blue icons-md"})}),onItemClick:t=>{ca(this.state.bodyContent,t.item.text,this.state.bodyContentPosition);const e=t.item.text.replace(/\[\[|\]\]/g,"");var i=`${e} NOTFOUND`;e.includes("NAME")&&(i="CUSTOMER");let s=`[[${e}]] | [[${i}]] `;const a=[];a.push(this.state.bodyContent,s);const n=a.filter((t=>""!==t)).join("");this.countBrackets(n)<=40?(this.setState({bodyContent:n}),this.props.callBack("bodytext",this.state.getTextLength,"do not count",null,n)):this.props.callBack("bodytext",this.state.getTextLength,"Add only 5 personalization",null,n)}})})}),Ti.jsx(Yl.Item,{className:"cursor-pointer",style:{backgroundColor:"transparent"},children:Ti.jsx("div",{className:2===(null==(t=this.props)?void 0:t.pushTypeID)?"click-off":"editor-ico",children:Ti.jsxs(Hi,{text:Ti.jsx(ws,{text:"Image",position:"top",show:!1,children:Ti.jsx("i",{className:"icon-rs-image-medium color-primary-blue icons-md"})}),onItemClick:t=>{"Upload image"===t.item.text?this.setState({isImagePickerModal:!this.state.isImagePickerModal}):"Remove image"===t.item.text?this.props.callBack("url",""):this.setState({isUpload:!0})},children:[Ti.jsx(Gi,{text:"Upload image"}),void 0!==(null==(e=this.props.notificationData)?void 0:e.url)&&null!==(null==(i=this.props.notificationData)?void 0:i.url)&&""!==(null==(s=this.props.notificationData)?void 0:s.url)?Ti.jsx(Gi,{text:"Remove image"}):null]})})}),Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.emojianochor,onClick:()=>this.buttonClick(3),children:Ti.jsx(Qi,{tooltip:"Emoji",icon:"icon-rs-circle-smile-medium"})}),Ti.jsx(Yl.Item,{className:"click-off d-none",style:{backgroundColor:"transparent"},onClick:()=>{this.props.onClickShortlinkBtnClick(!0)},children:Ti.jsx(Qi,{tooltip:"Short link",icon:"icon-rs-link-medium"})}),Ti.jsx(Yl.Item,{className:"click-off d-none",style:{backgroundColor:"transparent"},onClick:()=>{this.props.onClickCouponBtnClick(!0),this.buttonClick(5)},children:Ti.jsx(ws,{text:"Coupon code",position:"top",children:Ti.jsx("div",{className:"editor-ico",children:Ti.jsx("i",{className:"icon-rs-coupon-medium icons-md blue"})})})}),!0===this.props.mobilepush?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.fontcoloranochor,onClick:()=>this.buttonClick(6),children:Ti.jsx(Qi,{tooltip:"Text color",icon:"icon-rs-colorpicker-text-medium"})}),Ti.jsx(Ti.Fragment,{children:Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.backgroundcoloranochor,onClick:()=>this.buttonClick(7),children:Ti.jsx(Qi,{tooltip:"Background color",icon:"icon-rs-colorpicker-bg-medium"})})})]}):null,!1!==this.props.mobilepush||2!==this.props.deliveryTypeId&&3!==this.props.deliveryTypeId?null:Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.fontcoloranochor,onClick:()=>this.buttonClick(6),children:Ti.jsx(Qi,{tooltip:"Text color",icon:"icon-rs-colorpicker-text-medium"})}),Ti.jsx(Yl.Item,{style:{backgroundColor:"transparent"},ref:this.backgroundcoloranochor,onClick:()=>this.buttonClick(7),children:Ti.jsx(Qi,{tooltip:"Background color",icon:"icon-rs-colorpicker-bg-medium"})})]}),Ti.jsxs("div",{className:"position-absolute right10",children:[this.state.errMsg&&Ti.jsx("div",{className:"validation-message align-end body-text mt-48 left2",children:this.state.errMsg}),Ti.jsx(Yl.Item,{className:"cursor-pointer click-on d-none",style:{backgroundColor:"transparent"},onClick:()=>{""===this.props.notificationData.body&&""===this.props.notificationData.title?this.setState({errMsg:da}):""!==this.props.notificationData.body&&""!==this.props.notificationData.title&&this.setState({isPreviewWeb:!this.state.isPreviewWeb,errMsg:null})},children:Ti.jsx(Qi,{tooltip:"Preview",icon:"icon-rs-eye-medium"})})]})]})}),this.state.isUpload&&Ti.jsx(mc,{isUpload:this.state.isUpload,mobilePush:this.props.mobilepush,deliveryTypeId:this.props.deliveryTypeId,onChangeIsOpen:()=>{this.setState({isUpload:!1})},callback:t=>{let e=pa().slice(0,-1)+t;this.props.callBack("url",e),setTimeout((()=>{this.context.globalStateData.setIsLoadingData(!1),this.setState({isUpload:!1})}),2e3)}}),Ti.jsx("div",{children:Ti.jsx("textarea",{style:{height:230},className:"bgWhite",placeholder:"Message",value:this.state.bodyContent,onBlur:t=>{this.handleBodyOnBlur(t)},onChange:t=>{let e=this.getLengthCheck(t.target.value);e<=350&&(this.setState({bodyContent:t.target.value}),this.props.callBack("bodytext",e,null,null,t.target.value))}})}),1===this.state.clicked?Ti.jsx($i,{anchor:this.anchor.current,show:this.state.isShow,popupClass:"popup-content",style:{width:190,marginTop:1},children:Ti.jsx(Hl,{data:["Value 1","Value 2","Value 3"],value:"-- select personalize --",onChange:t=>{this.setState({clicked:0});let e=ca(this.state.bodyContent,t,this.state.bodyContentPosition);this.setState({bodyContent:e}),this.props.callBack("bodytext",e)}})}):null,3===this.state.clicked?Ti.jsx(oc,{anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,emojiClose:()=>{this.setState({isShow:!1})},onEmojiClick:t=>{if(this.state.bodyContent.length<=348){let e=ca(this.state.bodyContent,t,this.state.bodyContentPosition);this.setState({bodyContent:e,bodyContentPosition:this.state.bodyContentPosition+2}),this.props.callBack("bodytext",null,null,null,e)}}}):null,4===this.state.clicked?Ti.jsx($i,{anchor:this.anchor.current,show:this.state.isShow,popupClass:"popup-content",style:{width:190,marginTop:1},children:Ti.jsx(Hl,{data:["Smart link1","Smart link2","Smart link3"],value:"-- Select Smart link --",onChange:t=>{this.setState({clicked:0});let e=ca(this.state.bodyContent,t,this.state.bodyContentPosition);this.setState({bodyContent:e}),this.props.callBack("bodytext",e)}})}):null,6===this.state.clicked?Ti.jsx(Oo,{anchor:this.fontcoloranochor,show:this.state.isShow,selectColor:this.state.bodyTextColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:t=>{var e=t.split("(");parseInt(e[1].split(",")[0]),parseInt(e[1].split(",")[1]),parseInt(e[1].split(",")[2]);var i=ha(t);this.props.callBack("bodyTextColor",i),this.setState({clicked:0,bodyTextColor:i})}}):null,7===this.state.clicked?Ti.jsx(Oo,{anchor:this.backgroundcoloranochor,show:this.state.isShow,selectColor:this.state.bodyBgColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:t=>{var e=t.split("(");parseInt(e[1].split(",")[0]),parseInt(e[1].split(",")[1]),parseInt(e[1].split(",")[2]);var i=ha(t);this.props.callBack("bodyBgColor",i),this.setState({clicked:0,bodyBgColor:i})}}):null,this.state.isImagePickerModal?Ti.jsx(this.RRImageUpload,{callBack:(t,e)=>this.props.callBack("url",imageURL)}):null,this.state.isPreviewWeb?Ti.jsx(rc,{isOpen:this.state.isPreviewWeb,notificationData:this.props.notificationData,isWeb:!this.props.mobilepush,onChangeIsOpen:t=>{this.setState({isPreviewWeb:t})}}):null]})}}ji(uc,"contextType",Ji);const mc=t=>{const[e,i]=Di.useState(t.isUpload),[s,a]=Di.useState(""),[n,l]=Di.useState(!1);let o=Di.useContext(Ji);const[r,c]=Di.useState((t.deliveryTypeId,".png,.jpg")),[d,p]=Di.useState(!1);return Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs(_l,{show:e,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Browse image"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{t.onChangeIsOpen(!1)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsxs("div",{className:"upload-input-view",children:[Ti.jsxs("label",{class:"file",children:[Ti.jsx("input",{type:"file",id:"file",accept:r,"aria-label":"File browser example",onChange:e=>{if(Is("File Name",e.target.files[0].name),!(e=>{let i=!1;return 1===t.deliveryTypeId?e.includes(".png")||e.includes(".PNG")||e.includes(".jpg")?a(null):(a("Only JPG, PNG files are allowed"),i=!0):e.includes(".png")||e.includes(".jpg")||e.includes(".mp4")||e.includes(".gif")||e.includes(".mp3")?a(null):(a("Only JPG, PNG, GIF, MP3 and MP4 files are allowed"),i=!0),i})(e.target.files[0].name)){const i=e.target.files[0];if(Math.round(i.size/1024)>1024)return void a("Image size is more than 1 mb");aa(i,(e=>{o.globalStateData.setIsLoadingData(!0),((e,i)=>{let s=na;t.mobilePush&&(s=la),os({path:s,params:{file:e},ok:t=>{t.status&&null!==t.data&&void 0!==t.data?i(t.data):i(null)},fail:t=>{i(null)}})})(e,(e=>{null===e?a("Upload error! ,  Try again ..."):(p(!0),a(null),a("File uploaded successfully")),t.callback(e)}))}),(t=>{}))}},className:"sp-input btn-browse-edit",name:"uploaded_file"}),Ti.jsx("span",{class:"file-custom"})]}),1===t.deliveryTypeId?Ti.jsx(ws,{placement:"top",text:"Only JPG, PNG files are allowed",children:Ti.jsx("i",{className:"icon-rs-circle-info-medium icons-md color-primary-blue marginL15 cursor-pointer",onClick:()=>{l(!0)}})}):Ti.jsx(ws,{placement:"top",text:"Only JPG, PNG, GIF, MP4, MP3 files are allowed",children:Ti.jsx("i",{className:"icon-rs-circle-info-medium icons-md color-primary-blue marginL15 cursor-pointer",onClick:()=>{l(!0)}})})]}),Ti.jsx("center",{className:d?"green":"red",children:s})]})]}),n&&Ti.jsxs(_l,{show:n,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Help text"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{l(!1)}})]}),t.mobilePush?Ti.jsx(_l.Body,{children:Ti.jsxs("ul",{className:"file-size-info-list",children:[Ti.jsx("li",{children:"Image sizes for Inapp view:"}),Ti.jsx("li",{children:"iPhone & Android - Modal (Top, Middle, Bottom) 1280x680."}),Ti.jsx("li",{children:"iPhone & Android - Full screen 1280x1920."}),Ti.jsx("li",{children:"iPad & Android tab - Modal (Top, Middle, Bottom) 1280x680."}),Ti.jsx("li",{children:"Image sizes for normal notification:"}),Ti.jsx("li",{children:"File format: PNG or JPEG file."}),Ti.jsx("li",{children:"Size: Minimum width and height of 300px. Avoid using images wider than 2000 pixels. Also make sure that your image is not bigger than 1MB."}),Ti.jsx("li",{children:"Aspect ratio: Use images in landscape format respecting a 2:1 ratio (e.g. 1000x500px)."})]})}):Ti.jsx(_l.Body,{children:Ti.jsxs("ul",{className:"file-size-info-list",children:[Ti.jsx("li",{children:"Recommended size for proper image appearance."}),Ti.jsx("li",{children:"Image should be in aspect ratio of 16:9."}),Ti.jsx("li",{children:"Minimum image size is 320 x 180."}),Ti.jsx("li",{children:"16:9 aspect ratio resolutions: 1024576, 1152648, 1280720, 1366768, 1600900, 19201080, 25601440 and 38402160."}),Ti.jsx("li",{children:"Mostly HD (1280720) or FULL HD (19201080) will be good."})]})})]})]})};class vc extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isShow:this.props.isOpen,offerCodetype:"",nextBestOffer:!1,offerType:"",offerList:"",displayType:"",isAutoMatch:!0,recommendedOffer:"",couponCode:""})}render(){return Ti.jsxs(_l,{show:this.state.isShow,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Offer"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isShow:!1}),this.props.onChangeIsOpen(!1)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsxs(Jl,{className:"custom-column",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Offer code type"})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Common",name:"offerType",labelId:"offerTypeId",className:"marginB20",checked:"Common"===this.state.offerCodetype,cb:t=>{this.setState({offerCodetype:t.target.value})}})}),Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Unique",name:"offerType1",labelId:"offerTypeId1",className:"marginB20",checked:"Unique"===this.state.offerCodetype,cb:t=>{this.setState({offerCodetype:t.target.value})}})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(ma,{text:"Static represents an unique offer code used for all audience and Dynamic represents Unique offer code used for each audience.",position:"top",children:Ti.jsx("i",{className:"icon-rs-question-mark-mini question-unfill icons-md color-primary-blue mt0 cp"})})})]})})]}),Ti.jsxs(Jl,{className:"custom-column marginB30 marginT10",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Next best offer"})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Wi,{onLabel:"ON",offLabel:"OFF",onChange:t=>{this.setState({nextBestOffer:t.target.value})},checked:this.state.nextBestOffer})}),this.state.nextBestOffer&&Ti.jsx(Zl,{md:6,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx("label",{children:"Auto match"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Wi,{onLabel:"ON",offLabel:"OFF",onChange:t=>{this.setState({isAutoMatch:t.target.value})},checked:this.state.isAutoMatch})})]})})]})})]}),this.state.nextBestOffer?!this.state.isAutoMatch&&Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Recommended offers"})}),Ti.jsx(Zl,{md:8,children:yc.map(((t,e)=>Ti.jsx(Rl,{lbl:t.text,name:"reOffer"+e.toString(),labelId:"offerId"+e.toString(),className:"marginB20",checked:this.state.recommendedOffer===t.text,cb:t=>{this.setState({recommendedOffer:t.target.value})}})))})]}):Ti.jsxs(Jl,{className:"custom-column marginT0",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Select offer"})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Hl,{data:["EMI offer","Cash back","Discount","Festive","New product launch","Referral","Bundle offer"],value:""!==this.state.offerType?this.state.offerType:"-- Select offer type --",onChange:t=>{this.setState({offerType:t.target.value})}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Hl,{data:["Referral discount offer","Wonder text offer","Special offer","Mid season sale"],value:""!==this.state.offerList?this.state.offerList:"-- Select offer list --",onChange:t=>{this.setState({offerList:t.target.value})}})})]})})]}),Ti.jsxs(Jl,{className:"custom-column marginT10",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Display as"})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Text",name:"displayAs",labelId:"displayAsId",className:"marginB20",checked:"Text"===this.state.displayType,cb:t=>{this.setState({displayType:t.target.value})}})}),Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"QR code",name:"displayAs1",labelId:"displayAsId1",className:"marginB20",checked:"QR code"===this.state.displayType,cb:t=>{this.setState({displayType:t.target.value})}})}),Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Bar code",name:"displayAs2",labelId:"displayAsId2",className:"marginB20",checked:"Bar code"===this.state.displayType,cb:t=>{this.setState({displayType:t.target.value})}})})]})})]}),""!==this.state.displayType&&Ti.jsxs(Jl,{className:"custom-column marginT10 marginB0",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Enter the coupon code"})}),Ti.jsxs(Zl,{md:8,children:[Ti.jsx(ql,{placeholder:"Coupon code",val:this.state.couponCode,max:Cl,cb:t=>{this.setState({couponCode:t})}}),Ti.jsx("label",{children:"Example(HDMOB40)"})]})]}),""!==this.state.couponCode&&Ti.jsxs(Jl,{className:"custom-column marginT10 marginB0",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Preview"})}),Ti.jsx(Zl,{md:8,children:"Text"===this.state.displayType?Ti.jsx("p",{contentEditable:!1,style:{fontSize:"18px",width:"auto",float:"left",backgroundColor:"#F2FAF8",border:"2px dashed rgb(180, 180, 180)",padding:"10px 20px"},children:this.state.couponCode}):Ti.jsxs("div",{children:[Ti.jsx("img",{src:"QR code"===this.state.displayType?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIAQMAAACXljzdAAAABlBMVEX///8AAABVwtN+AAAA5ElEQVRYw+WWsRGEMAwEz0PwISVQypeGS6MUl0BIwODXWbIHKvif+wsYoVWCkM/C9/Wqrp0B1m2J902PnKCWHUhMWECtiiQSJCxpzZAmbEbN/0AwXbBAmYy5BokHkmR41ZnuXqVHbkqPhCDhp7ceABYUcMCtGXKkneAMzAcaqTHggqQ5kz1IWGKZi1CPnImkzDXky0VWJHHBMmEqzHCu5chQuDIHPFVFMu4fWhTlBNAjfafwEg64/21B0jfiYVrTpU3aRpzfZT7cq3TJMK04yoIElPcA6D2oguThVWstYc965If1Ae/L1sc0upibAAAAAElFTkSuQmCC":"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAUEBAQEAwUEBAQGBQUGCA0ICAcHCBALDAkNExAUExIQEhIUFx0ZFBYcFhISGiMaHB4fISEhFBkkJyQgJh0gISD/2wBDAQUGBggHCA8ICA8gFRIVICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICD/wgARCAAWAHEDAREAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAABgcABAUIAQn/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAADwcwGEAwMxMhmGYGAYOYTJDmg7KHMBhAMDMTIZhmBgGDmEyQ5nPrIbBTIUi6YpdLpSKZsmKegwf//EADoQAAADBgQDBQUGBwAAAAAAAAEDBQACBAYHERITFCI3drQjNjh3tQghMkKGEBUYR4XFJDE1VnWl0//aAAgBAQABPwBM/Oj68/bGqH4nKI/rnRuMX3Rrly+p+qr7Sb3RqP5vk+qwDVb8Tkk8/l9GhtQ7ghQvmBR6ZVZN43zR5vpHUqTVc8MUlcgF9YiNVjjdPnlBH9SYyx43J5+nvUUZk3jfNHm+kdSpMRxuo/zBO/Unt7N3e2lXMEx+lQjFd7a4/wCfU/Sl9rsmfnT9eftjVD8TtEP13o3GL7o1y5fVPVV9pN7o1H83yfVYBqueJySefy+jQ2odwQoXzAo9MrMm8bpo830jqVJqueGKSeQC+sQ2qxxunzygj+pMZZ8b08/T3qKMybxvmjzgSOpUmI43Ue5gnjqT29m7vdSnmCY/SoRi+91cuYFP0pf+wql0iE/fWBC/rmv1/wDFHdtrcrVfPtx5BXw2th2soyuhKszokyqEDnKqDn6A/NfdyM5zAbtAcL13QtuAWCQpTCEXYQErsV6HNhVF3PN7csw2IOfdvi23Mi4gdth3tBSFKafBqUJBpWUQprAL0U7nmDmRwGlmgb73vdvKLHCG1lelsiLszQUzKqFqFWBUAVCD9Uc5giQcIcAzCD4OjthSAsIW2MhyFKctoiEiIqVpYBAiDIpOKzzX8gwx011967zwi9cDzfiuG5iqNU1JXIpbLlu0fFLBK8cbrD98cU8Y8WbbHYLCcZtthZXpdIi7LEFLKqhahJgE8EsgjVHOYIYHyH8GIHweHdCkDcRvsZWkKU1xcj1pUSs+PUEcxBiTc813HAvvC8+VYHgALiI7gDEx1LpFPnePnU5Duvx+n1EXqjt+QYSaVsx4AwvwxI+4PkYqjNNiVuKWy5btHxSwSvHG6w/dHFPGvFm2x2CwnGbbYWCQpTcXEdaBKtHo0RHRUCbnm9iZGPPPRI2xWHGL4/zvb5WlqjVNpRi0qLQJb0RyQfERUGOsPMyjDynCTh3vjfEWW4DBRmm2sXYsJb7ZePNilEdYf25hhUQS+Px7blxZ4bbfG34XaFf2P/s4z/s3/8QAFBEBAAAAAAAAAAAAAAAAAAAAUP/aAAgBAgEBPwA3/8QAFBEBAAAAAAAAAAAAAAAAAAAAUP/aAAgBAwEBPwA3/9k=",width:"75",alt:this.state.displayType}),Ti.jsx("p",{children:this.state.couponCode})]})})]})]}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isShow:!1}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),Ti.jsx(ns,{className:this.state.nextBestOffer?"":"click-off",onClick:()=>{this.setState({isShow:!1}),this.props.onChangeIsOpen(!1)},children:"Save"})]})]})}}const yc=[{text:"Big Bonanza  Sale offer | Offer value: 8% | Score: 78%"},{text:" Super sale offer  | Offer value: 12% | Score: 67%"},{text:"Mid season sale offer | Offer value: 10% | Score: 55%"},{text:"Best Buying Days  offer | Offer value: 8% | Score: 53%"},{text:"Great shopping  festival offer | Offer value: 12% | Score: 30%"}];class gc extends Di.Component{constructor(){super(...arguments),ji(this,"state",{errFrequencyType:null,errFrequencyValue:null,ferquencyType:null==(i=null==(t=this.props)?void 0:t.content)?void 0:i.reschedule,frequencyValue:null==(a=null==(s=this.props)?void 0:s.content)?void 0:a.interactivehours})}componentDidMount(){}componentDidUpdate(t){t!==this.props&&this.setState({errFrequencyType:this.props.error.errFrequencyType,errFrequencyValue:this.props.error.errFrequencyValue})}render(){return Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errFrequencyType&&Ti.jsx("div",{className:"validation-message",children:this.state.errFrequencyType}),Ti.jsx(Hl,{data:Cr,className:"marginB0",value:void 0!==this.state.ferquencyType&&""!==this.state.ferquencyType?this.state.ferquencyType:"-- Select --",onChange:t=>{this.setState({ferquencyType:t.target.value});let e={ferquencyType:t.target.value,frequencyValue:this.state.frequencyValue};this.props.onChange(e)}})]})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(ql,{placeholder:"Enter frequency time",cls:"marginB0",val:this.state.frequencyValue,keyboardType:"number",max:jl,cb:t=>{let e=t.length>0?null:va;this.setState({errFrequencyValue:e}),""!==this.state.ferquencyType&&"Day(s)"===this.state.ferquencyType&&(""===t||/^[0-1]{1,1}$/.test(t))&&t<=1&&this.setState({frequencyValue:t}),""!==this.state.ferquencyType&&"Hour(s)"===this.state.ferquencyType&&(""===t||/^[0-9]{1,24}$/.test(t))&&t<=24&&this.setState({frequencyValue:t}),""!==this.state.ferquencyType&&"Minute(s)"===this.state.ferquencyType&&(""===t||/^[0-9]{1,60}$/.test(t))&&t<=60&&this.setState({frequencyValue:t})},ob:t=>{if(t.length>0){let e={ferquencyType:this.state.ferquencyType,frequencyValue:t};this.props.onChange(e)}},errorMessage:this.state.errFrequencyValue})})]})})}}class bc extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isExpiry:void 0!==(null==(l=null==(n=this.props)?void 0:n.content)?void 0:l.isExpiry)&&(null==(r=null==(o=this.props)?void 0:o.content)?void 0:r.isExpiry),errExpiryType:null,errExpiryValue:null,expiryType:null==(d=null==(c=this.props)?void 0:c.content)?void 0:d.expiryType,expiryValue:null==(h=null==(p=this.props)?void 0:p.content)?void 0:h.expiryValue}),ji(this,"componentDidMount",(()=>{})),ji(this,"componentDidUpdate",(t=>{t!==this.props&&(this.setState({errExpiryType:this.props.error.errExpireType,errExpiryValue:this.props.error.errExpireValue}),Is("Expire Component",this.state))}))}render(){return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Expiry"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:t=>{this.setState({isExpiry:t.target.value}),!1===t.target.value&&this.setState({expiryType:null,expiryValue:""});let e={isExpiry:t.target.value,expiryType:this.state.expiryType,expiryValue:this.state.expiryValue};this.props.onChange(e)},checked:this.state.isExpiry})})]})}),!0===this.state.isExpiry?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:jr,label:"Expiry duration",errorMessage:this.state.errExpiryType,required:!0,value:null!==this.state.expiryType&&""!==this.state.expiryType?"H"===this.state.expiryType?"Hour(s)":"Day(s)":"-- Select --",onChange:t=>{let e=t.target.value.length>0?null:ya;this.props.error.errExpireType=e,this.setState({errExpiryType:e,expiryValue:"",expiryType:"Hour(s)"===t.target.value?"H":"D"});let i={isExpiry:this.state.isExpiry,expiryType:"Hour(s)"===t.target.value?"H":"D",expiryValue:this.state.expiryValue};this.props.onChange(i)}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(ql,{required:!0,placeholder:"Value",val:this.state.expiryValue,keyboardType:"number",max:Tl,cb:t=>{let e=t.length>0?null:ga;this.props.error.errExpiryValue=e,this.setState({errExpiryValue:e}),""!==this.state.expiryType&&"D"===this.state.expiryType&&(""===t||/^[0-1]{1,1}$/.test(t))&&t<=1&&this.setState({expiryValue:t}),""!==this.state.expiryType&&"H"===this.state.expiryType&&(""===t||/^[0-9]{1,24}$/.test(t))&&t<=24&&this.setState({expiryValue:t}),""!==this.state.expiryType&&"Minute(s)"===this.state.expiryType&&(""===t||/^[0-9]{1,60}$/.test(t))&&t<=60&&this.setState({expiryValue:t})},ob:t=>{let e=t.length>0?null:ga;if(this.props.error.errExpiryValue=e,this.setState({errExpiryValue:e}),t.length>0){let e={isExpiry:this.state.isExpiry,expiryType:this.state.expiryType,expiryValue:t};this.props.onChange(e)}},errorMessage:this.state.errExpiryValue})})]})}):null]})}}class fc extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isAlertSound:void 0!==(null==(m=null==(u=this.props)?void 0:u.content)?void 0:m.isAlertSound)&&(null==(y=null==(v=this.props)?void 0:v.content)?void 0:y.isAlertSound),errAlertSound:null,alertSound:this.props.content.alertSound,alertEnter:!1}),ji(this,"componentDidMount",(()=>{})),ji(this,"componentDidUpdate",(t=>{var e,i,s,a,n,l,o;t!==this.props&&((null==(e=null==t?void 0:t.content)?void 0:e.alertSound)!==(null==(s=null==(i=this.props)?void 0:i.content)?void 0:s.alertSound)&&this.setState({alertSound:null==(n=null==(a=this.props)?void 0:a.content)?void 0:n.alertSound,isAlertSound:null==(o=null==(l=this.props)?void 0:l.content)?void 0:o.isAlertSound}),this.setState({errAlertSound:this.props.error.errAlertSound}),Is("Alert Sound Component update",this.state))}))}render(){return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Alert sound"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(Wi,{onChange:t=>{this.setState({isAlertSound:t.target.value});let e={isAlertSound:t.target.value,alertSound:this.state.alertSound};this.props.onChange(e)},checked:this.state.isAlertSound})})]})}),!0===this.state.isAlertSound?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:!0===this.state.alertEnter?Ti.jsx(Ti.Fragment,{children:Ti.jsx(ql,{style:{paddingRight:25,backgroundColor:"orange",width:300},required:!0,placeholder:"Enter sound name",val:this.state.alertSound,errorMessage:this.state.errAlertSound,iconPlaceholder:!0,iconName:ba,iconSize:"sm",iconColor:"color-primary-red",iconOnClick:()=>{this.setState({alertEnter:!1,alertSound:""}),props.data.push.content[0].alertSound="",this.props.notificationError.errAlertSound=null,this.setState({errAlertSound:null})},cb:t=>{if(t.length>50)return;let e=t.length>0?null:fa;this.setState({errAlertSound:e,alertSound:t});let i={isAlertSound:this.state.isAlertSound,alertSound:t};this.props.onChange(i)},ob:t=>{let e=t.length>0?null:fa;this.setState({errAlertSound:e,alertSound:t});let i={isAlertSound:this.state.isAlertSound,alertSound:t};this.props.onChange(i)}})}):Ti.jsx(Ul,{data:kr,label:"Alert sound",required:!0,value:void 0!==this.state.alertSound&&""!==this.state.alertSound?this.state.alertSound:"-- Select --",onChange:t=>{if(t.target.value.toLowerCase().includes("enter")){this.setState({alertEnter:!0,alertSound:""});let t={isAlertSound:!0,alertSound:""};this.props.onChange(t)}else{let e=t.target.value.length>0?null:fa;this.setState({errAlertSound:e}),this.setState({alertSound:""});let i={isAlertSound:this.state.isAlertSound,alertSound:t.target.value};this.props.onChange(i)}}})})})}):null]})}}class xc extends Ni.Component{constructor(){super(...arguments),ji(this,"state",{isModalOpen:this.props.isOpen,buttonName:"",buttonNamePosition:0,isWebType:this.props.isWeb,isMobileType:this.props.isMobile,clickBehaviorValue:"-- Select option --",contentValue:"",enterNewLinkvalue:"",typeValue:Cc[2],clicked:0,isShow:!1,errButtonName:null,errBehaviour:null,errBehaviourType:null,errNewLink:null}),ji(this,"componentDidMount",(()=>{if(this.emojianochor=Ni.createRef(),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.props.isWeb){let t=this.props.selectInterActivity.actionType||Cc[2],e=this.props.selectInterActivity.clickBehavourValue||"-- Select option --",i=""!==this.props.selectInterActivity.url?this.props.selectInterActivity.url:"";!1===e.toLowerCase().includes("smartlink")&&this.props.selectInterActivity.url,this.setState({buttonName:this.props.selectInterActivity.actionName,contentValue:this.props.selectInterActivity.url,clickBehaviorValue:e,typeValue:t,enterNewLinkvalue:i})}else{let t=this.props.selectInterActivity.actionType||Cc[2],e=""!==this.props.selectInterActivity.url?this.props.selectInterActivity.url:"",i=void 0!==this.props.selectInterActivity.clickBehavourValue&&""!==this.props.selectInterActivity.clickBehavourValue?this.props.selectInterActivity.clickBehavourValue:"-- Select option --";this.setState({buttonName:this.props.selectInterActivity.actionName,contentValue:this.props.selectInterActivity.url,typeValue:t,enterNewLinkvalue:e,clickBehaviorValue:i})}})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"onOpen",(t=>{this.contentRef.current.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)}))}render(){return Ti.jsxs("div",{onClick:()=>{},children:[1===this.state.clicked?Ti.jsx(oc,{popupClass:"emoji-popup-wrap-modal",anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:()=>{},emojiClose:()=>{this.setState({isShow:!1})},tabindex:0,onEmojiClick:t=>{if(!(this.state.buttonName.length>=20)){var e=ca(this.state.buttonName,t,this.state.buttonNamePosition);this.setState({buttonName:e,buttonNamePosition:this.state.buttonNamePosition+2})}}}):null,Ti.jsxs(_l,{show:this.state.isModalOpen,centered:!0,size:"md",onHide:()=>{this.setState({isShow:!1})},children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Create custom button"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsxs(Jl,{className:"",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Button name"})}),Ti.jsxs(Zl,{md:8,children:[Ti.jsx(ql,{required:!0,placeholder:"Enter button name",cls:"marginB0",val:this.state.buttonName,max:20,ob:(t,e)=>{let i=t.length>0?null:xa;this.setState({errButtonName:i}),this.setState({buttonNamePosition:e.target.selectionStart}),this.setState({buttonName:t.trim()})},cb:t=>{let e=20===t.length?"Reached max count":null;this.setState({errButtonName:e}),setTimeout((()=>{this.setState({errButtonName:null})}),3e3),this.setState({buttonName:t}),this.forceUpdate()},errorMessage:this.state.errButtonName}),Ti.jsx("div",{className:"input-below-icon-set mb0",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"emoji-picker-icon emoji-picker icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.emojianochor,onClick:()=>{this.buttonClick(1)}})})})]})]}),Ti.jsxs(Jl,{className:"mt5",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"On click behavior"})}),Ti.jsx(Zl,{md:8,children:"Enter new link"===this.state.clickBehaviorValue?Ti.jsxs(Ti.Fragment,{children:["call"===this.state.typeValue.toLowerCase()&&Ti.jsxs("div",{children:[Ti.jsxs("div",{className:"position-relative",children:[this.state.errNewLink&&Ti.jsx("div",{className:"validation-message",children:this.state.errNewLink}),Ti.jsx(Gl,{country:"us",value:this.state.enterNewLinkvalue,errorMessage:this.state.errNewLink,onBlur:(t,e)=>{var i;let s=t.target.value.slice((null==(i=null==e?void 0:e.dialCode)?void 0:i.length)+1),a=Ls(s.replaceAll("-","")).length<7?Sa:null;Ca(Ls(s.replaceAll("-","")))||(a=Da),this.setState({errNewLink:a})},onChange:(t,e,i)=>{var s,a,n,l,o;t.length;let r=null==(a=null==(s=i.target)?void 0:s.value)?void 0:a.split(" "),c=null==(o=null==(l=null==(n=null==r?void 0:r.splice(1))?void 0:n.toString())?void 0:l.replaceAll("-",""))?void 0:o.replaceAll(",","");this.setState({enterNewLinkvalue:(null==e?void 0:e.dialCode)+c,countryCode:null==e?void 0:e.countryCode,errNewLink:null,countryCodeMobile:`${e.dialCode}`,errMsgPhone:null})}})]}),Ti.jsx("div",{className:"input-inner-set",children:Ti.jsx("i",{className:"icon-rs-close-mini icons-sm red",onClick:()=>{this.setState({clickBehaviorValue:"-- Select option --"})}})})]}),"call"!==this.state.typeValue.toLowerCase()&&Ti.jsx("div",{children:Ti.jsx(ql,{cls:"paddingR30",required:!0,placeholder:"call"===this.state.typeValue.toLowerCase()?"Enter phone number":"weburl"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter share content",val:this.state.enterNewLinkvalue,cb:t=>{let e=t.length>0?null:"call"===this.state.typeValue.toLowerCase()?ja:"weburl"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter share content";if(this.setState({errNewLink:e}),this.state.typeValue.toLowerCase()===Cc[2].toLowerCase()){if(101===t.length)return void this.setState({errNewLink:Ns});this.setState({enterNewLinkvalue:t.trim()})}if(this.state.typeValue.toLowerCase()===Cc[1].toLowerCase()){if(101===t.length)return void this.setState({errNewLink:Ns});this.setState({enterNewLinkvalue:t})}},ob:t=>{t.length>0&&"share"!==this.state.typeValue.toLowerCase()?(this.setState({enterNewLinkvalue:t.trim()}),t.includes("https://")?Ta(t,this.context,(t=>{!0===t.status?this.setState({errNewLink:null}):this.setState({errNewLink:Aa})}),(t=>{this.setState({errNewLink:Aa})})):this.setState({errNewLink:"Enter valid url"})):this.setState({enterNewLinkvalue:t})},errorMessage:this.state.errNewLink})})]}):Ti.jsxs("div",{className:"position-relative",children:[this.state.errBehaviour&&Ti.jsx("div",{className:"validation-message",children:this.state.errBehaviour}),Ti.jsx(Hl,{className:"required",data:Sc,value:this.state.clickBehaviorValue,onChange:t=>{if(this.setState({enterNewLinkvalue:"",errNewLink:null}),this.props.isWeb){if(t.target.value===Sc[0]&&this.props.smartAppStore.length>=1&&void 0!==this.props.smartAppStore[0].smartAppStoreUrl){if(void 0!==JSON.parse(this.props.smartAppStore[0].smartAppStoreUrl).web){Is("SmartLink",this.props.smartAppStore);let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}}else if(t.target.value===Sc[1]&&this.props.smartAppStore.length>=2&&void 0!==this.props.smartAppStore[1].smartAppStoreUrl){if(void 0!==JSON.parse(this.props.smartAppStore[1].smartAppStoreUrl).web){Is("SmartLink",this.props.smartAppStore);let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}}else if(t.target.value===Sc[2]){let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}}else if(t.target.value===Sc[0]&&this.props.smartAppStore.length>=1&&void 0!==this.props.smartAppStore[0].smartAppStoreUrl){if(JSON.parse(this.props.smartAppStore[0].smartAppStoreUrl).mobilePlatform.length>0){Is("SmartLink",this.props.smartAppStore);let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}}else if(t.target.value===Sc[1]&&this.props.smartAppStore.length>=2&&void 0!==this.props.smartAppStore[1].smartAppStoreUrl){if(JSON.parse(this.props.smartAppStore[1].smartAppStoreUrl).mobilePlatform.length>0){Is("SmartLink",this.props.smartAppStore);let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}}else if(t.target.value===Sc[2]){let e=t.target.value.length>0?null:Ia;return void this.setState({clickBehaviorValue:t.target.value,errBehaviour:e})}let e=t.target.value.length>0?"Selected smartlink is not generated":Ia;this.setState({errBehaviour:e}),setTimeout((()=>{this.setState({errBehaviour:null})}),2e3)}})]})})]}),"Enter new link"===this.state.clickBehaviorValue?Ti.jsxs(Jl,{className:"",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Type"})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errBehaviourType&&Ti.jsx("div",{className:"validation-message",children:this.state.errBehaviourType}),Ti.jsx(Hl,{className:"required",data:this.props.isWeb?[Cc[2]]:Cc,value:this.state.typeValue,onChange:t=>{let e=t.target.value.length>0?null:ka;this.setState({errBehaviourType:e,errNewLink:null}),this.setState({typeValue:t.target.value,enterNewLinkvalue:""})}})]})})]}):null]}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{if(ss(this.state.buttonName))return void this.setState({errButtonName:xa});if(ss(this.state.clickBehaviorValue)||this.state.clickBehaviorValue.toLowerCase().includes("select"))return void this.setState({errBehaviour:Ia});if("Enter new link"===this.state.clickBehaviorValue&&(ss(Ls(this.state.enterNewLinkvalue))||null!==this.state.errNewLink))return void this.setState({enterNewLinkvalue:"",errNewLink:"call"===this.state.typeValue.toLowerCase()?ja:"weburl"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter share content"});let t={actionName:this.state.buttonName,actionType:!0===this.state.typeValue.toLowerCase().includes("select")?""!==this.state.clickBehaviorValue?this.state.clickBehaviorValue:"actionType":this.state.typeValue.toLowerCase(),clickBehavourValue:this.state.clickBehaviorValue,url:""!==this.state.enterNewLinkvalue?this.state.enterNewLinkvalue:""!==this.state.clickBehaviorValue&&this.state.clickBehaviorValue.split(" ").length>1?this.state.clickBehaviorValue.split(" ")[1]:""};Is("Smart Link Save",this.state),this.setState({isModalOpen:!1}),this.props.onSaveClick(t),this.props.onChangeIsOpen(!1)},children:"Save"})]})]})]})}}ji(xc,"contextType",Ji),wi(xc);const Sc=["Smart link 1","Smart link 2","Enter new link"],Cc=["Call","Share","Weburl"];var jc=["Smart link 1","Smart link 2","Web URL"],Tc=["Smart link 1","Smart link 2","Call","Share","Web URL"];class Ic extends Ni.Component{constructor(){super(...arguments),ji(this,"state",{isModalOpen:this.props.isOpen,buttonName:"",buttonNamePosition:0,isWebType:this.props.isWeb,isMobileType:this.props.isMobile,clickBehaviorValue:"",contentValue:"",enterNewLinkvalue:"",typeValue:"",clicked:0,isShow:!1,errButtonName:null,errBehaviour:null,errBehaviourType:null,errNewLink:null,countryCodeMobile:65}),ji(this,"componentDidMount",(()=>{var t,e,i,s,a,n,l,o,r,c;if(this.emojianochor=Ni.createRef(),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.props.isWeb){let n=this.props.selectInterActivity.actionType||"",l=this.props.selectInterActivity.clickBehavourValue||"-- Select option --",o=""!==this.props.selectInterActivity.url?this.props.selectInterActivity.url:"";!1===l.toLowerCase().includes("smartlink")&&this.props.selectInterActivity.url,this.setState({buttonName:this.props.selectInterActivity.actionName,contentValue:this.props.selectInterActivity.url,clickBehaviorValue:l,typeValue:n,enterNewLinkvalue:o});let r=["Web URL"];if(0===(null==(e=null==(t=this.props)?void 0:t.smartAppStore)?void 0:e.length)||void 0===(null==(i=this.props)?void 0:i.smartAppStore)||null===this.props.smartAppStore)r.push("Generate smartlink"),jc=r;else{let t=[];null==(a=null==(s=this.props)?void 0:s.smartAppStore)||a.map(((e,i)=>{let s=i+1;t.push("Smartlink "+parseInt(s))})),jc=t.concat(r)}}else{let t=this.props.selectInterActivity.actionType||"",e=""!==this.props.selectInterActivity.url?this.props.selectInterActivity.url:"",i=void 0!==this.props.selectInterActivity.clickBehavourValue&&""!==this.props.selectInterActivity.clickBehavourValue?this.props.selectInterActivity.clickBehavourValue:"-- Select option --";if(this.setState({buttonName:this.props.selectInterActivity.actionName,contentValue:this.props.selectInterActivity.url,typeValue:t,enterNewLinkvalue:e,clickBehaviorValue:i}),"call"===t)if(void 0!==this.props.selectInterActivity.countryCode&&null!==this.props.selectInterActivity.countryCode){let t="+"+this.props.selectInterActivity.countryCode;this.setState({countryCodeMobile:parseInt(t)})}else this.setDefaultCountryCode();else this.setDefaultCountryCode();let s=["Call","Share","Web URL"];if(0===(null==(l=null==(n=this.props)?void 0:n.smartAppStore)?void 0:l.length)||void 0===(null==(o=this.props)?void 0:o.smartAppStore)||null===this.props.smartAppStore)s.push("Generate smartlink"),Tc=s;else{let t=[];null==(c=null==(r=this.props)?void 0:r.smartAppStore)||c.map(((e,i)=>{let s=i+1;t.push("Smartlink "+parseInt(s))})),Tc=t.concat(s)}}})),ji(this,"setDefaultCountryCode",(()=>{if(null!=localStorage.getItem("bdetails")&&null!=localStorage.getItem("bdetails")){let t=ks(localStorage.getItem("bdetails"));1===parseInt(null==t?void 0:t.country_calling_code)?this.setState({countryCodeMobile:12}):this.setState({countryCodeMobile:parseInt(null==t?void 0:t.country_calling_code)})}})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"onOpen",(t=>{this.contentRef.current.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"mobileCustomButtonChange",(t=>{var e,i,s;let a=Tc.indexOf(t);if(!0===t.toLowerCase().includes("smartlink"))if((null==(e=this.props.smartAppStore)?void 0:e.length)>=1&&void 0!==(null==(i=this.props.smartAppStore[a])?void 0:i.smartAppStoreUrl)){if(JSON.parse(this.props.smartAppStore[a].smartAppStoreUrl).mobilePlatform.length>0){Is("SmartLink",this.props.smartAppStore);let e=t.length>0?null:Ia;return void this.setState({clickBehaviorValue:t,errBehaviour:e,typeValue:t})}}else{null==(s=this.props)||s.showSmartLink();let t="Generate smartlink";this.setState({errBehaviour:t,isModalOpen:!1})}else{let e=t.length>0?null:Ia;this.setState({clickBehaviorValue:t,errBehaviour:e,typeValue:t})}})),ji(this,"webCustomButtonChange",(t=>{var e,i,s;let a=jc.indexOf(t);if(!0===t.toLowerCase().includes("smartlink"))if((null==(e=this.props.smartAppStore)?void 0:e.length)>=1&&void 0!==(null==(i=this.props.smartAppStore[a])?void 0:i.smartAppStoreUrl)){if(void 0!==JSON.parse(this.props.smartAppStore[a].smartAppStoreUrl).web){Is("SmartLink",this.props.smartAppStore);let e=t.length>0?null:Ia;return void this.setState({clickBehaviorValue:t,errBehaviour:e,typeValue:t})}}else{null==(s=this.props)||s.showSmartLink();let t="Generate smartlink";this.setState({errBehaviour:t,isModalOpen:!1})}else{let e=t.length>0?null:Ia;this.setState({clickBehaviorValue:t,errBehaviour:e,typeValue:t})}}))}render(){return Ti.jsxs("div",{onClick:()=>{},children:[1===this.state.clicked?Ti.jsx(oc,{popupClass:"emoji-popup-wrap-modal",anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:()=>{},emojiClose:()=>{this.setState({isShow:!1})},tabindex:0,onEmojiClick:t=>{if(!(this.state.buttonName.length>=20)){var e=ca(this.state.buttonName,t,this.state.buttonNamePosition);this.setState({buttonName:e,buttonNamePosition:this.state.buttonNamePosition+2})}}}):null,Ti.jsxs(_l,{show:this.state.isModalOpen,centered:!0,size:"md",onHide:()=>{this.setState({isShow:!1})},children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Create custom button"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{small:!0,label:"Button name"})}),Ti.jsx(Zl,{md:8,children:Ti.jsx(ql,{required:!0,placeholder:"Button name",val:this.state.buttonName,max:20,handleOnBlur:(t,e)=>{let i=t.length>0?null:xa;this.setState({errButtonName:i}),this.setState({buttonNamePosition:e.target.selectionStart}),this.setState({buttonName:t.trim()})},handleOnchange:t=>{let e=20===t.length?"Reached max count":null;this.setState({errButtonName:e}),setTimeout((()=>{this.setState({errButtonName:null})}),3e3),this.setState({buttonName:t}),this.forceUpdate()},errorMessage:this.state.errButtonName})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:8,offset:4},children:Ti.jsx(Mo,{children:Ti.jsx("div",{className:"rsp-icon-group",children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"emoji-picker-icon emoji-picker icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.emojianochor,onClick:()=>{this.buttonClick(1)}})})})})})})})]}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{small:!0,label:"On click behavior"})}),Ti.jsx(Zl,{md:8,children:Ti.jsx(Ul,{required:!0,label:"Actions",errorMessage:this.state.errBehaviour,data:this.props.isWeb?jc:Tc,value:""===this.state.typeValue?"-- Select option --":this.state.typeValue,handleChange:(t,e)=>{this.setState({enterNewLinkvalue:"",errNewLink:null}),this.props.isWeb?this.webCustomButtonChange(t.target.value):this.mobileCustomButtonChange(t.target.value)}})})]})}),""!==this.state.typeValue&&!1===this.state.typeValue.toLowerCase().includes("smartlink")?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Ao,{label:"call"===this.state.typeValue.toLowerCase()?" Mobile number":"web url"===this.state.typeValue.toLowerCase()?"URL":"share"===this.state.typeValue.toLowerCase()?"Content":this.state.typeValue})}),Ti.jsx(Zl,{md:8,children:Ti.jsxs(Ti.Fragment,{children:["call"===this.state.typeValue.toLowerCase()&&Ti.jsx("div",{children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errNewLink&&Ti.jsx("div",{className:"validation-message mt-20",children:this.state.errNewLink}),Ti.jsx(Gl,{className:"required",value:this.state.countryCodeMobile+this.state.enterNewLinkvalue,errorMessage:this.state.errNewLink,onBlur:(t,e)=>{var i;let s=t.target.value.slice((null==(i=null==e?void 0:e.dialCode)?void 0:i.length)+1),a=Ls(s.replaceAll("-","")).length<7?Sa:null;Ca(Ls(s.replaceAll("-","")))||(a=wa),this.setState({errNewLink:a})},onChange:(t,e,i)=>{var s,a,n,l,o,r,c,d,p;if(t.length,void 0!==(null==(s=i.target)?void 0:s.value)&&null!==(null==(a=i.target)?void 0:a.value)&&(null==(l=null==(n=i.target)?void 0:n.value)?void 0:l.length)>0){let t=null==(r=null==(o=i.target)?void 0:o.value)?void 0:r.split(" "),s=null==(p=null==(d=null==(c=null==t?void 0:t.splice(1))?void 0:c.toString())?void 0:d.replaceAll("-",""))?void 0:p.replaceAll(",","");this.setState({enterNewLinkvalue:s,countryCode:null==e?void 0:e.countryCode,errNewLink:null,countryCodeMobile:`${e.dialCode}`,errMsgPhone:null})}else this.setState({countryCode:null==e?void 0:e.countryCode,errNewLink:null,countryCodeMobile:`${e.dialCode}`,errMsgPhone:null})}})]})}),"call"!==this.state.typeValue.toLowerCase()&&Ti.jsx("div",{children:Ti.jsx(ql,{className:"paddingR30",required:!0,max:100,placeholder:"web url"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter shareable content",val:this.state.enterNewLinkvalue,cb:t=>{var e;let i=t.length>0?null:"weburl"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter shareable content";this.setState({errNewLink:i}),null==(e=this.props)||e.isWeb,101!==t.length?this.setState({enterNewLinkvalue:t}):this.setState({errNewLink:"Reached max count"})},ob:t=>{t.length>0&&"share"!==this.state.typeValue.toLowerCase()?(this.setState({enterNewLinkvalue:t.trim()}),t.includes("https://")?Ta(t,this.context,(t=>{!0===t.status?this.setState({errNewLink:null}):this.setState({errNewLink:Aa})}),(t=>{this.setState({errNewLink:Aa})})):this.setState({errNewLink:"Enter valid URL"})):this.setState({enterNewLinkvalue:t})},errorMessage:this.state.errNewLink})})]})})]})}):null]}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isModalOpen:!this.state.isModalOpen}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{if(ss(this.state.buttonName))return void this.setState({errButtonName:xa});if(ss(this.state.clickBehaviorValue)||this.state.clickBehaviorValue.toLowerCase().includes("select"))return void this.setState({errBehaviour:Ia});if(!1===this.state.typeValue.toLocaleLowerCase().includes("smartlink")&&(ss(Ls(this.state.enterNewLinkvalue))||null!==this.state.errNewLink))return void this.setState({enterNewLinkvalue:"",errNewLink:"call"===this.state.typeValue.toLowerCase()?ja:"web url"===this.state.typeValue.toLowerCase()?"Enter Web URL":"Enter share content"});let t={actionName:this.state.buttonName,countryCode:this.state.countryCodeMobile,actionType:!0===this.state.typeValue.toLowerCase().includes("select")?""!==this.state.clickBehaviorValue?this.state.clickBehaviorValue:"actionType":this.state.typeValue.toLowerCase(),clickBehavourValue:this.state.clickBehaviorValue,url:""!==this.state.enterNewLinkvalue?this.state.enterNewLinkvalue:""!==this.state.clickBehaviorValue&&this.state.clickBehaviorValue.split(" ").length>1?this.state.clickBehaviorValue.split(" ")[1]:""};Is("Smart Link Save",this.state),this.setState({isModalOpen:!1}),this.props.onSaveClick(t),this.props.onChangeIsOpen(!1)},children:"Save"})]})]})]})}}ji(Ic,"contextType",Ji);const kc=wi(Ic);class Dc extends Di.Component{constructor(t){super(t),ji(this,"state",{iFrameValue:null==(b=null==(g=this.props)?void 0:g.content)?void 0:b.body,campaignURL:"",importZIPFile:{data:"",fileName:""},importFileNameFromAPI:"",fileTypeErr:null,importFile:!((null==(S=null==(x=null==(f=this.props)?void 0:f.content)?void 0:x.edmUrl)?void 0:S.length)>0),webUrl:(null==(j=null==(C=this.props)?void 0:C.content)?void 0:j.edmUrl)||"",builderPreview:!0,isMailboxPreviewModal:!1,checked:!1,content:{makeAlert:void 0!==(null==(I=null==(T=this.props)?void 0:T.content)?void 0:I.makeAlert)&&(null==(D=null==(k=this.props)?void 0:k.content)?void 0:D.makeAlert),title:null==(w=null==(A=this.props)?void 0:A.content)?void 0:w.title,titlePos:0,shortDesc:null==(L=null==(N=this.props)?void 0:N.content)?void 0:L.shortDesc,shortDescPos:0,hashTag:null==(B=null==(E=this.props)?void 0:E.content)?void 0:B.hashTag,isInterActivity:null==(P=null==(M=this.props)?void 0:M.content)?void 0:P.isInteractivebuttonEnabled,interActivity:null==(U=null==(F=this.props)?void 0:F.content)?void 0:U.interActivity,isAlertSound:null==(O=null==(R=this.props)?void 0:R.content)?void 0:O.isAlertSound,alertSound:null==(V=null==(q=this.props)?void 0:q.content)?void 0:V.alertSound,ferquencyType:"",frequencyValue:"",isExpiry:null==($=null==(z=this.props)?void 0:z.content)?void 0:$.isExpiryButtonEnabled,expiryType:null==(G=null==(H=this.props)?void 0:H.content)?void 0:G.pushexpirySchedule,expiryValue:null==(_=null==(W=this.props)?void 0:W.content)?void 0:_.pushExpiryhours},errContent:{errTitle:null,errShortDesc:null,errBody:null,errImportUrl:null,errExpireType:null,errExpireValue:null,errInterActivity1:null,errInterActivity2:null,errFrequencyType:null,errFrequencyValue:null,errAlertSound:null},titleEmoji:!1,shortDescEmoji:!1,isOpenCustomButtonModal:!1,currentIndex:0,clicked:0,height:0}),ji(this,"componentDidUpdate",(t=>{var e,i;if(t!==this.props){let t={...this.state.errContent};t.errTitle=this.props.error.errTitle,t.errAlertSound=null==(i=null==(e=this.props)?void 0:e.error)?void 0:i.errAlertSound,t.errShortDesc=this.props.error.errShortDesc,t.errBody=this.props.error.errBody,t.errImportUrl=this.props.error.errImportUrl,t.errExpireType=this.props.error.errExpiryType,t.errExpireValue=this.props.error.errExpiryValue,t.errInterActivity1=this.props.error.errInteractivityButton1,t.errInterActivity2=this.props.error.errInteractivityButton2,t.errFrequencyType=this.props.error.errFrequencyType,t.errFrequencyValue=this.props.error.errFrequencyValue,this.setState({errContent:t})}})),ji(this,"importZip",(t=>{this.setState({iFrameValue:""});const e=t.target.files[0].name.split(".").at(-1).toLowerCase();if("zip"===e||"rar"===e){this.setState({fileTypeErr:null});var i=new FileReader;i.readAsDataURL(t.target.files[0]);let e=t.target.files[0].name,s="";this.props.error.errImportUrl=null,this.setState((t=>({errContent:{...t.errContent,errBody:null,errImportUrl:null}}))),i.onload=t=>{s=i.result.split(",").pop(),this.setState({importZIPFile:{data:s,fileName:e}}),os({path:Na,isCache:!1,params:{importDescription:e,fileName:e,fileByte:s,headers:""},loading:this.context.globalStateData.setIsLoadingData,ok:t=>{var e,i;if(t.status&&(null==(e=null==t?void 0:t.data)?void 0:e.html)){let e=t.data;const s=this.handleEditableHtmlContent(e.html);let a=La+e.filePath;a.replaceAll("\\","/"),this.setState({iFrameValue:s,importFileNameFromAPI:a,builderPreview:!0},(()=>{null!==document.getElementById("edmFrame")&&void 0!==document.getElementById("edmFrame")&&document.querySelector("#edmFrame").setAttribute("srcDoc",s+"<style>body{pointer-events: none;}</style>")})),this.props.error.errImportUrl=null;let n={...this.state.errContent};n.errBody=null,n.errImportUrl=null,this.setState({errContent:n}),5===(null==(i=this.props)?void 0:i.pushType)?this.props.onChange(La+e.filePath,s,!0):(this.props.getBodyContent(La+e.filePath,s+""),this.props.onChange(this.state.content))}else{let t={...this.state.errContent};t.errBody=null,this.props.error.errImportUrl="Upload valid file",t.errImportUrl="Upload valid file",this.setState({errContent:t}),this.props.errorData("errImportUrl",t.errImportUrl)}},fail:t=>{}})},i.onerror=t=>{alert("EDM is not valid")},i.abort=t=>{alert("EDM is not valid")},t.target.value=null}else this.setState({fileTypeErr:Ea})})),ji(this,"handleEditableHtmlContent",(t=>{let e=document.createElement("div");return e.id="wrapperElement",e.innerHTML=t,e.querySelector("table")&&e.querySelectorAll("table").forEach((t=>{t.querySelector("img")||(t.contentEditable=!0,t.setAttribute("style","outline:none"))})),e.innerHTML})),ji(this,"createInteractivityObject",(t=>({actionName:t,displayName:t,actionId:Ba(t),actionType:t.toLowerCase(),fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:Ma(t)}))),ji(this,"filterByReference",((t,e)=>{let i=[];return i=t.filter((t=>!e.find((e=>{var i;return(null==(i=null==e?void 0:e.actionName)?void 0:i.toLowerCase())===t.toLowerCase()})))),i})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"ColorGraint",(t=>{let e=null,i=t.data;return 4===(null==t?void 0:t.id)&&0===(null==t?void 0:t.index)&&(e=this.font1coloranochor),4===(null==t?void 0:t.id)&&1===(null==t?void 0:t.index)&&(e=this.font2coloranochor),5===(null==t?void 0:t.id)&&0===(null==t?void 0:t.index)&&(e=this.bg1ColorAnochor),5===(null==t?void 0:t.id)&&1===(null==t?void 0:t.index)&&(e=this.bg2ColorAnochor),Ti.jsx(Oo,{anchor:e,selectColor:(null==i?void 0:i.textColor)||"#fff",show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0}),t.applyBtnClick(e)}})})),ji(this,"FontColorView",(t=>{var e,i;let s=null,a=null;return 0===(null==t?void 0:t.index)&&(s=this.font1coloranochor,a=this.bg1ColorAnochor),1===(null==t?void 0:t.index)&&(s=this.font2coloranochor,a=this.bg2ColorAnochor),Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:s,onClick:()=>this.buttonClick(4)})})}),Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:a,onClick:()=>this.buttonClick(5)})})}),4===this.state.clicked&&Ti.jsx(this.ColorGraint,{index:null==t?void 0:t.index,id:this.state.clicked,selectColor:(null==(e=t.data)?void 0:e.fontColor)||"#000000",data:t.data.fontColor,applyBtnClick:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);let o={...this.state.content};o.interActivity[t.index].fontColor=l,this.setState({content:o})}}),5===this.state.clicked&&Ti.jsx(this.ColorGraint,{index:null==t?void 0:t.index,id:this.state.clicked,selectColor:(null==(i=t.data)?void 0:i.bgColor)||"#ffffff",data:t.data,applyBtnClick:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);let o={...this.state.content};o.interActivity[t.index].bgColor=l,this.setState({content:o})}})]})})),ji(this,"contentUpdate",((t,e)=>{let i={...this.state.content};i[t.key]=t.value;let s={...this.state.errContent};s[e.key]=e.value,this.setState({content:i,errContent:s})})),ji(this,"onOpen",(t=>{this.contentRef.current.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({titleEmoji:!1,shortDescEmoji:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"importURL",(()=>{let t={url:this.state.webUrl,splitType:""};os({path:Fa,isCache:!1,params:t,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i;if(t.status){if(this.state.webUrl.toLowerCase().includes("forms")||this.state.webUrl.toLowerCase().includes("tellfriend"))return void this.setState({iFrameValue:this.state.webUrl,builderPreview:!0},(()=>{null!=document.querySelector("#edmFrame")&&(document.querySelector("#edmFrame").setAttribute("src",this.state.webUrl),document.querySelector("#edmFrame").removeAttribute("srcDoc")),this.props.getBodyContent(this.state.webUrl,this.state.webUrl);let t={...this.state.content};t.edmUrl=this.state.webUrl,this.props.onChange(t)}));const s=this.handleEditableHtmlContent(t.data.html);if(this.setState({iFrameValue:s+"",importFileNameFromAPI:(null==(e=null==t?void 0:t.data)?void 0:e.filePath)||"",builderPreview:!0},(()=>{var e;const i=document.querySelector("#edmFrame");null!=i&&(null==(e=null==t?void 0:t.data)?void 0:e.html)&&(i.setAttribute("srcDoc",t.data.html),i.removeAttribute("src"))})),5===(null==(i=this.props)?void 0:i.pushType))this.props.getBodyContent(this.state.webUrl,t.data.html),this.state.content,t.data.html,this.props.onChange(this.state.webUrl,t.data.html,!1);else{this.props.getBodyContent(this.state.webUrl,t.data.html);let e={...this.state.content};e.edmUrl=this.state.webUrl,this.props.onChange(e)}}else this.props.getBodyContent(this.state.webUrl,this.state.webUrl)},fail:t=>{this.props.getBodyContent(this.state.webUrl,this.state.webUrl)}})})),ji(this,"getVerificationLinks",(t=>{let e=t;const i=(new DOMParser).parseFromString(e,"text/html"),s=Array.from(i.querySelectorAll("[href]"),(t=>t.getAttribute("href")));if(0===s.length){let t={...this.state.errContent};return t.errBody=Ga,this.setState({errContent:t}),a=!0,a}let a=!1,n=[];return s.forEach((t=>{if(!0===a){let t={...this.state.errContent};return t.errBody=Ga,void this.setState({errContent:t})}let e=t.includes("http")?t:"";if(""!==e){let t={LinkURL:e,SDKStatus:!1,LinkStatus:!1};n.push(t),a=!0}else a=!0})),this.setState({edmLinks:n}),a})),ji(this,"MakeasAlertComponent",(()=>{var t,e,i,s,a,n,l,o,r,c,d,p;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Make alert"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[Ti.jsx(qo,{onChange:t=>{let e={...this.state.content};e.makeAlert=t.target.value,!1===t.target.value&&(e.title="",e.shortDesc=""),this.setState({content:e}),this.props.onChange(e)},checked:this.state.content.makeAlert}),Ti.jsx(Qi,{icon:Ua,size:"md",tooltip:"View the notification in alert style"})]})})})]})}),this.state.content.makeAlert&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Title"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{required:!0,type:"textarea",placeholder:"Title",val:this.state.content.title,max:60,errorMessage:this.state.errContent.errTitle,onBlur:t=>{let e={...this.state.content};e.titlePos=t.target.selectionStart,this.setState({content:e}),this.props.onChange(this.state.content)},onChange:t=>{if(t.target.value.length>60)return;let e=t.target.value.trimStart();e=e.replace(/\s+/g," ");let i=e.length>0?null:Ra;this.props.error.errTitle=i;let s={key:"title",value:e},a={key:"errTitle",value:i};this.contentUpdate(s,a)}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"d-flex justify-content-between",children:[Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx(Hi,{className:"click-off",items:[],icon:` ${Oa} color-primary-blue icons-md`,onItemClick:t=>{}}),Ti.jsx(Xi,{className:"ml10",children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:`${qa} color-primary-blue icons-md cp`,ref:this.titleanochor,onClick:()=>{this.setState({titleEmoji:!this.state.titleEmoji})}})})})})]}),Ti.jsx("small",{className:`float-end fs12 ${60===this.state.content.title.length&&"red"}`,children:0===this.state.content.title.length?"60":this.state.content.title.length+"/60"})]})})})]}),Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Short description"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{required:!0,type:"textarea",placeholder:0===(null==(e=null==(t=this.state.content)?void 0:t.shortDesc)?void 0:e.length)||void 0===(null==(i=this.state.content)?void 0:i.shortDesc)||null===(null==(s=this.state.content)?void 0:s.shortDesc)?"Enter description":"Description",val:this.state.content.shortDesc,max:60,errorMessage:this.state.errContent.errShortDesc,onBlur:t=>{let e={...this.state.content};e.shortDescPos=t.target.selectionStart,this.setState({content:e}),this.props.onChange(this.state.content)},onChange:t=>{if(t.target.value.length>60)return;let e=t.target.value.trimStart();e=e.replace(/\s+/g," ");let i=e.length>0?null:Va;this.props.error.errShortDesc=i;let s={key:"shortDesc",value:e},a={key:"errShortDesc",value:i};this.contentUpdate(s,a)}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"d-flex justify-content-between",children:[Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx(Hi,{className:"click-off",items:[],icon:` ${Oa} color-primary-blue icons-md`,onItemClick:t=>{}}),Ti.jsx(Xi,{className:"ml10",children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:`${qa} color-primary-blue icons-md cp`,ref:this.subTitleEmojiAnochor,onClick:()=>{this.setState({shortDescEmoji:!this.state.shortDescEmoji})}})})})})]}),Ti.jsx("small",{className:`float-end fs12 ${60===(null==(n=null==(a=this.state.content)?void 0:a.shortDesc)?void 0:n.length)&&"red"}`,children:0===(null==(o=null==(l=this.state.content)?void 0:l.shortDesc)?void 0:o.length)||void 0===(null==(r=this.state.content)?void 0:r.shortDesc)||null===(null==(c=this.state.content)?void 0:c.shortDesc)?"60":(null==(p=null==(d=this.state.content)?void 0:d.shortDesc)?void 0:p.length)||"0/60"})]})})})]})]})]})})),ji(this,"errContentMapping",{0:this.state.errContent.errInterActivity1,1:this.state.errContent.errInterActivity2}),ji(this,"interActivityButton",(t=>this.errContentMapping[t])),ji(this,"handleFileWindow",(()=>{const t=document.createElement("input");t.type="file",t.style.display="none",document.body.appendChild(t),t.addEventListener("change",(e=>{e.target.files[0],this.importZip(e),document.body.removeChild(t)})),t.click()})),ji(this,"getHashTagUpdation",(()=>{var t;return(null==(t=this.state.content.hashTag)?void 0:t.length)+" / 5"})),ji(this,"checkFileExtension",(t=>{let e=!1,i=!1;const s=t.split(".").pop().toLowerCase();return"png"===s||"jpg"===s||"jpeg"===s||"gif"===s?e=!0:"html"===s&&(i=!0),[e,i]})),ji(this,"checkTheExtension",(t=>{let e=!1,i=!1;const s=t.split(".").pop().toLowerCase();return"png"===s||"jpg"===s||"jpeg"===s||"gif"===s?e=!0:"html"===s&&(i=!0),!1===e&&!1===i&&(i=!0),[e,i]})),ji(this,"InterActivityComponent",(()=>Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Interactivity"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:t=>{let i={...this.state.content};if(i.isInterActivity=t.target.value,t.target.value){let t=i.interActivity;t.push(this.createInteractivityObject("")),i.interActivity=t,this.setState({content:i})}else i.interActivity=[],this.setState({content:i});this.props.onChange(i),this.props.content.isInterActivity=e.target.value,this.forceUpdate()},checked:this.props.content.isInterActivity})})]})}),this.state.content.interActivity.length>0&&this.state.content.interActivity.map(((t,e)=>{var i,s;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:["Button"],value:"Button",label:"Action type"})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{label:"Action",errorMessage:this.interActivityButton(e),data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),value:void 0!==t.displayName&&""!==t.displayName?t.displayName:"-- Select --",onChange:t=>{var i;0===e?(this.setState((t=>({errContent:{...t.errContent,errInterActivity1:null}}))),this.props.error.errInterActivity1=null):(this.setState((t=>({errContent:{...t.errContent,errInterActivity2:null}}))),this.props.error.errInterActivity2=null);let s=[...this.state.content.interActivity];s[e].displayName=t.target.value,s[e].actionName="Custom action"!==t.target.value?t.target.value:"",s[e].actionType="",s[e].url="",s[e].clickBehavourValue="",s[e].actionId=Ba(s[e].displayName),s[e].value=Ma(s[e].displayName);let a={...this.state.content,interActivity:s};this.setState({content:a}),5===(null==(i=this.props)?void 0:i.pushType)?this.props.onChange(this.state.webUrl,this.state.iFrameValue,!1,s):this.props.onChange(a)}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[0===e&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.font1coloranochor,onClick:()=>this.buttonClick(4)})})}),Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.bg1ColorAnochor,onClick:()=>this.buttonClick(5)})})}),4===this.state.clicked&&Ti.jsx(Oo,{anchor:_fanchor,selectColor:(null==data?void 0:data.textColor)||"#fff",show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:t=>{this.setState({clicked:0}),props.applyBtnClick(t)}}),5===this.state.clicked&&Ti.jsx(this.ColorGraint,{index:null==props?void 0:props.index,id:this.state.clicked,selectColor:(null==(i=props.data)?void 0:i.bgColor)||"#ffffff",data:props.data,applyBtnClick:t=>{var e=t.split("("),i=parseInt(e[1].split(",")[0]),s=parseInt(e[1].split(",")[1]),a=parseInt(e[1].split(",")[2]),n=Pa(i,s,a);let l={...this.state.content};l.interActivity[props.index].bgColor=n,this.setState({content:l})}})]}),3===t.actionId&&4!==t.value&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(Qi,{tooltip:"Settings",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal,currentIndex:e})}})}),5!==(null==(s=this.props)?void 0:s.pushType)&&Ti.jsx(Ti.Fragment,{children:0===e?Ti.jsx(Qi,{tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",iconClass:`${this.state.content.interActivity.length>1&&"click-off"}`,size:"md",onClick:()=>{let t=[...this.state.content.interActivity];t.push(this.createInteractivityObject(""));let e={...this.state.content,interActivity:t};this.setState({content:e}),this.props.onChange(e)}}):Ti.jsx(Qi,{tooltip:"Remove",icon:"icon-rs-circle-minus-fill-edge-medium",color:"red",size:"md",onClick:()=>{let t=[...this.state.content.interActivity];t.splice(1,1);let e={...this.state.content,interActivity:t};this.setState({content:e}),this.props.onChange(e)}})})]})})})]})}),1===t.actionId&&Ti.jsx(gc,{content:t,error:this.state.errContent,onChange:e=>{this.props.error.errFrequencyType=null!==e.ferquencyType?null:ya,this.props.error.errFrequencyValue=null!==e.ferquencyType&&e.frequencyValue.length>0?null:ga;let i={...this.state.errContent};i.errFrequencyType=null,i.errFrequencyValue=null,this.setState({errContent:i}),t.interactivehours=e.frequencyValue,t.reschedule=e.ferquencyType,t.maybeLaterTimeings=e.frequencyValue+" "+e.ferquencyType,this.props.onChange(this.state.content)}})]})}))]}))),this.createRef()}createRef(){this.font1coloranochor=Ni.createRef(),this.bg1ColorAnochor=Ni.createRef(),this.font2coloranochor=Ni.createRef(),this.bg2ColorAnochor=Ni.createRef()}componentDidMount(){var t,e;if(this.titleanochor=Ni.createRef(),this.subTitleEmojiAnochor=Ni.createRef(),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),null!==document.getElementById("edmFrame")&&void 0!==document.getElementById("edmFrame")){const i=document.querySelector("#edmFrame");if((null==(t=this.props.bodyData)?void 0:t.toLowerCase().includes("forms"))||(null==(e=this.props.bodyData)?void 0:e.toLowerCase().includes("tellfriend")))null!=i&&document.querySelector("#edmFrame").setAttribute("src",this.state.webUrl);else if(null!=i){null!=document.querySelector("#edmFrame")&&document.querySelector("#edmFrame").setAttribute("srcDoc",this.state.iFrameValue+"<style>body{pointer-events: none;margin:0;}</style>")}}}getMobileInteractivityButtons(){let t=["Dismiss","Maybe later","Unsubscribe","Custom action"];return 5===this.props.pushType&&(t=["Custom action"]),this.filterByReference(t,this.state.content.interActivity)}getWebInteractivityButtons(){let t=["Dismiss","Unsubscribe","Custom action"];return 5===this.props.pushType&&(t=["Custom action"]),this.filterByReference(t,this.state.content.interActivity)}initialize(){document.getElementById("file")}render(){var t,e,i,s,a,n,l;return Ti.jsxs("div",{children:[Ti.jsxs("div",{className:"position-relative",children:[!0===this.state.importFile&&this.state.errContent.errImportUrl&&Ti.jsx("div",{className:"validation-message mt-25",children:this.state.errContent.errImportUrl}),Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:12,className:"import-padding",children:Ti.jsxs(Jl,{className:"custom-column border2 m0",children:[Ti.jsxs(Zl,{className:"py15 bg-color4 border2R "+(this.state.importFile?"col-md-2 cp":"col-md-10"),onClick:()=>{var t;this.setState({importFile:!1,iFrameValue:""}),this.setState({fileTypeErr:null}),null==(t=this.props)||t.emptyData("","")},children:[Ti.jsxs(Jl,{className:"align-items-center",children:[Ti.jsx(Zl,{className:"d-flex align-items-center justify-content-center "+(this.state.importFile?"col-md-12":"col-md-3"),children:Ti.jsxs("div",{className:"d-flex align-items-center flex-column",children:[Ti.jsx("i",{className:"icon-rs-import-link-large icons-lg color-primary-blue mb7"}),Ti.jsx("span",{children:"Image URL"})]})}),this.state.importFile?"":Ti.jsx(Zl,{md:9,children:Ti.jsxs("div",{className:"d-flex align-items-end justify-content-center ml-9",children:[Ti.jsx(ql,{required:!0,placeholder:0===this.state.webUrl.length?"Enter image URL":"Import URL",val:this.state.webUrl,cls:"mb0",cls2:"mr15",errorMessage:this.state.errContent.errBody,max:Sl,cb:t=>{this.setState((t=>({errContent:{...t.errContent,errBody:null},iFrameValue:""}))),this.setState({webUrl:t})},ob:t=>{var e,i,s,a,n,l,o;let r=(null==(i=null==(e=this.state)?void 0:e.webUrl)?void 0:i.length)?null:"Enter import URL";if(this.setState({errMsgImportUrl:r}),5===(null==(s=this.props)?void 0:s.pushType)&&(null==(n=null==(a=this.state)?void 0:a.webUrl)?void 0:n.length)>0){let t=this.checkFileExtension(null==(l=this.state.webUrl)?void 0:l.trim());if(!1===t[0]&&!1===t[1])r="Enter valid URL. Only supports .png, .jpg, .jpeg, .gif, .html",this.setState((t=>({errContent:{...t.errContent,errBody:r},iFrameValue:""}))),this.setState({errMsgImportUrl:r,webUrl:""});else if(!0===t[0]){let t=new Image;t.src=null==(o=this.state.webUrl)?void 0:o.trim(),t.onload=()=>{},t.onerror=()=>{this.setState((t=>({errContent:{...t.errContent,errBody:"Valid image URL"},iFrameValue:""}))),this.setState({errMsgImportUrl:"Valid image URL",webUrl:""})}}}}}),Ti.jsx(ns,{className:"mr15",onClick:()=>{var t,e,i,s;let a=(null==(e=null==(t=this.state)?void 0:t.webUrl)?void 0:e.length)>0?null:za;if(this.setState({errMsgImportUrl:a}),null===a)if(5===(null==(i=this.props)?void 0:i.pushType)){let t=this.checkTheExtension(null==(s=this.state.webUrl)?void 0:s.trim());if(!1===t[0]&&!1===t[1])return a="Enter valid URL. Only supports .png, .jpg, .jpeg, .gif, .html",void this.setState((t=>({errContent:{...t.errContent,errBody:a},iFrameValue:""})));!0===t[1]?this.importURL():setTimeout((()=>{this.props.error.errImportUrl=null;let t={...this.state.errContent};t.errBody=null,t.errImportUrl=null,this.setState({errContent:t}),this.props.getBodyContent(this.state.webUrl,this.state.webUrl),this.state.content,this.state.webUrl,this.props.onChange(this.state.webUrl,this.state.webUrl,!1),this.setState({iFrameValue:this.state.webUrl,builderPreview:!0})}),1e3)}else this.importURL();this.setState((t=>({errContent:{...t.errContent,errBody:a}})))},children:"Go"})]})})]}),Ti.jsx("span",{className:"or-divider import-or user-select-none"})]}),Ti.jsx(Zl,{className:(this.state.importFile?"col-md-10 justify-content-start pl30":"col-md-2 justify-content-center cp")+" d-flex align-items-center ",children:Ti.jsxs("div",{className:"w-100 "+(this.state.importFile?"d-flex":"position-relative top15"),children:[Ti.jsxs("div",{className:"d-flex align-items-center flex-column",onClick:()=>{let t={...this.state.importZIPFile};t.fileName="",this.setState({importFile:!0,importZIPFile:t}),this.props.error.errImportUrl=null,this.setState((t=>({errContent:{...t.errContent,errBody:null,errImportUrl:null}}))),this.handleFileWindow()},children:[this.state.fileTypeErr&&Ti.jsx("div",{className:"validation-message left3",children:this.state.fileTypeErr}),Ti.jsx("i",{className:"icon-rs-zip-large icons-lg color-primary-blue cp mb7"}),Ti.jsx("span",{children:"Import ZIP file"})]}),Ti.jsxs("div",{children:[this.state.importFile&&Ti.jsx("div",{className:"upload-lable-text",children:""!==this.state.importZIPFile.fileName&&this.state.importZIPFile.fileName}),Ti.jsx("input",{id:"file",type:"file",className:"sp-input browse-hidden",accept:".zip,.rar",onClick:this.initialize,onChange:this.importZip})]})]})})]})})})})]}),5===(null==(t=this.props)?void 0:t.pushType)&&(null==(e=this.state.iFrameValue)?void 0:e.length)>0?Ti.jsxs(Ti.Fragment,{children:[!0===this.checkTheExtension(this.state.iFrameValue)[1]?Ti.jsx(Ti.Fragment,{children:Ti.jsx($l,{children:Ti.jsx("div",{className:"import-iframe-wrapper",children:Ti.jsx("div",{className:"import-iframe",children:Ti.jsx("iframe",{sandbox:!0,id:"edmFrame",title:"uploadFrame",srcDoc:this.state.iFrameValue+"<style>body{pointer-events: none;margin:0;}</style>",style:{width:"100%",minHeight:"100vh",marginTop:"20px",height:this.state.height},onLoad:()=>{let t=document.getElementById("edmFrame");var e=t.contentDocument||t.contentWindow.document,i=Math.min(e.body.scrollHeight,e.documentElement.scrollHeight,e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight);this.setState({height:i})},onError:()=>{}})})})})}):Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:8,offset:2},children:Ti.jsx($l,{className:"d-flex justify-content-center box-design padding0 overflow-hidden",children:Ti.jsx("img",{src:this.state.webUrl,alt:""})})})}),(this.checkTheExtension(this.state.iFrameValue)[0],Ti.jsx(this.InterActivityComponent,{}))]}):null,5!==(null==(i=this.props)?void 0:i.pushType)&&this.state.iFrameValue&&Ti.jsx($l,{children:Ti.jsx("div",{className:"import-iframe-wrapper",children:Ti.jsx("div",{className:"import-iframe",children:Ti.jsx("iframe",{sandbox:!0,id:"edmFrame",title:"uploadFrame",srcDoc:this.state.iFrameValue+"<style>body{pointer-events: none;margin:0;}</style>",style:{width:"100%",minHeight:"100vh",marginTop:"20px",height:this.state.height},onLoad:()=>{let t=document.getElementById("edmFrame");var e=t.contentDocument||t.contentWindow.document,i=Math.min(e.body.scrollHeight,e.documentElement.scrollHeight,e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight);this.setState({height:i})},onError:()=>{}})})})}),5===(null==(s=this.props)?void 0:s.pushType)?null:Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs(Ti.Fragment,{children:[!0===this.props.isCarousel&&0===this.props.index&&Ti.jsx(this.MakeasAlertComponent,{}),!1===this.props.isCarousel&&Ti.jsx(this.MakeasAlertComponent,{})]}),!1===this.props.isCarousel&&Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"#Hashtags"})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs("div",{className:"chips-input-container",children:[Ti.jsx(Fl,{label:"Hashtags",noDropdown:!0,data:this.state.content.hashTag,value:this.state.content.hashTag,allowCustom:!0,onChange:t=>{if(t.target.value.length>5)return;let e=$a(t),i={...this.state.content};i.hashTag=e,this.setState({content:i}),this.props.onChange(i)}}),Ti.jsx("small",{class:`rs-form-small-text fs12 d-inline-block text-end w-100 ${5===(null==(a=this.state.hashTags)?void 0:a.length)&&"red"}`,children:`${5===(null==(n=this.state.hashTags)?void 0:n.length)?Ha:""}  ${(null==(l=this.state.hashTags)?void 0:l.length)>0?this.getHashTagUpdation():" 0 / 5"}`})]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Ua,size:"md",pophover:"View analytics for trending topics"})})})})]})}),Ti.jsx(this.InterActivityComponent,{}),!1===this.props.isCarousel&&Ti.jsx(bc,{content:this.state.content,error:this.state.errContent,onChange:t=>{this.props.error.errExpiryType=null!==t.expiryType?null:ya,this.props.error.errExpiryValue=null!==t.expiryType&&t.expiryValue.length>0?null:ga;let e={...this.state.errContent};e.expiryType=null,e.errExpireValue=null,this.setState({errContent:e});let i={...this.state.content};i.isExpiry=t.isExpiry,i.expiryType=t.expiryType,i.expiryValue=t.expiryValue,this.setState({content:i}),this.props.onChange(i)}}),!1===this.props.isCarousel&&"mobile"===this.props.type&&Ti.jsx(fc,{content:this.state.content,error:this.state.errContent,onChange:t=>{this.props.error.errAlertSound=t.length>0?null:ya;let e={...this.state.errContent};e.errAlertSound=null,this.setState({errContent:e});let i={...this.state.content};i.isAlertSound=t.isAlertSound,i.alertSound=t.alertSound,this.setState({content:i}),this.props.onChange(i),this.forceUpdate()}}),!0===this.state.titleEmoji?Ti.jsx(oc,{anchor:this.titleanochor,show:this.state.titleEmoji,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:t=>{if(this.state.content.title.length<=58){let e=t.length>0?null:Ra,i={key:"title",value:ca(this.state.content.title,t,this.state.content.titlePos)},s={key:"errTitle",value:e};return this.contentUpdate(i,s),void this.props.onChange(this.state.content)}}}):null,!0===this.state.shortDescEmoji?Ti.jsx(oc,{anchor:this.subTitleEmojiAnochor,show:this.state.shortDescEmoji,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:t=>{if(this.state.content.shortDesc.length<=58){this.state.content;let e=t.length>0?null:Va,i={key:"shortDesc",value:ca(this.state.content.shortDesc,t,this.state.content.shortDescPos)},s={key:"errShortDesc",value:e};this.contentUpdate(i,s),this.props.onChange(this.state.content)}}}):null]}),!0===this.state.isOpenCustomButtonModal?Ti.jsx(kc,{isOpen:this.state.isOpenCustomButtonModal,isWeb:"web"===this.props.type,smartAppStore:this.props.smartAppStore,selectInterActivity:this.state.content.interActivity[this.state.currentIndex],onChangeIsOpen:t=>{this.setState({isOpenCustomButtonModal:t})},onSaveClick:t=>{var e;0===this.state.currentIndex?(this.setState((t=>({errContent:{...t.errContent,errInterActivity1:null}}))),this.props.error.errInterActivity1=null):(this.setState((t=>({errContent:{...t.errContent,errInterActivity2:null}}))),this.props.error.errInterActivity2=null);let i={...this.state.content};i.interActivity[this.state.currentIndex].actionName=t.actionName,i.interActivity[this.state.currentIndex].actionType=t.actionType,i.interActivity[this.state.currentIndex].displayName=t.actionName,i.interActivity[this.state.currentIndex].url=t.url,i.interActivity[this.state.currentIndex].clickBehavourValue=t.clickBehavourValue,i.interActivity[this.state.currentIndex].countryCode=t.countryCode,this.setState({content:i}),5===(null==(e=this.props)?void 0:e.pushType)?this.props.onChange(this.state.webUrl,this.state.iFrameValue,!1,i.interActivity):this.props.onChange(i)}}):null]})}}ji(Dc,"contextType",Ji);class Ac extends Di.Component{constructor(){super(...arguments),ji(this,"state",{brandId:(null==(Z=null==(J=this.props)?void 0:J.state)?void 0:Z.brandId)||"",previewErr:(null==(Y=null==(K=this.props)?void 0:K.state)?void 0:Y.previewErr)||null,clkofSend:(null==(Q=null==(X=this.props)?void 0:X.state)?void 0:Q.clkofSend)||!0,valAudPopUp:(null==(et=null==(tt=this.props)?void 0:tt.state)?void 0:et.valAudPopUp)||!1,sendBtnClick:(null==(st=null==(it=this.props)?void 0:it.state)?void 0:st.sendBtnClick)||!1,iconLoader:(null==(nt=null==(at=this.props)?void 0:at.state)?void 0:nt.iconLoader)||!1,status:null==(lt=this.props)?void 0:lt.status,isRFA:!1,isModalOpen:!1,approvalSettings:{approvalMatchType:"All",approvalMatchCount:0,isFollowHierarchyEnabled:!1},backupData:{matchType:"All",anyCount:0,followHierarchyChecked:!1},approverList:[],approvalList:[]}),ji(this,"componentDidMount",(()=>{var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S;if(null!==(null==(i=null==(e=null==(t=this.props)?void 0:t.notificationData)?void 0:e.push)?void 0:i.objectRequestApproval)&&void 0!==(null==(n=null==(a=null==(s=this.props)?void 0:s.notificationData)?void 0:a.push)?void 0:n.objectRequestApproval)){this.setState({approvalList:null==(c=null==(r=null==(o=null==(l=this.props)?void 0:l.notificationData)?void 0:o.push)?void 0:r.objectRequestApproval)?void 0:c.rfaList});let t={approvalMatchType:null==(u=null==(h=null==(p=null==(d=this.props)?void 0:d.notificationData)?void 0:p.push)?void 0:h.objectRequestApproval)?void 0:u.approvalFrom,approvalMatchCount:null==(g=null==(y=null==(v=null==(m=this.props)?void 0:m.notificationData)?void 0:v.push)?void 0:y.objectRequestApproval)?void 0:g.noOfApprovers,isFollowHierarchyEnabled:null==(S=null==(x=null==(f=null==(b=this.props)?void 0:b.notificationData)?void 0:f.push)?void 0:x.objectRequestApproval)?void 0:S.isFollowHierarchy};this.setState({approvalSettings:t,isRFA:!0})}this.getApproverList()})),ji(this,"componentDidUpdate",(t=>{var e,i,s;(null==(e=this.props)?void 0:e.status)!==(null==t?void 0:t.status)&&null!==(null==(i=this.props)?void 0:i.status)&&(this.setState({status:null==(s=this.props)?void 0:s.status}),this.setState({sendBtnClick:!0,valAudPopUp:!0},(()=>{setTimeout((()=>{this.setState({valAudPopUp:!1})}),2e3)})))})),ji(this,"sendButtonClicked",(()=>{""===this.state.brandId.toLowerCase()||this.state.brandId.toLowerCase().includes("enter")?this.setState({previewErr:"Enter brand id",clkofSend:!0}):(this.setState({status:null}),this.props.sendTestPreview(this.state.brandId))})),ji(this,"dbData",fs()),ji(this,"validateAudience",((t,e)=>{var i,s,a,n,l;let o={toEmail:t,channel:"web push"===(null==(i=this.props)?void 0:i.channel.toLowerCase())?"WN":"mobile push"===(null==(s=this.props)?void 0:s.channel.toLowerCase())?"MP":"",Dbname:null==(n=null==(a=this.dbData)?void 0:a.clientDetailsLocalization)?void 0:n.instanceName,Uid:null==(l=this.dbData)?void 0:l.userId};this.setState({iconLoader:!0}),os({path:Wa,isCache:!1,params:o,loading:this.context.globalStateData.setIsLoadingData,ok:i=>{""!==t&&null!=t?(this.setState({iconLoader:!1}),!1===i.data?(this.setState({previewErr:_a}),this.setState({valAudPopUp:!0,resData:!1},(()=>{setTimeout((()=>{this.setState({valAudPopUp:!1})}),2e3)})),e(!1)):(this.setState({previewErr:""}),this.setState({valAudPopUp:!0,resData:!0},(()=>{setTimeout((()=>{this.setState({valAudPopUp:!1})}),2e3)})),e(!0))):e(!1)},fail:t=>{this.setState({iconLoader:!1})}})})),ji(this,"getApproverList",(()=>{let t={dbName:"cust_c4363a53_4d19_4eb9_b83e_d3ba1f1f9f1e",departmentId:0,clientId:Ja()};this.setState({approverList:[]}),os({path:Za,params:t,isServiceWorker:!1,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e;(null==(e=null==t?void 0:t.data)?void 0:e.length)>0?this.setState({approverList:t.data}):this.setState({approverList:[]})},fail:t=>{this.setState({approverList:[]})}})})),ji(this,"PerviewStatusComponent",(()=>Ti.jsx(Jl,{md:12,children:this.state.resData?Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ka,size:"d font-xlg",color:"green",mainClass:""}),!0===this.state.sendBtnClick&&Ti.jsx("label",{style:{marginTop:10},children:"Test communication will be sent shortly."}),!1===this.state.sendBtnClick&&Ti.jsx("label",{style:{marginTop:10},children:"Valid audience"})]}):Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ya,size:"d font-xlg",color:"red",mainClass:""}),Ti.jsx("label",{style:{marginTop:10},children:"Invalid audience."})]})}))),ji(this,"PerviewStatusComponent1",(()=>{var t,e,i;return Ti.jsx(Jl,{md:12,children:this.state.resData?Ti.jsx("div",{className:"d-flex",children:!0===this.state.sendBtnClick&&Ti.jsxs("div",{className:"rs-form-small-text mt7 "+((null==(e=null==(t=this.state)?void 0:t.status)?void 0:e.toLowerCase().includes("please"))?"red":"green"),children:[Ti.jsx("i",{className:"position-relative top4"})," ",null==(i=this.state)?void 0:i.status]})}):Ti.jsx("div",{className:"d-flex flex-column"})})})),ji(this,"createApproverObject",(()=>{let t=[...this.state.approvalList];t.push({approvalEmailSentTo:"",approvalSentTo:0,email:"",isMandatory:!1,priority:1,approvalSentcount:0,isRequestApproval:!0,errorMessage:null}),this.setState({approvalList:t},(()=>{let e=this.prepareRFAValues();this.props.approverCreated(t),this.props.prepareData(e)}))})),ji(this,"TestPreviewElement",(()=>Ti.jsx("div",{children:Ti.jsx(Fl,{style:{borderBottom:1,borderBottomColor:"#999",borderBottomStyle:"solid"},noinput:!0,errorMessage:this.state.previewErr,label:"Brand id",data:[],value:""!==this.state.brandId?Xa(this.state.brandId):null,allowCustom:!0,onChange:t=>{const e=t.target.value.toString(),i=Xa(this.state.brandId),s=e.split(",").map((t=>t.trim())).find((t=>!i.includes(t)));s&&t.target.value.length<=5?this.validateAudience(s,(t=>{if(t){let t=[...i,s];t=Array.from(new Set(t)),this.setState({brandId:t.join(","),clkofSend:!1})}else this.setState({previewErr:`${s} is invalid.`}),setTimeout((()=>{this.setState({previewErr:""})}),2e3)})):!s&&t.target.value.length<=5?this.setState({brandId:e}):(this.setState({previewErr:"Maximum of 5 email IDs are allowed"}),setTimeout((()=>{this.setState({previewErr:""})}),2e3))},onFilterChange:t=>{}})}))),ji(this,"getData",(()=>{var t,e,i,s,a=[];return(null==(e=null==(t=this.state)?void 0:t.approverList)?void 0:e.length)>0&&(null==(s=null==(i=this.state)?void 0:i.approverList)||s.map((t=>{var e;let i=null==(e=this.state.approvalList)?void 0:e.filter((e=>e.email===t.email));0===(null==i?void 0:i.length)&&(t.type="select",a.push(t))}))),null==a||a.push({email:"Enter new email here",userid:0,type:"input"}),a})),ji(this,"onEmailChange",((t,e,i="onchange")=>{let s=t.target.value.length>0?null:Qa;"onblur"===i&&t.target.value.length>0&&(s=this.isValidEmail(t.target.value)?null:"Enter valid email");let a=[...this.state.approvalList];a[e].errorMessage=s,a[e].email=Ls(t.target.value),a[e].approvalEmailSentTo=t.target.value,this.setState({approvalList:a},(()=>{if("onblur"===i){let t=this.prepareRFAValues();this.props.approverCreated(a),this.props.prepareData(t)}}))})),ji(this,"RequestForApprovalElement",(()=>{var t,e;return Ti.jsx(Ti.Fragment,{children:(null==(t=this.state.approverList)?void 0:t.length)>0&&(null==(e=this.state.approvalList)?void 0:e.length)>0&&this.state.approvalList.map(((t,e)=>{var i,s;const a=this.state.approvalList.length-1;return Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsxs(Zl,{md:10,children:["input"===(null==(i=null==t?void 0:t.type)?void 0:i.toLowerCase())?Ti.jsx(ql,{placeholder:"Approver email",type:"email",required:!0,value:t.email,iconPlaceholder:!0,iconName:ba,iconColor:"red",iconSize:"sm",errorMessage:t.errorMessage,onChange:t=>{this.onEmailChange(t,e)},onBlur:t=>{this.onEmailChange(t,e,"onblur")},iconOnClick:()=>{let t=[...this.state.approvalList];t[e].errorMessage=Qa,t[e].email="",t[e].approvalEmailSentTo="",t[e].type="select",this.setState({approvalList:t})}}):Ti.jsx(Ul,{required:!0,id:`cam_approver_value${e+1}`,label:`Approver ${e+1}`,errorMessage:t.errorMessage,data:this.getData(),textField:"email",dataItemKey:"userid",value:t,onChange:t=>{let i=t.target.value.email.length>0?null:Qa,s=[...this.state.approvalList];s[e].errorMessage=i,s[e].email=t.target.value.email,s[e].approvalEmailSentTo=t.target.value.email,s[e].approvalSentTo=t.target.value.userId,s[e].emailVerfication="input"!==t.target.value.type,s[e].type=t.target.value.type,this.setState({approvalList:s},(()=>{let t=this.prepareRFAValues();this.props.approverCreated(s),this.props.prepareData(t)}))}}),a===e?Ti.jsx(Jl,{children:Ti.jsx(Zl,{children:Ti.jsx(Mo,{className:"position-absolute z-50 right10 "+(1===(null==(s=this.state.approvalList)?void 0:s.length)?"click-off d-none":""),children:Ti.jsx(Xi,{alignRight:!0,children:Ti.jsx(Qi,{tooltip:"Approval settings",icon:"icon-rs-settings-medium",id:"dl_approver_settings",onClick:()=>{let t=!1,e=[...this.state.approvalList];e.map(((e,i)=>{if(!1===t&&(ss(e.email)||e.email.toLowerCase().includes("select")))return e.errorMessage=Qa,void(t=!0)})),!1===t&&this.setState({isModalOpen:!this.state.isModalOpen}),this.setState({approvalList:e})}})})})})}):null]}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[Ti.jsx(Qi,{id:0===e?"dl_approver_add":"dl_approver_remove",tooltip:0===e?"Add":"Remove",icon:"icons-md color-primary-blue cursor-pointer d-block "+(0===e?this.state.approverList.length===this.state.approvalList.length?"icon-rs-circle-plus-fill-edge-medium":this.state.approvalList.length<3?"icon-rs-circle-plus-fill-edge-medium ":"icon-rs-circle-plus-fill-edge-medium click-off ":"icon-rs-circle-minus-fill-edge-medium red"),onClick:()=>{if(0===e&&this.state.approvalList.length<3){let t=!0,e=[...this.state.approvalList];e.forEach((e=>{if(ss(e.email)||e.email.toLowerCase().includes("select"))return t=!1,e.errorMessage=Qa,void this.forceUpdate();e.errorMessage="",t=!0})),t?this.createApproverObject():this.setState({approvalList:e})}else{let e=[...this.state.approvalList];var i=e.indexOf(t);e.splice(i,1),e.map((t=>{t.isMandatory=!1})),this.setState({matchType:"All"}),this.setState({approvalList:e},(()=>{let t=this.prepareRFAValues();this.props.approverCreated(e),this.props.prepareData(t)}))}}}),1!==this.state.approvalSettings.approvalMatchCount&&""!==this.state.approvalSettings.approvalMatchType&&3===this.state.approvalList.length&&"all"!==this.state.approvalSettings.approvalMatchType.toLowerCase()&&Ti.jsx(Qi,{mainClass:"mt5",id:"dl_approver_mandadory",tooltip:"Set mandatory",color:t.isMandatory?"color-primary-red":"mand-field",icon:t.isMandatory?"icon-rs-asterisk-mini red mand-field cursor-pointer":"icon-rs-asterisk-mini mand-field cursor-pointer",size:"sm",onClick:()=>{if(t.isMandatory){t.isMandatory=!t.isMandatory;let i=[...this.state.approvalList];i[e].isMandatory=t.isMandatory,this.setState({approvalList:i})}else if(this.state.approvalList.length>this.state.approvalSettings.approvalMatchCount&&this.state.approvalList.filter((t=>!0===t.isMandatory)).length<this.state.approvalList.length-2){t.isMandatory=!t.isMandatory;let i=[...this.state.approvalList];i[e].isMandatory=t.isMandatory,this.setState({approvalList:i})}}}),Ti.jsx(Qi,{tooltip:"Reset",id:"dl_approver_reset",icon:("-- Select approver --"===this.state.approvalList[0].email||0!==e?"d-none":"on")+" icon-rs-refresh-medium icons-md color-primary-blue d-none",onClick:()=>{this.createApproverObject()}})]})})})]},e)})}))})})),ji(this,"RFASettings",(()=>Ti.jsx(Ti.Fragment,{children:!0===this.state.isModalOpen&&Ti.jsxs(_l,{onHide:()=>{this.setState({isModalOpen:!this.state.isModalOpen})},show:this.state.isModalOpen,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Request approval settings"}),Ti.jsx(zl,{id:"dl_approver_close_button",mainClass:"close",size:"md",handleClose:()=>{this.setState({isModalOpen:!this.state.isModalOpen})}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx($l,{className:"mt20",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Get approval from"})}),Ti.jsx(Zl,{md:9,children:Ti.jsxs(wo,{children:[Ti.jsx("li",{children:Ti.jsx(Rl,{lbl:"All",id:"dl_approver_settings_all",name:"rmatchtype",labelId:"dl_approver_settings_all",checked:"all"===this.state.approvalSettings.approvalMatchType.toLowerCase(),handleChange:t=>{let e={...this.state.approvalSettings};e.approvalMatchType=t.target.value,e.approvalMatchCount=0,this.setState({approvalSettings:e});let i=[...this.state.approvalList];i.map((t=>{t.isMandatory=!1})),this.setState({approvalList:i})}})}),Ti.jsx("li",{className:"pl15",children:Ti.jsx(Rl,{lbl:"Any",name:"rmatchtype",labelId:"dl_approver_settings_any",id:"dl_approver_settings_any",checked:"any"===this.state.approvalSettings.approvalMatchType.toLowerCase(),handleChange:t=>{let e={...this.state.approvalSettings};e.approvalMatchType=t.target.value,e.approvalMatchCount=1,e.isFollowHierarchyEnabled=!1,this.setState({approvalSettings:e});let i=[...this.state.approvalList];i.map((t=>{t.isMandatory=!1})),this.setState({approvalList:i})}})}),"any"===this.state.approvalSettings.approvalMatchType.toLowerCase()?Ti.jsx("li",{className:"pl15",children:Ti.jsx(Ul,{required:!0,label:"Any count",id:"dl_approver_settings_anycount",data:2===this.state.approvalList.length?[1]:3===this.state.approvalList.length?[1,2]:[],value:this.state.approvalSettings.approvalMatchCount,customAlignRight:!0,className:"mb0 match-type-input",onChange:t=>{let e={...this.state.approvalSettings};e.approvalMatchCount=t.target.value,this.setState({approvalSettings:e});let i=[...this.state.approvalList];i.map((t=>{t.isMandatory=!1})),this.setState({approvalList:i})}})}):null]})}),Ti.jsx(Zl,{md:3})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{className:1===this.state.approvalList.length||"all"===this.state.approvalSettings.approvalMatchType.toLowerCase()?"click-on":"",children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Follow hierarchy"})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(qo,{className:"mt9 "+("any"===this.state.approvalSettings.approvalMatchType.toLowerCase()?"click-off":""),id:"dl_approver_hierarchy",onChange:()=>{let t={...this.state.approvalSettings};t.isFollowHierarchyEnabled=!t.isFollowHierarchyEnabled,!0===t.isFollowHierarchyEnabled&&(t.approvalMatchType="All",t.approvalMatchCount=0),this.setState({approvalSettings:t})},checked:this.state.approvalSettings.isFollowHierarchyEnabled})})]})})]}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{id:"dl_approver_cancel_button",onClick:()=>{let t={approvalMatchType:this.state.backupData.matchType,approvalMatchCount:this.state.backupData.anyCount,isFollowHierarchyEnabled:this.state.backupData.followHierarchyChecked};this.setState({approvalSettings:t}),this.setState({isModalOpen:!this.state.isModalOpen})},children:"Cancel"}),Ti.jsx(ns,{id:"dl_approver_save_button",onClick:()=>{let t={matchType:this.state.approvalSettings.approvalMatchType,anyCount:this.state.approvalSettings.approvalMatchCount,followHierarchyChecked:this.state.approvalSettings.isFollowHierarchyEnabled};this.setState({isModalOpen:!this.state.isModalOpen,backupData:t})},children:"Save"})]})]})}))),ji(this,"prepareRFAValues",(()=>{var t,e;let i={approvalFrom:this.state.approvalSettings.approvalMatchType,noOfApprovers:"all"===this.state.approvalSettings.approvalMatchType.toLowerCase()?this.state.approvalList.length:this.state.approvalSettings.approvalMatchCount,isFollowHierarchy:this.state.approvalSettings.isFollowHierarchyEnabled,channelType:(null==(e=null==(t=this.props)?void 0:t.channel)?void 0:e.includes("mobile"))?14:8,approverCount:"all"===this.state.approvalSettings.approvalMatchType.toLowerCase()?this.state.approvalList.length:this.state.approvalSettings.approvalMatchCount,rfaList:[]},s=[];return this.state.approvalList.map(((t,e)=>{let i={approvalSentTo:t.userId,approvalEmailSentTo:t.email,email:t.email,isMandatory:t.isMandatory,priority:e+1,approvalSentcount:this.state.approvalList.length,isRequestApproval:!0};s.push(i)})),i.rfaList=s,i})),ji(this,"RequestForApprovalCheckbox",(()=>Ti.jsx(Jl,{children:Ti.jsx(Vl,{lbl:"Request for approval",checked:this.state.isRFA,errorMessage:this.state.errRFA,iconPlaceholder:!0,iconName:"icon-rs-circle-question-mark-medium",iconPopover:"Get the notification approved by the concerned person",handleChange:t=>{this.setState({isRFA:t.target.checked}),this.props.isRequestApproval(t.target.checked),t.target.checked?this.createApproverObject():this.setState({approvalList:[]})}})})))}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}render(){var t,e;return Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(this.RFASettings,{}),Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:!0===this.state.isRFA?"Approval Request":"Send test push to"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsxs(Jl,{className:!0===this.state.isRFA?"mb-40":"",children:[!1===this.state.isRFA?Ti.jsx(this.TestPreviewElement,{}):null,!0===this.state.isRFA?Ti.jsx(this.RequestForApprovalElement,{}):null]}),Ti.jsx(this.RequestForApprovalCheckbox,{})]}),Ti.jsx(Zl,{md:3,className:!1===this.state.isRFA?this.state.clkofSend?"click-off raja":"":(null==(e=null==(t=this.state)?void 0:t.approvalList)?void 0:e.filter((t=>{var e;return null!==t.email&&void 0!==t.email&&(null==(e=t.email)?void 0:e.length)>0})).length)>0?"click-on":"click-off",children:Ti.jsx(ns,{onClick:()=>{if(!0===this.state.isRFA){let t=this.prepareRFAValues();this.props.sendRFA(t)}else this.sendButtonClicked()},children:"Send"})})]}),this.state.valAudPopUp&&Ti.jsx(Zl,{md:{span:10,offset:2},children:Ti.jsx(this.PerviewStatusComponent1,{})})]})})}}ji(Ac,"contextType",Ji);class wc extends Di.Component{constructor(t){super(t),ji(this,"state",{isModalOpen:null==(ot=this.props)?void 0:ot.isOpen,timerFG:(null==(ct=null==(rt=this.props)?void 0:rt.notificationData)?void 0:ct.mobTimerTextColor)||"#000000",timerBG:(null==(pt=null==(dt=this.props)?void 0:dt.notificationData)?void 0:pt.mobTimerBgColor)||"#ffffff",timerColorAnhor:1,isTimeColorView:"",isShow:!1,cminDate:new Date,timerDate:null!==(null==(ut=null==(ht=this.props)?void 0:ht.notificationData)?void 0:ut.mobTimerTTLLocalTime)&&void 0!==(null==(vt=null==(mt=this.props)?void 0:mt.notificationData)?void 0:vt.mobTimerTTLLocalTime)&&""!==(null==(gt=null==(yt=this.props)?void 0:yt.notificationData)?void 0:gt.mobTimerTTLLocalTime)?new Date(null==(ft=null==(bt=this.props)?void 0:bt.notificationData)?void 0:ft.mobTimerTTLLocalTime):"",timerErrBool:!1,timeFromChild:"",bgColorFromChild:"",textColorFromChild:"",devTimer:"",timerTtl:"",errTimer:null}),ji(this,"handleClickOutside",(t=>{this.colorPickerRef.current&&!this.colorPickerRef.current.contains(t.target)&&this.setState({isShow:!1})})),ji(this,"ColorPicker",(t=>Ti.jsx(Ti.Fragment,{children:!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,className:"position-relative",children:Ti.jsx(Oo,{className:"top0",anchor:t.anchor,show:this.state.isShow,selectColor:this.props.color,cancelBtnClicked:()=>{this.setState({isShow:!1}),this.props.cancelBtnClicked()},applyBtnClicked:e=>{this.setState({isShow:!1});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);t.callBack(l)}})}):null}))),ji(this,"RRDateTimePicker",(()=>{const{timerFG:t,timerBG:e,timerColorAnhor:i,isTimeColorView:s,isShow:a,cminDate:n,timerDate:l}=this.state;return Ti.jsx($l,{children:Ti.jsx(Zl,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:2,children:Ti.jsx(Ao,{label:"Select timer",right:!0})}),Ti.jsxs(Zl,{md:7,children:[Ti.jsx(Jl,{children:Ti.jsx("div",{className:"rsptimer-picker",children:Ti.jsxs("div",{className:"position-relative",children:[null!==this.state.errTimer&&Ti.jsx("div",{className:"validation-message",style:{marginTop:-20},children:this.state.errTimer}),Ti.jsx(_i,{name:"schedulerName",placeholder:"Select schedule date and time",errorMessage:"Rajaram",value:null!==l&&""!==l?new Date(l):"",min:n,toggleButton:Ol,onChange:t=>{if(this.setState({errTimer:null}),(t.target.value-new Date)/36e5<4)this.setState({timerErrBool:!0,timerDate:"",timerBG:"",timerFG:""});else{this.setState({timerErrBool:!1});let e=ao(t.target.value).format("yyyy-MM-DD HH:mm:ss"),i=t.target.value.toISOString().slice(0,19).replace("T"," ");this.setState({timerDate:t.target.value});let s=this.calculateTwoTimes(t.target.value);this.props.callBack("offerString",s),this.props.callBack("mobTimerTTL",i),this.props.callBack("mobTimerTTLLocalTime",e)}}})]})})}),Ti.jsxs(Jl,{style:{display:"flex",justifyContent:"end"},children:[Ti.jsxs(Zl,{md:1,children:[Ti.jsx(ws,{text:"Timer text color",position:"top",children:Ti.jsx("div",{className:"editor-ico",ref:this.timerFGRef,onClick:()=>{this.setState({isShow:!0,isTimeColorView:!0,timerColorAnhor:1})},children:Ti.jsx("div",{className:"picker-in picker-text",children:Ti.jsx("span",{style:{backgroundColor:`${t}`}})})})}),1===i&&!0===this.state.isTimeColorView?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(this.ColorPicker,{anchor:this.timerFGRef,color:t,cancelBtnClicked:()=>{this.setState({isShow:!1,isTimeColorView:!1,timerColorAnhor:0})},callBack:t=>{this.props.callBack("mobTimerTextColor",t),this.setState({isShow:!1,isTimeColorView:!1,timerColorAnhor:0,timerFG:t})}})}):null]}),Ti.jsxs(Zl,{md:1,className:"ml-25",children:[Ti.jsx(ws,{text:"Timer background color",position:"top",children:Ti.jsx("div",{className:"editor-ico",ref:this.timerBGRef,onClick:()=>{this.setState({isShow:!0,isTimeColorView:!0,timerColorAnhor:2})},children:Ti.jsx("div",{className:"picker-in picker-icon",children:Ti.jsx("span",{style:{backgroundColor:`${e}`}})})})}),2===i&&!0===this.state.isTimeColorView?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(this.ColorPicker,{anchor:this.timerBGRef,color:e,cancelBtnClicked:()=>{this.setState({isShow:!1,isTimeColorView:!1,timerColorAnhor:0})},callBack:t=>{this.props.callBack("mobTimerBgColor",t),this.setState({isShow:!1,isTimeColorView:!1,timerColorAnhor:0,timerBG:t})}})}):null]})]})]}),Ti.jsx(Zl,{md:3,children:Ti.jsxs(Jl,{children:[this.state.timerErrBool?null:Ti.jsx(Zl,{md:3,className:`${""===l&&"d-none"}`,style:{display:"flex",width:120,justifyContent:"center"},children:Ti.jsx("div",{style:{color:t,backgroundColor:e,display:"flex",alignItems:"center",borderRadius:5,fontWeight:800},children:Ti.jsx("strong",{style:{paddingRight:3,paddingLeft:3},children:this.calculateTwoTimes(l)})})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(ws,{text:"Reset",children:Ti.jsx("i",{className:"icon-rs-restart-medium color-primary-blue icons-md",style:{paddingTop:0,paddingLeft:10},onClick:()=>{this.setState({timerErrBool:!1,timerDate:"",timerBG:"#ffffff",timerFG:"#000000"})}})})})]})})]})})})})),this.timerFGRef=Ni.createRef(),this.timerBGRef=Ni.createRef(),this.colorPickerRef=Ni.createRef()}componentDidMount(){const t=new Date((new Date).getTime()+144e5);this.setState({cminDate:t}),document.removeEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}calculateTwoTimes(t){const e=t-new Date;return this.formatTimeDifference(e)}formatTimeDifference(t){const e=Math.floor(t/1e3),i=Math.floor(e/60),s=Math.floor(i/60);return`${Math.floor(s/24)}:${s%24}:${i%60}:${e%60}`}render(){const{isOpen:t}=this.props;return this.state,Ti.jsxs(_l,{show:t,size:"xl",className:"t90",top:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Timer"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.props.onClose(!1)}})]}),Ti.jsx(_l.Body,{children:Ti.jsxs("div",{children:[Ti.jsx(this.RRDateTimePicker,{}),this.state.timerErrBool&&Ti.jsx(Jl,{children:Ti.jsxs("div",{class:"timer-err-popup",children:[Ti.jsx(Qi,{icon:"icon-rs-alert-large icons-lg orange-large mb7 ml10",nocp:!0,size:"lg",color:"white"}),Ti.jsxs("div",{class:"ml15 mb-17",children:[Ti.jsx("h4",{children:"Not a valid time."}),Ti.jsx("p",{children:"Time difference should be at least 4 hours from current time."})]})]})}),Ti.jsx(Jl,{children:Ti.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[Ti.jsx(as,{onClick:()=>{var t;this.props.callBack("mobTimerTextColor","#000000"),this.props.callBack("mobTimerBgColor","#ffffff"),this.props.callBack("mobTimerTTL",""),this.props.callBack("timerTTL",""),this.props.callBack("devtimer",""),this.props.callBack("mobIsTimerEnabled",!1),null==(t=this.props)||t.onClose(!1)},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{var t;""!==this.state.timerDate?(ao(this.state.timerDate).format("yyyy-MM-DD HH:mm:ss"),this.state.timerDate.toISOString().slice(0,19).replace("T"," "),this.props.callBack("mobTimerTextColor",this.state.timerFG||"#000000"),this.props.callBack("mobTimerBgColor",this.state.timerBG||"#ffffff"),this.props.callBack("mobIsTimerEnabled",!0),null==(t=this.props)||t.onClose(close)):this.setState({errTimer:"Please select a valid time."})},children:"Submit"})]})})]})})]})}}const Nc=t=>{const e=Di.useContext(Ji);return Di.useEffect((()=>{e.globalStateData.setIsLoadingData(!0),document.querySelectorAll('[role="dialog"]')[0]&&document.querySelectorAll('[role="dialog"]')[0].removeAttribute("tabIndex"),setTimeout((()=>{e.globalStateData.setIsLoadingData(!1)}),2e3)}),[]),Ti.jsx(wc,{...t})},Lc=({isOpen:t,onClose:e,initialContent:i,onGenerate:s,type:a="text",mobilepush:n})=>{const[l,o]=Di.useState(i),[r,c]=Di.useState(!1),[d,p]=Di.useState(""),[h,u]=Di.useState(""),m=Di.useContext(Ji);if(!t)return null;return Ti.jsxs(_l,{show:t,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Genie"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>e()})]}),Ti.jsx(_l.Body,{children:Ti.jsxs("div",{style:{marginBottom:"1rem"},children:[Ti.jsxs(Jl,{children:[Ti.jsxs(Zl,{md:10,children:[d&&Ti.jsx("p",{style:{fontSize:"0.875rem",color:"#EF4444"},children:d}),Ti.jsx("textarea",{value:l,onChange:t=>o(t.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"4px",height:"4rem",border:"1px solid #D1D5DB",resize:"none"},placeholder:"Describe the content you want to generate..."})]}),Ti.jsx(Zl,{md:2,children:Ti.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1.75rem",paddingLeft:122},children:Ti.jsx(ns,{onClick:async()=>{var t;if(!l.trim())return void p("Please enter a prompt");c(!0),p(""),u("");let e=l,i="https://api.openai.com/v1/chat/completions";"text"===a&&(e+=" Only 350 characters"),"image"===a&&(i="https://api.openai.com/v1/images/generations");let s={model:"gpt-4",messages:[{role:"system",content:"You are a professional copywriter. Generate engaging and effective content based on the user's prompt. Return only the generated content without any additional formatting or explanation."},{role:"user",content:e}],temperature:.7,max_tokens:500};"image"===a&&(s={prompt:e,n:1,size:"512x512",quality:"hd",style:"natural"});try{const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${{}.VITE_OPENAI_API_KEY}`},body:JSON.stringify(s)});if(!e.ok)throw new Error("Failed to generate content");if("text"===a){const t=(await e.json()).choices[0].message.content.trim();u(t)}else if("image"===a){const i=await e.json();i.data&&(null==(t=i.data[0])?void 0:t.url)?u(i.data[0].url):p("Failed to generate image")}}catch(n){p("Failed to generate content")}finally{c(!1)}},disabled:r,style:{padding:"0.5rem 1rem",color:"white",borderRadius:"4px",cursor:r?"not-allowed":"pointer",opacity:r?.5:1,display:"flex",alignItems:"center"},children:r?Ti.jsx("span",{style:{animation:"spin 1s linear infinite",marginRight:"0.5rem"},children:""}):Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("span",{style:{marginRight:"0.5rem"},children:""}),"Generate"]})})})})]}),""!==h&&Ti.jsx(Jl,{children:Ti.jsxs(Zl,{md:10,className:"d-flex justify-content-center align-items-center",children:["text"===a&&Ti.jsx("textarea",{value:h,disabled:!0,style:{width:"100%",padding:"0.5rem",borderRadius:"4px",height:"8rem",border:"1px solid #D1D5DB",resize:"none"},placeholder:"Describe the content you want to generate..."}),"image"===a&&Ti.jsx("img",{style:{width:300,height:300},src:h,alt:"Generated Image"})]})})]})}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(zs,{onClick:e,children:"Cancel"}),Ti.jsx(ns,{className:""===h?"click-off":"click-on",onClick:()=>{"text"===a?(s(h),e()):"image"===a&&(async t=>{try{const e=await fetch(t),i=await e.blob();return new Promise(((t,e)=>{const s=new FileReader;s.onloadend=()=>t(s.result),s.onerror=e,s.readAsDataURL(i)}))}catch(e){}})(h).then((t=>{((t,e)=>{let i=na;n&&(i=la),os({path:i,loading:m.globalStateData.setIsLoadingData,isCache:!1,params:{file:t},ok:t=>{t.status&&null!==t.data&&void 0!==t.data?e(t.data):e(null)},fail:t=>{e(null)}})})(t,(t=>{alert(t)}))}))},children:"Save"})]})]})},Ec=ua;class Bc extends Di.Component{constructor(t){super(t),ji(this,"state",{personalizeTabData:(null==(xt=this.props)?void 0:xt.personalizeTabData)||[],bodyContent:(null==(St=this.props)?void 0:St.bodyContent)||"",richBodyContent:(null==(Ct=this.props)?void 0:Ct.bodyContent)||"",bodyContentPosition:(null==(jt=this.props)?void 0:jt.bodyContentPosition)||0,url:(null==(It=null==(Tt=this.props)?void 0:Tt.notificationData)?void 0:It.url)||"",isImagePickerModal:!1,isTimer:!1,isEmoji:!1,isTimerColorView:!1,timerColorAnhor:0,timerTTL:"",timerFG:"",timerBG:"",fontColor:"",backgroundColor:"",colorAnhor:0,isShow:!1,imagePickerModal:!1,selectIndex:0,emojiIndex:0,isPreview:!1,timerMinDate:tn(new Date(ao(this.props.campaignPlan.startDate).add(0,"day").toString()),15),timerMaxDate:en(new Date(ao(this.props.campaignPlan.endDate).add(0,"day").toString())),isBold:!1,update:!1,textCount:0,isAIModal:!1,generateImage:!1}),ji(this,"componentDidMount",(()=>{const t=document.querySelector(".k-editor-content");t&&(t.style.color="orange"),setTimeout((()=>{var t,e,i,s,a,n,l,o;if((null==(t=this.editorRef)?void 0:t.current)&&(null==(i=null==(e=this.props)?void 0:e.bodyContent)?void 0:i.length)>0&&null!==(null==(a=null==(s=this.editorRef)?void 0:s.current)?void 0:a.view)&&void 0!==(null==(l=null==(n=this.editorRef)?void 0:n.current)?void 0:l.view)){const t=this.editorRef.current.view;Lo.setHtml(t,(null==(o=this.props)?void 0:o.bodyContent)||"")}}),3e3),document.addEventListener("mousedown",this.handleClickOutside)})),ji(this,"handleClickOutside",(t=>{this.colorPickerRef.current&&!this.colorPickerRef.current.contains(t.target)&&this.setState({isShow:!1})})),ji(this,"setColorForFirstTag",((t,e)=>{const i=document.createElement("div");i.innerHTML=t;const s=i.firstChild;return s&&1===s.nodeType&&s.setAttribute("style",`color: ${e};`),i.innerHTML})),ji(this,"componentDidUpdate",(t=>{t!==this.props&&""!==this.props.notificationData.bodyTextColor&&this.setColorForFirstTag(this.state.bodyContent,this.props.notificationData.bodyTextColor)})),ji(this,"countBrackets",(t=>{let e=t.trim(),i=0;for(let s=0;s<e.length;s++){const t=e[s];("["===t||"]"===t)&&i++}return i})),ji(this,"getLengthCheck",(t=>{let e="";for(let a=0;a<t.length;a++){const i=t[a];" "!==i&&(e+=i)}let i=0,s=!1;for(let a=0;a<e.length;a++){const t=e[a];"["===t?s=!0:"]"===t?s=!1:s||"|"==t||i++}return i})),ji(this,"handleBodyOnBlur",(t=>{this.state;let e=!0;const i=t.target.value.split("|");for(const s of i){let t=0;for(const i of s)"["===i?t++:"]"===i&&t--,t<0&&(e=!1);0!==t&&(e=!1)}if(e?this.props.callBack("onBlur",t):this.props.callBack("onBlur",t,null,null,"In correct type ",null),this.editorRef.current){const t=this.editorRef.current.view;if(t&&t.state){let e=t.state.selection.$anchor.pos;this.setState({bodyContentPosition:e,emojiIndex:0})}}})),ji(this,"convertPTag",(t=>{if(t=t.replace(/\n/g,""),!/<p[^>]*>/i.test(t))return`<p>${t}</p>`;const e=/<p[^>]*>(<p[^>]*>.*?<\/p>)(.*)/;return e.test(t)?t.replace(e,((t,e,i)=>{const s=/<p([^>]*)>(.*?)<\/p>/.exec(e);return`<p${s[1]}>${s[2]} ${i.trim()}</p>`})):t.replace(/(<p[^>]*>)([^<]*)(<\/p>)([^<]*)/,((t,e,i,s,a)=>`${e}${i.replace(/\s+/g," ").trim()} ${a.replace(/\s+/g," ").trim()}${s}`)).replace(/<\/p>\s*([[^<]*]]\s*\|\s*[[^<]*]]|[[^<]*]])/g,((t,e)=>`${e}</p>`))})),ji(this,"InsertPersonalize",(()=>Ti.jsx("div",{className:"editor-view-container",children:Ti.jsx("div",{className:"editor-ico-body",children:Ti.jsx(Hi,{items:Ec,text:Ti.jsx(ws,{text:"Personalize",position:"top",show:!1,children:Ti.jsx("i",{className:"icon-rs-user-question-mark-edge-medium color-primary-blue icons-md"})}),onItemClick:t=>{const e=t.item.text.replace(/\[\[|\]\]/g,"");var i=`${e} NOTFOUND`;e.includes("NAME")&&(i="CUSTOMER");let s=`[[${e}]] | [[${i}]] `;const a=[];a.push(this.state.bodyContent,s);const n=a.filter((t=>""!==t)).join("");let l=this.countBrackets(n),o=this.convertPTag(n);l<=40&&o?(this.setState({bodyContent:o}),this.props.callBack("bodytext",o,n,null,"do not count",this.state.textCount)):this.props.callBack("bodytext",o,n,null,"Add only 5 personalization",this.state.textCount)}})})}))),ji(this,"RRInsertImage",(t=>{var e,i,s,a;const{view:n}=t,l=n&&n.state.schema.nodes.text;return n&&Lo.canInsert(n.state,l),Ti.jsx(Ti.Fragment,{children:2!==this.props.pushType&&3!==this.props.pushType||2!==(null==(a=null==(s=null==(i=null==(e=this.props)?void 0:e.pushJson)?void 0:i.push)?void 0:s.pushLayout)?void 0:a.pushLayoutId)?Ti.jsxs(Hi,{className:"editor-rs-image-wrap",text:Ti.jsx(Qi,{tooltip:"Image",icon:"icon-rs-image-medium"}),onItemClick:t=>{"Generate image with AI"!==t.item.text?"Upload image"===t.item.text?this.setState({imagePickerModal:!0}):"Remove image"===t.item.text?(this.props.callBack("url",""),this.setState({url:""})):this.setState({imagePickerModal:!this.state.imagePickerModal}):this.setState({generateImage:!0})},children:[Ti.jsx(Gi,{text:"Upload image"}),void 0!==this.state.url&&null!==this.state.url&&""!==this.state.url?Ti.jsx(Gi,{text:"Remove image"}):null]}):null})})),ji(this,"RRTimerIcon",(t=>{const{view:e}=t,i=e&&e.state.schema.nodes.text;return e&&Lo.canInsert(e.state,i),Ti.jsx(Qi,{tooltip:"Add timer",icon:"icon-rs-time-medium",onClick:()=>{this.setState({isTimer:!0})}})})),ji(this,"RRPreviewIcon",(t=>{const{view:e}=t,i=e&&e.state.schema.nodes.text;return e&&Lo.canInsert(e.state,i),Ti.jsx(Qi,{tooltip:"Add timer",icon:"icon-rs-eye-medium",onClick:()=>{this.setState({isAIModal:!0})}})})),ji(this,"RREmojiIcon",(t=>{const{view:e}=t,i=e&&e.state.schema.nodes.text;return e&&Lo.canInsert(e.state,i),Ti.jsx("div",{className:"k-button-md",ref:this.emojiAnchor,children:Ti.jsx(Qi,{tooltip:"Emoji",icon:"icon-rs-circle-smile-medium",onClick:()=>{if(this.editorRef.current){const t=this.editorRef.current.view;if(this.setState({isEmoji:!0}),t&&t.state){let e=t.state.selection.$anchor.pos;this.setState({bodyContentPosition:e+2,emojiIndex:0})}}}})})})),ji(this,"onOpen",(t=>{var e;null==(e=this.emojiRef.current)||e.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.emojiRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isEmoji:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"TAEmojiClick",(t=>{const e=this.editorRef.current.element.children[1].children[0].contentDocument.querySelector("body").ownerDocument.getSelection();if(e.rangeCount>0){const i=e.getRangeAt(0);i.startOffset,this.state.emojiIndex;const s=document.createTextNode(t);i.insertNode(s),i.collapse(!1),e.removeAllRanges(),e.addRange(i),this.setState({emojiIndex:this.state.emojiIndex+2})}})),ji(this,"TAColorClick",((t,e)=>{var i,s,a,n;const l=this.editorRef.current.element.children[1].children[0].contentDocument.querySelector("body"),o=l.ownerDocument.getSelection();if(o.rangeCount>0){const r=o.getRangeAt(0),c=document.createElement("span");if(c.setAttribute("style",`color: ${t};`),c.textContent=e,(null==(s=null==(i=null==o?void 0:o.extentNode)?void 0:i.outerHTML)?void 0:s.length)>0){const t=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,i=(null==(n=null==(a=null==o?void 0:o.focusNode)?void 0:a.outerHTML)?void 0:n.match(t)).reduce(((t,e)=>(e.startsWith("</")?t.closingTags.push(e):t.openingTags.push(e),t)),{openingTags:[],closingTags:[]}),s=(i.openingTags.toString()+e+i.closingTags.toString()).replace(/,/g,"");c.innerHTML=s}r.deleteContents(),r.insertNode(c),r.collapse(!1),o.removeAllRanges(),o.addRange(r);const d=this.editorRef.current.view;Lo.getHtml(d.state);const p=this.removeDivTag(l.innerHTML);Lo.setHtml(d,p)}})),ji(this,"RREmojiComponent",(t=>Ti.jsx(oc,{anchor:this.emojiAnchor,show:this.state.isEmoji,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.emojiRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:t=>{this.TAEmojiClick(t)},emojiClose:()=>{this.setState({isEmoji:!1})}}))),ji(this,"RRTimerComponent",(t=>Ti.jsx(Nc,{isOpen:this.state.isTimer,notificationData:this.props.notificationData,onClose:t=>{this.setState({isTimer:!1})},callBack:(t,e)=>{this.props.timerModal(t,e)}}))),ji(this,"ColorPicker",(t=>Ti.jsx(Ti.Fragment,{children:Ti.jsx(Oo,{anchor:t.anchor,show:this.state.isShow,selectColor:t.color,popupSettings:null==t?void 0:t.popupSettings,cancelBtnClicked:()=>{this.setState({isShow:!1}),t.cancelBtnClicked()},applyBtnClicked:e=>{this.setState({isShow:!1});var i=ha(e);t.callBack(i)}})}))),ji(this,"setColorInRootElement",(t=>{let e=this.setColorForFirstTag(this.state.bodyContent,t);this.state.bodyContent.replace(/<p>(.*?)<\/p>/,`<p style="color:${t}">$1</p>`),this.setState({bodyContent:e},(()=>{if(this.editorRef.current){this.editorRef.current.view,this.props.callBack("bodyTextColor",t,"",this.editorRef);let e=this.state.bodyContent.replace(/<\/?[^>]+(>|$)/g,""),i=this.state.bodyContent;this.props.callBack("bodytext",i,e,this.editorRef)}})),this.setState({isShow:!1,colorAnhor:0,fontColor:t})})),ji(this,"RRFontColorIcon",(t=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"k-button-md",ref:this.fgRef,children:[Ti.jsx(Qi,{tooltip:"Text color",mainClass:"lh0",icon:sn,onClick:()=>{this.setState({colorAnhor:1,isShow:!0})}}),1===this.state.colorAnhor&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(this.ColorPicker,{anchor:this.fgRef,color:this.state.fontColor,cancelBtnClicked:()=>{this.setState({isShow:!1,colorAnhor:0})},callBack:t=>{var e,i,s,a,n,l,o;if(this.editorRef.current){const r=this.editorRef.current.view;if(r&&r.state&&(null==(s=null==(i=null==(e=r.state)?void 0:e.selection)?void 0:i.ranges)?void 0:s.length)>0){let e=null==(n=null==(a=r.state)?void 0:a.selection)?void 0:n.ranges[0].$from.pos,i=null==(o=null==(l=r.state)?void 0:l.selection)?void 0:o.ranges[0].$to.pos,s=Lo.getHtml(r.state),c=s.replace(/<\/?[^>]+(>|$)/g,"");if(c.length>0){c.substring(0,i-1);let a=c.substring(e-1,i-1);if(s.indexOf(a),0===a.length)return void this.setColorInRootElement(t);this.TAColorClick(t,a)}else this.setColorInRootElement(t)}}}})}):null]})}))),ji(this,"RRTextFontColorIcon",(t=>Ti.jsx(Ti.Fragment,{children:Ti.jsx(ws,{text:"Recent color",position:"top",children:Ti.jsxs("div",{className:"editor-ico",ref:this.fgRef,onClick:()=>this.setState({colorAnhor:1,isShow:!0}),children:[Ti.jsx("div",{className:"picker-in picker-text",children:Ti.jsx("span",{style:{backgroundColor:`${this.state.fontColor}`}})}),1===this.state.colorAnhor&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(this.ColorPicker,{anchor:this.fgRef,color:this.state.fontColor,cancelBtnClicked:()=>{this.setState({isShow:!1,colorAnhor:0})},callBack:t=>{this.props.callBack("bodyTextColor",t),this.setState({isShow:!1,colorAnhor:0,fontColor:t})}})}):null]})})}))),ji(this,"RRBackgroundColor",(t=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"k-button-md",ref:this.bgRef,children:[Ti.jsx(Qi,{tooltip:"Background color",icon:an,onClick:()=>this.setState({colorAnhor:2,isShow:!0})}),2===this.state.colorAnhor&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(this.ColorPicker,{anchor:this.bgRef,color:this.state.backgroundColor,cancelBtnClicked:()=>{this.setState({isShow:!1,colorAnhor:0})},callBack:t=>{this.props.callBack("bodyBgColor",t),this.setState({isShow:!1,colorAnhor:0,backgroundColor:t})}})}):null]})}))),ji(this,"inputCount",(t=>!1)),ji(this,"components",[Ti.jsx(pc,{isOpen:this.state.imagePickerModal,mobilepush:this.props.mobilepush,deliveryTypeId:this.props.deliveryTypeId,onChangeIsOpen:(t,e)=>{this.setState({imagePickerModal:t}),e.length>0&&(this.setState({url:e}),this.props.callBack("url",e))}})]),ji(this,"RRImageUpload",(()=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs(_l,{show:this.state.imagePickerModal,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Image upload"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({imagePickerModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"camp-pannel-content",children:this.components[0]})})})]})}))),ji(this,"orangestyles",{"$kendo-color-text":"red"}),ji(this,"RRPreviewComponent",(t=>Ti.jsx(rc,{...this.props,data:this.props.data.push,isOpen:this.state.isPreview,notificationData:this.props.notificationData,isWeb:!1,onChangeIsOpen:t=>{this.setState({isPreview:t})}}))),ji(this,"onMount",(t=>{const e=t.dom.ownerDocument,i=e.createElement("style");i.appendChild(e.createTextNode('\n    body {\n      font-family: "MuktaRegular", sans-serif; // Ensure body has the desired font family\n      color: rgb(51, 51, 51);\n  }\n')),e.head.appendChild(i)})),this.timerFGRef=Ni.createRef(),this.timerBGRef=Ni.createRef(),this.fgRef=Ni.createRef(),this.bgRef=Ni.createRef(),this.editorRef=Ni.createRef(),this.emojiRef=Ni.createRef(),this.emojiAnchor=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.colorPickerRef=Ni.createRef()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}removeDivTag(t){const e=document.createElement("div");return e.innerHTML=t,`<p>${e.firstChild.children[0].innerHTML}</p>`}hexToRgba(t,e){t=t.replace(/^#/,"");let i=parseInt(t,16);return`rgba(${i>>16&255}, ${i>>8&255}, ${255&i}, ${e=e||1})`}render(){return Ti.jsxs(Ti.Fragment,{children:[!0===this.state.isTimer?Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.RRTimerComponent,{})}):null,!0===this.state.isAIModal||!0===this.state.generateImage?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Lc,{mobilepush:this.props.mobilepush,type:!0===this.state.generateImage?"image":"text",isOpen:!0,onClose:()=>this.setState({isAIModal:!1,generateImage:!1}),initialContent:"",onGenerate:t=>{if(!0===this.state.generateImage)return this.setState({url:t}),void this.props.callBack("url",t);this.props.callBack("bodytext",`<p className="ta_editor">${t}</p>`,t,this.editorRef),this.setState({bodyContent:t})}})}):null,this.state.isEmoji&&Ti.jsx(this.RREmojiComponent,{}),this.state.isPreview&&Ti.jsx(this.RRPreviewComponent,{}),!0===this.state.imagePickerModal?Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.RRImageUpload,{})}):null,Ti.jsx(Eo,{className:"ta_editor",ref:this.editorRef,style:this.orangestyles,value:this.state.bodyContent,onMount:this.onMount,tools:[[Bo.Bold,Bo.Italic,Bo.Underline,Bo.Strikethrough],[this.RRFontColorIcon,this.RRBackgroundColor,this.RREmojiIcon,this.RRTimerIcon,this.RRInsertImage,this.InsertPersonalize]],contentStyle:{height:200,color:"orange"},onPasteHtml:t=>Ii(t.pastedHtml,{wordwrap:!1}),onBlur:t=>{this.handleBodyOnBlur(t)},onChange:t=>{var e,i,s,a;if(13==(null==(a=null==(s=null==(i=null==(e=null==t?void 0:t.target)?void 0:e.state)?void 0:i.view)?void 0:s.input)?void 0:a.lastKeyCode))return;let n=document.getElementsByClassName("k-content");if(n.length>0){let t=n[0].children;for(let e=0;e<t.length;e++)t[e].style.color="#ff0000"}let l=t.target.value.textContent,o=l.replace(/([\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2694-\u2697]|\uD83E[\uDD10-\uDD5D])/g,"");this.inputCount(l)-this.inputCount(o)>0?this.props.getErrorMessage("Emoji's are not accepted"):this.props.getErrorMessage(null);let r=t.html.replace(/<\/?[^>]+(>|$)/g,""),c=t.html;""!==this.props.notificationData.bodyTextColor&&(c=t.html.replace(/<p>(.*?)<\/p>/,`<p style="color:${this.props.notificationData.bodyTextColor}">$1</p>`));let d=this.getLengthCheck(r);this.setState({textCount:d}),c=c.replace(/<p[^>]*>\s*<\/p>/g,"").replace(/\s{2,}/g," "),d<=350&&(this.props.callBack("bodytext",c,r,this.editorRef,null,d),this.setState({bodyContent:c,update:!1},(()=>{})))}})]})}}const Mc={fullscreen:{width:414,height:896},leaderboard:{width:320,height:60},mediumRectangle:{width:300,height:250},largeBanner:{width:320,height:100},modal:{width:320,height:496}},Pc={fullscreen:{width:1280,height:720},modal:{width:320,height:496},leaderboard:{width:728,height:90},banner:{width:728,height:90},skyscraper:{width:120,height:600},largeRectangle:{width:336,height:280}},Fc=Ni.memo((t=>{zo.useHistory();const[e,i]=Di.useState(null==t?void 0:t.isOpen);Di.useState(0);const[s,a]=Di.useState((null==t?void 0:t.templateName)||""),[n,l]=Di.useState((null==t?void 0:t.templateDescription)||""),[o,r]=Di.useState(null==t?void 0:t.selectData),c=Di.useContext(Ji),[d,p]=Di.useState([]),[h,u]=Di.useState((null==t?void 0:t.timezoneData)||null),[m,v]=Di.useState(null);Di.useEffect((()=>{var t;let e=Zs();(null==(t=null==e?void 0:e.timeZone)?void 0:t.length)>0&&p(null==e?void 0:e.timeZone);let i=fs().clientDetailsLocalization,s=null==e?void 0:e.timeZone,a=(null==s?void 0:s.filter((t=>(null==t?void 0:t.timezoneId)===(null==i?void 0:i.timeZoneId)))[0])||s[0];null!==(null==i?void 0:i.timeZoneId)&&void 0!==(null==i?void 0:i.timeZoneId)&&0!==(null==i?void 0:i.timeZoneId)||(a=s[0]),Object.keys(a).length>0&&u(a)}),[]);const y=(e,i="fullscreen")=>{var s,a,n,l,o,r;let c={..."web"===(null==t?void 0:t.type)?Go:Wo};if(void 0!==(null==(n=null==(a=null==(s=null==t?void 0:t.fullData)?void 0:s.pushLayout)?void 0:a.pushLayoutValue)?void 0:n.trim().toLowerCase())){let i=e[(null==(r=null==(o=null==(l=null==t?void 0:t.fullData)?void 0:l.pushLayout)?void 0:o.pushLayoutValue)?void 0:r.trim().toLowerCase()).replace(/\s+/g,"")];null!=i?(c.width=i.width,c.height=i.height):(c.width=e.fullscreen.width,c.height=e.fullscreen.height)}else c.width=e.fullscreen.width,c.height=e.fullscreen.height;c.isAuth=!0,v(c)};Di.useEffect((()=>{let e="fullscreen";"web"===(null==t?void 0:t.type)?y(Pc,e):y(Mc,e)}),[null==t?void 0:t.fullData]),Di.useMemo((()=>({display:e?"block":"none",position:"fixed",top:79,left:0,zIndex:1e3,backgroundColor:"#fff",padding:"0px",borderRadius:"8px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",minWidth:"300px",height:"calc(100% - 79px)",width:"100%"})),[e]);let g=Di.useMemo((()=>({...m,personalisationData:[],formList:[],getFormListCallback:()=>{null==t||t.getFormListCallback()},selectedForm:{},getSelectedFormCallback:e=>{null==t||t.getSelectedFormCallback(e)},selectData:o,templateName:s,templateDescription:n,saveButtonClick:e=>{null==t||t.saveButtonClick(e)},imageUpload:e=>{null==t||t.imageUpload(e)}})),[m,o,s,n]);const b=Di.useCallback((e=>{c.globalStateData.setHeader(!0),c.globalStateData.setFooter(!0),null==t||t.callback(e)}),[]);if(null!==sessionStorage.getItem("pbstore")&&void 0!==sessionStorage.getItem("pbstore")){let t=$o.decompress(sessionStorage.getItem("pbstore"),"zlib");g={...g,...null==t?void 0:t.pconfig}}return Ti.jsx(_l,{show:!0,fullscreen:!0,className:"modal-top-fixed fluid-container-modal pushbuilder-wrapper field-track-mobile-modal",children:Ti.jsx(Ti.Fragment,{children:null!==m&&Ti.jsx("div",{children:Ti.jsx(Ho,{callback:b,pconfig:g,timeZoneData:d,selectTimeZone:h,addForm:e=>{null==t||t.addForm(e)},editForm:e=>{null==t||t.editForm(e)}})})})})}));class Uc extends Di.Component{constructor(t){super(t),ji(this,"state",{checked:!1,isShowPushBuilder:!1,templateId:null==(Dt=null==(kt=this.props)?void 0:kt.content)?void 0:Dt.templateId,templateName:null==(wt=null==(At=this.props)?void 0:At.content)?void 0:wt.templateName,templateDescription:null==(Lt=null==(Nt=this.props)?void 0:Nt.content)?void 0:Lt.templateDescription,onEdit:!1,content:{templateList:[],hashTag:null==(Bt=null==(Et=this.props)?void 0:Et.content)?void 0:Bt.hashTag,isInterActivity:null==(Pt=null==(Mt=this.props)?void 0:Mt.content)?void 0:Pt.isInteractivebuttonEnabled,interActivity:null==(Ut=null==(Ft=this.props)?void 0:Ft.content)?void 0:Ut.interActivity,isAlertSound:null==(Ot=null==(Rt=this.props)?void 0:Rt.content)?void 0:Ot.isAlertSound,alertSound:null==(Vt=null==(qt=this.props)?void 0:qt.content)?void 0:Vt.alertSound,ferquencyType:"",frequencyValue:"",isExpiry:null==($t=null==(zt=this.props)?void 0:zt.content)?void 0:$t.isExpiryButtonEnabled,expiryType:null==(Gt=null==(Ht=this.props)?void 0:Ht.content)?void 0:Gt.pushexpirySchedule,expiryValue:null==(_t=null==(Wt=this.props)?void 0:Wt.content)?void 0:_t.pushExpiryhours,templateId:null==(Zt=null==(Jt=this.props)?void 0:Jt.content)?void 0:Zt.templateId},errContent:{errExpireType:null,errExpireValue:null,errInterActivityMessage:null,errInterActivity1:null,errInterActivity2:null,errFrequencyType:null,errFrequencyValue:null,errAlertSound:null},shortDescEmoji:!1,isOpenCustomButtonModal:!1,currentIndex:0,clicked:0,height:0,templateList:null,isModalShow:!0,selectTemplate:(null==(Xt=null==(Yt=null==(Kt=this.props)?void 0:Kt.content)?void 0:Yt.body)?void 0:Xt.length)>0?null==(te=null==(Qt=this.props)?void 0:Qt.content)?void 0:te.body:null,galleryTemplateId:0,deletePopUp:!1,layoutConfirm:!1,templateConfig:{..."web"===this.props.type?Go:Wo,templateList:[],deleteTemplate:t=>{this.setState({deletePopUp:!0,galleryTemplateId:t})}},templateData:null,showAddpopup:!1,saveTemplateData:null,category:null,searchQuery:"",templateLoader:!0}),ji(this,"deleteTemplate",(t=>{if(0===this.state.galleryTemplateId)return;let e="web"===this.props.type?8:9;os({path:ln,params:{TemplateID:t,ChannelID:e},loading:this.context.globalStateData.setIsLoadingData,ok:e=>{if(this.setState({galleryTemplateId:0}),null==e?void 0:e.status){let e=[...this.state.templateList];e=null==e?void 0:e.filter((e=>e.templateID!==t));let i={...this.state.templateConfig};i.templateList=e,i.allTemplateData=e,this.setState({templateList:e,templateConfig:i})}},fail:t=>{this.setState({galleryTemplateId:0})}})})),ji(this,"getTemplateList",(()=>{this.setState({templateLoader:!0});let t={channelId:"web"===this.props.type?8:14};os({path:on,params:t,ok:t=>{if(this.setState({templateLoader:!1}),null==t?void 0:t.status){let e={...this.state.templateConfig};e.templateList=(null==t?void 0:t.data)||[],e.allTemplateData=(null==t?void 0:t.data)||[],this.setState({templateList:(null==t?void 0:t.data)||[],templateConfig:e})}}})})),ji(this,"componentWillUnmount",(()=>{this.setState({onEdit:!1,isShowPushBuilder:!1})})),ji(this,"componentDidUpdate",(t=>{var e,i,s;if(t!==this.props){let t={...this.state.errContent};t.errTitle=this.props.error.errTitle,t.errShortDesc=this.props.error.errShortDesc,t.errBody=this.props.error.errBody,t.errImportUrl=this.props.error.errImportUrl,t.errExpireType=this.props.error.errExpiryType,t.errExpireValue=this.props.error.errExpiryValue,t.errInterActivity1=this.props.error.errInteractivityButton1,t.errInterActivity2=this.props.error.errInteractivityButton2,t.errFrequencyType=this.props.error.errFrequencyType,t.errFrequencyValue=this.props.error.errFrequencyValue,this.setState({errContent:t})}null==(e=null==t?void 0:t.content)||e.timezoneId,null==(s=null==(i=this.props)?void 0:i.content)||s.timezoneId})),ji(this,"createInteractivityObject",(t=>({actionName:t,displayName:t,actionId:Ba(t),actionType:t.toLowerCase(),fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:Ma(t)}))),ji(this,"filterByReference",((t,e)=>{let i=[];return i=t.filter((t=>!e.find((e=>{var i;return(null==(i=null==e?void 0:e.actionName)?void 0:i.toLowerCase())===t.toLowerCase()})))),i})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"ColorGraint",(t=>{let e=t.data;return Ti.jsx(Oo,{anchor:4===t.id?this.fontcoloranochor:this.bgColorAnochor,selectColor:(null==e?void 0:e.textColor)||"#fff",show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0}),t.applyBtnClick(e)}})})),ji(this,"FontColorView",(t=>{var e,i;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(4)})})}),Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.bgColorAnochor,onClick:()=>this.buttonClick(5)})})}),4===this.state.clicked&&Ti.jsx(this.ColorGraint,{id:this.state.clicked,selectColor:(null==(e=t.data)?void 0:e.fontColor)||"#000000",data:t.data.fontColor,applyBtnClick:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);let o={...this.state.content};o.interActivity[t.index].fontColor=l,this.setState({content:o})}}),5===this.state.clicked&&Ti.jsx(this.ColorGraint,{id:this.state.clicked,selectColor:(null==(i=t.data)?void 0:i.bgColor)||"#ffffff",data:t.data,applyBtnClick:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);let o={...this.state.content};o.interActivity[t.index].bgColor=l,this.setState({content:o})}})]})})),ji(this,"contentUpdate",((t,e)=>{let i={...this.state.content};i[t.key]=t.value;let s={...this.state.errContent};s[e.key]=e.value,this.setState({content:i,errContent:s})})),ji(this,"getHashTagUpdation",(()=>{var t;return(null==(t=this.state.content.hashTag)?void 0:t.length)+" / 5"})),ji(this,"InlineCssModal",(t=>{Di.useState(this.state.isShowPushBuilder);const e=Di.useContext(Ji),i=Ko.useHistory(),[s,a]=Di.useState(null),[n,l]=Di.useState(0),[o,r]=Di.useState(!1);this.props.type,this.props.type,0!==this.state.templateId&&this.state.templateId,this.props.type,this.state.templateData,this.state.templateName,this.state.templateDescription;return Di.useEffect((()=>{e.globalStateData.setHeader(!1),e.globalStateData.setFooter(!1)}),[]),Ti.jsxs(Ti.Fragment,{children:[!0===o?Ti.jsx(kl,{size:"md",headerTitle:"Forms",para:5==n?"You've reached your form limit. Contact support for assistance.":1==n?"You've reached your form limit. Upgrade your package to create more forms.":2==n?"You've reached your form limit. Upgrade to Premier or Ultimate to create more forms.":3==n?"You've reached your form limit. Upgrade to Ultimate to create more forms.":null,primaryButtonText:5==n?"Okay":"Proceed",secondaryButtonText:5==n?null:"Cancel",buttonClicked:t=>{r(!1),5!=n&&!0===t&&i.push("/subscription")}}):null,Ti.jsx(Fc,{fullData:this.props.fullData,isOpen:this.state.isShowPushBuilder,type:this.props.type,selectData:this.state.templateData,templateName:this.state.templateName,templateDescription:this.state.templateDescription,timezoneData:this.props.timezoneData,callback:t=>{document.body.setAttribute("class","");const e=new URL(window.location.href),i=new URLSearchParams(e.search);i.delete("isPushbuilder"),window.history.replaceState({},"",`${e.pathname}?${i.toString()}`),sessionStorage.removeItem("pbcampdata"),sessionStorage.removeItem("pbstore"),sessionStorage.removeItem("tmldata"),t.length?this.setState({isShowPushBuilder:!1,selectTemplate:t,onEdit:!1}):this.setState({isShowPushBuilder:!1,onEdit:!1})},saveButtonClick:t=>{const i=new URL(window.location.href),s=new URLSearchParams(i.search);s.delete("isPushbuilder"),window.history.replaceState({},"",`${i.pathname}?${s.toString()}`),setTimeout((()=>{sessionStorage.removeItem("pbcampdata"),sessionStorage.removeItem("tmldata"),sessionStorage.removeItem("pbstore")}),3e3),e.globalStateData.setHeader(!0),e.globalStateData.setFooter(!0),this.setState({saveTemplateData:t},(()=>{var e;this.setState({isShowPushBuilder:!0,onEdit:!1});const i=ms();let s=t.data;if(void 0!==sessionStorage.getItem("tmldata")&&null!==sessionStorage.getItem("tmldata")&&"null"!==sessionStorage.getItem("tmldata"))try{let t=ks(sessionStorage.getItem("tmldata"));s.TemplateName=t.templateName,s.TemplateID=null==t?void 0:t.templateId;let a=null==(e=null==i?void 0:i.productCategorysList)?void 0:e.filter((e=>e.categoryName===t.templateDescription));if((null==a?void 0:a.length)>0){let t=a[0];s.TemplateCategoryID=null==t?void 0:t.categoryId,s.Text=null==t?void 0:t.categoryName}this.setState({isShowPushBuilder:!1}),this.createTemplate(s)}catch(a){}else this.setState({showAddpopup:!0})}))},imageUpload:t=>{(t=>{os({path:na,params:t,loading:e.globalStateData.setIsLoadingData,ok:t=>{if(null==t?void 0:t.status){let e=mn.slice(0,-1)+(null==t?void 0:t.data);_o.postMessage({type:"imageUpload",result:e||""})}},fail:t=>{}})})(t)},getFormListCallback:()=>{(()=>{const t={clientId:Ja(),tenentId:cn()};os({path:dn,params:t,loading:e.globalStateData.setIsLoadingData,ok:t=>{var e,i,s;if((null==t?void 0:t.status)&&(null==(e=null==t?void 0:t.data)?void 0:e.length)>0){let e=null==(i=null==t?void 0:t.data)?void 0:i.filter((t=>"Brand owned form"!==(null==t?void 0:t.formType)));_o.postMessage({type:"formList",result:e||[]}),a(null==t?void 0:t.data),setFormListLength((null==(s=null==t?void 0:t.data)?void 0:s.length)||0)}},fail:t=>{}})})()},getSelectedFormCallback:t=>{var i;os({path:pn,params:{recipientFormID:i=t},loading:e.globalStateData.setIsLoadingData,ok:t=>{if(null==t?void 0:t.status){let e={formData:(null==t?void 0:t.data)||[],formId:i};_o.postMessage({type:"selectForm",result:e})}},fail:t=>{}})},addForm:t=>{var a;let n=$o.compress(t,"zlib");sessionStorage.setItem("pbstore",n);let o={channelId:"web"===this.props.type?8:9,fullData:null==(a=this.props)?void 0:a.fullData,currentIndex:this.props.index,isEdit:this.state.onEdit},c=$o.compress(o,"zlib");if(sessionStorage.setItem("pbcampdata",c),!1===hn((null==s?void 0:s.length)||0))r(!0),l((null==s?void 0:s.length)||0);else{let t=window.location.search,[s,...a]=t,n=a.join("");n+="&isPushbuilder=true",n=window.btoa(n),e.globalStateData.setHeader(!0),e.globalStateData.setFooter(!0),i.push({pathname:"/preferences/form-generation",search:`path=/campaign/creation-notification&data=${n}`})}},editForm:t=>{var a;let n=$o.compress(t,"zlib");sessionStorage.setItem("pbstore",n);let o={channelId:"web"===this.props.type?8:9,fullData:null==(a=this.props)?void 0:a.fullData,currentIndex:this.props.index,isEdit:this.state.onEdit},c=$o.compress(o,"zlib");if(sessionStorage.setItem("pbcampdata",c),!1===hn((null==s?void 0:s.length)||0))r(!0),l((null==s?void 0:s.length)||0);else{let s=window.location.search,[a,...n]=s,l=n.join("");l+="&isPushbuilder=true",l=window.btoa(l),e.globalStateData.setHeader(!0),e.globalStateData.setFooter(!0),i.push({pathname:"/preferences/form-generation",search:`path=/campaign/creation-notification&data=${l}&recipientFormID=${null==t?void 0:t.formId}`})}}})]})})),ji(this,"getTemplateData",((t,e)=>{let i="web"===this.props.type?8:9;os({path:un,params:{ChannelID:i,TemplateID:t},loading:this.context.globalStateData.setIsLoadingData,ok:i=>{var s,a,n,l,o,r;if(null==i?void 0:i.status){if(null==(s=null==i?void 0:i.data)?void 0:s.jsonContent){this.props.content.templateId=t,this.props.content.templateName=(null==(a=null==i?void 0:i.data)?void 0:a.templateName)||"",this.props.content.templateDescription=(null==(n=null==i?void 0:i.data)?void 0:n.text)||"",this.setState({templateName:this.props.content.templateName,templateDescription:this.props.content.templateDescription,templateId:t}),this.setState({templateData:null==i?void 0:i.data});let s={selectData:(null==(l=null==i?void 0:i.data)?void 0:l.jsonContent)||null,templateName:(null==(o=null==i?void 0:i.data)?void 0:o.templateName)||"",templateDescription:(null==(r=null==i?void 0:i.data)?void 0:r.text)||"",templateId:t,data:null==i?void 0:i.data},c=ts(s)||null;return sessionStorage.setItem("tmldata",c),void e({status:!0})}e({status:!1})}else e({status:!1})},fail:t=>{e({status:!1})}})})),ji(this,"getTemplateList1",((t,e)=>{let i="web"===this.props.type?8:9;os({path:un,params:{ChannelID:i,TemplateID:t},loading:this.context.globalStateData.setIsLoadingData,ok:t=>{(null==t?void 0:t.status)?e(t):e({status:!1})},fail:t=>{e({status:!1})}})})),ji(this,"updateLayoutConfig",((t,e="fullscreen")=>{var i,s,a,n,l,o,r,c,d,p;let h=t.fullscreen;if(void 0!==(null==(l=null==(n=null==(a=null==(s=null==(i=this.props)?void 0:i.fullData)?void 0:s.push)?void 0:a.pushLayout)?void 0:n.pushLayoutValue)?void 0:l.trim().toLowerCase())){let e=t[(null==(p=null==(d=null==(c=null==(r=null==(o=this.props)?void 0:o.fullData)?void 0:r.push)?void 0:c.pushLayout)?void 0:d.pushLayoutValue)?void 0:p.trim().toLowerCase()).replace(/\s+/g,"")];null!=e?(h.width=e.width,h.height=e.height):(h.width=t.fullscreen.width,h.height=t.fullscreen.height)}else h.width=t.fullscreen.width,h.height=t.fullscreen.height;return h})),ji(this,"TemplateList",(t=>{const[e,i]=Di.useState(!1),[s,a]=Di.useState(!1),[n,l]=Di.useState(!1),[o,r]=Di.useState(!1),[c,d]=Di.useState(null);let p="web"===this.props.type?8:9;return Di.useEffect((()=>{let t=!1,e=!1,s=!1;const n=Zi("Communications");1==(null==n?void 0:n.get_AddAccessData)&&(t=!0),e=1==(null==n?void 0:n.accessUpdateData),(null==n?void 0:n.accessDeleteData)&&(s=!0),l(s),i(e),a(t)}),[]),Ti.jsx(Ti.Fragment,{children:Ti.jsx(Zo,{fullData:this.props.fullData,isAutherPage:!0,templateList:this.state.templateConfig.templateList,channelId:p,addButtonClick:()=>{this.setState({isShowPushBuilder:!0,templateId:0,selectTemplate:null,templateData:null})},selectBtnClick:e=>{this.getTemplateList1(e.templateID,(i=>{if(null==i?void 0:i.status){let s=null==i?void 0:i.data;if(void 0!==(null==s?void 0:s.jsonContent)&&null!==s.jsonContent){const e=JSON.parse(null==s?void 0:s.jsonContent);if(null!=e)if(8===p){let i=this.updateLayoutConfig(nn.web,"fullscreen"),s=null==e?void 0:e.settings;if((null==s?void 0:s.width)!==i.width||(null==s?void 0:s.height)!==(null==i?void 0:i.height)){r(!0);let e="We observing your choosing wrong layout in Layout/Position section and Templete size Shall we proceed?";d(e),null==t||t.isError({status:!0,errMsg:e})}}else this.updateLayoutConfig(nn.mobile,"fullscreen")}this.props.getBodyContent(s.body,s.body),this.props.content.templateId=e.templateID,this.props.content.templateName=e.templateName,this.props.content.templateDescription=e.text,this.setState({templateName:e.templateName,templateDescription:e.text}),this.setState({isModalShow:!1,selectTemplate:s.body,templateId:e.templateID})}}))},editButtonClick:t=>{this.getTemplateData(t.templateID,(e=>{var i,s,a;if(null==e?void 0:e.status){let e="web"===this.props.type?8:9,n=window.location.pathname,l=window.location.search,o=$o.compress(n,"zlib"),r=$o.compress(l,"zlib"),c={channelId:e,fullData:null==(i=this.props)?void 0:i.fullData,currentIndex:this.props.index,isEdit:this.state.onEdit},d=$o.compress(c,"zlib");sessionStorage.setItem("pbcampdata",d);let p={};p=8===e?this.updateLayoutConfig(nn.web):this.updateLayoutConfig(nn.mobile);let h=$o.compress(p,"zlib");null==(a=null==(s=this.props)?void 0:s.history)||a.push({pathname:"/preferences/addPushBuilder",search:`ch=${e}&tId=${t.templateID}&path=${o}&query=${r}&isAdd=true&ssetting=${h}`}),window.location.reload()}}))}})})})),ji(this,"validateInteractivity",(()=>{let t=!1;return this.state.content.interActivity.map(((e,i)=>{var s;if(!0!==t&&(0===(null==(s=null==e?void 0:e.displayName)?void 0:s.length)||"Custom action"===(null==e?void 0:e.displayName))){let e={...this.state.errContent};e.errInterActivityMessage="Please enter display name",this.setState({errContent:e}),t=!0}})),t})),ji(this,"addInterActivityObject",(()=>{if(!0===this.validateInteractivity())return;let t=[...this.state.content.interActivity];t.push(this.createInteractivityObject(""));let e={...this.state.content,interActivity:t};this.setState({content:e}),this.props.onChange(e)})),ji(this,"removeInterActivityObject",(()=>{let t=[...this.state.content.interActivity];t.splice(1,1);let e={...this.state.content,interActivity:t};this.setState({content:e}),this.props.onChange(e)})),ji(this,"createTemplate",(t=>{os({path:rn,params:t,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{this.props.getBodyContent(t.Body,t.Body),this.setState({selectTemplate:t.Body}),this.setState({templateId:t.TemplateID})}})})),this.createRef()}createRef(){this.fontcoloranochor=Ni.createRef(),this.bgColorAnochor=Ni.createRef()}componentDidMount(){var t;this.getTemplateList();let e=no.parse(window.location.search),i=(null==e?void 0:e.tId)||0;0!==i&&this.getTemplateList1(i,(t=>{let e="web"===this.props.type?8:9;if(null==t?void 0:t.status){let i=null==t?void 0:t.data;if(void 0!==(null==i?void 0:i.jsonContent)&&null!==i.jsonContent){const t=JSON.parse(null==i?void 0:i.jsonContent);if(null!=t)if(8===e){let e=this.updateLayoutConfig(nn.web,"fullscreen"),i=null==t?void 0:t.settings;(null==i?void 0:i.width)!==e.width||(null==i||i.height,null==e||e.height)}else this.updateLayoutConfig(nn.mobile,"fullscreen")}this.props.getBodyContent(i.body,i.body),this.props.content.templateId=i.templateID,this.props.content.templateName=i.templateName,this.props.content.templateDescription=i.text,this.setState({templateName:i.templateName,templateDescription:i.text}),this.setState({isModalShow:!1,selectTemplate:i.body,templateId:i.templateID});const s=new URLSearchParams(window.location.search);s.delete("tId");const a=window.location.pathname+(s.toString()?`?${s}`:"");window.history.replaceState({},"",a)}})),(null==(t=null==e?void 0:e.isPushbuilder)?void 0:t.length)>0&&null!==sessionStorage.getItem("pbcampdata")&&void 0!==sessionStorage.getItem("pbcampdata")&&($o.decompress(sessionStorage.getItem("pbcampdata"),"zlib"),this.setState({isShowPushBuilder:!0}))}getMobileInteractivityButtons(){return this.filterByReference(xr,this.state.content.interActivity)}getWebInteractivityButtons(){return this.filterByReference(Sr,this.state.content.interActivity)}render(){var t,e,i,s,a,n,l,o;const r=ms();return(null==(t=null==r?void 0:r.productCategorysList)?void 0:t.length)>0?r.productCategorysList.unshift({categoryName:"All",categoryId:100}):r.productCategorysList.push({categoryName:"All",categoryId:100}),Ti.jsxs("div",{children:[this.state.deletePopUp&&Ti.jsx(kl,{size:"md",headerTitle:"Template",para:"Are you sure you want to delete?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{this.setState({deletePopUp:!1}),!0===t?this.deleteTemplate(this.state.galleryTemplateId):this.setState({galleryTemplateId:0})}}),this.state.layoutConfirm&&Ti.jsx(kl,{size:"md",headerTitle:"Template",para:"We are observing your choosing wrong layout in Layout/Position section and Templete size Shall we proceed?",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{this.setState({layoutConfirm:!1}),!1===t&&(this.props.getBodyContent("",""),this.props.content.templateId=0,this.props.content.templateName="",this.props.content.templateDescription="",this.setState({templateName:"",templateDescription:""}),this.setState({isModalShow:!1,selectTemplate:null,templateId:0}))}}),!0===this.state.showAddpopup&&Ti.jsx(Jo,{isinline:!0,isShow:this.state.showAddpopup,templateData:this.state.saveTemplateData,savedData:t=>{this.props.getBodyContent(t.Body,t.Body),this.setState({selectTemplate:t.Body}),this.setState({templateId:t.TemplateID}),this.props.content.templateId=t.TemplateID,this.setState({isShowPushBuilder:!1}),this.forceUpdate()},close:()=>{this.setState({showAddpopup:!1}),this.getTemplateList()}}),null===this.state.selectTemplate&&Ti.jsxs("div",{className:"d-flex justify-content-between",children:[Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx("div",{className:"mr20",children:Ti.jsx(Ao,{right:!0,label:"Template list"})}),Ti.jsx("div",{style:{width:"275px"},children:Ti.jsx(Ul,{required:!1,label:"Category",data:(null==r?void 0:r.productCategorysList)||[],textField:"categoryName",dataItemKey:"categoryId",value:void 0!==this.state.category&&null!==this.state.category?this.state.category:null==r?void 0:r.productCategorysList[0],errorMessage:null,onChange:t=>{var e,i,s;this.setState({category:t.target.value});let a=[...null==(e=this.state.templateConfig)?void 0:e.allTemplateData];if((null==a?void 0:a.length)>0){let e=null==a?void 0:a.filter((e=>{var i;return(null==e?void 0:e.templateCategoryID)===(null==(i=t.target.value)?void 0:i.categoryId)}));(null==e?void 0:e.length)>0?this.setState({templateConfig:{...this.state.templateConfig,templateList:e}}):100===(null==(i=t.target.value)?void 0:i.categoryId)?this.setState({templateConfig:{...this.state.templateConfig,templateList:null==(s=this.state.templateConfig)?void 0:s.allTemplateData}}):this.setState({templateConfig:{...this.state.templateConfig,templateList:[]}})}}})})]}),Ti.jsx("div",{children:Ti.jsxs("div",{className:"d-flex align-items-center mr5",children:[Ti.jsx("div",{className:"pb-search-wrapper me-2",children:Ti.jsx(ro,{campListing:!1,normal:!0,fullWidth:300,onPeriyaMenuChange:t=>this.setState({periyaMenu:t}),onSearchDataReceived:(t,e)=>{var i,s;let a=[...null==(i=this.state.templateConfig)?void 0:i.allTemplateData];if((null==a?void 0:a.length)>0){let e=null==a?void 0:a.filter((e=>{var i;return null==(i=null==e?void 0:e.templateName)?void 0:i.toLowerCase().includes(t.campaignName.toLowerCase())}));(null==e?void 0:e.length)>0?this.setState({templateConfig:{...this.state.templateConfig,templateList:e}}):""===t.campaignName?this.setState({templateConfig:{...this.state.templateConfig,templateList:null==(s=this.state.templateConfig)?void 0:s.allTemplateData}}):this.setState({templateConfig:{...this.state.templateConfig,templateList:[]}})}}})}),Ti.jsx(Qi,{tooltip:"Add template",icon:"icon-rs-circle-plus-fill-edge-medium color-primary-blue mt3 cursor-pointer paddingL10",iconClass:"",size:"lg",color:"blue",onClick:()=>{var t,e,i;sessionStorage.setItem("tmldata",null);let s="web"===this.props.type?8:9,a=window.location.pathname,n=window.location.search,l=$o.compress(a,"zlib"),o=$o.compress(n,"zlib"),r={channelId:s,fullData:null==(t=this.props)?void 0:t.fullData,currentIndex:this.props.index,isEdit:this.state.onEdit},c=$o.compress(r,"zlib");sessionStorage.setItem("pbcampdata",c);let d={};d=8===s?this.updateLayoutConfig(nn.web):this.updateLayoutConfig(nn.mobile);let p=$o.compress(d,"zlib");null==(i=null==(e=this.props)?void 0:e.history)||i.push({pathname:"/preferences/addPushBuilder",search:`ch=${s}&tId=0&path=${l}&query=${o}&isAdd=true&ssetting=${p}`}),window.location.reload()}})]})})]}),null===this.state.selectTemplate&&(null==(i=null==(e=this.state.templateConfig)?void 0:e.templateList)?void 0:i.length)>0&&Ti.jsx(this.TemplateList,{isError:t=>{}}),null===this.state.selectTemplate&&0===(null==(a=null==(s=this.state.templateConfig)?void 0:s.templateList)?void 0:a.length)&&!1===this.state.templateLoader&&Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"box-design pb10 mt20",children:Ti.jsx(oo,{count:5,isError:!0,children:Ti.jsxs("div",{className:"nodata-bar add-func",children:[Ti.jsx("i",{className:"icon-rs-alert-medium icons-md orange-medium"}),Ti.jsx("p",{children:"No data available"})]})})})}),this.state.isShowPushBuilder&&Ti.jsx(this.InlineCssModal,{onEdit:!1}),this.state.onEdit&&null!==this.state.templateData&&Ti.jsx(this.InlineCssModal,{onEdit:!0}),null!==this.state.selectTemplate&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(ws,{text:"Edit",position:"top",children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md color-primary-blue   cursor-pointer paddingL10",onClick:()=>{this.getTemplateData(this.state.templateId,(t=>{var e,i,s;if(null==t?void 0:t.status){let t="web"===this.props.type?8:9,a=window.location.pathname,n=window.location.search,l=$o.compress(a,"zlib"),o=$o.compress(n,"zlib"),r={channelId:t,fullData:null==(e=this.props)?void 0:e.fullData,currentIndex:this.props.index,isEdit:this.state.onEdit},c=$o.compress(r,"zlib");sessionStorage.setItem("pbcampdata",c);let d={};d=8===t?this.updateLayoutConfig(nn.web):this.updateLayoutConfig(nn.mobile);let p=$o.compress(d,"zlib");null==(s=null==(i=this.props)?void 0:i.history)||s.push({pathname:"/preferences/addPushBuilder",search:`ch=${t}&tId=${this.state.templateId}&path=${l}&query=${o}&isAdd=true&ssetting=${p}`}),window.location.reload()}}))}})}),Ti.jsx("iframe",{sandbox:!0,id:"edmFrame",className:"",title:"uploadFrame",srcDoc:this.state.selectTemplate+"<style>body{margin:0;display:block}</style>",style:{width:"100%",minHeight:"100vh",marginTop:"20px",height:this.state.height},onLoad:()=>{let t=document.getElementById("edmFrame");var e=t.contentDocument||t.contentWindow.document,i=Math.min(e.body.scrollHeight,e.documentElement.scrollHeight,e.body.offsetHeight,e.documentElement.offsetHeight,e.body.clientHeight,e.documentElement.clientHeight);const s=e.querySelector(".content-wrapper");if(s){s.classList.add("authoring-iframe");const t=e.createElement("style");t.innerHTML='\n                    .content-wrapper.authoring-iframe > div[id^="online-form"] {\n                      height: 100% !important;\n                    }\n                  ',e.head.appendChild(t)}this.setState({height:i})},onError:()=>{}}),!1===this.props.isCarousel&&Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"#Hashtags"})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs("div",{className:"chips-input-container",children:[Ti.jsx(Fl,{label:"Hashtags",noDropdown:!0,data:this.state.content.hashTag,value:this.state.content.hashTag,allowCustom:!0,onChange:t=>{if(t.target.value.length>5)return;let e=$a(t),i={...this.state.content};i.hashTag=e,this.setState({content:i}),this.props.onChange(i)}}),Ti.jsx("small",{class:`rs-form-small-text fs12 d-inline-block text-end w-100 ${5===(null==(n=this.state.hashTags)?void 0:n.length)&&"red"}`,children:`${5===(null==(l=this.state.hashTags)?void 0:l.length)?Ha:""}  ${(null==(o=this.state.hashTags)?void 0:o.length)>0?this.getHashTagUpdation():" 0 / 5"}`})]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Ua,size:"md",pophover:"View analytics for trending topics"})})})})]})}),Ti.jsx($l,{style:{marginTop:10},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Interactivity"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:t=>{let e={...this.state.content};if(e.isInterActivity=t.target.value,t.target.value){let t=e.interActivity;t.push(this.createInteractivityObject("")),e.interActivity=t,this.setState({content:e})}else e.interActivity=[],this.setState({content:e});this.props.onChange(e)},checked:this.state.content.isInterActivity})})]})}),this.state.content.interActivity.length>0&&this.state.content.interActivity.map(((t,e)=>Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:["Button"],value:"Button",label:"Interactivity type"})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{label:"Interactive actions",errorMessage:this.state.errContent.errInterActivityMessage,data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),value:void 0!==t.displayName&&""!==t.displayName?t.displayName:"-- Select --",onChange:t=>{0===e?(this.setState((t=>({errContent:{...t.errContent,errInterActivity1:null}}))),this.props.error.errInterActivity1=null):(this.setState((t=>({errContent:{...t.errContent,errInterActivity2:null}}))),this.props.error.errInterActivity2=null);let i=[...this.state.content.interActivity];i[e].displayName=t.target.value,i[e].actionName="Custom action"!==t.target.value?t.target.value:"",i[e].actionType="",i[e].url="",i[e].clickBehavourValue="",i[e].actionId=Ba(i[e].displayName),i[e].value=Ma(i[e].displayName);let s={...this.state.content,interActivity:i},a={...this.state.errContent};a.errInterActivityMessage=null,this.setState({content:s,errContent:a}),this.props.onChange(s)}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[""===t.actionName?null:Ti.jsx(this.FontColorView,{index:e,data:t}),t.displayName.length>0&&"Custom action"===t.displayName&&3===t.actionId&&4!==t.value&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(Qi,{tooltip:"Settings",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal,currentIndex:e})}})}),Ti.jsx(Qi,{tooltip:0===e?"Add":"Remove",icon:0===e?"icon-rs-circle-plus-fill-edge-medium":1===e?"icon-rs-circle-minus-fill-edge-medium":"",iconClass:`${0===e&&`${this.state.content.interActivity.length>1&&"click-off"}`}`,size:"md",color:0===e?"blue":"red",onClick:()=>{0===e?this.addInterActivityObject():1===e&&this.removeInterActivityObject()}})]})})})]})}),1===t.actionId&&Ti.jsx(gc,{content:t,error:this.state.errContent,onChange:e=>{this.props.error.errFrequencyType=null!==e.ferquencyType?null:ya,this.props.error.errFrequencyValue=null!==e.ferquencyType&&e.frequencyValue.length>0?null:ga;let i={...this.state.errContent};i.errFrequencyType=null,i.errFrequencyValue=null,this.setState({errContent:i}),t.interactivehours=e.frequencyValue,t.reschedule=e.ferquencyType,t.maybeLaterTimeings=e.frequencyValue+" "+e.ferquencyType,this.props.onChange(this.state.content)}})]}))),!1===this.props.isCarousel&&Ti.jsx(bc,{content:this.state.content,error:this.state.errContent,onChange:t=>{this.props.error.errExpiryType=null!==t.expiryType?null:ya,this.props.error.errExpiryValue=null!==t.expiryType&&t.expiryValue.length>0?null:ga;let e={...this.state.errContent};e.expiryType=null,e.errExpireValue=null,this.setState({errContent:e});let i={...this.state.content};i.isExpiry=t.isExpiry,i.expiryType=t.expiryType,i.expiryValue=t.expiryValue,this.setState({content:i}),this.props.onChange(i)}}),!1===this.props.isCarousel&&"mobile"===this.props.type&&Ti.jsx(fc,{content:this.state.content,error:this.state.errContent,onChange:t=>{this.props.error.errAlertSound=t.length>0?null:ya;let e={...this.state.errContent};e.errAlertSound=null,this.setState({errContent:e});let i={...this.state.content};i.isAlertSound=t.isAlertSound,i.alertSound=t.alertSound,this.setState({content:i}),this.props.onChange(i)}}),!0===this.state.isOpenCustomButtonModal?Ti.jsx(kc,{isOpen:this.state.isOpenCustomButtonModal,isWeb:"web"===this.props.type,smartAppStore:this.props.smartAppStore,selectInterActivity:this.state.content.interActivity[this.state.currentIndex],onChangeIsOpen:t=>{this.setState({isOpenCustomButtonModal:t})},onSaveClick:t=>{0===this.state.currentIndex?(this.setState((t=>({errContent:{...t.errContent,errInterActivity1:null}}))),this.props.error.errInterActivity1=null):(this.setState((t=>({errContent:{...t.errContent,errInterActivity2:null}}))),this.props.error.errInterActivity2=null);let e={...this.state.content};e.interActivity[this.state.currentIndex].actionName=t.actionName,e.interActivity[this.state.currentIndex].actionType=t.actionType,e.interActivity[this.state.currentIndex].displayName=t.actionName,e.interActivity[this.state.currentIndex].url=t.url,e.interActivity[this.state.currentIndex].clickBehavourValue=t.clickBehavourValue,e.interActivity[this.state.currentIndex].countryCode=t.countryCode,this.setState({content:e}),this.props.onChange(e)}}):null]})]})}}ji(Uc,"contextType",Ji);const Rc=zo.withRouter(Uc),Oc=ua,qc=[],Vc=["Notification","Emergency","Enter sound name"],zc=["Hour(s)","Day(s)"],$c=["Minute(s)","Hour(s)","Day(s)"];class Hc extends Di.Component{constructor(t){super(t),ji(this,"tabs",[{text:"Create",iconLeft:"icon-rs-text-document-edge-large icons-lg",disable:!1,id:0},{text:"Import",iconLeft:"icon-rs-import-file-edge-large icons-lg",disable:!1,id:2},{text:"Template",iconLeft:"icon-rs-template-edge-large icons-lg",disable:!0,id:3}]),ji(this,"state",{resData:!1,valAudPopUp:!1,clkofSend:!0,isRequestForApproval:!1,approverName:{brandId:"",userId:0,firstName:"-- Select email --"},approverErr:null,isCouponCodeBtnClicked:!1,isShortlinkBtnClicked:!1,isFirstCustomButtonChoose:this.props.notificationData.push.content[0].interActivity.length>0&&""!==this.props.notificationData.push.content[0].interActivity[0].actionName&&3===this.props.notificationData.push.content[0].interActivity[0].actionId,isSecondCustomButtonChoose:this.props.notificationData.push.content[0].interActivity.length>1&&""!==this.props.notificationData.push.content[0].interActivity[1].actionName&&3===this.props.notificationData.push.content[0].interActivity[1].actionId,activeTab:"TEXT"===this.props.notificationData.push.content[0].contentType?0:"EDM"===this.props.notificationData.push.content[0].contentType?1:"TEMPLATE"===this.props.notificationData.push.content[0].contentType?2:-1,isSendRecommendation:!1,isDaylightSaving:!1,addBtnClick:this.props.notificationData.push.content[0].interActivity.length>1,bodyTextCount:(null==(ae=null==(se=null==(ie=null==(ee=this.props.notificationData)?void 0:ee.push)?void 0:ie.content[0])?void 0:se.body)?void 0:ae.length)>0?(null==(ce=null==(re=null==(oe=null==(le=null==(ne=this.props.notificationData)?void 0:ne.push)?void 0:le.content[0])?void 0:oe.body)?void 0:re.length)?void 0:ce.toString())+"/":"",titleTextCount:(null==(ue=null==(he=null==(pe=null==(de=this.props.notificationData)?void 0:de.push)?void 0:pe.content[0])?void 0:he.title)?void 0:ue.length)||0,subTitleTextCount:(null==(ge=null==(ye=null==(ve=null==(me=this.props.notificationData)?void 0:me.push)?void 0:ve.content[0])?void 0:ye.subTitle)?void 0:ge.length)||0,isInterActivity:null==(Se=null==(xe=null==(fe=null==(be=this.props)?void 0:be.notificationData)?void 0:fe.push)?void 0:xe.content[0])?void 0:Se.isInteractivebuttonEnabled,interActivityButton1Name:(null==(ke=null==(Ie=null==(Te=null==(je=null==(Ce=this.props)?void 0:Ce.notificationData)?void 0:je.push)?void 0:Te.content[0])?void 0:Ie.interActivity)?void 0:ke.length)>0?null==(Ne=null==(we=null==(Ae=null==(De=this.props)?void 0:De.notificationData)?void 0:Ae.push)?void 0:we.content[0])?void 0:Ne.interActivity[0].actionName:"",interActivityButton2Name:(null==(Pe=null==(Me=null==(Be=null==(Ee=null==(Le=this.props)?void 0:Le.notificationData)?void 0:Ee.push)?void 0:Be.content[0])?void 0:Me.interActivity)?void 0:Pe.length)>1?null==(Oe=null==(Re=null==(Ue=null==(Fe=this.props)?void 0:Fe.notificationData)?void 0:Ue.push)?void 0:Re.content[0])?void 0:Oe.interActivity[1].actionName:"",interActivityButton1:"Button",interActivityButton2:"Button",isAlertSound:this.props.notificationData.push.content[0].isAlertSound,isExpiry:this.props.notificationData.push.content[0].isExpiryButtonEnabled,isOpenCustomButtonModal:!1,isFirstCustomButton:!1,expiryType:this.props.notificationData.push.content[0].pushexpirySchedule,expiryValue:this.props.notificationData.push.content[0].pushExpiryhours,frequencyType:"",frequencyValue:"",alertSound:this.props.notificationData.push.content[0].alertSound,alertEnter:!1,schedule:"",clicked:0,isShow:!1,isTitleEmoji:!1,isTitlePerson:!1,isSubTitlePerson:!1,titlePerson:"",subTitlePerson:"",titleEmoji:"",subTitleEmoji:"",isSubtitleEmoji:!1,titleValue:this.props.notificationData.push.content[0].title,titleValueDublicate:null,personalizeChooseCount:0,subTitleValue:this.props.notificationData.push.content[0].subTitle,subTitleColor:null==($e=null==(ze=null==(Ve=null==(qe=this.props)?void 0:qe.notificationData)?void 0:Ve.push)?void 0:ze.content[0])?void 0:$e.subTitleColor,bodyValue:this.props.notificationData.push.content[0].body,titleColor:this.props.notificationData.push.content[0].titleColor,interActivityObject:{actionName:"",actionId:"",actionType:"",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:"",interactivehours:0,reschedule:""},errContent:this.props.notificationError.errContentType,errTitle:this.props.notificationError.errTitle,errSubtitle:this.props.notificationError.errSubtitle,errBody:this.props.notificationError.errBody,errInterActivity1:this.props.notificationError.errInterActivityButton1,errInterActivityButton1:this.props.notificationError.errInterActivityButton1,errInterActivityButton2:this.props.notificationError.errInterActivityButton2,errInterActivity2:this.props.notificationError.errInterActivityButton2,errAlertSound:this.props.notificationError.errAlertSound,errExpiryType:this.props.notificationError.errExpiryType,errExpiryValue:this.props.notificationError.errExpiryValue,errHashtag:this.props.notificationError.errHashtag,errSchedule:this.props.notificationError.errSchedule,errFrequencyType:this.props.notificationError.errFrequencyType,errFrequencyValue:this.props.notificationError.errFrequencyValue,editTimeZone:!1,hashTags:this.props.notificationData.push.content[0].hashTag.length>0?this.props.notificationData.push.content[0].hashTag:[],timeZone:this.props.notificationData.push.content[0].timezone,timeZoneList:[],currentDate:new Date,pushType:0,treeUpdate:1,saveError:!1,timeZoneDate:null,currentTimeZone:null,campaignStartDate:tn(new Date(ao(this.props.campaignPlan.startDate).add(0,"day").toString()),15),timerBtnClicked:!1,refreshPopup:!1}),ji(this,"createFieldRef",(()=>{this.anchor=Ni.createRef(),this.fontcoloranochor=Ni.createRef(),this.subTitleFontColorAnchor=Ni.createRef(),this.backgroundcoloranochor=Ni.createRef(),this.emojianochor=Ni.createRef(),this.subTitleEmojiAnochor=Ni.createRef(),this.ca1FontColorAnochor=Ni.createRef(),this.ca1BackgroundColorAnochor=Ni.createRef(),this.ca2FontColorAnochor=Ni.createRef(),this.ca2BackgroundColorAnochor=Ni.createRef(),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.titleRef=Ni.createRef(),this.colorPickerRef=Ni.createRef()})),ji(this,"contentScroll",(()=>{null!==this.props.notificationError.errTitle&&window.scrollTo(0,this.titleRef.current.offSetTop)})),ji(this,"componentDidMount",(()=>{var t,e,i,s,a,n,l,o,r,c,d,p,h,u;let m=Bs(this.props.notificationData.push.content[0].scheduleDate);u=isNaN(Date.parse(m))?"":this.props.notificationData.push.content[0].localScheduleTime,this.props.notificationData.push.content[0].interActivity.map((t=>{if("maybe later"===t.actionType&&""!==t.maybeLaterTimeings){let e=t.maybeLaterTimeings.split(" ");this.setState({frequencyType:e[1],frequencyValue:e[0]})}}));let v=fs().clientDetailsLocalization;vn();let y=null==(t=Zs())?void 0:t.timeZone,g=(null==y?void 0:y.filter((t=>(null==t?void 0:t.timezoneId)===(null==v?void 0:v.timeZoneId))))||[y[0]];if(null!==(null==v?void 0:v.timeZoneId)&&void 0!==(null==v?void 0:v.timeZoneId)&&0!==(null==v?void 0:v.timeZoneId)||(g=[y[0]]),""!==this.props.notificationData.push.content[0].timezoneId){g=null==y?void 0:y.filter((t=>(null==t?void 0:t.timezoneId)===this.props.notificationData.push.content[0].timezoneId));let t=(new Date).toLocaleString([],{timeZone:null==(e=g[0])?void 0:e.timezoneValue});this.setState({schedule:u,timeZoneDate:t,timeZoneList:(null==(i=Zs())?void 0:i.timeZone)||[],timeZone:{timezoneId:null==(s=g[0])?void 0:s.timezoneId,timezoneName:null==(a=g[0])?void 0:a.timezoneName,timezoneValue:null==(n=g[0])?void 0:n.timezoneValue,offSet:null==(l=g[0])?void 0:l.gmtOffset}})}else{let t=(new Date).toLocaleString([],{timeZone:null==(o=g[0])?void 0:o.timezoneValue});this.setState({schedule:u,timeZoneDate:t,timeZoneList:(null==(r=Zs())?void 0:r.timeZone)||[],timeZone:{timezoneId:(null==v?void 0:v.timeZoneId)||(null==(c=g[0])?void 0:c.timezoneId)||0,timezoneName:(null==v?void 0:v.timeZoneName)||(null==(d=g[0])?void 0:d.timezoneName)||"-- Select timezone --",timezoneValue:null==(p=g[0])?void 0:p.timezoneValue,offSet:null==(h=g[0])?void 0:h.gmtOffset}})}new Date(ao(this.props.campaignPlan.startDate).add(0,"day"))<new Date&&this.setState({campaignStartDate:tn(new Date,15)}),document.addEventListener("mousedown",this.handleClickOutside)})),ji(this,"handleClickOutside",(t=>{this.colorPickerRef.current&&!this.colorPickerRef.current.contains(t.target)&&this.setState({isShow:!1})})),ji(this,"alertDelivaryType",(()=>{let t=[...this.tabs];t.forEach((t=>{"Template"!==t.text&&"Import"!==t.text||(t.disable=!0)})),this.tabs=t})),ji(this,"configureTabs",(()=>{if("web"===this.props.type)if(2===this.props.notificationData.push.pushType.deliveryTypeId||3===this.props.notificationData.push.pushType.deliveryTypeId||4===this.props.notificationData.push.pushType.deliveryTypeId){let t=[...this.tabs];t.forEach((t=>{t.disable=!1,"TEXT"===this.props.notificationData.push.content[0].contentType&&("Import"!==t.text&&"Template"!==t.text||(t.disable=!0)),"EDM"===this.props.notificationData.push.content[0].contentType&&("Create"!==t.text&&"Template"!==t.text||(t.disable=!0)),"TEMPLATE"===this.props.notificationData.push.content[0].contentType&&("Create"!==t.text&&"Import"!==t.text||(t.disable=!0))})),this.tabs=t}else 1===this.props.notificationData.push.pushType.deliveryTypeId&&this.alertDelivaryType();else if(2===this.props.notificationData.push.deliveryType.deliveryTypeId||3===this.props.notificationData.push.deliveryType.deliveryTypeId||4===this.props.notificationData.push.deliveryType.deliveryTypeId){let t=[...this.tabs];t.forEach((t=>{t.disable=!1,"TEXT"===this.props.notificationData.push.content[0].contentType&&("Import"!==t.text&&"Template"!==t.text||(t.disable=!0)),"EDM"===this.props.notificationData.push.content[0].contentType&&("Create"!==t.text&&"Template"!==t.text||(t.disable=!0)),"TEMPLATE"===this.props.notificationData.push.content[0].contentType&&("Create"!==t.text&&"Import"!==t.text||(t.disable=!0))})),this.tabs=t}else 1===this.props.notificationData.push.deliveryType.deliveryTypeId&&this.alertDelivaryType()})),ji(this,"componentDidUpdate",(t=>{Is("Update ",this.props.notificationData),t!==this.props&&this.setState({errContent:this.props.notificationError.errContentType,errTitle:this.props.notificationError.errTitle,errSubtitle:this.props.notificationError.errSubtitle,errBody:this.props.notificationError.errBody,errInterActivity1:this.props.notificationError.errInteractivityButton1,errInterActivityButton1:this.props.notificationError.errInteractivityButton1,errInterActivityButton2:this.props.notificationError.errInteractivityButton2,errInterActivity2:this.props.notificationError.errInterActivityButton2,errAlertSound:this.props.notificationError.errAlertSound,errExpiryType:this.props.notificationError.errExpiryType,errExpiryValue:this.props.notificationError.errExpiryValue,errHashtag:this.props.notificationError.errHashTag,errSchedule:this.props.notificationError.errSchdule,errFrequencyType:this.props.notificationError.errFrequencyType,errFrequencyValue:this.props.notificationError.errFrequencyValue})})),ji(this,"CreateInteractivityObject",(t=>({actionName:t,actionId:Ba(t),actionType:t.toLowerCase(),fontColor:"",bgColor:"",url:4===Ma(t)?4:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:Ma(t)}))),ji(this,"GetButtonsForPreview",(t=>{let e=[];return void 0!==t&&t.length>0&&t.forEach((t=>{t.actionName.length>0&&e.push({text:t.actionName,bgColor:t.bgColor,fontColor:t.fontColor})})),e})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"onOpen",(t=>{var e;null==(e=this.contentRef.current)||e.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"header",(t=>{var e,i,s,a;return Ti.jsx("div",{children:Ti.jsx("div",{className:`rs-tabs-with-heading rs-tabs-bg-fill ${-1===this.state.activeTab?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper transition"} stricky-window push-content mb30`,children:Ti.jsxs(Jl,{className:"rs-flat-tabs",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"d-flex align-items-center",children:Ti.jsx(Ao,{right:!0,label:"Push content",className:"font-medium"})}),Ti.jsx(Zl,{md:7,className:"ml0",children:Ti.jsxs("div",{className:"position-relative",children:[(null==(e=this.state.errContent)?void 0:e.length)&&Ti.jsx("div",{className:"rich-content-error validation-message mt-30",children:this.state.errContent}),Ti.jsx(Pi,{defaultSelectedItem:this.state.activeTab,defaultClass:"",dynamicTab:"rs-content-tabs-flat "+(-1===this.state.activeTab?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:this.tabs,callBack:(e,i)=>{[...this.tabs].map((t=>{t!==e&&(t.disable=!0)})),this.setState({errContent:null}),this.props.notificationError.errContentType=null,t.data.push.content[0].contentType=0===i?"TEXT":1===i?"EDM":"TEMPLATE",t.data.push.content[0].body=1===i?"":t.data.push.content[0].body,t.data.push.objectRequestApproval=null,this.setState({activeTab:i})},refresh:""!==(null==(a=null==(s=null==(i=null==t?void 0:t.data)?void 0:i.push)?void 0:s.content[0])?void 0:a.contentType),onRefresh:()=>{this.setState({refreshPopup:!0})}}),this.state.refreshPopup&&Ti.jsxs(_l,{backdrop:"static",show:this.state.refreshPopup,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Note"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({refreshPopup:!1})}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx("p",{children:"This action will clear the content from all the fields."}),Ti.jsx("div",{className:"d-flex justify-content-end",children:Ti.jsx(ns,{onClick:()=>{this.setState({errContent:null,titleValue:"",subTitleValue:"",subTitleEmoji:"",bodyValue:"",bodyTextCount:"",hashTags:[],isInterActivity:!1,titleTextCount:"",subTitleTextCount:"",interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton2Name:"",frequencyValue:"",frequencyType:"",isExpiry:!1,expiryType:"",expiryValue:"",isAlertSound:!1,alertSound:"",schedule:"",editTimeZone:!1,activeTab:-1}),t.data.push.objectRequestApproval=null,t.data.push.content[0].importContent="",t.data.push.content[0].templateId=0,t.data.push.content[0].templateName="",t.data.push.content[0].templateDescription="",t.data.push.content[0].title="",t.data.push.content[0].edmUrl="",t.data.push.content[0].titleColor="",t.data.push.content[0].bgColor="",t.data.push.content[0].subTitle="",t.data.push.content[0].bodyTextColor="",t.data.push.content[0].body="",t.data.push.content[0].hashTag=[],t.data.push.content[0].isInteractivebuttonEnabled=!1,t.data.push.content[0].interActivity=[],t.data.push.content[0].isExpiryButtonEnabled=!1,t.data.push.content[0].pushexpirySchedule="",t.data.push.content[0].pushExpiryhours=0,t.data.push.content[0].isAlertSound=!1,t.data.push.content[0].alertSound="",t.data.push.content[0].timezone="-- Select time zone --",t.data.push.content[0].scheduleDate="",t.data.push.content[0].contentType="",t.data.push.content[0].url="",t.data.push.content[0].body="",t.data.push.content[0].bodyBgColor="",t.data.push.content[0].htmlBody="",t.data.push.content[0].mobTimerTTL="",t.data.push.content[0].mobTimerTextColor="",t.data.push.content[0].mobTimerBgColor="",this.props.notificationError.errContentType=null,this.props.notificationError.errTitle=null,this.props.notificationError.errBody=null,this.props.notificationError.errInteractivityButton1=null,this.props.notificationError.errInteractivityButton2=null,this.props.notificationError.errAlertSound=null,this.props.notificationError.errExpiryType=null,this.props.notificationError.errExpiryValue=null,this.props.notificationError.errHashTag=null,this.props.notificationError.errSchdule=null,this.props.notificationError.errFrequencyType=null,this.props.notificationError.errFrequencyValue=null,t.data.push.content[0].importContent="",this.setState({errContent:this.props.notificationError.errContentType,errTitle:this.props.notificationError.errTitle,errSubtitle:this.props.notificationError.errSubtitle,errBody:this.props.notificationError.errBody,errInterActivity1:this.props.notificationError.errInteractivityButton1,errInterActivityButton1:this.props.notificationError.errInteractivityButton1,errInterActivityButton2:this.props.notificationError.errInteractivityButton2,errInterActivity2:this.props.notificationError.errInterActivityButton2,errAlertSound:this.props.notificationError.errAlertSound,errExpiryType:this.props.notificationError.errExpiryType,errExpiryValue:this.props.notificationError.errExpiryValue,errHashtag:this.props.notificationError.errHashTag,errSchedule:this.props.notificationError.errSchdule,errFrequencyType:this.props.notificationError.errFrequencyType,errFrequencyValue:this.props.notificationError.errFrequencyValue}),this.configureTabs(),this.forceUpdate(),this.setState({refreshPopup:!1})},children:"Ok"})})]})]})]})})]})})})})),ji(this,"RSCAFontColorPlate",((t,e,i,s,a)=>{const[n,l]=Di.useState(e),[o,r]=Di.useState(i);return Ti.jsx(Oo,{anchor:t,selectColor:o,show:n,cancelBtnClicked:()=>{l(!1),s()},applyBtnClicked:t=>{var e=t.split("("),i=parseInt(e[1].split(",")[0]),s=parseInt(e[1].split(",")[1]),n=parseInt(e[1].split(",")[2]),l=Pa(i,s,n);r(t),a(l)}})})),ji(this,"RSCABodyColorPlate",(()=>{})),ji(this,"getHashTagUpdation",(()=>{var t;return(null==(t=this.state.hashTags)?void 0:t.length)+" / 5"})),ji(this,"content",(t=>{var e,i,s,a,n,l,o;const r=this.state.bodyTextCount.replace("/",""),c=t=>{let e="";for(let a=0;a<t.length;a++){const i=t[a];" "!==i&&(e+=i)}let i=0,s=!1;for(let a=0;a<e.length;a++){const t=e[a];"["===t?s=!0:"]"===t?s=!1:s||"|"==t||i++}return i},d=t=>{let e=t.trim(),i=0;for(let s=0;s<e.length;s++){const t=e[s];("["===t||"]"===t)&&i++}return i},p=e=>{t.data.push.content[0].titlePosition=e.target.selectionStart,this.state;let i=e.target.value;c(i);let s=!0;const a=i.split("|");for(const t of a){let e=0;for(const i of t)"["===i?e++:"]"===i&&e--,e<0&&(s=!1);0!==e&&(s=!1)}if(s){let e=t.data.push.content[0];ca(e.title,i,e.titlePosition),t.data.push.content[0].title=i;let s=i.length>0?null:this.state.errTitle;this.setState({titleValue:i,isTitlePerson:!this.state.isTitlePerson,errTitle:s})}else this.setState({errTitle:"In correct type"})},h=e=>{t.data.push.content[0].subTitlePosition=e.target.selectionStart,this.state;let i=e.target.value;c(i);let s=!0;const a=i.split("|");for(const t of a){let e=0;for(const i of t)"["===i?e++:"]"===i&&e--,e<0&&(s=!1);0!==e&&(s=!1)}if(s){let e=t.data.push.content[0];ca(e.title,i,e.titlePosition),t.data.push.content[0].subTitle=i;let s=i.length>0?null:"Enter subtitle";this.setState({subTitleValue:i,isSubTitlePerson:!this.state.isTitlePerson,errSubtitle:s})}else this.setState({errSubtitle:"In correct type"})};return Ti.jsxs(Ti.Fragment,{children:["TEXT"===t.data.push.content[0].contentType?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs($l,{className:"mt30",children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:(this.props.type,"Title")})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{ref:this.titleRef,type:"textarea",required:!0,placeholder:"Title",val:this.state.titleValue,errorMessage:this.state.errTitle,onBlur:t=>{p(t)},onChange:e=>{let i=e.target.value.trimStart();i=i.replace(/\s+/g," "),this.tabs.map((t=>{0!==t.id&&(t.disable=!0)}));let s=c(i);if(s>60)return;let a=s;this.setState({titleTextCount:a}),Is("Cursor Position",e.target.selectionStart);let n=i.length>0?null:Ra;this.props.notificationError.errTitle=n,this.setState({titleValue:i,errTitle:n}),t.data.push.content[0].title=i}})}),Ti.jsx(Zl,{md:4,className:"instant-preview",children:this.state.titleValue.length>0||t.data.push.content[0].body.length>0||t.data.push.content[0].subTitle.length>0||""!=t.data.push.content[0].url?Ti.jsx(bo,{isAuthoring:!0,data:t.data,pushType:this.props.pushType,content:t.data.push.content[0],mobileApp:this.props.mobileApp,title:this.state.titleValue,titleColor:t.data.push.content[0].titleColor,bodyColor:t.data.push.content[0].bodyBgColor,bodyFontColor:t.data.push.content[0].bodyTextColor,body:t.data.push.content[0].body,subTitle:""!==t.data.push.content[0].subTitle?t.data.push.content[0].subTitle:"",subTitleColor:void 0!==t.data.push.content[0].subTitleColor&&""!==t.data.push.content[0].subTitleColor?t.data.push.content[0].subTitleColor:"",type:this.props.type,imageSrc:t.data.push.content[0].url,customArray:(this.props.type,this.GetButtonsForPreview(t.data.push.content[0].interActivity))}):null})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"justify-content-between",children:[Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx(Hi,{items:Oc,text:Ti.jsx(ws,{text:"Personalize",position:"top",children:Ti.jsx("i",{className:"icon-rs-user-question-mark-edge-medium color-primary-blue icons-md"})}),onItemClick:e=>{t.data.push.content[0];const i=e.item.text.replace(/\[\[|\]\]/g,"");var s=`${i} NOTFOUND`;i.includes("NAME")&&(s="CUSTOMER");let a=`[[${i}]] | [[${s}]] `;const n=[];n.push(this.state.titleValue,a);const l=n.filter((t=>""!==t)),o=n.filter((t=>""!==t)).join("");t.data.push.content[0].title=o;let r=d(o);if(r<=40){let t=e.item.text.length>0?null:this.state.errTitle;this.setState({titleValue:o,titleValueDublicate:l,isTitlePerson:!this.state.isTitlePerson,errTitle:t,personalizeChooseCount:r})}else this.setState({errTitle:"Only 5 personalize add"})}}),Ti.jsxs(Xi,{className:"ml15 position-relative rsp-icon-group top3",children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.emojianochor,onClick:()=>{this.buttonClick(2),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}})})}),"web"!==this.props.type&&3!==this.props.pushJson.push.deliveryType.deliveryTypeId?Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative top2",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(3)})}),3===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);t.data.push.content[0].interActivity[0].fontColor=s,this.setState({clicked:0})}})}):null]}):null,"web"===this.props.type&&2===this.props.pushType?Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative top2",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(3)})}),3===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);this.setState({titleColor:s}),t.data.push.content[0].titleColor=s,this.setState({clicked:0})}})}):null]}):null]})]}),Ti.jsx(Po,{className:`${60===this.state.titleTextCount&&"red"}`,text:0===this.state.titleTextCount?"60":this.state.titleTextCount+"/60"})]})})})]}),"mobile"===this.props.type&&1===this.props.pushJson.push.deliveryType.deliveryTypeId?Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Subtitle"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{type:"textarea",maxLength:15,placeholder:"Subtitle",val:this.state.subTitleValue,errorMessage:this.state.errSubtitle,onBlur:t=>{h(t)},onChange:e=>{let i=e.target.value.trimStart();i=i.replace(/\s+/g," "),this.tabs.map((t=>{0!==t.id&&(t.disable=!0)}));let s=c(i);if(s>60)return;let a=s;this.setState({subTitleTextCount:a}),Is("Cursor Position",e.target.selectionStart);let n=i.length>0?null:"Enter subtitle";this.props.notificationError.errTitle=n,this.setState({subTitleValue:i,errSubtitle:n}),t.data.push.content[0].subTitle=i+this.state.subTitleEmoji}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"justify-content-between",children:[Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx(ws,{text:"Personalize",position:"top",children:Ti.jsx(Hi,{items:Oc,icon:" icon-rs-user-question-mark-edge-medium color-primary-blue icons-md",onItemClick:e=>{const i=e.item.text.replace(/\[\[|\]\]/g,"");let s=`[[${i}]] | [[${i}_NOTFOUND]] `;const a=[];a.push(this.state.subTitleValue,s);const n=a.filter((t=>""!==t)).join("");t.data.push.content[0].subTitle=n;let l=""!=n?null:"Enter subtitle";d(n)<=40?this.setState({subTitleValue:n,isSubTitlePerson:!this.state.isSubTitlePerson,errSubtitle:l}):this.setState({errSubtitle:"Only 5 personalize add"})}})}),Ti.jsx(Xi,{className:"ml10",children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.subTitleEmojiAnochor,onClick:()=>{this.buttonClick(8),this.setState({isSubtitleEmoji:!this.state.isSubtitleEmoji})}})})})})]}),Ti.jsx(Po,{className:`${60===this.state.subTitleTextCount&&"red"}`,text:0===this.state.subTitleTextCount?"/60":this.state.subTitleTextCount+"/60"})]})})})]}):null,Ti.jsx($l,{className:"mb10",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Body"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsxs("div",{className:"position-relative",children:[this.state.errBody&&Ti.jsx("div",{className:"validation-message align-end body-text",children:this.state.errBody}),"mobile"===this.props.type?Ti.jsx(Bc,{...this.props,data:t.data,notificationData:t.data.push.content[0],mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.push.content[0].htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){let e=s.length>0?null:yn,a=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null;s.length>0&&s.length.toString();let o=l>0?l.toString()+"/":"";this.setState({errBody:a,bodyTextCount:o}),this.props.notificationError.errBody=e,gn(i),t.data.push.content[0].body=bn(i),t.data.push.content[0].htmlBody=bn(i),""!==t.data.push.content[0].bodyTextColor&&(t.data.push.content[0].body=bn(i),t.data.push.content[0].htmlBody=bn(i))}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.push.content[0].htmlBody+"</font>",r=`<span color="${i}">`+t.data.push.content[0].htmlBody+"</span>";gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`),t.data.push.content[0].body=bn(r),t.data.push.content[0].bodyTextColor=i,t.data.push.content[0].htmlBody=bn(r)}else"url"===e?t.data.push.content[0][e]=i:"onBlur"===e?(t.data.push.content[0].bodyPosition=i.target.selectionStart,n&&this.setState({errBody:n})):"bodyBgColor"===e?t.data.push.content[0].bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(e,i)=>{t.data.push.content[0][e]=i,this.forceUpdate()}}):null,"web"==this.props.type&&"In page overlay"==this.props.notificationData.push.pushType.deliveryTypeValue?Ti.jsx(Bc,{...this.props,data:t.data,notificationData:t.data.push.content[0],mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.push.content[0].htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){let e=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null,a=l>0?l.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.notificationError.errBody=e;let o=gn(i);t.data.push.content[0].body=bn(o),t.data.push.content[0].htmlBody=bn(i),""!==t.data.push.content[0].bodyTextColor&&(t.data.push.content[0].body=bn(i),t.data.push.content[0].htmlBody=bn(i))}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.push.content[0].htmlBody+"</font>",r=`<span color="${i}">`+t.data.push.content[0].htmlBody+"</span>";gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`),t.data.push.content[0].body=bn(r),t.data.push.content[0].bodyTextColor=i,t.data.push.content[0].htmlBody=bn(r)}else"url"===e?t.data.push.content[0][e]=i:"onBlur"===e?n&&(this.setState({errBody:n}),t.data.push.content[0].bodyPosition=i.target.selectionStart):"bodyBgColor"===e?t.data.push.content[0].bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(e,i)=>{t.data.push.content[0][e]=i,this.forceUpdate()}}):null,"web"==this.props.type&&"Alert / Rich push"==this.props.notificationData.push.pushType.deliveryTypeValue&&1==this.props.notificationData.push.pushType.deliveryTypeId?Ti.jsx(uc,{onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},notificationData:t.data.push.content[0],onClickCouponBtnClick:t=>{this.setState({isCouponCodeBtnClicked:t})},mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,bodyContent:t.data.push.content[0].body,pushTypeID:this.props.pushTypeId,callBack:(e,i,s,a,n)=>{if("bodytext"===e){let e=0==i&&""==n?yn:"Add only 5 personalization"==s||"In correct type"==s?s:null,a=0!=i&&"Add only 5 personalization"==s?"":0!=i?n.length.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.notificationError.errBody=e,"Add only 5 personalization"!=s&&(t.data.push.content[0].body=n)}else"bodyTextColor"===e?t.data.push.content[0].bodyTextColor=i:"url"===e?t.data.push.content[0][e]=i:"onBlur"===e?(t.data.push.content[0].bodyPosition=i.target.selectionStart,s&&this.setState({errBody:s})):"bodyBgColor"===e&&(t.data.push.content[0].bodyBgColor=i);this.forceUpdate()}}):null]}),this.state.bodyTextCount?Ti.jsx(Po,{right:!0,text:350===Number(r)?Ti.jsxs("span",{children:["Maximum character limit reached ",Ti.jsx("span",{className:"color-dark-red font-bold",children:"350"})," "]}):Number(r)>299?Ti.jsxs("span",{children:["Available ",Ti.jsx("span",{className:"blue",children:Number(r)-350})," characters only ",Ti.jsx("span",{className:"color-medium-orange font-bold",children:this.state.bodyTextCount+"350"})," "]}):Ti.jsx("span",{children:this.state.bodyTextCount+"350"})}):Ti.jsx(Po,{right:!0,text:"Upto 350 characters are allowed."})]})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Interactivity"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:e=>{e.target.value?(t.data.push.content[0].isInteractivebuttonEnabled=e.target.value,t.data.push.content[0].interActivityButton1Name="",t.data.push.content[0].interActivityButton2Name="",this.setState({isInterActivity:e.target.value,errInterActivityButton1:null,errInterActivityButton2:null}),t.data.push.content[0].interActivity[0]=this.CreateInteractivityObject("")):(this.setState({isFirstCustomButtonChoose:!1,addBtnClick:!1,isInterActivity:e.target.value,interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton1Name:"-- Select --",interActivityButton2Name:"-- Select --",frequencyType:"",frequencyValue:""}),t.data.push.content[0].isInteractivebuttonEnabled=e.target.value,t.data.push.content[0].interActivity=[])},checked:this.state.isInterActivity})})]})}),!0===this.state.isInterActivity?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:["Button"],value:"Button",label:"Interactivity type",required:!0,handleChange:t=>{this.setState({interActivityButton1:t.target.value})}})}),"Button"===this.state.interActivityButton1?Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),value:void 0!==this.state.interActivityButton1Name&&""!==this.state.interActivityButton1Name?this.state.interActivityButton1Name:"-- Select --",label:"Interactive actions",required:!0,errorMessage:this.state.errInterActivityButton1,handleChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isFirstCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isFirstCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:fn;this.setState({errInterActivityButton1:s}),this.props.notificationError.errInteractivityButton1=s,2===t.data.push.content[0].interActivity.length||null!==t.data.push.content[0].interActivity[0]?t.data.push.content[0].interActivity[0]=i:t.data.push.content[0].interActivity.push(i),t.data.push.content[0].interActivityButton1Name=e.target.value,this.setState({interActivityButton1Name:e.target.value,frequencyType:"",frequencyValue:""})}})}):null]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:"Button"===this.state.interActivityButton1?Ti.jsxs(Xi,{children:["web"!==this.props.type&&""!==this.state.interActivityButton1Name&&"-- Select --"!==this.state.interActivityButton1Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(4)})}),4===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);this.setState({titleColor:s}),t.data.push.content[0].interActivity[0].fontColor=s,this.setState({clicked:0})}})}):null]}),2===this.props.pushType||1===this.props.pushType?Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(5)})}),5===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]),ha(e),t.data.push.content[0].interActivity[0].bgColor=ha(e),this.setState({clicked:0})}})}):null]})}):null]}):null,"web"===this.props.type&&2===this.props.pushType&&""!==this.state.interActivityButton1Name&&"-- Select --"!==this.state.interActivityButton1Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(4)})}),4===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);this.setState({titleColor:s}),t.data.push.content[0].interActivity[0].fontColor=s,this.setState({clicked:0})}})}):null]}),Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(5)})}),5===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].titleColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);this.setState({bgColor:s}),t.data.push.content[0].interActivity[0].bgColor=ha(e),this.setState({clicked:0})}})}):null]})]}):null,this.state.isFirstCustomButtonChoose?Ti.jsx(Qi,{tooltip:"Configure custom action",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{let e=t.data.push.content[0].interActivity[0];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal,isFirstCustomButton:!this.state.isFirstCustomButton})}}):null,Ti.jsx(Qi,{tooltip:"Add",icon:`icon-rs-circle-plus-fill-edge-medium ${this.state.addBtnClick&&"click-off"}`,size:"md",onClick:()=>{0!==t.data.push.content[0].interActivity.length&&""!==t.data.push.content[0].interActivity[0].actionName?(t.data.push.content[0].interActivity[1]=this.CreateInteractivityObject(""),this.setState({addBtnClick:!0,frequencyType:"",frequencyValue:""})):this.setState({errInterActivityButton1:fn})}})]}):null})})]})}),"Maybe later"===t.data.push.content[0].interActivityButton1Name?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:$c,required:!0,label:"Frequency type",errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.notificationError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.push.content[0].interActivity[0].reschedule=e.target.value,t.data.push.content[0].interActivity[0].maybeLaterTimeings=e.target.value}})}),Ti.jsx(Zl,{children:Ti.jsx(ql,{placeholder:"Frequency time",required:!0,val:this.state.frequencyValue,keyboardType:"number",max:jl,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.notificationError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[0].interactivehours=parseInt(e),t.data.push.content[0].interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[0].interactivehours=parseInt(e),t.data.push.content[0].interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[0].interactivehours=parseInt(e),t.data.push.content[0].interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType)},errorMessage:this.state.errFrequencyValue})})]})})})}):null,!0===this.state.addBtnClick?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:["Button"],value:void 0!==this.state.interActivityButton2&&""!==this.state.interActivityButton2?this.state.interActivityButton2:"-- Select  --",label:"Interactivity type",required:!0,onChange:t=>{this.setState({interActivityButton2:t.target.value})}})}),"Button"===this.state.interActivityButton2?Ti.jsx(Zl,{className:"position-relative",children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errInterActivityButton2&&Ti.jsx("div",{className:"validation-message",children:this.state.errInterActivityButton2}),Ti.jsx(Ul,{data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),label:"Interactive actions",required:!0,value:void 0!==this.state.interActivityButton2Name&&""!==this.state.interActivityButton2Name?this.state.interActivityButton2Name:"-- Select --",onChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isSecondCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isSecondCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:Sn;this.setState({errInterActivityButton2:s}),this.props.notificationError.errInteractivityButton2=s,2===t.data.push.content[0].interActivity.length?t.data.push.content[0].interActivity[1]=i:null===t.data.push.content[0].interActivity[1]?t.data.push.content[0].interActivity.push(i):t.data.push.content[0].interActivity[1]=i,t.data.push.content[0].interActivityButton2Name=e.target.value,this.setState({interActivityButton2Name:e.target.value})}})]})}):null]})}),Ti.jsx(Zl,{md:2,children:this.state.addBtnClick&&"Button"===this.state.interActivityButton2?Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:["web"===this.props.type&&2===this.props.pushType&&""!==this.state.interActivityButton2Name&&"-- Select --"!==this.state.interActivityButton2Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(6)})}),6===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:null==(e=t.data.push.content[0])?void 0:e.interActivity[1].fontColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);t.data.push.content[0].interActivity[1].fontColor=s,this.setState({clicked:0})}})}):null]}),Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(7)})}),7===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].interActivity[1].bgColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]);var s=ha(e);this.setState({bgColor:s}),t.data.push.content[0].interActivity[1].bgColor=ha(e),this.setState({clicked:0})}})}):null]})]}):null,"web"!==this.props.type&&""!==this.state.interActivityButton2Name&&"-- Select --"!==this.state.interActivityButton2Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca2FontColorAnochor,onClick:()=>this.buttonClick(6)})}),6===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].interActivity[1].fontColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]),ha(e),t.data.push.content[0].interActivity[1].fontColor=ha(e),this.setState({clicked:0})}})}):null]}),2===this.props.pushType||1===this.props.pushType?Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"rsp-icon rsp-icon-md",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca2BackgroundColorAnochor,onClick:()=>this.buttonClick(7)})}),7===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,selectColor:t.data.push.content[0].interActivity[1].bgColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0,isShow:!1})},applyBtnClicked:e=>{var i=e.split("(");parseInt(i[1].split(",")[0]),parseInt(i[1].split(",")[1]),parseInt(i[1].split(",")[2]),ha(e),t.data.push.content[0].interActivity[1].bgColor=ha(e),this.setState({clicked:0})}})}):null]})}):null]}):null,this.state.isSecondCustomButtonChoose?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Qi,{tooltip:"Configure custom action",icon:Cn,size:"md",onClick:()=>{let e=t.data.push.content[0].interActivity[1];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal})}})}):null,Ti.jsx(Qi,{tooltip:"Remove",icon:ea,size:"md",color:"red",onClick:()=>{this.setState({addBtnClick:!1,clicked:0,interActivityButton2Name:"",isSecondCustomButtonChoose:!1});let e=Bs(t.data.push.content[0].interActivity);t.data.push.content[0].interActivity=Bs([e[0]]),this.forceUpdate()}})]})}):null})]})}):null,!0===this.state.addBtnClick&&"Maybe later"===t.data.push.content[0].interActivityButton2Name?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:$c,label:"Frequency type",required:!0,errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.notificationError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.push.content[0].interActivity[1].reschedule=e.target.value,t.data.push.content[0].interActivity[1].maybeLaterTimeings=e.target.value}})}),Ti.jsx(Zl,{children:Ti.jsx(ql,{placeholder:"Frequency time",required:!0,keyboardType:"number",val:this.state.frequencyValue,max:jl,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.notificationError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[1].interactivehours=parseInt(e),t.data.push.content[0].interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[1].interactivehours=parseInt(e),t.data.push.content[0].interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(this.setState({frequencyValue:e}),t.data.push.content[0].interActivity[1].interactivehours=parseInt(e),t.data.push.content[0].interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType)},errorMessage:this.state.errFrequencyValue})})]})})})}):null]}):null,"mobile"===this.props.type?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Alert sound"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:e=>{t.data.push.content[0].isAlertSound=e.target.value,t.data.push.content[0].alertSound="",this.setState({isAlertSound:e.target.value,alertSound:"",alertEnter:!1}),this.props.notificationError.errAlertSound=null,this.setState({errAlertSound:null})},checked:this.state.isAlertSound})}),!0===this.state.isAlertSound&&Ti.jsx(Zl,{})]})}),!0===this.state.isAlertSound?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:!0===this.state.alertEnter?Ti.jsx(ql,{errorMessage:this.state.errAlertSound,className:"paddingR30",required:!0,placeholder:"Enter sound name",val:this.state.alertSound,iconPlaceholder:!0,iconName:ba,iconColor:"red",iconSize:"sm",handleOnchange:e=>{if(e.length>50)return;let i=e.length>0?null:fa;this.setState({errAlertSound:i,alertSound:e}),this.props.notificationError.errAlertSound=i,t.data.push.content[0].alertSound=e},handleOnBlur:e=>{let i=e.length>0?null:fa;this.setState({errAlertSound:i,alertSound:e}),this.props.notificationError.errAlertSound=i,t.data.push.content[0].alertSound=e},iconOnClick:()=>{this.setState({alertEnter:!1,alertSound:"",errAlertSound:null}),t.data.push.content[0].alertSound="",this.props.notificationError.errAlertSound=null}}):Ti.jsx(Ul,{data:Vc,required:!0,label:"Alert sound",value:void 0!==this.state.alertSound&&""!==this.state.alertSound?this.state.alertSound:"-- Select --",handleChange:e=>{if(e.target.value.toLowerCase().includes("enter"))return this.props.notificationError.errAlertSound=null,this.setState({errAlertSound:null}),void this.setState({alertEnter:!0,alertSound:""});let i=e.target.value.length>0?null:fa;this.setState({errAlertSound:i}),this.props.notificationError.errAlertSound=i,t.data.push.content[0].alertSound=e.target.value,this.setState({alertSound:e.target.value})}})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"Select or input the name of a sound available in the app. If the sound file is not available, the default sound will be played. To add sound file contact app development team and ensure the file name is the same for both Android and iOS",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})}):null]}):null,Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Expiry"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:e=>{t.data.push.content[0].isExpiryButtonEnabled=e.target.value,this.setState({isExpiry:e.target.value}),this.setState({errExpiryType:null}),this.props.notificationError.errExpiryType=null,t.data.push.content[0].pushexpirySchedule="",t.data.push.content[0].pushExpiryhours=0,this.setState({expiryValue:""}),this.setState({expiryType:""})},checked:this.state.isExpiry})})]})}),!0===this.state.isExpiry?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{xs:6,children:Ti.jsx(Ul,{data:zc,label:"Expiry duration",required:!0,errorMessage:this.state.errExpiryType,value:void 0!==this.state.expiryType&&""!==this.state.expiryType?"H"===this.state.expiryType?"Hour(s)":"Day(s)":"-- Select --",handleChange:e=>{let i=e.target.value.length>0?null:ya;this.setState({errExpiryType:i}),this.props.notificationError.errExpiryType=i,t.data.push.content[0].pushexpirySchedule="Hour(s)"===e.target.value?"H":"D",t.data.push.content[0].pushExpiryhours="",this.setState({expiryValue:""}),this.setState({expiryType:t.data.push.content[0].pushexpirySchedule})}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{required:!0,placeholder:"Value",val:this.state.expiryValue,keyboardType:"number",max:Tl,handleOnchange:e=>{let i=e.length>0?null:ga;this.setState({errExpiryValue:i}),this.props.notificationError.errExpiryValue=i,""!==t.data.push.content[0].pushexpirySchedule&&"D"===t.data.push.content[0].pushexpirySchedule&&(""!==e?e.length<=3&&parseInt(e)<=100&&(t.data.push.content[0].pushExpiryhours=e,this.setState({expiryValue:e})):(t.data.push.content[0].pushExpiryhours="",this.setState({expiryValue:""}))),""!==t.data.push.content[0].pushexpirySchedule&&"H"===t.data.push.content[0].pushexpirySchedule&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(t.data.push.content[0].pushExpiryhours=e,this.setState({expiryValue:e})),""!==t.data.push.content[0].pushexpirySchedule&&"Minute(s)"===t.data.push.content[0].pushexpirySchedule&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(t.data.push.content[0].pushExpiryhours=e,this.setState({expiryValue:e}))},handleOnBlur:e=>{"H"===t.data.push.content[0].pushexpirySchedule?""!==e&&0!==parseInt(e)||this.setState({errExpiryValue:"Enter the hours for expiry"}):""!==e&&0!==parseInt(e)||this.setState({errExpiryValue:"Enter the days for expiry"})},errorMessage:this.state.errExpiryValue})})]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(Mo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"Set an expiry time to control when messages are delivered, making it perfect for time-sensitive communications",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})}):null,Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"#Hashtags"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsx("div",{className:"chips-input-container",children:Ti.jsx(Fl,{label:"Hashtags",noDropdown:!0,value:this.state.hashTags,data:qc,allowCustom:!0,onChange:e=>{if(e.target.value.length>5)return;let i=[];e.target.value.length>0&&(e.target.value.filter((t=>""!==Ls(t))),e.target.value.map(((t,s)=>{let a=Ls(t);!ss(a)&&a.length<=15?(t=a,i.push(a)):e.target.value.splice(s,1)})));let s=[...i];s=s.map(((t,e)=>t.includes("#")?t:"#"+t));let a=$a(e);const n=a.reduce(((t,e)=>t.find((t=>t===e))?t:t.concat([e])),[]);this.setState({hashTags:n}),t.data.push.content[0].hashTag=a}})}),Ti.jsx("small",{class:`rs-form-small-text fs12 d-inline-block text-end w-100 ${5===(null==(i=this.state.hashTags)?void 0:i.length)&&"red"}`,children:`${5===(null==(s=this.state.hashTags)?void 0:s.length)?Ha:""}  ${(null==(a=this.state.hashTags)?void 0:a.length)>0?this.getHashTagUpdation():" 0 / 5"}`})]}),Ti.jsx(Zl,{md:2,children:Ti.jsx(Mo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"View analytics for trending topics",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})})]}):"EDM"===t.data.push.content[0].contentType&&Ti.jsx(Dc,{type:this.props.type,isCarousel:!1,content:t.data.push.content[0],error:this.props.notificationError,smartAppStore:this.props.smartAppStore,bodyData:t.data.push.content[0].body,importContent:(null==(o=null==(l=null==(n=null==t?void 0:t.data)?void 0:n.push)?void 0:l.content[0])?void 0:o.importContent)||"",getBodyContent:(e,i)=>{t.data.push.content[0].body=i,t.data.push.content[0].importContent=i;let s=e.length>0?null:Ra;this.props.notificationError.errBody=s},emptyData:(e,i)=>{t.data.push.content[0].body=i,t.data.push.content[0].importContent=i},onChange:e=>{t.data.push.content[0].makeAlert=e.makeAlert,t.data.push.content[0].title=e.title,t.data.push.content[0].edmUrl=e.edmUrl,t.data.push.content[0].shortDesc=e.shortDesc,t.data.push.content[0].hashTag=e.hashTag,t.data.push.content[0].isInteractivebuttonEnabled=e.isInterActivity,t.data.push.content[0].interActivity=e.interActivity,t.data.push.content[0].isAlertSound=e.isAlertSound,t.data.push.content[0].alertSound=e.alertSound,t.data.push.content[0].isExpiryButtonEnabled=e.isExpiry,t.data.push.content[0].pushexpirySchedule=e.expiryType,t.data.push.content[0].pushExpiryhours=e.expiryValue,this.props.notificationError.errInteractivityButton1=null,this.props.notificationError.errInteractivityButton2=null}}),this.ScheduleContainer(t),Ti.jsx(Ac,{status:this.props.testPerviewStatus,isTestPreview:this.props.isTestPreview,channel:this.props.type.includes("web")?"web push":"mobile push",notificationData:this.props.notificationData,sendTestPreview:t=>{this.props.sendTestPreview(t)},sendRFA:t=>{this.props.sendRFA(t)},isRequestApproval:t=>{this.props.isRequestApproval(t)},approverCreated:t=>{this.props.approverCreated(t)},prepareData:t=>{this.props.prepareData(t)}}),this.state.isCouponCodeBtnClicked&&Ti.jsx(vc,{isOpen:this.state.isCouponCodeBtnClicked,onChangeIsOpen:()=>{this.setState({isCouponCodeBtnClicked:!1})}}),!0===this.state.isOpenCustomButtonModal?Ti.jsx(kc,{dynamicListId:this.props.dynamicListId,isOpen:this.state.isOpenCustomButtonModal,isWeb:"web"===this.props.type,smartAppStore:this.props.smartAppStore,selectInterActivity:this.state.interActivityObject,showSmartLink:()=>{this.props.showSmartLink()},onChangeIsOpen:t=>{this.setState({isOpenCustomButtonModal:t})},onSaveClick:e=>{if(this.setState({isOpenCustomButtonModal:!1}),this.state.isFirstCustomButton){t.data.push.content[0].interActivity[0].actionName=e.actionName,t.data.push.content[0].interActivity[0].actionType=e.actionType,t.data.push.content[0].interActivityButton1Name=e.actionName,t.data.push.content[0].interActivity[0].url=e.url,t.data.push.content[0].interActivity[0].clickBehavourValue=e.clickBehavourValue,t.data.push.content[0].interActivity[0].countryCode=e.countryCode;let i=e.actionName.length>0?null:fn;this.setState({errInterActivityButton1:i}),this.props.notificationError.errInteractivityButton1=null,this.setState({interActivityButton1Name:e.actionName,isFirstCustomButton:!this.state.isFirstCustomButton})}else{t.data.push.content[0].interActivity[1].actionName=e.actionName,t.data.push.content[0].interActivity[1].actionType=e.actionType,t.data.push.content[0].interActivityButton2Name=e.actionName,t.data.push.content[0].interActivity[1].url=e.url;let i=e.actionName.length>0?null:Sn;this.setState({errInterActivityButton2:i}),t.data.push.content[0].interActivity[1].url=e.url,t.data.push.content[0].interActivity[1].clickBehavourValue=e.clickBehavourValue,t.data.push.content[0].interActivity[1].countryCode=e.countryCode,this.props.notificationError.errInteractivityButton2=null,this.setState({interActivityButton2Name:e.actionName})}}}):null,1===this.state.clicked?Ti.jsx($i,{anchor:this.anchor.current,show:this.state.isShow,popupClass:"popup-content",style:{width:100},children:Ti.jsx("div",{className:"dropBtn",children:Ti.jsx(Hi,{items:["Value 1","Value 2","Value 3"],className:"icon-dropmenu-medium icons-sm kendo-icon-btn",icon:"arrow-60-down",onItemClick:e=>{if(this.setState({clicked:0}),this.state.isTitlePerson){if(t.data.push.content[0].title.length>=60)return;let i=ca(t.data.push.content[0].title,e.item,t.data.push.content[0].titlePosition);t.data.push.content[0].title=i,this.setState({titleValue:i}),this.setState({isTitlePerson:!this.state.isTitlePerson})}else{if(t.data.push.content[0].subTitle.length>=60)return;let i=ca(t.data.push.content[0].subTitle,e.item,t.data.push.content[0].subTitlePosition);t.data.push.content[0].subTitle=i,this.setState({subTitleValue:i}),this.setState({isSubTitlePerson:!this.state.isSubTitlePerson})}}})})}):null,2===this.state.clicked?Ti.jsx(oc,{anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{if(this.state.titleValue.length<=58){let i=t.data.push.content[0];t.data.push.content[0].title=ca(i.title,e,i.titlePosition);let s=t.data.push.content[0].title.length>0?null:"Enter title";t.data.push.content[0].titlePosition=t.data.push.content[0].titlePosition+2;let a=this.state.titleTextCount+2;this.setState({titleValue:t.data.push.content[0].title,errTitle:s,titleTextCount:a}),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}},emojiClose:()=>{this.setState({isShow:!1})}}):null,9===this.state.clicked?Ti.jsx(Oo,{anchor:this.subTitleFontColorAnchor,show:this.state.isShow,selectColor:t.data.push.content[0].subTitleColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]);Pa(s,a,n),t.data.push.content[0].subTitleColor=e}}):null,8===this.state.clicked?Ti.jsx(oc,{anchor:this.subTitleEmojiAnochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{if(this.state.subTitleValue.length<=58){let i=t.data.push.content[0];t.data.push.content[0].subTitle=ca(i.subTitle,e,i.subTitlePosition),t.data.push.content[0].subTitlePosition=t.data.push.content[0].subTitlePosition+2;let s=this.state.subTitleTextCount+2;this.setState({subTitleTextCount:s,isSubtitleEmoji:!this.state.isSubtitleEmoji,subTitleEmoji:e,subTitleValue:t.data.push.content[0].subTitle})}},emojiClose:()=>{this.setState({isShow:!1})}}):null]})})),ji(this,"ScheduleContainer",(t=>{var e,i,s,a;return Ti.jsx(Ti.Fragment,{children:0===this.props.dynamicListId&&Ti.jsxs($l,{className:"rs-tabs-bg-fill even",children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"py20",children:Ti.jsx(Ao,{right:!0,label:"Schedule"})}),Ti.jsxs(Zl,{md:6,className:"py20",children:[Ti.jsx(Vo,{name:"schedulerName",placeholder:"Select schedule date and time",errorMessage:this.state.errSchedule,format:!0===(null==(i=null==(e=fs())?void 0:e.timeFormat)?void 0:i.includes("24"))?{skeleton:"yMMMdEHmSs"}:"MMM dd, yyyy:HH:mm a",min:tn(this.state.campaignStartDate,2),max:en(new Date(ao(this.props.campaignPlan.endDate).add(0,"day").toString())),steps:{minute:2,second:10},value:""!==this.state.schedule?new Date(this.state.schedule):null,handleChange:e=>{const i=(new Date).toLocaleString([],{timeZone:this.state.timeZone.timezoneValue,hour12:!1}),[s,a]=i.split(", "),[n,l,o]=a.split(":"),r=new Date;r.setHours(n),r.setMinutes(l),r.setSeconds(o);var c=r;e.target.value>c?(this.props.notificationError.errSchedule=null,t.data.push.content[0].localScheduleTime=ao(e.target.value).format("yyyy-MM-DD HH:mm:ss"),t.data.push.content[0].scheduleDate=e.target.value.toISOString().slice(0,19).replace("T"," "),this.setState({schedule:e.target.value,errSchedule:null})):(this.setState({errSchedule:"Selected value lesser than current date and time"}),setTimeout((()=>{this.props.data.push.content[0].scheduleDate="",this.setState({errSchedule:null,schedule:""})}),2e3))}}),""!==this.state.schedule&&Ti.jsx("div",{className:"input-inner-set right52 zIndex2",children:Ti.jsx("i",{className:"icon-rs-close-mini icons-sm red posr bottom-10 right0 fs13",onClick:()=>{t.data.push.content[0].scheduleDate="",this.setState({schedule:""})}})}),Ti.jsx(Jl,{className:"marginT5",children:!1===this.state.editTimeZone?Ti.jsx(Zl,{children:Ti.jsxs("div",{className:"float-end d-flex align-items-center",children:[Ti.jsx("small",{className:"fs12",children:this.state.timeZone.offSet}),Ti.jsx(Xi,{children:Ti.jsx(Qi,{tooltip:"Select time zone",icon:"icon-rs-pencil-edit-mini",size:"sm",onClick:()=>{this.setState({editTimeZone:!0})}})})]})}):null})]}),Ti.jsx(Zl,{md:2,className:"py20"})]}),this.state.editTimeZone?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pt23",children:Ti.jsx(Ao,{right:!0,label:"Select time zone"})}),Ti.jsx(Zl,{md:6,className:"pt23",children:Ti.jsx(Ul,{required:!0,textField:"timezoneName",dataItemKey:"timezoneId",label:"Timezone",data:this.state.timeZoneList,value:(null==(s=this.state)?void 0:s.timeZone)||{timezoneId:0,timezoneName:"-- Select timezone --"},handleChange:e=>{this.setState({timeZone:e.target.value});const i=(new Date).toLocaleString([],{timeZone:e.target.value.timezoneValue,hour12:!1}),[s,a]=i.split(", "),[n,l,o]=s.split("/"),[r,c,d]=a.split(":"),p=new Date;p.setHours(r),p.setMinutes(c),p.setSeconds(d);let h=new Date;h.setDate(n),h.setMonth(parseInt(l)-1),h.setFullYear(o),h.setHours(r),h.setMinutes(c),h.setSeconds(d),t.data.push.content[0].timezoneId=e.target.value.timezoneId;var u=p;""!==this.state.schedule&&this.state.schedule>u||(this.setState({errSchedule:"Selected value lesser than current date and time"}),setTimeout((()=>{t.data.push.content[0].scheduleDate="",this.setState({errSchedule:null,schedule:""})}),2e3))}})}),Ti.jsx(Zl,{md:2,className:"pt23"})]}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pb20"}),Ti.jsx(Zl,{md:6,className:"pb20",children:Ti.jsx("div",{className:(null==(a=this.state.timeZone)?void 0:a.isDayLight)?"":"click-off",children:Ti.jsx(Vl,{lbl:"Daylight saving",checked:this.state.isDaylightSaving,cb:t=>{this.setState({isDaylightSaving:!this.state.isDaylightSaving})}})})}),Ti.jsx(Zl,{md:2,className:"pb20"})]})]}):null]})})})),ji(this,"templateComponent",(t=>{var e,i,s,a,n,l;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Rc,{index:0,type:this.props.type,isCarousel:!1,fullData:t.data,content:t.data.push.content[0],error:this.props.notificationError,smartAppStore:this.props.smartAppStore,bodyData:null==(s=null==(i=null==(e=null==t?void 0:t.data)?void 0:e.push)?void 0:i.content[0])?void 0:s.body,importContent:(null==(l=null==(n=null==(a=null==t?void 0:t.data)?void 0:a.push)?void 0:n.content[0])?void 0:l.importContent)||"",timezoneData:this.state.timeZone,getBodyContent:(e,i)=>{t.data.push.content[0].body=i;let s=e.length>0?null:Ra;this.props.notificationError.errBody=s},emptyData:(e,i)=>{t.data.push.content[0].body=i,t.data.push.content[0].importContent=i},onChange:e=>{t.data.push.content[0].makeAlert=e.makeAlert,t.data.push.content[0].title=e.title,t.data.push.content[0].edmUrl=e.edmUrl,t.data.push.content[0].shortDesc=e.shortDesc,t.data.push.content[0].hashTag=e.hashTag,t.data.push.content[0].isInteractivebuttonEnabled=e.isInterActivity,t.data.push.content[0].interActivity=e.interActivity,t.data.push.content[0].isAlertSound=e.isAlertSound,t.data.push.content[0].alertSound=e.alertSound,t.data.push.content[0].isExpiryButtonEnabled=e.isExpiry,t.data.push.content[0].pushexpirySchedule=e.expiryType,t.data.push.content[0].pushExpiryhours=e.expiryValue,this.props.notificationError.errInteractivityButton1=null,this.props.notificationError.errInteractivityButton2=null}}),this.ScheduleContainer(t),Ti.jsx(Ac,{status:this.props.testPerviewStatus,isTestPreview:this.props.isTestPreview,channel:this.props.type.includes("web")?"web push":"mobile push",notificationData:this.props.notificationData,sendTestPreview:t=>{this.props.sendTestPreview(t)},isRequestApproval:t=>{this.props.isRequestApproval(t)},sendRFA:t=>{this.props.sendRFA(t)},approverCreated:t=>{this.props.approverCreated(t)},prepareData:t=>{this.props.prepareData(t)}})]})})),ji(this,"sendButtonClicked",(()=>{""===this.state.approverName.brandId.toLowerCase()||this.state.approverName.brandId.toLowerCase().includes("enter")?this.setState({approverErr:"Enter brand id"}):this.props.sendTestPreview(this.state.approverName.brandId)})),ji(this,"dbData",fs()),ji(this,"validateAudience",(()=>{var t,e,i,s,a,n,l,o;let r={toEmail:null==(t=this.state.approverName)?void 0:t.brandId,channel:"web push"===(null==(i=null==(e=this.props)?void 0:e.notificationData)?void 0:i.authuringType.toLowerCase())?"WN":"mobile push"===(null==(a=null==(s=this.props)?void 0:s.notificationData)?void 0:a.authuringType.toLowerCase())?"MP":"",Dbname:null==(l=null==(n=this.dbData)?void 0:n.clientDetailsLocalization)?void 0:l.instanceName,Uid:null==(o=this.dbData)?void 0:o.userId};os({path:Wa,isCache:!1,params:r,ok:t=>{!1===t.data?this.setState({clkofSend:!0,valAudPopUp:!0,resData:!1}):this.setState({clkofSend:!1,valAudPopUp:!0,resData:!0})},fail:t=>{}})})),ji(this,"TimerComponent",(()=>Ti.jsx(Nc,{isOpen:this.state.timerBtnClicked,onClose:()=>{this.setState({timerBtnClicked:!1})}}))),ji(this,"parsed",no.parse(window.location.search)),ji(this,"campStatus",void 0!==(null==(He=this.parsed)?void 0:He.cs)?null==(Ge=this.parsed)?void 0:Ge.cs:0),this.createFieldRef(),Ys("lsConfig"),this.configureTabs()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}getMobileInteractivityButtons(){let t=["Dismiss","Maybe later"];0===this.props.dynamicListId?(t.push("Unsubscribe"),t.push("Custom action")):t.push("Custom action");var e=[];return t.map((t=>{0===this.props.notificationData.push.content[0].interActivity.filter((e=>e.actionName.toLowerCase()===t.toLowerCase())).length&&e.push(t)})),e}getWebInteractivityButtons(){let t=["Dismiss"];0===this.props.dynamicListId?(t.push("Unsubscribe"),t.push("Custom action")):t.push("Custom action");var e=[];return t.map((t=>{0===this.props.notificationData.push.content[0].interActivity.filter((e=>{var i;return(null==(i=null==e?void 0:e.actionName)?void 0:i.toLowerCase())===t.toLowerCase()})).length&&e.push(t)})),e}render(){var t,e;return Ti.jsxs("div",{className:9!==(null==(t=this.props)?void 0:t.jobStatusId)&&5==this.campStatus&&(null==(e=this.props)?void 0:e.etClickOff)?"click-off":"",children:[!0===this.state.timerBtnClicked&&Ti.jsx(this.TimerComponent,{}),this.state.treeUpdate>=1&&Ti.jsxs("div",{className:this.props.editClickOff?"click-off":"",children:[Ti.jsx(this.header,{data:this.props.pushJson,someData:this.props}),0===this.state.activeTab?Ti.jsx(this.content,{data:this.props.notificationData}):null,1===this.state.activeTab?Ti.jsx(this.content,{data:this.props.notificationData}):null,2===this.state.activeTab?Ti.jsx(this.templateComponent,{...this.props,data:this.props.notificationData}):null,this.state.valAudPopUp&&Ti.jsx(_l,{show:this.state.valAudPopUp,centered:!0,children:Ti.jsxs("div",{children:[Ti.jsx(Jl,{md:12,children:this.state.resData?Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:jn,size:"xl",color:"color-remove",mainClass:"mb15"}),Ti.jsx("label",{children:"Valid audience."})]}):Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:jn,size:"xl",color:"color-remove",mainClass:"mb15"}),Ti.jsx("label",{children:"Invalid audience."})]})}),Ti.jsx(Jl,{children:Ti.jsx(ns,{onClick:()=>{this.setState({valAudPopUp:!1})},children:"Close"})})]})})]})]})}}const Gc=ua,Wc=[],_c=["Notification","Emergency","Enter sound name"],Jc=["Dismiss","Maybe later","Unsubscribe","Custom action"],Zc=["Hour(s)","Day(s)"],Kc=["Dismiss","Unsubscribe","Custom action"],Yc=["Minute(s)","Hour(s)","Day(s)"];class Xc extends Ni.Component{constructor(t){super(t),ji(this,"tabs",[{text:"Create",iconLeft:"icon-rs-text-document-edge-large icons-lg marginB10",disable:!1,id:0},{text:"Import",iconLeft:"icon-rs-import-file-edge-large icons-lg marginB10",disable:!0,id:1},{text:"Template",iconLeft:"icon-rs-template-edge-large icons-lg marginB10",disable:!0,id:2}]),ji(this,"state",{isRequestForApproval:!1,approverName:"",isCouponCodeBtnClicked:!1,isFirstCustomButtonChoose:this.props.notificationData.interActivity.length>0&&""!==this.props.notificationData.interActivity[0].actionName&&3===this.props.notificationData.interActivity[0].actionId,isSecondCustomButtonChoose:this.props.notificationData.interActivity.length>1&&""!==this.props.notificationData.interActivity[1].actionName&&3===this.props.notificationData.interActivity[1].actionId,activeTab:"TEXT"===this.props.notificationData.contentType?0:"EDM"===this.props.notificationData.contentType?1:"TEMPLATE"===this.props.notificationData.contentType?2:-1,isSendRecommendation:!1,isDaylightSaving:!1,addBtnClick:this.props.notificationData.interActivity.length>1,bodyTextCount:"",isInterActivity:this.props.notificationData.isInteractivebuttonEnabled,interActivityButton1Name:this.props.notificationData.interActivity.length>0?this.props.notificationData.interActivity[0].actionName:"",interActivityButton2Name:this.props.notificationData.interActivity.length>1?this.props.notificationData.interActivity[1].actionName:"",interActivityButton1:"Button",interActivityButton2:"Button",isAlertSound:this.props.notificationData.isAlertSound,alertEnter:!1,isExpiry:this.props.notificationData.isExpiryButtonEnabled,isOpenCustomButtonModal:!1,isFirstCustomButton:!1,expiryType:this.props.notificationData.pushexpirySchedule,expiryValue:this.props.notificationData.pushExpiryhours,frequencyType:"",frequencyValue:"",alertSound:this.props.notificationData.alertSound,schedule:this.props.notificationData.scheduleDate,clicked:0,isShow:!1,isTitleEmoji:!1,isTitlePerson:!1,isPerson:!1,titlePerson:"",subTitlePerson:"",titleEmoji:"",titleTextCount:"",subTitleTextCount:"",subTitleEmoji:"",isSubtitleEmoji:!1,titleValue:this.props.notificationData.title,titleValuePosition:0,subTitleValue:this.props.notificationData.subTitle,subTitlePosition:0,bodyValue:this.props.notificationData.body,titleColor:this.props.notificationData.titleColor,subTitleColor:this.props.notificationData.subTitleColor,interActivityObject:{actionName:"",actionId:"",actionType:"",fontColor:"",url:"",bgColor:"",maybeLaterTimeings:""},errContent:null,errTitle:null,errSubtitle:null,errBody:null,errInterActivityButton1:null,errInterActivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashtag:null,errSchedule:null,errFrequencyType:null,errFrequencyValue:null,editTimeZone:!1,hashTags:this.props.notificationData.hashTag.length>0?this.props.notificationData.hashTag:[],timeZone:"-- "+Xs+" --",timeZoneList:[],campaignStartDate:tn(new Date(ao(this.props.campaignPlan.startDate).add(0,"day").toString()),15)}),ji(this,"componentDidMount",(()=>{this.props.notificationData.interActivity.map((t=>{if("maybe later"===t.actionType&&""!==t.maybeLaterTimeings){let e=t.maybeLaterTimeings.split(" ");this.setState({frequencyType:e[1],frequencyValue:e[0]})}})),this.setTimeZoneData();const t=Zs();this.setState({timeZoneList:t.timeZone}),new Date(ao(this.props.campaignPlan.startDate).add(0,"day"))<new Date&&this.setState({campaignStartDate:tn(new Date,15)});var e;e=isNaN(Date.parse(this.props.notificationData.scheduleDate))?"":this.props.notificationData.localScheduleTime,this.setState({schedule:e}),this.configureTabs()})),ji(this,"componentDidUpdate",(t=>{var e,i;t!==this.props&&(this.setState({titleValue:this.props.notificationData.title,titleValuePosition:0,subTitleValue:this.props.notificationData.subTitle,subTitleValuePosition:0,bodyValue:this.props.notificationData.body,titleColor:this.props.notificationData.titleColor,alertSound:this.props.notificationData.alertSound,hashTags:this.props.notificationData.hashTag,expiryType:this.props.notificationData.pushexpirySchedule,expiryValue:this.props.notificationData.pushExpiryhours,isAlertSound:this.props.notificationData.isAlertSound,isExpiry:this.props.notificationData.isExpiryButtonEnabled,isInterActivity:this.props.notificationData.isInteractivebuttonEnabled,schedule:(null==(i=null==(e=this.props)?void 0:e.notificationData)?void 0:i.localScheduleTime)||"",interActivityButton1Name:this.props.notificationData.interActivity.length>0?this.props.notificationData.interActivity[0].actionName:"",interActivityButton2Name:this.props.notificationData.interActivity.length>1?this.props.notificationData.interActivity[1].actionName:"",interActivityButton1:"Button",interActivityButton2:"Button",errContent:this.props.splitError.errContentType,errTitle:this.props.splitError.errTitle,errSubtitle:this.props.splitError.errSubtitle,errBody:this.props.splitError.errBody,errInterActivityButton1:this.props.splitError.errInteractivityButton1,errInterActivityButton2:this.props.splitError.errInteractivityButton2,errAlertSound:this.props.splitError.errAlertSound,errExpiryType:this.props.splitError.errExpiryType,errExpiryValue:this.props.splitError.errExpiryValue,errHashtag:this.props.splitError.errHashTag,errSchedule:this.props.splitError.errSchdule,errFrequencyType:this.props.splitError.errFrequencyType,errFrequencyValue:this.props.splitError.errFrequencyValue}),this.setTimeZoneData())})),ji(this,"setTimeZoneData",(()=>{var t,e,i,s,a,n,l,o,r;let c=fs().clientDetailsLocalization,d=null==(t=Zs())?void 0:t.timeZone,p=(null==d?void 0:d.filter((t=>(null==t?void 0:t.timezoneId)===(null==c?void 0:c.timeZoneId))))||[d[0]];null!==(null==c?void 0:c.timeZoneId)&&void 0!==(null==c?void 0:c.timeZoneId)&&0!==(null==c?void 0:c.timeZoneId)||(p=[d[0]]);let h="";this.props.data.push.content.map((t=>{""!==t.timezoneId&&(h=t.timezoneId)})),""!==h?(p=null==d?void 0:d.filter((t=>(null==t?void 0:t.timezoneId)===this.props.notificationData.timezoneId)),this.setState({timeZone:{timezoneId:null==(e=p[0])?void 0:e.timezoneId,timezoneName:null==(i=p[0])?void 0:i.timezoneName,timezoneValue:null==(s=p[0])?void 0:s.timezoneValue,offSet:null==(a=p[0])?void 0:a.gmtOffset}})):this.setState({timeZone:{timezoneId:(null==c?void 0:c.timeZoneId)||(null==(n=p[0])?void 0:n.timezoneId)||0,timezoneName:(null==c?void 0:c.timeZoneName)||(null==(l=p[0])?void 0:l.timezoneName)||"-- Select timezone --",timezoneValue:null==(o=p[0])?void 0:o.timezoneValue,offSet:null==(r=p[0])?void 0:r.gmtOffset}})})),ji(this,"CreateInteractivityObject",(t=>({actionName:t,actionId:Ba(t),actionType:t.toLowerCase(),fontColor:"",bgColor:"",url:4===Ma(t)?4:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:Ma(t)}))),ji(this,"GetButtonsForPreview",(t=>{let e=[];return void 0!==t&&t.length>0&&t.forEach((t=>{t.actionName.length>0&&e.push({text:t.actionName,bgColor:t.bgColor,fontColor:t.fontColor})})),e})),ji(this,"createFieldRef",(()=>{this.anchor=Ni.createRef(),this.fontcoloranochor=Ni.createRef(),this.subTitleColorAnocher=Ni.createRef(),this.backgroundcoloranochor=Ni.createRef(),this.emojianochor=Ni.createRef(),this.subTitleEmojiAnochor=Ni.createRef(),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.titleRef=Ni.createRef(),this.ca1FontColorAnochor=Ni.createRef(),this.ca1BackgroundColorAnochor=Ni.createRef(),this.ca2FontColorAnochor=Ni.createRef(),this.ca2BackgroundColorAnochor=Ni.createRef()})),ji(this,"configureTabs",(()=>{if("web"===this.props.type)if(2===this.props.pushType||3===this.props.pushType){let t=[...this.tabs];t.forEach((t=>{t.disable=!1,"Template"===t.text&&(t.disable=!0)})),this.tabs=t}else 1===this.props.pushType&&this.alertDelivaryType();else if(2===this.props.pushType||3===this.props.pushType){let t=[...this.tabs];t.forEach((t=>{t.disable=!1,"Template"===t.text&&(t.disable=!0)})),this.tabs=t}else 1===this.props.pushType&&this.alertDelivaryType()})),ji(this,"alertDelivaryType",(()=>{let t=[...this.tabs];t.forEach((t=>{"Template"!==t.text&&"Import"!==t.text||(t.disable=!0)})),this.tabs=t})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"onOpen",(t=>{this.contentRef.current.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"header",(t=>{var e;return Ti.jsx("div",{className:"mt30",children:Ti.jsx("div",{className:`rs-tabs-with-heading rs-tabs-bg-fill ${-1===this.state.activeTab?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper transition"} stricky-window push-content mb30`,children:Ti.jsxs(Jl,{className:"rs-flat-tabs",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"d-flex align-items-center",children:Ti.jsx(Ao,{right:!0,label:"Push content",className:"font-medium"})}),Ti.jsx(Zl,{md:7,className:"ml0",children:Ti.jsxs("div",{className:"position-relative",children:[(null==(e=this.state.errContent)?void 0:e.length)&&Ti.jsx("div",{className:"rich-content-error validation-message mt-30",children:this.state.errContent}),Ti.jsx(Pi,{defaultSelectedItem:this.state.activeTab,defaultClass:"",dynamicTab:"rs-content-tabs-flat "+(-1===this.state.activeTab?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:this.tabs,callBack:(e,i)=>{[...this.tabs].map((t=>{t!==e&&(t.disable=!0)})),this.setState({errContent:null}),this.props.notificationData.contentType=0===i?"TEXT":1===i?"EDM":"TEMPLATE",this.props.splitError.errContentType=null,t.data.body=1===i?"":t.data.body,this.setState({activeTab:i})},refresh:""!==this.props.notificationData.contentType,onRefresh:()=>{this.setState({contentType:"",titleValue:"",titleTextCount:"",subTitleValue:"",bodyValue:"",bodyTextCount:"",hashTags:[],isInterActivity:!1,interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton2Name:"",frequencyValue:"",frequencyType:"",isExpiry:!1,expiryType:"",expiryValue:"",isAlertSound:!1,alertSound:"",schedule:"",editTimeZone:!1,activeTab:-1}),this.setState({errContent:null}),this.props.notificationData.push.objectRequestApproval=null,t.data.contentType="",t.data.edmUrl="",t.data.title="",t.data.titlePosition=0,t.data.titleColor="",t.data.bgColor="",t.data.subTitle="",t.data.subTitlePosition=0,t.data.body="",t.data.hashTag=[],t.data.isInteractivebuttonEnabled=!1,t.data.interActivity=[],t.data.interActivityButton1Name="",t.data.interActivityButton2Name="",t.data.isExpiryButtonEnabled=!1,t.data.pushexpirySchedule="",t.data.pushExpiryhours=0,t.data.isAlertSound=!1,t.data.alertSound="",t.data.timezone="-- Select time zone --",t.data.scheduleDate="",t.data.contentType="",t.data.url="",t.data.importContent="",this.props.splitError.errContentType=null,this.props.notificationData.contentType="",t.data.contentType="",t.data.importContent="",this.configureTabs(),this.forceUpdate()}})]})})]})})})})),ji(this,"MaybeLaterComponent",(t=>{})),ji(this,"getHashTagUpdation",(()=>{var t;return(null==(t=this.state.hashTags)?void 0:t.length)+" / 5"})),ji(this,"getLengthCheck",(t=>{let e="";for(let a=0;a<t.length;a++){const i=t[a];" "!==i&&(e+=i)}let i=0,s=!1;for(let a=0;a<e.length;a++){const t=e[a];"["===t?s=!0:"]"===t?s=!1:s||"|"==t||i++}return i})),ji(this,"countBrackets",(t=>{let e=t.trim(),i=0;for(let s=0;s<e.length;s++){const t=e[s];("["===t||"]"===t)&&i++}return i})),ji(this,"handleTitleOnBlur",((t,e)=>{e.data.titlePosition=t.target.selectionStart,this.state;let i=t.target.value,s=!0;const a=i.split("|");for(const n of a){let t=0;for(const e of n)"["===e?t++:"]"===e&&t--,t<0&&(s=!1);0!==t&&(s=!1)}if(s){e.data.title=i;let t=i.length>0?null:this.state.errTitle;this.setState({titleValue:i,isTitlePerson:!this.state.isTitlePerson,errTitle:t})}else this.setState({errTitle:"In correct type"})})),ji(this,"handleSubTitleOnBlur",((t,e)=>{e.data.subTitlePosition=t.target.selectionStart,this.state;let i=t.target.value,s=!0;const a=i.split("|");for(const n of a){let t=0;for(const e of n)"["===e?t++:"]"===e&&t--,t<0&&(s=!1);0!==t&&(s=!1)}if(s){e.data.title=i;let s=i.length>0?null:"Enter subtitle";this.setState({subTitleValue:i,isSubTitlePerson:!this.state.isTitlePerson,errSubtitle:s,subTitleValuePosition:t.target.selectionStart})}else this.setState({errSubtitle:"In correct type"})})),ji(this,"content",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y;const g=this.state.bodyTextCount.replace("/","");return Ti.jsxs(Ti.Fragment,{children:["TEXT"===t.contentType?Ti.jsxs("div",{className:"mt30",children:[Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:(this.props.type,"Title")})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{ref:this.titleRef,type:"textarea",required:!0,placeholder:"Title",val:this.state.titleValue,errorMessage:this.state.errTitle,onBlur:e=>{this.handleTitleOnBlur(e,t)},onChange:e=>{let i=e.target.value.trimStart();i=i.replace(/\s+/g," "),this.tabs.map((t=>{0!==t.id&&(t.disable=!0)}));let s=this.getLengthCheck(i);if(s>60)return;let a=s;this.setState({titleTextCount:a}),Is("Cursor Position",e.target.selectionStart);let n=i.length>0?null:Ra;this.setState({titleValue:i,errTitle:n}),t.data.title=i,this.props.splitError.errTitle=n}})}),Ti.jsx(Zl,{md:4,className:"instant-preview",children:this.state.titleValue.length>0||t.data.body.length>0||t.data.subTitle.length>0||t.data.url.length>0?Ti.jsx(bo,{isAuthoring:!0,pushType:this.props.pushType,content:t.data,data:this.props.data,title:this.state.titleValue,titleColor:t.data.titleColor,bodyColor:t.data.bodyBgColor,bodyFontColor:t.data.bodyTextColor,body:t.data.body,subTitle:""!==t.data.subTitle?t.data.subTitle:"",subTitleColor:void 0!==t.data.subTitleColor&&""!==t.data.subTitleColor?t.data.subTitleColor:"",type:this.props.type,imageSrc:t.data.url,customArray:"web"===this.props.type?this.GetButtonsForPreview(t.data.interActivity):t.data.interActivity}):null})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"justify-content-between",children:[Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx(Hi,{items:Gc,text:Ti.jsx(ws,{text:"Personalize",position:"top",children:Ti.jsx("i",{className:"icon-rs-user-question-mark-edge-medium color-primary-blue icons-md"})}),onItemClick:e=>{let i=t.data;this.getLengthCheck(e.item.text),ca(i.title,e.item.text,i.titlePosition);const s=e.item.text.replace(/\[\[|\]\]/g,"");var a=`${s} NOTFOUND`;s.includes("NAME")&&(a="CUSTOMER");let n=`[[${s}]] | [[${a}]] `;const l=[];l.push(this.state.titleValue,n);const o=l.filter((t=>""!==t)).join("");t.data.title=o,this.countBrackets(o)<=40?(!(e.item.text.length>0)&&this.state.errTitle,this.setState({titleValue:o,isTitlePerson:!this.state.isTitlePerson})):this.setState({errTitle:"Only 5 personalize add"})}}),Ti.jsxs(Xi,{className:"ml15",children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.emojianochor,onClick:()=>{this.buttonClick(2),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}})})}),"web"!==this.props.type&&3!==this.props.pushJson.push.deliveryType.deliveryTypeId?Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(3)})})}):null,"web"===this.props.type&&2===this.props.pushType?Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(3)})})}):null]})]}),Ti.jsx(Po,{className:`${60===this.state.titleTextCount&&"red"}`,text:0===this.state.titleTextCount?"60":this.state.titleTextCount+"/60"})]})})})]}),"mobile"===this.props.type&&1===this.props.pushType?Ti.jsx(Ti.Fragment,{children:Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Subtitle"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{type:"textarea",maxLength:60,placeholder:"Subtitle",val:this.state.subTitleValue,errorMessage:this.state.errSubtitle,onBlur:e=>{this.handleSubTitleOnBlur(e,t)},onChange:e=>{let i=e.target.value.trimStart();i=i.replace(/\s+/g," "),this.tabs.map((t=>{0!==t.id&&(t.disable=!0)}));let s=this.getLengthCheck(i);if(s>60)return;let a=s;this.setState({subTitleTextCount:a}),Is("Cursor Position",e.target.selectionStart);let n=i.length>0?null:"Enter subtitle";this.props.splitError.errSubtitle=n,this.setState({subTitleValue:i,errSubtitle:n}),t.data.push.content[0].subTitle=i+this.state.subTitleEmoji}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"justify-content-between",children:[Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx(ws,{text:"Personalize",position:"top",children:Ti.jsx(Hi,{items:Gc,icon:" icon-rs-user-question-mark-edge-medium color-primary-blue icons-md",onItemClick:e=>{const i=e.item.text.replace(/\[\[|\]\]/g,"");var s=`${i} NOTFOUND`;i.includes("NAME")&&(s="CUSTOMER");let a=`[[${i}]] | [[${s}]] `;const n=[];n.push(this.state.subTitleValue,a);const l=n.filter((t=>""!==t)).join("");t.data.subTitle=l;let o=""!=l?null:"Enter subtitle";this.countBrackets(l)<=40?this.setState({subTitleValue:l,isSubTitlePerson:!this.state.isSubTitlePerson,errSubtitle:o}):this.setState({errSubtitle:"Only 5 personalize add"})}})}),Ti.jsx(Xi,{className:"ml10",children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.subTitleEmojiAnochor,onClick:()=>{this.buttonClick(8),this.setState({isSubtitleEmoji:!this.state.isSubtitleEmoji})}})})})})]}),Ti.jsx(Po,{className:`${60===this.state.subTitleTextCount&&"red"}`,text:0===this.state.subTitleTextCount?"/60":this.state.subTitleTextCount+"/60"})]})})})]})}):null,Ti.jsx($l,{className:"mb10",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Body"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsxs("div",{className:"position-relative",children:[this.state.errBody&&Ti.jsx("div",{className:"validation-message align-end body-text",children:this.state.errBody}),"mobile"===this.props.type?Ti.jsx(Bc,{...this.props,...this.props,data:t.data,notificationData:t.data,mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){s.length;let e=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null;s.length>0&&s.length.toString();let a=l>0?l.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.splitError.errBody=e;let o=gn(i);if(t.data.body=bn(o),t.data.htmlBody=bn(i),""!==t.data.bodyTextColor){let e=o.replace(/<p>(.*?)<\/p>/,`<p style="color:${t.data.bodyTextColor}">$1</p>`);t.data.body=bn(e),t.data.htmlBody=bn(e)}}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.htmlBody+"</font>",r=`<span color="${i}">`+t.data.htmlBody+"</span>";let e=gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`);t.data.body=e,t.data.bodyTextColor=i,t.data.htmlBody=r}else"url"===e?t.data[e]=i:"onBlur"===e?(t.data.bodyPosition=i.target.selectionStart,n&&this.setState({errBody:n})):"bodyBgColor"===e?t.data.bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(e,i)=>{t.data[e]=i,this.forceUpdate()}}):"web"!==(null==(e=this.props)?void 0:e.type)||2!==(null==(n=null==(a=null==(s=null==(i=this.props)?void 0:i.data)?void 0:s.push)?void 0:a.pushType)?void 0:n.deliveryTypeId)&&3!==(null==(c=null==(r=null==(o=null==(l=this.props)?void 0:l.data)?void 0:o.push)?void 0:r.pushType)?void 0:c.deliveryTypeId)?Ti.jsx(uc,{mobilepush:"mobile"===this.props.type,deliveryTypeId:"mobile"===this.props.type?2:this.props.pushJson.push.pushType.deliveryTypeId,notificationData:t.data,bodyContent:t.data.body,callBack:(e,i,s,a,n)=>{if("bodytext"===e){let e=0==i&&""==n?yn:"Add only 5 personalization"==s||"In correct type"==s?s:null,a=0!=i&&"Add only 5 personalization"==s?"":0!=i?i.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.splitError.errBody=e,this.setState({bodyValue:n}),t.data.body=n}else"bodyTextColor"===e?t.data.bodyTextColor=i:"url"===e?t.data.url=i:"onBlur"===e?(t.data.bodyPosition=i.target.selectionStart,s&&this.setState({errBody:s})):"bodyBgColor"===e&&(t.data.bodyBgColor=i);this.forceUpdate()},colorCodeChange:(e,i)=>{t.data[e.toString()]=i},onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},onClickCouponBtnClick:t=>{this.setState({isCouponCodeBtnClicked:t})}}):Ti.jsx(Bc,{...this.props,...this.props,data:t.data,notificationData:t.data,mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){s.length;let e=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null;s.length>0&&s.length.toString();let a=l>0?l.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.splitError.errBody=e;let o=gn(i);if(t.data.body=bn(i),t.data.htmlBody=bn(i),""!==t.data.bodyTextColor){let e=o.replace(/<p>(.*?)<\/p>/,`<p style="color:${t.data.bodyTextColor}">$1</p>`);t.data.body=bn(e),t.data.htmlBody=bn(e)}}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.htmlBody+"</font>",r=`<span color="${i}">`+t.data.htmlBody+"</span>";let e=gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`);t.data.body=e,t.data.bodyTextColor=i,t.data.htmlBody=r}else"url"===e?t.data[e]=i:"onBlur"===e?(t.data.bodyPosition=i.target.selectionStart,n&&this.setState({errBody:n})):"bodyBgColor"===e?t.data.bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(e,i)=>{t.data[e]=i,this.forceUpdate()}})]}),this.state.bodyTextCount.length>0?Ti.jsx(Po,{right:!0,text:350===Number(g)?Ti.jsxs("span",{children:["Maximum character limit reached ",Ti.jsx("span",{className:"color-dark-red font-bold",children:"350"})," "]}):Number(g)>299?Ti.jsxs("span",{children:["Available ",Ti.jsx("span",{className:"blue",children:Number(g)-350})," characters only ",Ti.jsx("span",{className:"color-medium-orange font-bold",children:this.state.bodyTextCount+"350"})," "]}):Ti.jsx("span",{children:this.state.bodyTextCount+"350"})}):Ti.jsx(Po,{right:!0,text:"Upto 350 characters are allowed."})]})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Interactivity"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{checked:this.state.isInterActivity,onChange:e=>{e.target.value?(t.data.isInteractivebuttonEnabled=e.target.value,this.setState({isInterActivity:e.target.value}),t.data.interActivity.length>0&&(t.data.interActivity=[])):(this.setState({addBtnClick:!1,isInterActivity:e.target.value,interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton1Name:"-- Select --",interActivityButton2Name:"-- Select --",frequencyType:"",frequencyValue:""}),t.data.isInteractivebuttonEnabled=e.target.value,t.data.interActivity=[])}})})]})}),this.state.isInterActivity&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:["Button"],value:"Button",label:"Interactivity type",required:!0,handleChange:t=>{this.setState({interActivityButton1:t.target.value})}})}),"Button"===this.state.interActivityButton1&&Ti.jsx(Zl,{children:Ti.jsx(Ul,{required:!0,label:"Interactive actions",data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),value:void 0!==this.state.interActivityButton1Name&&""!==this.state.interActivityButton1Name?this.state.interActivityButton1Name:"-- Select --",errorMessage:this.state.errInterActivityButton1,handleChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isFirstCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isFirstCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:fn;this.setState({errInterActivityButton1:s}),this.props.splitError.errInteractivityButton1=s,2===t.data.interActivity.length||null!==t.data.interActivity[0]?t.data.interActivity[0]=i:t.data.interActivity.push(i),t.data.interActivityButton1Name=e.target.value,this.setState({interActivityButton1Name:e.target.value})}})})]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:"Button"===this.state.interActivityButton1&&Ti.jsxs(Xi,{children:["web"!==this.props.type&&""!==this.state.interActivityButton1Name&&"-- Select --"!==this.state.interActivityButton1Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(4)})})}),Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(5)})})})})]}):null,"web"===this.props.type&&""!==this.state.interActivityButton1Name&&"-- Select --"!==this.state.interActivityButton1Name?Ti.jsx(Ti.Fragment,{children:2===this.props.pushType||2===this.props.pushType&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(4)})})}),Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(5)})})})]})}):null,this.state.isFirstCustomButtonChoose?Ti.jsx(Qi,{tooltip:"Configure custom action",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{let e=t.data.interActivity[0];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal,isFirstCustomButton:!this.state.isFirstCustomButton})}}):null,Ti.jsx(Qi,{tooltip:"Add",icon:`icon-rs-circle-plus-fill-edge-medium ${this.state.addBtnClick&&"click-off"}`,size:"md",onClick:()=>{0!==t.data.interActivity.length&&""!==t.data.interActivity[0].actionName?(t.data.interActivity[1]=this.CreateInteractivityObject(""),this.setState({addBtnClick:!0,frequencyType:"",frequencyValue:""})):this.setState({errInterActivityButton1:fn})}})]})})})]})}),"Maybe later"===t.data.interActivityButton1Name&&Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:Yc,required:!0,label:"Frequency type",errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.splitError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.interActivity[0].maybeLaterTimeings=e.target.value,t.data.interActivity[0].reschedule=e.target.value}})}),Ti.jsx(Zl,{children:Ti.jsx(ql,{placeholder:"Frequency time",required:!0,val:this.state.frequencyValue,keyboardType:"number",max:jl,errorMessage:this.state.errFrequencyValue,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.splitError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.interActivity[0].interactivehours=parseInt(e),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(t.data.interActivity[0].interactivehours=parseInt(e),this.setState({frequencyValue:e}),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&(t.data.interActivity[0].interactivehours=parseInt(e),e<=60&&(this.setState({frequencyValue:e}),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType))}})})]})})})}),!0===this.state.addBtnClick&&Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:["Button"],value:void 0!==this.state.interActivityButton2&&""!==this.state.interActivityButton2?this.state.interActivityButton2:"-- Select  --",label:"Interactivity type",required:!0,onChange:t=>{this.setState({interActivityButton2:t.target.value})}})}),"Button"===this.state.interActivityButton2&&Ti.jsx(Zl,{className:"position-relative",children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errInterActivityButton2&&Ti.jsx("div",{className:"validation-message",children:this.state.errInterActivityButton2}),Ti.jsx(Ul,{data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),label:"Interactive actions",required:!0,value:void 0!==this.state.interActivityButton2Name&&""!==this.state.interActivityButton2Name?this.state.interActivityButton2Name:"-- Select --",onChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isSecondCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isSecondCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:Sn;this.setState({errInterActivityButton2:s}),this.props.splitError.errInteractivityButton2=s,2===t.data.interActivity.length?t.data.interActivity[1]=i:null===t.data.interActivity[1]?t.data.interActivity.push(i):t.data.interActivity[1]=i,t.data.interActivityButton2Name=e.target.value,this.setState({interActivityButton2Name:e.target.value})}})]})})]})}),"Button"===this.state.interActivityButton2&&Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:["web"===this.props.type&&2===this.props.pushType&&""!==this.state.interActivityButton2Name&&"-- Select --"!==this.state.interActivityButton2Name&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca2FontColorAnochor,onClick:()=>this.buttonClick(6)})})}),Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca2BackgroundColorAnochor,onClick:()=>this.buttonClick(7)})})})]}),"web"!==this.props.type&&""!==this.state.interActivityButton2Name&&"-- Select --"!==this.state.interActivityButton2Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca2FontColorAnochor,onClick:()=>this.buttonClick(6)})})}),2===this.props.pushType||1===this.props.pushType?Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca2BackgroundColorAnochor,onClick:()=>this.buttonClick(7)})})})}):null]}):null,this.state.isSecondCustomButtonChoose&&Ti.jsx(Qi,{tooltip:"Configure custom action",icon:Cn,size:"md",onClick:()=>{let e=t.data.interActivity[1];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal})}}),Ti.jsx(Qi,{tooltip:"Remove",icon:ea,size:"md",color:"red",onClick:()=>{this.setState({addBtnClick:!1,clicked:0,interActivityButton2Name:"",isSecondCustomButtonChoose:!1});let e=Bs(t.data.interActivity);t.data.interActivity=Bs([e[0]]),this.forceUpdate()}})]})})})]})}),this.state.addBtnClick&&"Maybe later"===t.data.interActivityButton2Name&&Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:Yc,label:"Frequency type",required:!0,errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.splitError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.interActivity[1].reschedule=e.target.value,t.data.interActivity[1].maybeLaterTimeings=e.target.value}})}),Ti.jsx(Zl,{children:Ti.jsx(ql,{placeholder:"Frequency time",required:!0,keyboardType:"number",val:this.state.frequencyValue,max:jl,errorMessage:this.state.errFrequencyValue,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.splitError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType)}})})]})})})})]}),"mobile"===this.props.type?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Alert sound"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:e=>{t.data.isAlertSound=e.target.value,this.setState({isAlertSound:e.target.value})},checked:this.state.isAlertSound})})]})}):null,!0===this.state.isAlertSound?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:!0===this.state.alertEnter?Ti.jsx(Ti.Fragment,{children:Ti.jsx(ql,{style:{paddingRight:25,backgroundColor:"orange",width:300},required:!0,placeholder:"Enter sound name",errorMessage:this.state.errAlertSound,val:this.state.alertSound,iconPlaceholder:!0,iconName:ba,iconSize:"sm",iconColor:"color-primary-red",iconOnClick:()=>{this.props.splitError.errAlertSound=null,this.setState({errAlertSound:null}),this.setState({alertEnter:!1,alertSound:""}),t.data.alertSound=""},cb:e=>{if(e.length>50)return;let i=e.length>0?null:fa;this.props.splitError.errAlertSound=i,this.setState({errAlertSound:i}),this.setState({alertSound:e}),t.data.alertSound=e},ob:e=>{let i=e.length>0?null:fa;this.props.splitError.errAlertSound=i,this.setState({errAlertSound:i}),this.setState({alertSound:e}),t.data.alertSound=e}})}):Ti.jsx(Ul,{data:_c,required:!0,label:"Expiry duration",value:void 0!==this.state.alertSound&&""!==this.state.alertSound?this.state.alertSound:"-- Select --",onChange:e=>{if(e.target.value.toLowerCase().includes("enter"))return this.props.splitError.errAlertSound=null,this.setState({errAlertSound:null}),this.setState({alertEnter:!0,alertSound:""}),void(t.data.alertSound="");let i=e.target.value.length>0?null:fa;this.setState({errAlertSound:i}),this.props.splitError.errAlertSound=i,t.data.alertSound=e.target.value,this.setState({alertSound:e.target.value})}})})})}):null,Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Expiry"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{checked:this.state.isExpiry,onChange:e=>{t.data.isExpiryButtonEnabled=e.target.value,this.setState({isExpiry:e.target.value}),this.setState({errExpiryType:null}),this.props.splitError.errExpiryType=null,t.data.pushexpirySchedule="",t.data.pushExpiryhours=0,this.setState({expiryValue:""}),this.setState({expiryType:""})}})})]})}),!0===this.state.isExpiry?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{data:Zc,required:!0,errorMessage:this.state.errExpiryType,label:"Expiry duration",value:void 0!==this.state.expiryType&&""!==this.state.expiryType?"H"===this.state.expiryType?"Hour(s)":"Day(s)":"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:ya;this.setState({errExpiryType:i}),this.props.splitError.errExpiryType=i,t.data.pushexpirySchedule="Hour(s)"===e.target.value?"H":"D",t.data.pushExpiryhours="",this.setState({expiryValue:""}),this.setState({expiryType:t.data.pushexpirySchedule})}})}),void 0!==this.state.expiryType&&""!==this.state.expiryType&&"-- Select -- "!==this.state.expiryType&&Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{required:!0,placeholder:"Value",val:this.state.expiryValue,keyboardType:"number",max:Tl,cb:e=>{let i=e.length>0?null:ga;this.setState({errExpiryValue:i}),this.props.splitError.errExpiryValue=i,""!==t.data.pushexpirySchedule&&"D"===t.data.pushexpirySchedule&&(""!==e?e.length<=3&&parseInt(e)<=100&&(t.data.pushExpiryhours=e,this.setState({expiryValue:e})):(t.data.pushExpiryhours=e,this.setState({expiryValue:e}))),""!==t.data.pushexpirySchedule&&"H"===t.data.pushexpirySchedule&&(""===e||/^[0-9]{1,2}$/.test(e))&&e<=24&&(t.data.pushExpiryhours=e,this.setState({expiryValue:e})),""!==t.data.pushexpirySchedule&&"Minute(s)"===t.data.pushexpirySchedule&&(""===e||/^[0-9]{1,2}$/.test(e))&&e<=60&&(t.data.pushExpiryhours=e,this.setState({expiryValue:e}))},errorMessage:this.state.errExpiryValue})})]})})})}):null,Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"#Hashtags"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsx("div",{className:"chips-input-container two-line",children:Ti.jsx(Fl,{noDropdown:!0,data:Wc,value:this.state.hashTags,allowCustom:!0,onChange:e=>{if(e.target.value.length>5)return;let i=[];e.target.value.filter((t=>""!==Ls(t))),e.target.value.map(((t,s)=>{let a=Ls(t);!ss(a)&&a.length<=25?(t=a,i.push(a)):e.target.value.splice(s,1)}));let s=[...i];s=s.map(((t,e)=>t.includes("#")?t:"#"+t));const a=s.reduce(((t,e)=>t.find((t=>t===e))?t:t.concat([e])),[]);this.setState({hashTags:a}),t.data.hashTag=a}})}),Ti.jsx("small",{class:`rs-form-small-text fs12 d-inline-block text-end w-100 ${5===(null==(d=this.state.hashTags)?void 0:d.length)&&"red"}`,children:`${5===(null==(p=this.state.hashTags)?void 0:p.length)?Ha:""}  ${(null==(h=this.state.hashTags)?void 0:h.length)>0?this.getHashTagUpdation():" 0 / 5"}`})]}),Ti.jsx(Zl,{md:2,children:Ti.jsx(Mo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"View analytics for trending topics",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})})]}):Ti.jsx(Dc,{type:this.props.type,isCarousel:!1,content:t.data,error:this.props.splitError,smartAppStore:this.props.smartAppStore,bodyData:t.data.body,importContent:(null==(u=null==t?void 0:t.data)?void 0:u.importContent)||"",getBodyContent:(e,i)=>{t.data.importContent=i,t.data.body=i},onChange:e=>{t.data.makeAlert=e.makeAlert,t.data.title=e.title,t.data.shortDesc=e.shortDesc,t.data.hashTag=e.hashTag,t.data.isInteractivebuttonEnabled=e.isInterActivity,t.data.interActivity=e.interActivity,t.data.isAlertSound=e.isAlertSound,t.data.alertSound=e.alertSound,t.data.isExpiryButtonEnabled=e.isExpiry,t.data.pushexpirySchedule=e.expiryType,t.data.pushExpiryhours=e.expiryValue,this.props.splitError.errInteractivityButton1=null,this.props.splitError.errInteractivityButton2=null}}),0===this.props.dynamicListId&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs($l,{className:"rs-tabs-bg-fill even",children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"py20",children:Ti.jsx(Ao,{right:!0,label:"Schedule"})}),Ti.jsxs(Zl,{md:6,className:"py20",children:[Ti.jsx(Vo,{name:`schedulerName${this.props.index}`,placeholder:"Select schedule date and time",errorMessage:this.state.errSchedule,format:!0===(null==(v=null==(m=fs())?void 0:m.timeFormat)?void 0:v.includes("24"))?{skeleton:"yMMMdEHmSs"}:"MMM dd, yyyy:HH:mm a",min:this.state.campaignStartDate,max:en(new Date(ao(this.props.campaignPlan.endDate).add(0,"day").toString())),steps:{minute:5,second:10},value:""!==this.state.schedule?new Date(this.state.schedule):null,handleChange:e=>{const i=(new Date).toLocaleString([],{timeZone:this.state.timeZone.timezoneValue,hour12:!1}),[s,a]=i.split(", "),[n,l,o]=a.split(":"),r=new Date;r.setHours(n),r.setMinutes(l),r.setSeconds(o);var c=r;e.target.value>c&&(t.data.errSchdule=null,this.setState({errSchedule:null}),Tn(),t.data.localScheduleTime=ao(e.target.value).format("yyyy-MM-DD HH:mm:ss"),t.data.scheduleDate=e.target.value.toISOString().slice(0,19).replace("T"," "),this.setState({schedule:t.data.localScheduleTime,errSchedule:null}))}}),""!==this.state.schedule&&Ti.jsx("div",{className:"input-inner-set right52 zIndex2",children:Ti.jsx("i",{className:"icon-rs-close-mini icons-sm red posr bottom-10 right0 fs13",onClick:()=>{t.data.scheduleDate="",this.setState({schedule:""})}})}),Ti.jsx(Jl,{className:"mt5",children:!1===this.state.editTimeZone&&Ti.jsx(Zl,{children:Ti.jsxs("div",{className:"float-end d-flex align-items-center",children:[Ti.jsx("small",{className:"fs12",children:this.state.timeZone.offSet}),Ti.jsx(Xi,{children:Ti.jsx(Qi,{tooltip:"Select time zone",icon:"icon-rs-pencil-edit-mini",size:"sm",onClick:()=>{this.setState({editTimeZone:!0})}})})]})})})]})]}),this.state.editTimeZone&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pt23 pb20",children:Ti.jsx(Ao,{right:!0,label:"Select time zone"})}),Ti.jsx(Zl,{md:6,className:"pt23 pb20",children:Ti.jsx(Ul,{required:!0,textField:"timezoneName",dataItemKey:"timezoneId",label:"Timezone",data:this.state.timeZoneList,value:(null==(y=this.state)?void 0:y.timeZone)||{timezoneId:0,timezoneName:"-- Select timezone --"},handleChange:e=>{this.setState({timeZone:t.data.timezone}),this.props.pushJson.push.content.map(((t,i)=>{t.timezoneId=e.target.value.timezoneId})),this.props.data.push.content.map((t=>{t.scheduleDate=""})),this.setState({timeZone:e.target.value});const i=(new Date).toLocaleString([],{timeZone:e.target.value.timezoneValue,hour12:!1}),[s,a]=i.split(", "),[n,l,o]=a.split(":"),r=new Date;r.setHours(n),r.setMinutes(l),r.setSeconds(o),r>this.state.schedule||(this.setState({schedule:""}),t.data.errSchdule="Selected value lesser than current date and time",t.data.localScheduleTime="",t.data.scheduleDate="",this.setState({errSchedule:"Selected value lesser than current date and time"}),setTimeout((()=>{t.data.push.content[0].scheduleDate="",this.setState({errSchedule:null,schedule:""}),t.data.errSchdule=null}),2e3)),this.forceUpdate()}})})]})})]})}),this.state.isCouponCodeBtnClicked&&Ti.jsx(vc,{isOpen:this.state.isCouponCodeBtnClicked,onChangeIsOpen:()=>{this.setState({isCouponCodeBtnClicked:!1})}}),!0===this.state.isOpenCustomButtonModal?Ti.jsx(kc,{isOpen:this.state.isOpenCustomButtonModal,isWeb:"web"===this.props.type,selectInterActivity:this.state.interActivityObject,smartAppStore:this.props.smartAppStore,onChangeIsOpen:t=>{this.setState({isOpenCustomButtonModal:t})},showSmartLink:()=>{this.props.showSmartLink()},onSaveClick:e=>{if(this.state.isFirstCustomButton){t.data.interActivity[0].actionName=e.actionName,t.data.interActivity[0].actionType=e.actionType,t.data.interActivityButton1Name=e.actionName;let i=e.actionName.length>0?null:fn;this.setState({errInterActivityButton1:i}),t.data.interActivity[0].url=e.url,t.data.interActivity[0].clickBehavourValue=e.clickBehavourValue,t.data.interActivity[0].countryCode=e.countryCode,this.setState({interActivityButton1Name:e.actionName,isFirstCustomButton:!this.state.isFirstCustomButton})}else{t.data.interActivity[1].actionName=e.actionName,t.data.interActivity[1].actionType=e.actionType,t.data.interActivityButton2Name=e.actionName;let i=e.actionName.length>0?null:Sn;this.setState({errInterActivityButton2:i}),t.data.interActivity[1].url=e.url,t.data.interActivity[1].clickBehavourValue=e.clickBehavourValue,t.data.interActivity[1].countryCode=e.countryCode,this.setState({interActivityButton2Name:e.actionName})}}}):null,1===this.state.clicked?Ti.jsx($i,{anchor:this.anchor.current,show:this.state.isShow,popupClass:"popup-content",style:{width:100},children:Ti.jsx(Hl,{data:["Value 1","Value 2","Value 3"],value:"-- select personalition --",onChange:e=>{this.setState({clicked:0}),this.state.isTitlePerson?(t.data.title=ca(t.data.title,e.target.value,t.data.titlePosition),this.setState({titleValue:t.data.title}),this.setState({isTitlePerson:!this.state.isTitlePerson})):(t.data.subTitle=ca(t.data.subTitle,e.target.value,t.data.subTitlePosition),this.setState({subTitleValue:t.data.subTitle}),this.setState({isSubTitlePerson:!this.state.isSubTitlePerson}))}})}):null,2===this.state.clicked?Ti.jsx(oc,{anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{t.data.title=ca(t.data.title,e,t.data.titlePosition),t.data.titlePosition=t.data.titlePosition+2,this.setState({titleValue:t.data.title}),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}}):null,3===this.state.clicked?Ti.jsx(Oo,{anchor:this.fontcoloranochor,show:this.state.isShow,selectColor:t.data.titleColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);this.setState({titleColor:l}),t.data.titleColor=l,this.setState({clicked:0}),this.forceUpdate()}}):null,9===this.state.clicked?Ti.jsx(Oo,{anchor:this.subTitleColorAnocher,show:this.state.isShow,selectColor:t.data.subTitleColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);this.setState({subTitleColor:l}),t.data.subTitleColor=l,this.setState({clicked:0}),this.forceUpdate()}}):null,4===this.state.clicked?Ti.jsx(Oo,{anchor:this.ca1FontColorAnochor,show:this.state.isShow,selectColor:t.data.interActivity[0].fontColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]);Pa(s,a,n),t.data.interActivity[0].fontColor=e}}):null,5===this.state.clicked?Ti.jsx(Oo,{anchor:this.ca1BackgroundColorAnochor,show:this.state.isShow,selectColor:t.data.interActivity[0].bgColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]);Pa(s,a,n),t.data.interActivity[0].bgColor=e}}):null,6===this.state.clicked?Ti.jsx(Oo,{anchor:this.ca2FontColorAnochor,selectColor:t.data.interActivity[1].fontColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]);Pa(s,a,n),t.data.interActivity[1].fontColor=e}}):null,7===this.state.clicked?Ti.jsx(Oo,{anchor:this.ca2BackgroundColorAnochor,show:this.state.isShow,selectColor:t.data.interActivity[1].bgColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]);Pa(s,a,n),t.data.interActivity[1].bgColor=e}}):null,8===this.state.clicked?Ti.jsx(oc,{anchor:this.subTitleEmojiAnochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{this.setState({subTitleEmoji:e}),t.data.subTitle=ca(t.data.subTitle,e,t.data.subTitlePosition),t.data.subTitlePosition=t.data.subTitlePosition+2,this.setState({subTitleValue:t.data.subTitle}),this.setState({isSubtitleEmoji:!this.state.isSubtitleEmoji})}}):null]})})),ji(this,"templateComponent",(t=>Ti.jsx("div",{className:"marginT25",children:Ti.jsx("h1",{children:"Template"})}))),Ys("lsConfig"),this.createFieldRef()}getMobileInteractivityButtons(){var t=[];return Jc.map((e=>{0===this.props.notificationData.interActivity.filter((t=>t.actionName.toLowerCase()===e.toLowerCase())).length&&t.push(e)})),t}getWebInteractivityButtons(){var t=[];return Kc.map((e=>{0===this.props.notificationData.interActivity.filter((t=>{var i;return(null==(i=null==t?void 0:t.actionName)?void 0:i.toLowerCase())===e.toLowerCase()})).length&&t.push(e)})),t}render(){return Ti.jsxs("div",{className:this.props.editClickOff?"click-off":"",children:[Ti.jsx(this.header,{data:this.props.pushJson}),0===this.state.activeTab?Ti.jsx(this.content,{contentType:"TEXT",data:this.props.notificationData}):null,1===this.state.activeTab?Ti.jsx(this.content,{contentType:"EDM",data:this.props.notificationData}):null,2===this.state.activeTab?Ti.jsx(this.templateComponent,{}):null]})}}const Qc=ua,td=[],ed=["Notification","Emergency","Enter sound name"],id=["Hour(s)","Day(s)"],sd=["Minute(s)","Hour(s)","Day(s)"];class ad extends Ni.Component{constructor(t){super(t),ji(this,"tabs",[{text:"Create",iconLeft:"icon-rs-text-document-edge-large icons-lg marginB10",disable:!1,id:0},{text:"Import",iconLeft:"icon-rs-import-file-edge-large icons-lg marginB10",disable:!0,id:1},{text:"Template",iconLeft:"icon-rs-template-edge-large icons-lg marginB10",disable:!0,id:2}]),ji(this,"state",{isRequestForApproval:!1,approverName:"",isCouponCodeBtnClicked:!1,hashTags:this.props.notificationData.hashTag.length>0?this.props.notificationData.hashTag:[],isFirstCustomButtonChoose:this.props.notificationData.interActivity.length>0&&""!==this.props.notificationData.interActivity[0].actionName&&3===this.props.notificationData.interActivity[0].actionId,isSecondCustomButtonChoose:this.props.notificationData.interActivity.length>1&&""!==this.props.notificationData.interActivity[1].actionName&&3===this.props.notificationData.interActivity[1].actionId,activeTab:"TEXT"===this.props.notificationData.contentType?0:"EDM"===this.props.notificationData.contentType?1:"TEMPLATE"===this.props.notificationData.contentType?2:-1,isSendRecommendation:!1,isDaylightSaving:!1,editTimeZone:!1,addBtnClick:this.props.notificationData.interActivity.length>1,bodyTextCount:"",isInterActivity:this.props.notificationData.isInteractivebuttonEnabled,interActivityButton1Name:this.props.notificationData.interActivity.length>0?this.props.notificationData.interActivity[0].actionName:"",interActivityButton2Name:this.props.notificationData.interActivity.length>1?this.props.notificationData.interActivity[1].actionName:"",interActivityButton1:"Button",interActivityButton2:"Button",isAlertSound:this.props.notificationData.isAlertSound,alertEnter:!0,isExpiry:this.props.notificationData.isExpiryButtonEnabled,isOpenCustomButtonModal:!1,isFirstCustomButton:!1,interActivityObject:{actionName:"",actionId:"",actionType:"",fontColor:"",bgColor:"",url:"",maybeLaterTimeings:""},expiryType:this.props.notificationData.pushexpirySchedule,expiryValue:this.props.notificationData.pushExpiryhours,frequencyType:"",frequencyValue:"",alertSound:this.props.notificationData.alertSound,schedule:this.props.notificationData.scheduleDate,clicked:0,isShow:!1,isTitleEmoji:!1,isTitlePerson:!1,isSubTitlePerson:!1,titlePerson:"",subTitlePerson:"",titleEmoji:"",subTitleEmoji:"",isSubtitleEmoji:!1,titleValue:this.props.notificationData.title,titleTextCount:(null==(Je=null==(_e=null==(We=this.props)?void 0:We.notificationData)?void 0:_e.title)?void 0:Je.length)?null==(Ye=null==(Ke=null==(Ze=this.props)?void 0:Ze.notificationData)?void 0:Ke.title)?void 0:Ye.length:0,titleValuePosition:0,subTitleValue:this.props.notificationData.subTitle,bodyValue:this.props.notificationData.body,titleColor:this.props.notificationData.titleColor,errContent:null,errTitle:null,errSubtitle:null,errBody:null,errInterActivityButton1:null,errInterActivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashtag:null,errSchedule:null,errFrequencyType:null,errFrequencyValue:null,timeZone:"-- "+Xs+" --",timeZoneList:[],refreshPopup:!1}),ji(this,"CreateInteractivityObject",(t=>({actionName:t,actionId:Ba(t),actionType:t.toLowerCase(),fontColor:"",bgColor:"",url:4===Ma(t)?4:"",maybeLaterTimeings:"",interactivehours:0,reschedule:"",value:Ma(t)}))),ji(this,"GetButtonsForPreview",(t=>{let e=[];return void 0!==t&&t.length>0&&t.forEach((t=>{t.actionName.length>0&&e.push({text:t.actionName,bgColor:t.bgColor,fontColor:t.fontColor})})),e})),ji(this,"componentDidUpdate",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A;isNaN(Date.parse(this.props.notificationData.scheduleDate))||this.props.notificationData.scheduleDate,t!==this.props&&(this.setTimeZone(),this.setState({titleValue:this.props.notificationData.title,titleValuePosition:this.props.notificationData.subTitlePosition,subTitleValue:this.props.notificationData.subTitle,personalizeChooseCount:0,bodyValue:this.props.notificationData.body,titleColor:this.props.notificationData.titleColor,alertSound:this.props.notificationData.alertSound,schedule:(null==(i=null==(e=this.props)?void 0:e.notificationData)?void 0:i.schedule)||"",hashTags:this.props.notificationData.hashTag,expiryType:this.props.notificationData.pushexpirySchedule,expiryValue:this.props.notificationData.pushExpiryhours,isAlertSound:this.props.notificationData.isAlertSound,isExpiry:this.props.notificationData.isExpiryButtonEnabled,isInterActivity:this.props.notificationData.isInteractivebuttonEnabled,interActivityButton1Name:this.props.notificationData.interActivity.length>0?this.props.notificationData.interActivity[0].actionName:"",interActivityButton2Name:this.props.notificationData.interActivity.length>1?this.props.notificationData.interActivity[1].actionName:"",interActivityButton1:"Button",interActivityButton2:"Button",errContent:null==(a=null==(s=this.props)?void 0:s.carouselError)?void 0:a.errContentType,errTitle:null==(l=null==(n=this.props)?void 0:n.carouselError)?void 0:l.errTitle,errSubtitle:null==(r=null==(o=this.props)?void 0:o.carouselError)?void 0:r.errSubtitle,errBody:null==(d=null==(c=this.props)?void 0:c.carouselError)?void 0:d.errBody,errInterActivityButton1:null==(h=null==(p=this.props)?void 0:p.carouselError)?void 0:h.errInteractivityButton1,errInterActivityButton2:null==(m=null==(u=this.props)?void 0:u.carouselError)?void 0:m.errInteractivityButton2,errAlertSound:null==(y=null==(v=this.props)?void 0:v.carouselError)?void 0:y.errAlertSound,errExpiryType:null==(b=null==(g=this.props)?void 0:g.carouselError)?void 0:b.errExpiryType,errExpiryValue:null==(x=null==(f=this.props)?void 0:f.carouselError)?void 0:x.errExpiryValue,errHashtag:null==(C=null==(S=this.props)?void 0:S.carouselError)?void 0:C.errHashTag,errSchedule:null==(T=null==(j=this.props)?void 0:j.carouselError)?void 0:T.errSchdule,errFrequencyType:null==(k=null==(I=this.props)?void 0:I.carouselError)?void 0:k.errFrequencyType,errFrequencyValue:null==(A=null==(D=this.props)?void 0:D.carouselError)?void 0:A.errFrequencyValue}))})),ji(this,"componentDidMount",(()=>{var t,e,i,s;this.props.notificationData.interActivity.map((t=>{if("maybe later"===t.actionType&&""!==t.maybeLaterTimeings){let e=t.maybeLaterTimeings.split(" ");this.setState({frequencyType:e[1],frequencyValue:e[0]})}})),this.setTimeZone();var a="";(null==(e=null==(t=this.props)?void 0:t.notificationData)?void 0:e.schedule)?this.setState({schedule:null==(s=null==(i=this.props)?void 0:i.notificationData)?void 0:s.schedule}):(a=isNaN(Date.parse(this.props.notificationData.scheduleDate))?"":this.props.notificationData.scheduleDate,this.setState({schedule:a}));const n=Zs();[...this.tabs].forEach((t=>{"Template"===t.text||"Import"===t.text?t.disable=!0:t.disable=!1})),this.configureTabs(),this.setState({timeZoneList:n.timeZone}),document.addEventListener("mousedown",this.handleClickOutside)})),ji(this,"handleClickOutside",(t=>{this.colorPickerRef.current&&!this.colorPickerRef.current.contains(t.target)&&this.setState({isShow:!1})})),ji(this,"setTimeZone",(()=>{var t,e,i,s,a,n,l,o,r,c,d;let p=fs().clientDetailsLocalization;vn();let h=null==(t=Zs())?void 0:t.timeZone,u=null==h?void 0:h.filter((t=>(null==t?void 0:t.timezoneId)===(null==p?void 0:p.timeZoneId)));null!==(null==p?void 0:p.timeZoneId)&&void 0!==(null==p?void 0:p.timeZoneId)&&0!==(null==p?void 0:p.timeZoneId)||(u=[h[0]]),""!==(null==(i=null==(e=this.props)?void 0:e.notificationData)?void 0:i.timezoneId)&&void 0!==(null==(a=null==(s=this.props)?void 0:s.notificationData)?void 0:a.timezoneId)?(u=null==h?void 0:h.filter((t=>{var e,i;return(null==t?void 0:t.timezoneId)===(null==(i=null==(e=this.props)?void 0:e.notificationData)?void 0:i.timezoneId)})),this.setState({timeZone:{timezoneId:null==(n=u[0])?void 0:n.timezoneId,timezoneName:null==(l=u[0])?void 0:l.timezoneName,timezoneValue:null==(o=u[0])?void 0:o.timezoneValue,offSet:null==(r=u[0])?void 0:r.gmtOffset}})):this.setState({timeZone:{timezoneId:(null==p?void 0:p.timeZoneId)||0,timezoneName:(null==p?void 0:p.timeZoneName)||"-- Select timezone --",timezoneValue:null==(c=u[0])?void 0:c.timezoneValue,offSet:null==(d=u[0])?void 0:d.gmtOffset}})})),ji(this,"alertDelivaryType",(()=>{let t=[...this.tabs];t.forEach((t=>{"Template"!==t.text&&"Import"!==t.text||(t.disable=!0)})),this.tabs=t})),ji(this,"configureTabs",(()=>{if("web"===this.props.type){if("TEXT"===this.props.notificationData.contentType)return void this.alertDelivaryType();if(2===this.props.pushType||3===this.props.pushType){let t=[...this.tabs];t.forEach((t=>{var e,i,s;t.disable=!0,""===this.props.notificationData.contentType&&(t.disable=!1),"template"===(null==(e=this.props.notificationData.contentType)?void 0:e.toLowerCase())&&"Template"===t.text&&(t.disable=!1),"create"===(null==(i=this.props.notificationData.contentType)?void 0:i.toLowerCase())&&"Create"===t.text&&(t.disable=!1),"import"===(null==(s=this.props.notificationData.contentType)?void 0:s.toLowerCase())&&"Import"===t.text&&(t.disable=!1)})),this.tabs=t}else 1===this.props.pushType&&this.alertDelivaryType()}else if(2===this.props.pushType||3===this.props.pushType||4===this.props.pushType){let t=[...this.tabs];t.forEach((t=>{var e,i,s;t.disable=!0,""===this.props.notificationData.contentType&&(t.disable=!1),"template"===(null==(e=this.props.notificationData.contentType)?void 0:e.toLowerCase())&&"Template"===t.text&&(t.disable=!1),"create"===(null==(i=this.props.notificationData.contentType)?void 0:i.toLowerCase())&&"Create"===t.text&&(t.disable=!1),"import"===(null==(s=this.props.notificationData.contentType)?void 0:s.toLowerCase())&&"Import"===t.text&&(t.disable=!1)})),this.tabs=t}else if(1===this.props.pushType){let t=[...this.tabs];t.forEach((t=>{t.disable=!1,"Template"!==t.text&&"Import"!==t.text||(t.disable=!0)})),this.tabs=t}})),ji(this,"buttonClick",(t=>{this.setState({clicked:t,isShow:!0})})),ji(this,"onOpen",(t=>{var e,i;null==(i=null==(e=this.contentRef)?void 0:e.current)||i.focus()})),ji(this,"onFocus",(()=>{clearTimeout(this.blurTimeoutRef.current)})),ji(this,"onBlurTimeout",(()=>{this.setState({isShow:!1})})),ji(this,"onBlur",(()=>{clearTimeout(this.blurTimeoutRef.current),this.blurTimeoutRef.current=setTimeout(this.onBlurTimeout,200)})),ji(this,"header",(t=>Ti.jsx("div",{className:`rs-tabs-with-heading rs-tabs-bg-fill ${-1===this.state.activeTab?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper transition"} stricky-window push-content mb30`,children:Ti.jsxs(Jl,{className:"rs-flat-tabs",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"d-flex align-items-center",children:Ti.jsx(Ao,{right:!0,label:"Push content",className:"font-medium"})}),Ti.jsx(Zl,{md:9,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errContent&&Ti.jsx("div",{className:"rich-content-error validation-message transY-35",children:this.state.errContent}),Ti.jsx(Pi,{defaultSelectedItem:this.state.activeTab,defaultClass:"",dynamicTab:"rs-content-tabs-flat "+(-1===this.state.activeTab?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:this.tabs,callBack:(e,i)=>{[...this.tabs].map((t=>{t!==e&&(t.disable=!0)})),this.setState({errContent:null}),this.props.carouselError.errContentType=null,this.props.notificationData.contentType=0===i?"TEXT":1===i?"EDM":"TEMPLATE",t.data.body=1===i?"":t.data.body,this.setState({activeTab:i})},refresh:""!==t.data.push.content[0].contentType,onRefresh:()=>{this.setState({refreshPopup:!0})},onRefreshTooltip:"Choose a new content"}),this.state.refreshPopup&&Ti.jsxs(_l,{backdrop:"static",show:this.state.refreshPopup,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Note"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({refreshPopup:!1})}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx("p",{children:"This action will clear the content from all the fields."}),Ti.jsx("div",{className:"d-flex justify-content-end",children:Ti.jsx(ns,{onClick:()=>{this.setState({titleValue:"",subTitleValue:"",bodyValue:"",bodyTextCount:"",hashTags:[],isInterActivity:!1,interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton2Name:"",frequencyValue:"",frequencyType:"",isExpiry:!1,expiryType:"",expiryValue:"",isAlertSound:!1,alertSound:"",editTimeZone:!1,activeTab:-1}),this.setState({errContent:null}),this.props.notificationData.contentType="",this.props.notificationData.importContent="",this.props.notificationData.templateId=0,this.props.notificationData.templateName="",this.props.notificationData.templateDescription="",this.props.notificationData.edmUrl="",this.props.notificationData.title="",this.props.notificationData.titleColor="",this.props.notificationData.bgColor="",this.props.notificationData.subTitle="",this.props.notificationData.body="",this.props.notificationData.hashTag=[],this.props.notificationData.isInteractivebuttonEnabled=!1,this.props.notificationData.interActivity=[],this.props.notificationData.interActivityButton1Name="",this.props.notificationData.interActivityButton2Name="",this.props.notificationData.isExpiryButtonEnabled=!1,this.props.notificationData.pushexpirySchedule="",this.props.notificationData.pushExpiryhours=0,this.props.notificationData.isAlertSound=!1,this.props.notificationData.alertSound="",this.props.notificationData.timezone="-- Select time zone --",this.props.notificationData.contentType="",this.props.notificationData.url="",this.props.notificationData.contentType="",this.props.notificationData.bodyBgColor="",this.props.notificationData.htmlBody="",this.props.notificationData.mobTimerBgColor="",this.props.notificationData.mobTimerTTL="",this.props.notificationData.mobTimerTextColor="",this.configureTabs(),this.forceUpdate(),this.setState({refreshPopup:!1})},children:"Ok"})})]})]})]})})]})}))),ji(this,"getHashTagUpdation",(()=>{var t;return(null==(t=this.state.hashTags)?void 0:t.length)+" / 5"})),ji(this,"content",(t=>{var e,i,s,a,n,l,o,r;return Ti.jsxs("div",{className:this.props.editClickOff?"click-off":"",children:["TEXT"===t.data.contentType||"EDM"===t.data.contentType?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"#Hashtags"})}),Ti.jsxs(Zl,{md:6,children:[Ti.jsx("div",{className:"chips-input-container two-line",children:Ti.jsx(Fl,{noDropdown:!0,data:td,allowCustom:!0,value:this.state.hashTags,onChange:t=>{if(t.target.value.length>5)return;let e=[];t.target.value.filter((t=>""!==Ls(t))),t.target.value.map(((i,s)=>{let a=Ls(i);!ss(a)&&a.length<=25?(i=a,e.push(a)):t.target.value.splice(s,1)}));let i=[...e];i=i.map(((t,e)=>t.includes("#")?t:"#"+t));const s=i.reduce(((t,e)=>t.find((t=>t===e))?t:t.concat([e])),[]);this.props.pushJson.push.content.map(((t,e)=>{t.hashTag=s})),this.setState({hashTags:s})}})}),Ti.jsx("small",{class:`rs-form-small-text fs12 d-inline-block text-end w-100 ${5===(null==(e=this.state.hashTags)?void 0:e.length)&&"red"}`,children:`${5===(null==(i=this.state.hashTags)?void 0:i.length)?Ha:""}  ${(null==(s=this.state.hashTags)?void 0:s.length)>0?this.getHashTagUpdation():" 0 / 5"}`})]}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"View analytics for trending topics",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Expiry"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:t=>{this.props.pushJson.push.content.map(((e,i)=>{e.isExpiryButtonEnabled=t.target.value})),this.setState({isExpiry:t.target.value}),this.setState({errExpiryType:null}),this.props.carouselError.errExpiryType=null,this.setState({expiryValue:""}),this.props.pushJson.push.content.map(((t,e)=>{t.pushexpirySchedule="",t.pushExpiryhours=""})),this.setState({expiryType:""})},checked:this.state.isExpiry})})]})}),this.props.notificationData.isExpiryButtonEnabled?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{data:id,errorMessage:this.state.errExpiryType,required:!0,label:"Expiry duration",value:void 0!==this.state.expiryType&&""!==this.state.expiryType?"H"===this.state.expiryType?"Hour(s)":"Day(s)":"-- Select --",onChange:t=>{let e=t.target.value.length>0?null:ya;this.setState({errExpiryType:e}),this.props.carouselError.errExpiryType=e,this.setState({expiryValue:""}),this.props.pushJson.push.content.map(((e,i)=>{e.pushexpirySchedule="Hour(s)"===t.target.value?"H":"D",e.pushExpiryhours=0})),this.setState({expiryType:"Hour(s)"===t.target.value?"H":"D"})}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{required:!0,placeholder:"Value",val:this.state.expiryValue,keyboardType:"number",max:Tl,cb:t=>{let e=t.length>0?null:ga;this.setState({errExpiryValue:e}),this.props.carouselError.errExpiryValue=e,this.props.pushJson.push.content.map(((e,i)=>{e.pushExpiryhours=t})),""!==this.state.expiryType&&"D"===this.state.expiryType&&(""!==t?t.length<=3&&t<=100&&this.setState({expiryValue:t}):this.setState({expiryValue:""})),""!==this.state.expiryType&&"H"===this.state.expiryType&&(""===t||/^[0-9]{1,24}$/.test(t))&&t<=24&&this.setState({expiryValue:t}),""!==this.state.expiryType&&"Minute(s)"===this.state.expiryType&&(""===t||/^[0-9]{1,60}$/.test(t))&&t<=60&&this.setState({expiryValue:t})},ob:t=>{"H"===this.state.expiryType?""!==t&&0!==parseInt(t)||this.setState({errExpiryValue:"Enter the hours for expiry"}):""!==t&&0!==parseInt(t)||this.setState({errExpiryValue:"Enter the days for expiry"})},errorMessage:this.state.errExpiryValue})})]})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"Set an expiry time to control when messages are delivered, making it perfect for time-sensitive communications",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})}):null,"web"!==this.props.type?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Alert sound"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:t=>{this.props.pushJson.push.content.map(((e,i)=>{e.isAlertSound=t.target.value})),this.setState({isAlertSound:t.target.value,alertEnter:!1})},checked:this.state.isAlertSound})})]})}):null]}):null,!0===this.state.isAlertSound?Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:!0===this.state.alertEnter?Ti.jsx(ql,{required:!0,placeholder:"Enter sound name",errorMessage:this.state.errAlertSound,val:this.state.alertSound,iconTooltip:"Close",iconPlaceholder:!0,iconName:ba,iconColor:"red",iconSize:"sm",iconOnClick:()=>{this.props.carouselError.errAlertSound=null,this.setState({errAlertSound:null}),this.setState({alertEnter:!1,alertSound:""}),this.props.pushJson.push.content.map(((t,e)=>{t.alertSound=""}))},cb:t=>{if(t.length>50)return;let e=t.length>0?null:fa;this.setState({errAlertSound:e,alertSound:t}),this.props.notificationError.errAlertSound=e,this.props.carouselError.errAlertSound=e,this.setState({errAlertSound:e}),this.setState({alertEnter:!1,alertSound:""}),this.props.pushJson.push.content.map(((e,i)=>{e.alertSound=t}))},ob:t=>{let e=t.length>0?null:fa;this.props.carouselError.errAlertSound=e,this.setState({errAlertSound:e}),this.setState({alertSound:t}),this.props.pushJson.push.content.map(((e,i)=>{e.alertSound=t}))}}):Ti.jsx(Ul,{cls:"paddingR30 mb0 mt20",data:ed,label:"Alert",required:!0,value:void 0!==this.state.alertSound&&""!==this.state.alertSound?this.state.alertSound:"-- Select --",onChange:t=>{if(t.target.value.toLowerCase().includes("enter"))return this.props.carouselError.errAlertSound=null,this.setState({errAlertSound:null}),this.setState({alertEnter:!0,alertSound:""}),void this.props.pushJson.push.content.map(((t,e)=>{t.alertSound=""}));let e=t.target.value.length>0?null:fa;this.setState({errAlertSound:e}),this.props.carouselError.errAlertSound=e,this.props.pushJson.push.content.map(((e,i)=>{e.alertSound=t.target.value})),this.setState({alertSound:t.target.value})}})})})}):null,0===this.props.dynamicListId&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs($l,{className:"rs-tabs-bg-fill even",children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"py20",children:Ti.jsx(Ao,{right:!0,label:"Schedule"})}),Ti.jsxs(Zl,{md:6,className:"py20",children:[Ti.jsx(Vo,{name:"schedulerName"+t.index+1,placeholder:"Select schedule date and time",errorMessage:this.state.errSchedule,format:!0===(null==(n=null==(a=fs())?void 0:a.timeFormat)?void 0:n.includes("24"))?{skeleton:"yMMMdEHmSs"}:"MMM dd, yyyy:HH:mm a",min:In(new Date(ao(this.props.campaignPlan.startDate).add(0,"day").toString()),15,null==(r=null==(o=null==(l=this.props.pushJson)?void 0:l.push)?void 0:o.content[0])?void 0:r.timeZoneId),max:en(new Date(ao(this.props.campaignPlan.endDate).add(0,"day").toString())),steps:{minute:5,second:10},value:""!==this.state.schedule?new Date(this.state.schedule):null,handleChange:e=>{const i=(new Date).toLocaleString([],{timeZone:this.state.timeZone.timezoneValue,hour12:!1}),[s,a]=i.split(", ");s.split("/");const[n,l,o]=a.split(":"),r=new Date;r.setHours(n),r.setMinutes(l),r.setSeconds(o);var c=r;e.target.value>c?(this.setState({schedule:e.target.value}),this.props.carouselError.errSchdule=null,this.setState({errSchedule:null}),this.props.pushJson.push.content.map(((t,i)=>{t.scheduleDate=e.target.value.toISOString().slice(0,19).replace("T"," "),t.schedule=e.target.value,Tn(),t.localScheduleTime=ao(e.target.value).format("yyyy-MM-DD HH:mm:ss")}))):(this.setState({errSchedule:"Selected value lesser than current date and time"}),setTimeout((()=>{t.data.push.content[0].scheduleDate="",this.props.carouselError.errSchdule=null,this.props.pushJson.push.content.map(((t,e)=>{t.scheduleDate="",t.schedule="",t.localScheduleTime=""})),this.setState({errSchedule:null})}),2e3))}}),""!==this.state.schedule&&Ti.jsx("div",{className:"input-inner-set right52 zIndex2",children:Ti.jsx("i",{className:"icon-rs-close-mini icons-sm red posr bottom-10 right0 fs13",onClick:()=>{this.setState({schedule:""}),this.props.pushJson.push.content.map(((t,e)=>{t.scheduleDate="",t.schedule="",t.localScheduleTime=""}))}})}),Ti.jsx(Jl,{children:!1===this.state.editTimeZone?Ti.jsx(Zl,{children:Ti.jsxs("div",{className:"float-end d-flex align-items-center",children:[Ti.jsx("small",{className:"float-end fs12",children:this.state.timeZone.offSet}),Ti.jsx(Xi,{children:Ti.jsx(Qi,{tooltip:"Select time zone",icon:"icon-rs-pencil-edit-mini",size:"sm",onClick:()=>{this.setState({editTimeZone:!0})}})})]})}):null})]}),Ti.jsx(Zl,{md:2,className:"py20"})]}),this.state.editTimeZone?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pt23 pb20",children:Ti.jsx(Ao,{right:!0,label:"Select time zone"})}),Ti.jsx(Zl,{md:6,className:"pt23 pb20",children:Ti.jsx(Ul,{required:!0,label:"Timezone",data:this.state.timeZoneList,value:this.state.timeZone,textField:"timezoneName",dataItemKey:"timezoneId",onChange:e=>{const i=(new Date).toLocaleString([],{timeZone:e.target.value.timezoneValue,hour12:!1}),[s,a]=i.split(", ");s.split("/");const[n,l,o]=a.split(":"),r=new Date;r.setHours(n),r.setMinutes(l),r.setSeconds(o),r>this.state.schedule||(this.setState({errSchedule:"Selected value lesser than current date and time"}),setTimeout((()=>{t.data.push.content[0].scheduleDate="",this.props.carouselError.errSchdule=null,this.props.pushJson.push.content.map(((t,e)=>{t.scheduleDate="",t.schedule="",t.localScheduleTime=""})),this.setState({errSchedule:null})}),2e3)),this.props.pushJson.push.content.map(((t,i)=>{t.timezoneId=e.target.value.timezoneId,t.scheduleDate="",t.schedule="",t.localScheduleTime=""})),this.setState({schedule:""}),this.setState({timeZone:e.target.value})}})}),Ti.jsx(Zl,{md:2,className:"pt23 pb20"})]}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pt23 pb20"}),Ti.jsx(Zl,{md:6,className:"pb20",children:Ti.jsx(Mo,{children:Ti.jsx(Vl,{disabled:!this.state.timeZone.isDayLight,lbl:"Daylight saving",checked:this.state.isDaylightSaving,cb:t=>{this.setState({isDaylightSaving:!this.state.isDaylightSaving})}})})}),Ti.jsx(Zl,{md:2,className:"pb20"})]})]}):null]})})]})})),ji(this,"dynamicContent",(t=>{var e,i,s,a;const n=this.state.bodyTextCount.replace("/",""),l=t=>{let e=t.trim(),i=0;for(let s=0;s<e.length;s++){const t=e[s];("["===t||"]"===t)&&i++}return i},o=e=>{this.state;let i=e.target.value,s=e.target.selectionStart;t.data.titlePosition=e.target.selectionStart;let a=!0;const n=i.split("|");for(const t of n){let e=0;for(const i of t)"["===i?e++:"]"===i&&e--,e<0&&(a=!1);0!==e&&(a=!1)}if(a){let t=i.length>0?null:this.state.errTitle;this.setState({titleValue:i,isTitlePerson:!this.state.isTitlePerson,errTitle:t})}else t.data.titlePosition=e.target.selectionStart,this.setState({titlePosition:s,errTitle:"In correct type"})};return Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"marginT30 carousel-split",children:["TEXT"===t.contentType?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:(this.props.type,"Title")})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{type:"textarea",required:!0,className:"rs-input  required",placeholder:"Title",val:this.state.titleValue,errorMessage:this.state.errTitle,onBlur:t=>{o(t)},onChange:e=>{let i=e.target.value.trimStart();i=i.replace(/\s+/g," "),this.tabs.map((t=>{0!==t.id&&(t.disable=!0)}));let s=(t=>{let e="";for(let a=0;a<t.length;a++){const i=t[a];" "!==i&&(e+=i)}let i=0,s=!1;for(let a=0;a<e.length;a++){const t=e[a];"["===t?s=!0:"]"===t?s=!1:s||"|"==t||i++}return i})(i);if(l(i),s>60)return;let a=s;this.setState({titleTextCount:a});let n=i.length>0?null:Ra;this.setState({errTitle:n}),this.props.carouselError.errTitle=n,this.setState({titleValue:i}),t.data.title=i}})}),Ti.jsx(Zl,{md:4,className:"instant-preview",children:this.state.titleValue.length>0||t.data.body.length>0||t.data.subTitle.length>0||t.data.url.length?Ti.jsx(bo,{isAuthoring:!0,data:this.props.data,pushType:this.props.pushType,content:t.data,title:this.state.titleValue,body:t.data.body,titleColor:t.data.titleColor&&t.data.titleColor,bodyColor:t.data.bodyBgColor&&t.data.bodyBgColor,bodyFontColor:t.data.bodyTextColor&&t.data.bodyTextColor,subTitle:""!==t.data.subTitle?t.data.subTitle:"",type:this.props.type,imageSrc:t.data.url,customArray:(this.props.type,this.GetButtonsForPreview(t.data.interActivity))}):null})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"justify-content-between",children:[Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx(ws,{text:"Personalize",position:"top",children:Ti.jsx(Hi,{items:Qc,icon:" icon-rs-user-question-mark-edge-medium color-primary-blue icons-md",onItemClick:e=>{const i=e.item.text.replace(/\[\[|\]\]/g,"");var s=`${i} NOTFOUND`;i.includes("NAME")&&(s="CUSTOMER");let a=`[[${i}]] | [[${s}]] `;const n=[];n.push(this.state.titleValue,a);const o=n.filter((t=>""!==t)),r=n.filter((t=>""!==t)).join("");t.data.title=r;let c=l(r);if(c<=40){let t=e.item.text.length>0?null:this.state.errTitle;this.setState({titleValue:r,titleValueDublicate:o,isTitlePerson:!this.state.isTitlePerson,errTitle:t,personalizeChooseCount:c})}else this.setState({errTitle:"Only 5 personalize add"})}})}),Ti.jsxs(Xi,{className:"ml10",children:[Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:"icon-rs-circle-smile-medium color-primary-blue icons-md cp",ref:this.emojianochor,onClick:()=>{this.buttonClick(2),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}})})}),Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.fontcoloranochor,onClick:()=>this.buttonClick(3)})}),3===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,show:this.state.isShow,selectColor:t.data.titleColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);this.setState({titleColor:l}),t.data.titleColor=l,this.setState({clicked:0})}})}):null]})]})]}),Ti.jsx(Po,{className:`${60===this.state.titleTextCount&&"red"}`,text:0===this.state.titleTextCount?"60":this.state.titleTextCount+"/60"})]})})})]}),Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Body"})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errBody&&Ti.jsx("div",{className:"validation-message align-end body-text",children:this.state.errBody}),"mobile"===this.props.type?Ti.jsx(Bc,{...this.props,data:t.data,notificationData:t.data,mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){let e=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null,a=l>0?l.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.carouselError&&(this.props.carouselError.errBody=e);let o=gn(i);t.data.body=bn(i),t.data.htmlBody=bn(i),""!==t.data.bodyTextColor&&(o.replace(/<p>(.*?)<\/p>/,`<p style="color:${t.data.bodyTextColor}">$1</p>`),t.data.body=bn(i),t.data.htmlBody=bn(i))}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.htmlBody+"</font>",r=`<span color="${i}">`+t.data.htmlBody+"</span>";gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`),t.data.body=r,t.data.bodyTextColor=i,t.data.htmlBody=r}else"url"===e?t.data[e]=i:"onBlur"===e?(t.data.bodyPosition=i.target.selectionStart,n&&this.setState({errBody:n})):"bodyBgColor"===e?t.data.bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(t,e)=>{this.props.pushJson.push.content.map(((i,s)=>{i[t]=e})),this.forceUpdate()}}):Ti.jsx(Bc,{...this.props,data:t.data,notificationData:t.data,mobilepush:"mobile"===this.props.type,deliveryTypeId:this.props.pushType,campaignPlan:this.props.campaignPlan,personalizeTabData:[],bodyContent:t.data.htmlBody,getErrorMessage:t=>{this.setState({errBody:t})},callBack:(e,i,s,a,n,l)=>{if("bodytext"===e){let e=0==l&&""==s?yn:"Add only 5 personalization"==n||"In correct type"==n?n:null,a=l>0?l.toString()+"/":"";this.setState({errBody:e,bodyTextCount:a}),this.props.carouselError&&(this.props.carouselError.errBody=e);let o=gn(i);t.data.body=bn(i),t.data.htmlBody=bn(i),""!==t.data.bodyTextColor&&(o.replace(/<p>(.*?)<\/p>/,`<p style="color:${t.data.bodyTextColor}">$1</p>`),t.data.body=bn(i),t.data.htmlBody=bn(i))}else if("bodyTextColor"===e){var o=`<font color="${i}">`+t.data.htmlBody+"</font>",r=`<span color="${i}">`+t.data.htmlBody+"</span>";gn(o).replace(/<p>(.*?)<\/p>/,`<p style="color:${i}">$1</p>`),t.data.body=r,t.data.bodyTextColor=i,t.data.htmlBody=r}else"url"===e?t.data[e]=i:"onBlur"===e?(t.data.bodyPosition=i.target.selectionStart,n&&this.setState({errBody:n})):"bodyBgColor"===e?t.data.bodyBgColor=i:"timerBtnClicked"===e&&this.setState({timerBtnClicked:!0});this.forceUpdate()},timerModal:(t,e)=>{this.props.pushJson.push.content.map(((i,s)=>{i[t]=e})),this.forceUpdate()}})]})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsx(Mo,{children:this.state.bodyTextCount?Ti.jsx(Po,{right:!0,text:350===Number(n)?Ti.jsxs("span",{children:["Maximum character limit reached"," ",Ti.jsx("span",{className:"color-dark-red font-bold",children:"350"})," "]}):Number(n)>299?Ti.jsxs("span",{children:["Available"," ",Ti.jsx("span",{className:"blue",children:Number(n)-350})," ","characters only"," ",Ti.jsx("span",{className:"color-medium-orange font-bold",children:this.state.bodyTextCount+"350"})," "]}):Ti.jsx("span",{children:this.state.bodyTextCount+"350"})}):Ti.jsx(Po,{right:!0,text:"Upto 350 characters are allowed."})})})})]}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Interactivity"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(qo,{onChange:e=>{e.target.value?(t.data.isInteractivebuttonEnabled=e.target.value,this.setState({isInterActivity:e.target.value}),t.data.interActivity.length>0&&(t.data.interActivity=[]),t.data.interActivity[0]=this.CreateInteractivityObject("")):(this.setState({addBtnClick:!1,isInterActivity:e.target.value,interActivityButton1:"Button",interActivityButton2:"Button",interActivityButton1Name:"-- Select --",interActivityButton2Name:"-- Select --",frequencyType:"",frequencyValue:""}),t.data.isInteractivebuttonEnabled=e.target.value,t.data.interActivity=[])},checked:this.state.isInterActivity})})]})}),!0===this.state.isInterActivity?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:["Button"],label:"Interactivity type",required:!0,value:void 0!==this.state.interActivityButton1&&""!==this.state.interActivityButton1?this.state.interActivityButton1:"-- Select  --",handleChange:t=>{this.setState({interActivityButton1:t.target.value})}})}),"Button"===this.state.interActivityButton1?Ti.jsx(Zl,{children:Ti.jsx(Ul,{data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),required:!0,label:"Interactive actions",errorMessage:this.state.errInterActivityButton1,value:void 0!==this.state.interActivityButton1Name&&""!==this.state.interActivityButton1Name?this.state.interActivityButton1Name:"-- Select --",handleChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isFirstCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isFirstCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:fn;this.setState({errInterActivityButton1:s}),this.props.carouselError.errInteractivityButton1=s,2===t.data.interActivity.length||null!==t.data.interActivity[0]?t.data.interActivity[0]=i:t.data.interActivity.push(i),t.data.interActivityButton1Name=e.target.value,this.setState({interActivityButton1Name:e.target.value}),this.forceUpdate()}})}):null]})}),"Button"===this.state.interActivityButton1?Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:"Button"===this.state.interActivityButton1?Ti.jsxs(Xi,{children:[""!==this.state.interActivityButton1Name&&"-- Select --"!==this.state.interActivityButton1Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca1FontColorAnochor,onClick:()=>this.buttonClick(4)})}),4===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.ca1FontColorAnochor,show:this.state.isShow,selectColor:t.data.interActivity[0].fontColor,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);t.data.interActivity[0].fontColor=l}})}):null]}),1===this.props.pushType||2===this.props.pushType||3===this.props.pushType?Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca1BackgroundColorAnochor,onClick:()=>this.buttonClick(5)})}),5===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.ca1BackgroundColorAnochor,selectColor:t.data.interActivity[0].bgColor,show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);t.data.interActivity[0].bgColor=l}})}):null]})}):null]}):null,this.state.isFirstCustomButtonChoose?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Qi,{tooltip:"Configure custom action",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{let e=t.data.interActivity[0];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal,isFirstCustomButton:!this.state.isFirstCustomButton})}})}):null,Ti.jsx(Qi,{tooltip:"Add",icon:"icon-rs-circle-plus-fill-edge-medium",iconClass:`${this.state.addBtnClick&&"click-off"}`,size:"md",onClick:()=>{0!==t.data.interActivity.length&&""!==t.data.interActivity[0].actionName?(t.data.interActivity[1]=this.CreateInteractivityObject(""),this.setState({addBtnClick:!0})):this.setState({errInterActivityButton1:fn})}})]}):null})}):null]})}),"Maybe later"===t.data.interActivityButton1Name?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:sd,label:"Frequency type",required:!0,errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",handleChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.carouselError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.interActivity[0].maybeLaterTimeings=e.target.value,t.data.interActivity[0].reschedule=e.target.value,t.data.interActivity[0].interactivehours=e.target.value}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(ql,{placeholder:"Enter frequency time",cls:"marginB0",required:!0,val:this.state.frequencyValue,keyboardType:"number",max:jl,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.carouselError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.interActivity[0].interactivehours=parseInt(e),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(this.setState({frequencyValue:e}),t.data.interActivity[0].interactivehours=parseInt(e),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(this.setState({frequencyValue:e}),t.data.interActivity[0].interactivehours=parseInt(e),t.data.interActivity[0].maybeLaterTimeings=e+" "+this.state.frequencyType)},errorMessage:this.state.errFrequencyValue})})]})}):null,!0===this.state.addBtnClick?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:["Button"],label:"Interactivity type",value:void 0!==this.state.interActivityButton2&&""!==this.state.interActivityButton2?this.state.interActivityButton2:"-- Select  --",required:!0,onChange:t=>{this.setState({interActivityButton2:t.target.value})}})}),"Button"===this.state.interActivityButton2?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{data:"mobile"===this.props.type?this.getMobileInteractivityButtons():this.getWebInteractivityButtons(),required:!0,label:"Interactive actions",errorMessage:this.state.errInterActivityButton2,value:void 0!==this.state.interActivityButton2Name&&""!==this.state.interActivityButton2Name?this.state.interActivityButton2Name:"-- Select --",onChange:e=>{let i=null;"Custom action"!==e.target.value?(this.setState({isSecondCustomButtonChoose:!1}),i=this.CreateInteractivityObject(e.target.value)):(this.setState({isSecondCustomButtonChoose:!0}),i=this.CreateInteractivityObject(""),i.actionId=3);let s=e.target.value.length>0?null:Sn;this.setState({errInterActivityButton2:s}),this.props.carouselError.errInteractivityButton2=s,2===t.data.interActivity.length?t.data.interActivity[1]=i:null===t.data.interActivity[1]?t.data.interActivity.push(i):t.data.interActivity[1]=i,t.data.interActivityButton2Name=e.target.value,this.setState({interActivityButton2Name:e.target.value})}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[""!==this.state.interActivityButton2Name&&"-- Select --"!==this.state.interActivityButton2Name?Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:this.ca2FontColorAnochor,onClick:()=>this.buttonClick(6)})}),6===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.ca2FontColorAnochor,show:this.state.isShow,selectColor:(null==(i=null==(e=t.data)?void 0:e.interActivity[1])?void 0:i.fontColor)||"black",cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);t.data.interActivity[1].fontColor=l}})}):null]}),2===this.props.pushType&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"rsp-icon rsp-icon-md",children:[Ti.jsx(ws,{text:"Background color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.ca2BackgroundColorAnochor,onClick:()=>this.buttonClick(7)})}),7===this.state.clicked&&!0===this.state.isShow?Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.ca2BackgroundColorAnochor,selectColor:(null==(a=null==(s=t.data)?void 0:s.interActivity[1])?void 0:a.bgColor)||"white",show:this.state.isShow,cancelBtnClicked:()=>{this.setState({clicked:0})},applyBtnClicked:e=>{this.setState({clicked:0});var i=e.split("("),s=parseInt(i[1].split(",")[0]),a=parseInt(i[1].split(",")[1]),n=parseInt(i[1].split(",")[2]),l=Pa(s,a,n);t.data.interActivity[1].bgColor=l}})}):null]})})]}):null,this.state.isSecondCustomButtonChoose?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Qi,{tooltip:"Configure custom action",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{let e=t.data.interActivity[1];this.setState({interActivityObject:e}),this.setState({isOpenCustomButtonModal:!this.state.isOpenCustomButtonModal})}})}):null,Ti.jsx(Qi,{tooltip:"Remove",icon:"icon-rs-circle-minus-fill-edge-medium",size:"md",color:"red",onClick:()=>{this.setState({addBtnClick:!1}),this.setState({clicked:0});let e=Bs(t.data.interActivity);t.data.interActivity=[e[0]],this.setState({interActivityButton2Name:"",isSecondCustomButtonChoose:!1}),this.forceUpdate()}})]})})})]}):null]})}):null,!0===this.state.addBtnClick&&"Maybe later"===t.data.interActivityButton2Name?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:2},children:Ti.jsx(Ul,{data:sd,label:"Frequency type",required:!0,errorMessage:this.state.errFrequencyType,value:void 0!==this.state.frequencyType&&""!==this.state.frequencyType?this.state.frequencyType:"-- Select --",onChange:e=>{let i=e.target.value.length>0?null:xn;this.setState({errFrequencyType:i}),this.props.carouselError.errFrequencyType=i,this.setState({frequencyType:e.target.value}),this.setState({frequencyValue:""}),t.data.interActivity[1].reschedule=e.target.value,t.data.interActivity[1].maybeLaterTimeings=e.target.value}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(ql,{placeholder:"Enter frequency time",cls:"marginB0",required:!0,val:this.state.frequencyValue,keyboardType:"number",max:jl,cb:e=>{let i=e.length>0?null:va;this.setState({errFrequencyValue:i}),this.props.carouselError.errFrequencyValue=i,""!==this.state.frequencyType&&"Day(s)"===this.state.frequencyType&&(""===e||/^[0-1]{1,1}$/.test(e))&&e<=1&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Hour(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,24}$/.test(e))&&e<=24&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType),""!==this.state.frequencyType&&"Minute(s)"===this.state.frequencyType&&(""===e||/^[0-9]{1,60}$/.test(e))&&e<=60&&(this.setState({frequencyValue:e}),t.data.interActivity[1].interactivehours=parseInt(e),t.data.interActivity[1].maybeLaterTimeings=e+" "+this.state.frequencyType)},errorMessage:this.state.errFrequencyValue})})]})}):null]}):null]}):"EDM"===this.props.notificationData.contentType&&Ti.jsx(Dc,{index:this.props.index,type:this.props.type,isCarousel:!0,content:this.props.notificationData,error:this.props.carouselError,smartAppStore:this.props.smartAppStore,bodyData:t.data.body,getBodyContent:(t,e)=>{let i=t.length>0?null:Ra;this.props.notificationData.importContent=e,this.props.carouselError.errBody=i,this.props.notificationData.body=e},emptyData:(t,e)=>{this.props.carouselError.errBody=e,this.props.notificationData.importContent=e},onChange:t=>{this.props.notificationData.makeAlert=t.makeAlert,this.props.notificationData.title=t.title,this.props.notificationData.shortDesc=t.shortDesc,this.props.notificationData.hashTag=t.hashTag,this.props.notificationData.isInteractivebuttonEnabled=t.isInterActivity,this.props.notificationData.interActivity=t.interActivity,this.props.notificationData.isAlertSound=t.isAlertSound,this.props.notificationData.alertSound=t.alertSound,this.props.notificationData.isExpiryButtonEnabled=t.isExpiry,this.props.notificationData.pushexpirySchedule=t.expiryType,this.props.notificationData.pushExpiryhours=t.expiryValue,this.props.carouselError.errInteractivityButton1=null,this.props.carouselError.errInteractivityButton2=null}}),"TEMPLATE"===this.props.notificationData.contentType&&Ti.jsx(Rc,{fullData:this.props.data,index:this.props.index,type:this.props.type,isCarousel:!0,content:this.props.notificationData,error:this.props.carouselError,smartAppStore:this.props.smartAppStore,bodyData:t.data.body,getBodyContent:(t,e)=>{let i=t.length>0?null:Ra;this.props.notificationData.importContent=e,this.props.carouselError.errBody=i,this.props.notificationData.body=e},emptyData:(t,e)=>{this.props.carouselError.errBody=e,this.props.notificationData.importContent=e},onChange:t=>{this.props.notificationData.makeAlert=t.makeAlert,this.props.notificationData.title=t.title,this.props.notificationData.shortDesc=t.shortDesc,this.props.notificationData.hashTag=t.hashTag,this.props.notificationData.isInteractivebuttonEnabled=t.isInterActivity,this.props.notificationData.interActivity=t.interActivity,this.props.notificationData.isAlertSound=t.isAlertSound,this.props.notificationData.alertSound=t.alertSound,this.props.notificationData.isExpiryButtonEnabled=t.isExpiry,this.props.notificationData.pushexpirySchedule=t.expiryType,this.props.notificationData.pushExpiryhours=t.expiryValue,this.props.carouselError.errInteractivityButton1=null,this.props.carouselError.errInteractivityButton2=null}}),this.state.isCouponCodeBtnClicked&&Ti.jsx(vc,{isOpen:this.state.isCouponCodeBtnClicked,onChangeIsOpen:()=>{this.setState({isCouponCodeBtnClicked:!1})}}),!0===this.state.isOpenCustomButtonModal?Ti.jsx(kc,{isOpen:this.state.isOpenCustomButtonModal,isWeb:"web"===this.props.type,smartAppStore:this.props.smartAppStore,selectInterActivity:this.state.interActivityObject,onChangeIsOpen:t=>{this.setState({isOpenCustomButtonModal:t})},showSmartLink:()=>{this.props.showSmartLink()},onSaveClick:e=>{if(this.state.isFirstCustomButton){t.data.interActivity[0].actionName=e.actionName,t.data.interActivity[0].actionType=e.actionType,t.data.interActivityButton1Name=e.actionName;let i=e.actionName.length>0?null:fn;this.setState({errInterActivityButton1:i}),this.props.carouselError.errInteractivityButton1=i,t.data.interActivity[0].url=e.url,t.data.interActivity[0].clickBehavourValue=e.clickBehavourValue,t.data.interActivity[0].countryCode=e.countryCode,this.setState({interActivityButton1Name:e.actionName,isFirstCustomButton:!this.state.isFirstCustomButton})}else{t.data.interActivity[1].actionName=e.actionName,t.data.interActivity[1].actionType=e.actionType,t.data.interActivityButton2Name=e.actionName;let i=e.actionName.length>0?null:fn;this.setState({errInterActivityButton2:i}),this.props.carouselError.errInteractivityButton2=i,t.data.interActivity[1].url=e.url,t.data.interActivity[1].clickBehavourValue=e.clickBehavourValue,t.data.interActivity[1].countryCode=e.countryCode,this.setState({interActivityButton2Name:e.actionName})}}}):null,1===this.state.clicked?Ti.jsx($i,{anchor:this.anchor.current,show:this.state.isShow,popupClass:"popup-content",style:{width:100},children:Ti.jsx(Hl,{data:["Value 1","Value 2","Value 3"],value:"-- select personalition --",onChange:e=>{if(this.setState({clicked:0}),this.state.isTitlePerson){if(t.data.title.length>=60)return;let i=ca(t.data.title,e.target.value,t.data.titlePosition);t.data.title=i,this.setState({titleValue:i}),this.setState({isTitlePerson:!this.state.isTitlePerson})}else{if(t.data.subTitle.length>=60)return;let i=ca(t.data.subTitle,e.target.value,t.data.subTitlePosition);t.data.subTitle=i,this.setState({subTitleValue:i}),this.setState({isSubTitlePerson:!this.state.isSubTitlePerson})}}})}):null,2===this.state.clicked?Ti.jsx(oc,{anchor:this.emojianochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{if(this.state.titleValue.length<=58){let i=ca(t.data.title,e,t.data.titlePosition);t.data.title=i,t.data.titlePosition=t.data.titlePosition+2;let s=this.state.titleTextCount+2;this.setState({titleValue:t.data.title,titlePosition:t.data.titlePosition+2,titleTextCount:s}),this.setState({isTitleEmoji:!this.state.isTitleEmoji})}}}):null,8===this.state.clicked?Ti.jsx(oc,{anchor:this.subTitleEmojiAnochor,show:this.state.isShow,onOpen:this.onOpen,onFocus:this.onFocus,ref:this.contentRef,onBlur:this.onBlur,tabindex:0,onEmojiClick:e=>{this.setState({subTitleEmoji:e}),t.data.subTitle=t.data.subTitle+e,this.setState({subTitleValue:t.data.subTitle}),this.setState({isSubtitleEmoji:!this.state.isSubtitleEmoji})}}):null]})})})),ji(this,"importComponent",(t=>Ti.jsx("div",{className:"marginT25",children:Ti.jsx("h1",{children:"Import"})}))),this.anchor=Ni.createRef(),this.fontcoloranochor=Ni.createRef(),this.backgroundcoloranochor=Ni.createRef(),this.emojianochor=Ni.createRef(),this.subTitleEmojiAnochor=Ni.createRef(),this.ca1FontColorAnochor=Ni.createRef(),this.ca1BackgroundColorAnochor=Ni.createRef(),this.ca2FontColorAnochor=Ni.createRef(),this.ca2BackgroundColorAnochor=Ni.createRef(),Ys("lsConfig"),this.contentRef=Ni.createRef(),this.blurTimeoutRef=Ni.createRef(),this.colorPickerRef=Ni.createRef()}getMobileInteractivityButtons(){let t=["Dismiss","Maybe later"];0===this.props.dynamicListId?(t.push("Unsubscribe"),t.push("Custom action")):t.push("Custom action");var e=[];return t.map((t=>{0===this.props.notificationData.interActivity.filter((e=>e.actionName.toLowerCase()===t.toLowerCase())).length&&e.push(t)})),e}getWebInteractivityButtons(){let t=["Dismiss"];0===this.props.dynamicListId?(t.push("Unsubscribe"),t.push("Custom action")):t.push("Custom action");var e=[];return t.map((t=>{0===this.props.notificationData.interActivity.filter((e=>{var i;return(null==(i=null==e?void 0:e.actionName)?void 0:i.toLowerCase())===t.toLowerCase()})).length&&e.push(t)})),e}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}render(){var t;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"mt30 "+(9!==(null==(t=this.props)?void 0:t.jobStatusId)&&this.props.editClickOff?"click-off":""),children:[Ti.jsx(this.header,{data:this.props.pushJson}),0===this.state.activeTab?Ti.jsx(this.dynamicContent,{contentType:"TEXT",data:this.props.notificationData}):null,1===this.state.activeTab?Ti.jsx(this.dynamicContent,{contentType:"EDM",data:this.props.notificationData}):null,2===this.state.activeTab?Ti.jsx(this.dynamicContent,{contentType:"TEMPLATE",data:this.props.notificationData}):null]}),this.state.activeTab>=0&&Ti.jsx(this.content,{index:this.props.index,data:this.props.notificationData,json:this.props.pushJson})]})}}const nd=["Hour(s)","Day(s)","Week(s)","Month(s)"];class ld extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isShow:this.props.isOpen,isAutoSchedule:this.props.splitDetails.isAutoSchedule,campPerformanceBy:this.props.splitDetails.campaignPerFormanceBy,scheduleBy:null==(Qe=null==(Xe=this.props)?void 0:Xe.splitDetails)?void 0:Qe.scheduleBy,periodValue:(null==(ei=null==(ti=this.props)?void 0:ti.splitDetails)?void 0:ei.duration)||8,periodType:(null==(si=null==(ii=this.props)?void 0:ii.splitDetails)?void 0:si.period)||nd[0],errCampPerformanceByMsg:null,errPeriodValueMsg:null,errPeriodTypeMsg:null}),ji(this,"componentDidMount",(()=>{})),ji(this,"saveWebSplitAutoSchedule",(()=>{var t,e;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);if(null==i?void 0:i.cId){let t={CampaignID:null==i?void 0:i.cId,AutoSchedule:this.state.isAutoSchedule,PerformedBy:this.state.campPerformanceBy,StartIn:this.state.periodValue,PeriodRange:this.state.periodType,StatusID:1};os({path:kn,isCache:!1,params:t,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{},fail:t=>{}})}})),ji(this,"saveMobSplitAutoSchedule",(()=>{var t,e;this.props.campaignId,this.state.isAutoSchedule,!1===this.state.isAutoSchedule||!0===this.state.campPerformanceBy||this.state.scheduleBy,!1===this.state.isAutoSchedule||this.state.periodValue,!1===this.state.isAutoSchedule||this.state.periodType;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);if(null==i?void 0:i.cId){let t={CampaignID:null==i?void 0:i.cId,AutoSchedule:this.state.isAutoSchedule,PerformedBy:this.state.campPerformanceBy,StartIn:this.state.periodValue,PeriodRange:this.state.periodType,StatusID:1};os({path:Dn,isCache:!1,params:t,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{},fail:t=>{}})}}))}render(){var t,e,i,s;return Ti.jsxs(_l,{show:this.state.isShow,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Schedule"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isShow:!this.state.isShow}),this.props.onChangeIsOpen(!1)}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:5,children:Ti.jsx(Ao,{label:"Auto schedule"})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(qo,{onChange:t=>{this.props.splitDetails.isAutoSchedule=t.target.value,this.setState({isAutoSchedule:t.target.value})},checked:this.state.isAutoSchedule})})]})}),this.state.isAutoSchedule&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:5,children:Ti.jsx(Ao,{label:"Communication performance by"})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errCampPerformanceByMsg&&Ti.jsx("div",{className:"validation-message",children:this.state.errCampPerformanceByMsg}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Content",name:"campPerformance1",labelId:"campPerformanceId1",className:"",checked:!!(null==(e=null==(t=this.state.campPerformanceBy)?void 0:t.toLowerCase())?void 0:e.includes("content")),cb:t=>{this.props.splitDetails.campaignPerFormanceBy=t.target.value,this.setState({campPerformanceBy:t.target.value,scheduleBy:!1,errCampPerformanceByMsg:null})}})}),Ti.jsx(Zl,{md:4,children:Ti.jsx(Rl,{lbl:"Schedule",name:"schedule01",labelId:"Schedule01",className:"",checked:!!(null==(s=null==(i=this.state.campPerformanceBy)?void 0:i.toLowerCase())?void 0:s.includes("schedule")),cb:t=>{t.target.value&&(this.props.splitDetails.campaignPerFormanceBy=t.target.value,this.setState({scheduleBy:t.target.value,campPerformanceBy:t.target.value,errCampPerformanceByMsg:null}))}})})]})]})})]})}),Ti.jsx($l,{children:Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:7,offset:5},children:Ti.jsxs(Jl,{children:[Ti.jsxs(Zl,{className:"d-flex",children:[Ti.jsx("i",{className:"icon-rs-time-medium color-primary-blue icons-md"}),Ti.jsx("label",{className:"ml10",children:"Start in"})]}),Ti.jsx(Zl,{md:5,children:Ti.jsx(ql,{placeholder:"Enter value",val:this.state.periodValue,max:2,errorMessage:this.state.errPeriodValueMsg,cb:t=>{let e=parseInt(t);if(e>=8&&e<=23){let e=t<=0?"Enter period value":null;this.props.splitDetails.duration=t,this.setState({periodValue:t,errPeriodValueMsg:e})}else{let e="Period value min 8 to 23",i=0===t.length?"":t;this.setState({errPeriodValueMsg:e,periodValue:i})}}})}),Ti.jsx(Zl,{md:3,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errPeriodTypeMsg&&Ti.jsx("div",{className:"validation-message",children:this.state.errPeriodTypeMsg}),Ti.jsx(Yo,{data:nd,defaultItem:this.state.periodType,value:this.state.periodType,customAlignRight:!0,className:"fs16-btn",onSelect:(t,e)=>{let i=""===t?"PERIOD_TYPE":null;this.props.splitDetails.period=t,this.setState({periodType:t,errPeriodTypeMsg:i})}})]})})]})})})})]})]}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isShow:!this.state.isShow}),this.props.onChangeIsOpen(!1)},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{if(this.state.isAutoSchedule){if(ss(this.state.campPerformanceBy))return this.setState({errCampPerformanceByMsg:"CAMP_PERFORMANCE"}),!1;if(this.state.periodValue<=0)return this.setState({errPeriodValueMsg:"PERIOD_VALUE"}),!1;if(ss(this.state.periodType))return this.setState({errPeriodTypeMsg:"PERIOD_TYPE"}),!1}this.setState({isShow:!this.state.isShow}),this.props.onDataUpdate({isAutoSchedule:this.state.isAutoSchedule,campaignPerFormanceBy:!1===this.state.isAutoSchedule?"":!0===this.state.campPerformanceBy?"content":!0===this.state.scheduleBy?"schedule":"",duration:!1===this.state.isAutoSchedule?0:this.state.periodValue,period:!1===this.state.isAutoSchedule?"":this.state.periodType}),this.props.web?this.saveWebSplitAutoSchedule():this.saveMobSplitAutoSchedule(),this.props.onChangeIsOpen(!1)},children:"Save"})]})]})}}ji(ld,"contextType",Ji);const od=wi(ld),rd=["red","green","blue","orange"];class cd extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isShow:this.props.isOpen,splitList:null==(ai=this.props.data)?void 0:ai.splitList,splitAudience:null==(ni=this.props.data)?void 0:ni.splitAudience,totalAuidence:null==(li=this.props.data)?void 0:li.totalAuidence,splitSizePercentage:(null==(oi=this.props.data)?void 0:oi.splitSizePercentage)||10,count:0,width:0,isDragging:!1,originalWith:0,percentage:0}),ji(this,"containerRef",Ni.createRef()),ji(this,"draggingRef",Ni.createRef()),ji(this,"lastPageX",0),ji(this,"calculateWidth",(()=>{this.containerRef.current.offsetWidth,this.state.width;const t=Math.floor(20/this.props.data.splitList.length),e=Math.floor(20/this.props.data.splitList.length)*this.state.splitSizePercentage,i=t*this.props.data.splitList.length,s=Math.ceil(i*this.props.data.totalAuidence/100);this.setState({width:Math.round(e),count:s,originalWith:Math.round(e),percentage:t})})),ji(this,"handleMouseMove1",(t=>{if(!this.state.isDragging)return;let e=0;e=2===this.props.data.splitList.length?.2:3===this.props.data.splitList.length?.35:.45;const i=this.containerRef.current.offsetWidth;Math.floor(i/this.props.data.splitList.length*e);const s=this.state.width,{pageX:a}=t,n=a-this.lastPageX;this.lastPageX=a;const l=Math.max(0,Math.min(i-s,this.state.width+n));let o=this.state.width/this.state.splitList.length;if(o>20||o<3)return;const r=Math.round(o/100*this.props.data.totalAuidence);this.setState({width:l,count:r,percentage:o})})),ji(this,"handleMouseMove",(t=>{if(!this.state.isDragging)return;const e=this.containerRef.current.offsetWidth,i=this.state.width,s=this.props.data.splitList.length,{pageX:a}=t,n=a-this.lastPageX;this.lastPageX=a;const l=Math.max(0,Math.min(e-i,this.state.width+n)),o=100/s*2,r=100/s*10,c=Math.round(l/(e-i)*100);if(2!==c&&(c<o||c>r)&&l<this.state.originalWith){const t=Math.round(c/100*this.props.data.totalAuidence);this.setState({width:l,count:t,percentage:c},(()=>{}))}})),ji(this,"handleMouseDown",(t=>{t.preventDefault(),this.setState({isDragging:!0}),this.lastPageX=t.pageX})),ji(this,"handleMouseUp",(()=>{this.setState({isDragging:!1})})),ji(this,"getMatchedAuidence",(()=>this.getSingalAuidencePercentage()*this.props.data.splitList.length)),ji(this,"getSingalAuidencePercentage",(()=>{let t=this.state.totalAuidence*this.state.percentage/100;return Math.floor(t)}))}componentDidMount(){this.calculateWidth()}render(){var t;const{splitList:e,totalAuidence:i}=this.props.data;return this.state.width,e.length,Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"rs-split-top",children:[Ti.jsxs("span",{className:"d-flex",children:[Ti.jsx("label",{children:"Split size :"}),Ti.jsxs("div",{className:"d-flex",children:[Ti.jsx("span",{children:this.getMatchedAuidence()}),Ti.jsxs("span",{children:["/",this.state.totalAuidence]})]})]}),Ti.jsxs("span",{children:["% of audience viewing the winning communication: ",this.state.totalAuidence-this.getMatchedAuidence()||0," (",Math.round(100-this.state.percentage*e.length)||0,")%"]})]}),Ti.jsx("div",{className:"rs-split-silder-canvas-wrapper",ref:this.containerRef,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseUp,children:Ti.jsxs("div",{className:"rs-split-wrapper",children:[e.map(((t,e)=>Ti.jsx("span",{id:"rs_box",className:"rssw-box",style:{background:rd[e],width:this.state.width+"px"},children:Ti.jsx("span",{className:"rs-split-box-lables",style:{color:rd[e]},children:t.splitType})},e))),Ti.jsx("img",{src:uo,onMouseDown:this.handleMouseDown,ref:this.draggingRef})]})}),Ti.jsx("div",{className:"rs-split-slider-bottom",children:Ti.jsx("ul",{className:"rs-list-inline rli-space-25 mt10",children:null==(t=this.state.splitList)?void 0:t.map(((t,e)=>Ti.jsxs("li",{children:[Ti.jsx("span",{className:"rs-split-bottom-label-round",style:{backgroundColor:rd[e]},children:t.splitType}),Ti.jsxs("span",{className:"rs-split-bottom-label-number",children:[this.getSingalAuidencePercentage(),Ti.jsxs("span",{className:"rss-percentage",children:["( "+Math.floor(this.state.percentage)||0,"% "," )"]})]})]},e)))})}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[Ti.jsx(as,{onClick:()=>{this.props.cancelBtnClicked()},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{this.props.saveBtnClicked({percentage:this.state.percentage,matchedAuidence:this.getMatchedAuidence(),totalAuidence:this.state.totalAuidence})},children:"Save"})]})]})}}const dd=t=>{const[e,i]=Di.useState([]);Di.useEffect((()=>{s(0)}),[]);const s=t=>({contentName:`Content ${t+1}`,deviceType:"Device type",fieldTrackData:[]});return Di.useEffect((()=>{}),[null==t?void 0:t.selectedContainer]),Ti.jsxs(Jl,{children:[Ti.jsx("label",{children:"Dynamic Section"}),Ti.jsx(Xl,{activeKey:"tab0",id:"uncontrolled-tab-example",className:"mb-3 borderB0",children:null==e?void 0:e.map(((t,e)=>Ti.jsx(Ql,{eventKey:"tab0",children:Ti.jsx("div",{children:Ti.jsx("label",{children:null==t?void 0:t.contentName})})})))})]})},pd=t=>{var e,i,s;const[a,n]=Di.useState(1),[l,o]=Di.useState(null),[r,c]=Di.useState([{text:"Create",iconLeft:"icon-rs-text-document-edge-large icons-lg",disable:!1,id:0},{text:"Import",iconLeft:"icon-rs-import-file-edge-large icons-lg",disable:!1,id:2},{text:"Template",iconLeft:"icon-rs-template-edge-large icons-lg",disable:!0,id:3}]);Di.useEffect((()=>{var e,i,s,a,l,o;"TEXT"===(null==(s=null==(i=null==(e=null==t?void 0:t.notificationData)?void 0:e.push)?void 0:i.content[0])?void 0:s.contentType)?n(0):"EDM"===(null==(o=null==(l=null==(a=null==t?void 0:t.notificationData)?void 0:a.push)?void 0:l.content[0])?void 0:o.contentType)&&n(1)}),[null==(s=null==(i=null==(e=null==t?void 0:t.notificationData)?void 0:e.push)?void 0:i.content[0])?void 0:s.contentType]),Di.useEffect((()=>{o(null==t?void 0:t.errActivityTab)}),[null==t?void 0:t.errActivityTab]),Di.useEffect((()=>{5===(null==t?void 0:t.pushType)&&d(5)}),[null==t?void 0:t.pushType]);const d=t=>{let e=[...r];e.map((e=>{e.disable=!0,5===t?1!==e.id&&2!==e.id||(e.disable=!1):e.id===t&&(e.disable=!1)})),c(e)};return Ti.jsx("div",{children:Ti.jsx("div",{className:`rs-tabs-with-heading rs-tabs-bg-fill ${-1===a?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper transition"} stricky-window push-content mb30`,children:Ti.jsxs(Jl,{className:"rs-flat-tabs",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"d-flex align-items-center",children:Ti.jsx(Ao,{right:!0,label:"Push content",className:"font-medium"})}),Ti.jsx(Zl,{md:7,className:"ml0",children:Ti.jsxs("div",{className:"position-relative",children:[l&&Ti.jsx("div",{className:"rich-content-error validation-message mt-30",children:l}),Ti.jsx(Pi,{defaultSelectedItem:a,defaultClass:"",dynamicTab:"rs-content-tabs-flat "+(-1===a?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:r,callBack:(e,i)=>{let s=[...r];s.map((t=>{t!==e&&(t.disable=!0)})),c(s),n(i),null==t||t.selectTab(i)},refresh:-1===a,onRefresh:()=>{null==t||t.refreshTab()}})]})})]})})})},hd=t=>{const e=Di.useRef(),i=Di.useRef(),s=Di.useRef(),a=Di.useRef(),n=Di.useRef(),l=Di.useRef(),[o,r]=Di.useState(""),[c,d]=Di.useState(""),[p,h]=Di.useState(0),[u,m]=Di.useState(""),[v,y]=Di.useState(!1),[g,b]=Di.useState(!1);Di.useEffect((()=>(document.addEventListener("mousedown",f),()=>{document.addEventListener("mousedown",f)})),[]);const f=t=>{a.current&&!a.current.contains(t.target)&&b(!1)};Di.useEffect((()=>{r(null==t?void 0:t.title)}),[null==t?void 0:t.title]),Di.useEffect((()=>{m(null==t?void 0:t.errTitle)}),[null==t?void 0:t.errTitle]),Di.useEffect((()=>{d(null==t?void 0:t.titleColor)}),[null==t?void 0:t.titleColor]);const x=()=>{y(!1)};return Ti.jsxs($l,{children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Title"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(ql,{ref:e,required:!0,type:"textarea",placeholder:"Title",val:o,max:60,errorMessage:u,onBlur:e=>{r(e.target.value),h(e.target.selectionStart),null==t||t.onChange("title",value),null==t||t.onChange("titlePosition",e.target.selectionStart)},onChange:t=>{if(t.target.value.length>60)return;let e=t.target.value.trimStart();e=e.replace(/\s+/g," ");let i=e.length>0?null:Ra;r(e),m(i)}})})]}),Ti.jsx(Jl,{children:Ti.jsx(Zl,{md:{span:6,offset:2},children:Ti.jsxs(Mo,{className:"d-flex justify-content-between",children:[Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx(Hi,{className:"click-off",items:[],icon:` ${Oa} color-primary-blue icons-md`,onItemClick:t=>{}}),Ti.jsxs(Xi,{className:"ml10",children:[!0===(null==t?void 0:t.showEmoji)&&Ti.jsx("div",{className:"rsp-icon rsp-icon-md",children:Ti.jsx(ws,{text:"Emoji",position:"top",children:Ti.jsx("i",{className:`${qa} color-primary-blue icons-md cp`,ref:i,onClick:()=>{y(!v)}})})}),!0===(null==t?void 0:t.showTextColor)&&Ti.jsxs("div",{className:"rsp-icon rsp-icon-md position-relative top2",children:[Ti.jsx(ws,{text:"Text color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-text-medium color-primary-blue icons-md cp",ref:n,onClick:()=>b(!0)})}),g?Ti.jsx("div",{ref:a,children:Ti.jsx(Oo,{anchor:n,selectColor:c,show:g,cancelBtnClicked:()=>{b(!1)},applyBtnClicked:e=>{var i=ha(e);d(i),b(!1),null==t||t.onChange("titleColor",i)}})}):null]})]})]}),Ti.jsx("small",{className:`float-end fs12 ${60===(null==o?void 0:o.length)&&"red"}`,children:null==o||0===(null==o?void 0:o.length)?60:(null==o?void 0:o.length)+"/60"})]})})}),!0===v?Ti.jsx(oc,{anchor:i,show:v,onOpen:t=>{var e;null==(e=s.current)||e.focus()},onFocus:()=>{clearTimeout(l.current)},ref:s,onBlur:()=>{clearTimeout(l.current),l.current=setTimeout(x,200)},tabindex:0,onEmojiClick:e=>{if((null==o?void 0:o.length)<=58){let i=ca(o,e,p),s=p+2;r(i),h(s),null==t||t.onChange("title",i),null==t||t.onChange("titlePosition",s)}},emojiClose:()=>{y(!1)}}):null]})},ud=t=>{var e,i,s,a,n,l;return Di.useState(null),Di.useEffect((()=>{}),[null==t?void 0:t.notificationContent]),Ti.jsx(Jl,{children:Ti.jsx(hd,{...t,title:null==(s=null==(i=null==(e=null==t?void 0:t.notificationData)?void 0:e.push)?void 0:i.content[0])?void 0:s.title,titlePos:(null==(l=null==(n=null==(a=null==t?void 0:t.notificationData)?void 0:a.push)?void 0:n.content[0])?void 0:l.titlePos)||0,showEmoji:!0,showTextColor:!0,onChange:(e,i)=>{t.notificationData.push.content[0][e]=i}})})},md=t=>{var e,i;const[s,a]=Di.useState(null),[n,l]=Di.useState(null),[o,r]=Di.useState(null),[c,d]=Di.useState([]),[p,h]=Di.useState(!1);Di.useEffect((()=>{u()}),[]),Di.useEffect((()=>{}),[null==t?void 0:t.scheduleDate]),Di.useEffect((()=>{}),[null==t?void 0:t.errSchedule]),Di.useEffect((()=>{}),[null==t?void 0:t.localScheduleTime]),Di.useEffect((()=>{}),[null==t?void 0:t.timezoneId]);const u=()=>{var e,i,s,n,l,o,c,p,h,u,m;let v=Bs(t.scheduleDate);m=isNaN(Date.parse(v))?"":t.localScheduleTime;let y=fs().clientDetailsLocalization,g=null==(e=Zs())?void 0:e.timeZone,b=(null==g?void 0:g.filter((t=>(null==t?void 0:t.timezoneId)===(null==y?void 0:y.timeZoneId))))||[g[0]];null!==(null==y?void 0:y.timeZoneId)&&void 0!==(null==y?void 0:y.timeZoneId)&&0!==(null==y?void 0:y.timeZoneId)||(b=[g[0]]),a(m),d((null==(i=Zs())?void 0:i.timeZone)||[]),""!==t.timezoneId?(b=null==g?void 0:g.filter((e=>(null==e?void 0:e.timezoneId)===t.timezoneId)),r({timezoneId:null==(s=b[0])?void 0:s.timezoneId,timezoneName:null==(n=b[0])?void 0:n.timezoneName,timezoneValue:null==(l=b[0])?void 0:l.timezoneValue,offSet:null==(o=b[0])?void 0:o.gmtOffset})):r({timezoneId:(null==y?void 0:y.timeZoneId)||(null==(c=b[0])?void 0:c.timezoneId)||0,timezoneName:(null==y?void 0:y.timeZoneName)||(null==(p=b[0])?void 0:p.timezoneName)||"-- Select timezone --",timezoneValue:null==(h=b[0])?void 0:h.timezoneValue,offSet:null==(u=b[0])?void 0:u.gmtOffset})};return Ti.jsx(Ti.Fragment,{children:0===t.dynamicListId&&Ti.jsxs($l,{className:"rs-tabs-bg-fill even",children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"py20",children:Ti.jsx(Ao,{right:!0,label:"Schedule"})}),Ti.jsxs(Zl,{md:6,className:"py20",children:[Ti.jsx(Vo,{name:"schedulerName",placeholder:"Select schedule date and time",errorMessage:n,format:!0===(null==(i=null==(e=fs())?void 0:e.timeFormat)?void 0:i.includes("24"))?{skeleton:"yMMMdEHmSs"}:"MMM dd, yyyy:HH:mm a",min:tn(new Date(ao(t.campaignPlan.startDate).add(0,"day").toString()),2),max:en(new Date(ao(t.campaignPlan.endDate).add(0,"day").toString())),steps:{minute:2,second:10},value:""!==s?new Date(s):null,handleChange:e=>{const i=(new Date).toLocaleString([],{timeZone:null==o?void 0:o.timezoneValue,hour12:!1}),[s,n]=i.split(", "),[r,c,d]=n.split(":"),p=new Date;p.setHours(r),p.setMinutes(c),p.setSeconds(d);var h=p;e.target.value>h?(null==t||t.onChange({scheduleDate:e.target.value.toISOString().slice(0,19).replace("T"," "),errSchedule:null,localScheduleTime:ao(e.target.value).format("yyyy-MM-DD HH:mm:ss")}),a(e.target.value),l(null)):(l("Selected value lesser than current date and time"),setTimeout((()=>{t.scheduleDate="",a(""),l(null)}),2e3))}}),""!==s&&Ti.jsx("div",{className:"input-inner-set right52 zIndex2",children:Ti.jsx("i",{className:"icon-rs-close-mini icons-sm red posr bottom-10 right0 fs13",onClick:()=>{null==t||t.onChange({scheduleDate:"",errSchedule:null,localScheduleTime:""}),a("")}})}),Ti.jsx(Jl,{className:"marginT5",children:!1===p?Ti.jsx(Zl,{children:Ti.jsxs("div",{className:"float-end d-flex align-items-center",children:[Ti.jsx("small",{className:"fs12",children:null==o?void 0:o.offSet}),Ti.jsx(Xi,{children:Ti.jsx(Qi,{tooltip:"Select time zone",icon:"icon-rs-pencil-edit-mini",size:"sm",onClick:()=>{h(!0)}})})]})}):null})]}),Ti.jsx(Zl,{md:2,className:"py20"})]}),p?Ti.jsx(Ti.Fragment,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pt23 pb20",children:Ti.jsx(Ao,{right:!0,label:"Select time zone"})}),Ti.jsx(Zl,{md:6,className:"pt23 pb20",children:Ti.jsx(Ul,{required:!0,textField:"timezoneName",dataItemKey:"timezoneId",label:"Timezone",data:c,value:o||{timezoneId:0,timezoneName:"-- Select timezone --"},handleChange:e=>{r(e.target.value);const i=(new Date).toLocaleString([],{timeZone:e.target.value.timezoneValue,hour12:!1}),[n,o]=i.split(", "),[c,d,p]=n.split("/"),[h,u,m]=o.split(":"),v=new Date;v.setHours(h),v.setMinutes(u),v.setSeconds(m);let y=new Date;y.setDate(c),y.setMonth(parseInt(d)-1),y.setFullYear(p),y.setHours(h),y.setMinutes(u),y.setSeconds(m),t.data.push.content[0].timezoneId=e.target.value.timezoneId,""!==s&&s>v||(l("Selected value lesser than current date and time"),setTimeout((()=>{a(""),l(null),t.data.push.content[0].scheduleDate=""}),2e3))}})}),Ti.jsx(Zl,{md:2,className:"pt23 pb20"})]})}):null]})})},vd=({data:t,cancelBtnClick:e})=>{const i=Di.useContext(Ji),[s,a]=Di.useState(t),n=Di.useRef();Di.useRef();const[l,o]=Di.useState(null),[r,c]=Di.useState(null),d=()=>{n.current=null,o(null);const t=[...s];t.map(((t,e)=>t.priority=e+1)),a(t)};return Ti.jsxs("div",{className:"rs-grid-detail-view",style:{width:"100%"},children:[Ti.jsx("div",{children:null!=r&&Ti.jsx("div",{className:"error-message",children:r})}),Ti.jsxs("table",{className:"grid-detail-content",style:{width:"100%"},children:[Ti.jsx("thead",{className:"detail-component-header",children:Ti.jsxs("tr",{children:[Ti.jsx("th",{children:"Communication name"}),Ti.jsx("th",{children:"Priority"})]})}),Ti.jsx("tbody",{children:s.map(((t,e)=>Ti.jsxs("tr",{draggable:!0,onDragStart:()=>(t=>{n.current=t,o(t)})(e),onDragEnter:()=>(t=>{if(n.current===t)return;const e=[...s],i=e[n.current];e.splice(n.current,1),e.splice(t,0,i),n.current=t,o(t),a(e)})(e),onDragEnd:d,className:`${yd.draggableRow} ${l===e?"dragging":""}`,style:{cursor:"move",transition:"transform 0.2s ease-in-out",backgroundColor:l===e?"#e2e8f0":e%2==0?"#f9f9f9":"#fff",...e%2==0?yd.evenRow:yd.oddRow},children:[Ti.jsx("td",{style:yd.td,children:t.campaignName}),Ti.jsx("td",{style:{...yd.td,textAlign:"center"},children:Ti.jsx("div",{style:{...yd.priorityBadge,backgroundColor:(null==t?void 0:t.priority)>=7?"#ff6b6b":2===(null==t?void 0:t.priority)?"#4ecdc4":"#a5d8ff"},children:null==t?void 0:t.priority})})]},e)))})]}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[Ti.jsx(as,{onClick:e,children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{os({path:An,params:s,loading:i.globalStateData.setIsLoadingData,ok:t=>{(null==t?void 0:t.status)||(c((null==t?void 0:t.message)||"Please try again"),setTimeout((()=>{c(null)}),2e3))},fail:t=>{c("Please try again"),setTimeout((()=>{c(null)}),2e3)}})},children:"Update"})]})]})},yd={container:{fontFamily:"Arial, sans-serif",margin:"20px",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",backgroundColor:"#fff"},header:{color:"#333",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid #eee"},table:{width:"100%",borderCollapse:"collapse"},headerRow:{backgroundColor:"#f8f9fa"},th:{padding:"12px 15px",textAlign:"left",borderBottom:"1px solid #ddd",color:"#555"},td:{padding:"12px 15px",borderBottom:"1px solid #eee",color:"#333"},evenRow:{backgroundColor:"#f9f9f9"},oddRow:{backgroundColor:"#fff"},priorityBadge:{display:"inline-block",padding:"4px 8px",borderRadius:"12px",color:"white",fontWeight:"bold",fontSize:"0.8em"},draggableRow:{transition:"transform 0.2s ease-in-out","&:active":{backgroundColor:"#f1f5f9",cursor:"grabbing"},"&:hover":{backgroundColor:"#f8fafc",cursor:"grab"}},dragging:{opacity:.6,backgroundColor:"orange"}},gd=t=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f;const[x,S]=Di.useState({bannerId:0,bannerName:"Select container"}),[C,j]=Di.useState(null),[T,I]=Di.useState([]),[k,D]=Di.useState(null),[A,w]=Di.useState(1),[N,L]=Di.useState(1);Di.useState(null);const E=Di.useContext(Ji),[B,M]=Di.useState([]),[P,F]=Di.useState(!1);Di.useEffect((()=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g;S((null==(s=null==(i=null==(e=null==t?void 0:t.notificationData)?void 0:e.push)?void 0:i.containerData)?void 0:s.bannerId)>0?null==(n=null==(a=null==t?void 0:t.notificationData)?void 0:a.push)?void 0:n.containerData:{bannerId:0,bannerName:"Select container"}),null!==(null==(r=null==(o=null==(l=null==t?void 0:t.notificationData)?void 0:l.push)?void 0:o.containerData)?void 0:r.bannerId)&&void 0!==(null==(p=null==(d=null==(c=null==t?void 0:t.notificationData)?void 0:c.push)?void 0:d.containerData)?void 0:p.bannerId)&&0!==(null==(m=null==(u=null==(h=null==t?void 0:t.notificationData)?void 0:h.push)?void 0:u.containerData)?void 0:m.bannerId)&&R(null==(g=null==(y=null==(v=null==t?void 0:t.notificationData)?void 0:v.push)?void 0:y.containerData)?void 0:g.bannerId)}),[null==(i=null==(e=null==t?void 0:t.notificationData)?void 0:e.push)?void 0:i.containerData]),Di.useEffect((()=>{j(null==t?void 0:t.notificationData)}),[null==t?void 0:t.notificationData]),Di.useEffect((()=>("web"===(null==t?void 0:t.type)&&U(),()=>{D(null)})),[]),Di.useEffect((()=>{var e;(null==(e=null==t?void 0:t.smartAppStore)?void 0:e.length)>0&&"mobile"===(null==t?void 0:t.type)&&U()}),[null==t?void 0:t.smartAppStore]),Di.useEffect((()=>{var e,i,s,a;"web"===t.type&&(null==(a=null==(s=null==(i=null==(e=null==t?void 0:t.pushJson)?void 0:e.push)?void 0:i.domainName)?void 0:s.domainId)?void 0:a.length)>0&&U()}),[null==(a=null==(s=null==t?void 0:t.pushJson)?void 0:s.push)?void 0:a.domainName]),Di.useEffect((()=>{w(t.notificationData.push.content[0].impressionCount)}),[t.notificationData.push.content[0].impressionCount]),Di.useEffect((()=>{null!==t.notificationData.push.content[0].priority&&void 0!==t.notificationData.push.content[0].priority?L(t.notificationData.push.content[0].priority):L(1)}),[t.notificationData.push.content[0].priority]),Di.useEffect((()=>{D(null==t?void 0:t.errContainerData)}),[null==t?void 0:t.errContainerData]);const U=()=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x;let S={appId:"a280ab4d-0e62-4197-b22e-7e7428af212e",bannerName:"",bannerSize:"",domainName:""};if((null==(e=null==t?void 0:t.smartAppStore)?void 0:e.length)>0){if(void 0!==(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl)&&null!==(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl)){let e=JSON.parse(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl);if("mobile"===(null==t?void 0:t.type)){if(0===(null==(i=null==e?void 0:e.mobilePlatform)?void 0:i.length))return void D("Generate smartlink for the app");S.appId=null==(s=null==e?void 0:e.mobilePlatform[0].appName)?void 0:s.appId}else if("web"===t.type&&(null==(o=null==(l=null==(n=null==(a=null==t?void 0:t.pushJson)?void 0:a.push)?void 0:n.domainName)?void 0:l.domainId)?void 0:o.length)>0){S.appId="";const e=null==(d=null==(c=null==(r=null==t?void 0:t.pushJson)?void 0:r.push)?void 0:c.domainName)?void 0:d.domainUrl;S.domainName=null==(u=null==(h=null==(p=null==t?void 0:t.pushJson)?void 0:p.push)?void 0:h.domainName)?void 0:u.domainUrl;const i=null==e?void 0:e.substring(0,(null==e?void 0:e.length)-1);S.domainName=i}}}else{if(!("web"===t.type&&(null==(g=null==(y=null==(v=null==(m=null==t?void 0:t.pushJson)?void 0:m.push)?void 0:v.domainName)?void 0:y.domainId)?void 0:g.length)>0))return;{S.appId="";const e=null==(x=null==(f=null==(b=null==t?void 0:t.pushJson)?void 0:b.push)?void 0:f.domainName)?void 0:x.domainUrl,i=null==e?void 0:e.substring(0,(null==e?void 0:e.length)-1);S.domainName=i}}os({path:wn,params:S,loading:E.globalStateData.setIsLoadingData,ok:t=>{var e,i;if((null==t?void 0:t.status)&&(null==(e=null==t?void 0:t.data)?void 0:e.length)>0){let e=null==(i=null==t?void 0:t.data)?void 0:i.map((t=>(t.bannerName=`${null==t?void 0:t.bannerName} (${null==t?void 0:t.bannerSize})`,t)));I(e)}}})},R=(e,i)=>{var s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C;let j={appId:"a280ab4d-0e62-4197-b22e-7e7428af212e",bannerId:e,domainName:""};if((null==(s=null==t?void 0:t.smartAppStore)?void 0:s.length)>0){if(void 0!==(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl)&&null!==(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl)){let e=JSON.parse(null==t?void 0:t.smartAppStore[0].smartAppStoreUrl);if("mobile"===(null==t?void 0:t.type)){if(0===(null==(a=null==e?void 0:e.mobilePlatform)?void 0:a.length))return void D("Generate smartlink for the app");j.appId=null==(n=null==e?void 0:e.mobilePlatform[0].appName)?void 0:n.appId}else if("web"===t.type&&(null==(c=null==(r=null==(o=null==(l=null==t?void 0:t.pushJson)?void 0:l.push)?void 0:o.domainName)?void 0:r.domainId)?void 0:c.length)>0){j.appId="";const e=null==(h=null==(p=null==(d=null==t?void 0:t.pushJson)?void 0:d.push)?void 0:p.domainName)?void 0:h.domainUrl;j.domainName=null==(v=null==(m=null==(u=null==t?void 0:t.pushJson)?void 0:u.push)?void 0:m.domainName)?void 0:v.domainUrl;const i=null==e?void 0:e.substring(0,(null==e?void 0:e.length)-1);j.domainName=i}}}else{if(!("web"===t.type&&(null==(f=null==(b=null==(g=null==(y=null==t?void 0:t.pushJson)?void 0:y.push)?void 0:g.domainName)?void 0:b.domainId)?void 0:f.length)>0))return;{j.appId="";const e=null==(C=null==(S=null==(x=null==t?void 0:t.pushJson)?void 0:x.push)?void 0:S.domainName)?void 0:C.domainUrl,i=null==e?void 0:e.substring(0,(null==e?void 0:e.length)-1);j.domainName=i}}os({path:Nn,params:j,loading:E.globalStateData.setIsLoadingData,ok:t=>{(null==t?void 0:t.status)&&(M((null==t?void 0:t.data)||[]),i(t))},fail:t=>{i({status:!1})}})};return Ti.jsxs("div",{className:!0===t.etClickOff?"click-off":"",children:[P&&Ti.jsxs(_l,{show:P,centered:!0,size:"lg",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Linked communication"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{F(!1)}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(vd,{data:B,cancelBtnClick:()=>{F(!1)}})})]}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:2,right:!0,children:Ti.jsx(Ao,{label:"Content container"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{required:!0,errorMessage:k,data:T,textField:"bannerName",dataItemKey:"bannerId",value:x,onChange:e=>{let i=e.target.value;D(null),R(e.target.value.bannerId,(e=>{var s;(null==e?void 0:e.status)&&((null==(s=null==e?void 0:e.data)?void 0:s.length)>=7?(D("Content container usage is limited to a maximum of 7 communications."),t.notificationData.push.content[0].contentType="",setTimeout((()=>{t.onChange("containerData",null)}),100)):(t.notificationData.push.content[0].body="",t.notificationData.push.content[0].importContent="",t.notificationData.push.content[0].makeAlert=!1,t.notificationData.push.content[0].edmUrl="",t.notificationData.push.content[0].hashTag=[],t.notificationData.push.content[0].impressionCount=1,t.notificationData.push.content[0].priority=1,t.notificationData.push.content[0].isInteractivebuttonEnabled=!1,t.notificationData.push.content[0].interActivity=[],t.notificationData.push.content[0].isInterActivity=!1,t.notificationData.push.content[0].isAlertSound=!1,t.notificationData.push.content[0].alertSound="",t.notificationData.push.content[0].url="",t.notificationData.push.content[0].isExpiryButtonEnabled=!1,t.notificationData.push.content[0].pushexpirySchedule="",t.notificationData.push.content[0].pushExpiryhours=0,t.notificationError.errInteractivityButton1=null,t.notificationError.errInteractivityButton2=null,w(1),S(i),t.notificationData.push.content[0].contentType="",setTimeout((()=>{t.onChange("containerData",i)}),100)))})),t.notificationData.push.content[0].impressionCount=1}})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:Ti.jsx(Qi,{pophover:"Up to 7 communications can be assigned to each banner. Once existing communications are completed, you may assign new ones or create a new banner.",icon:"icon-rs-circle-question-mark-medium",size:"md"})})})})]})}),(null==x?void 0:x.bannerId)>0&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(pd,{...t,selectTab:e=>{let i={...C};0===e&&(i.push.content[0].contentType="TEXT"),1===e&&(i.push.content[0].contentType="EDM"),t.notificationData.push.content[0].contentType=i.push.content[0].contentType,j(i)}}),"TEXT"===(null==(l=null==(n=null==C?void 0:C.push)?void 0:n.content[0])?void 0:l.contentType)&&Ti.jsx(ud,{...t}),"EDM"===(null==(c=null==(r=null==(o=null==t?void 0:t.notificationData)?void 0:o.push)?void 0:r.content[0])?void 0:c.contentType)&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Dc,{...t,type:t.type,isCarousel:!1,content:t.notificationData.push.content[0],error:t.notificationError,smartAppStore:t.smartAppStore,bodyData:t.notificationData.push.content[0].body,importContent:(null==(h=null==(p=null==(d=null==t?void 0:t.notificationData)?void 0:d.push)?void 0:p.content[0])?void 0:h.importContent)||"",getBodyContent:(e,i)=>{t.notificationData.push.content[0].body=e,t.notificationData.push.content[0].importContent=i;let s=e.length>0?null:TITLE;t.notificationError.errBody=s},emptyData:(e,i)=>{t.notificationData.push.content[0].body=i,t.notificationData.push.content[0].importContent=i},onChange:(e,i,s,a)=>{t.notificationData.push.content[0].body=i,t.notificationData.push.content[0].importContent=i,t.notificationData.push.content[0].makeAlert=!1,t.notificationData.push.content[0].edmUrl=!0===s?"":e,t.notificationData.push.content[0].hashTag=[],t.notificationData.push.content[0].isInteractivebuttonEnabled=!1,t.notificationData.push.content[0].interActivity=(null==a?void 0:a.length)>0?a:[],t.notificationData.push.content[0].isInterActivity=(null==a?void 0:a.length)>0,t.notificationData.push.content[0].isAlertSound=!1,t.notificationData.push.content[0].alertSound="",t.notificationData.push.content[0].url=!0===s?"":e,t.notificationData.push.content[0].isExpiryButtonEnabled=!1,t.notificationData.push.content[0].pushexpirySchedule="",t.notificationData.push.content[0].pushExpiryhours=0,t.notificationError.errInteractivityButton1=null,t.notificationError.errInteractivityButton2=null}}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:2,className:"text-end",children:Ti.jsx(Ao,{label:"Impressions"})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{required:!0,label:"Impressions",data:["1","2","3","4","5","6","7","8","9","10"],value:A,onChange:e=>{t.notificationData.push.content[0].impressionCount=e.target.value,w(e.target.value)}})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(Ul,{required:!0,label:"Priority",data:["1","2","3","4","5","6","7"],value:N,onChange:e=>{t.notificationData.push.content[0].priority=e.target.value,L(e.target.value)}})})]})}),Ti.jsx(md,{...t,scheduleDate:t.notificationData.push.content[0].scheduleDate,errSchedule:null==(u=null==t?void 0:t.notificationError)?void 0:u.errSchdule,localScheduleTime:null==(y=null==(v=null==(m=null==t?void 0:t.notificationData)?void 0:m.push)?void 0:v.content[0])?void 0:y.localScheduleTime,timezoneId:null==(f=null==(b=null==(g=null==t?void 0:t.notificationData)?void 0:g.push)?void 0:b.content[0])?void 0:f.timezoneId,onChange:e=>{t.notificationData.push.content[0].scheduleDate=e.scheduleDate,t.notificationData.push.content[0].localScheduleTime=e.localScheduleTime,t.notificationData.push.content[0].timezoneId=e.timezoneId,t.notificationError.errSchdule=null}})]})]}),"Section content"===(null==x?void 0:x.name)&&Ti.jsx(dd,{...t})]})},bd=t=>Ti.jsxs("div",{style:fd.container,children:[Ti.jsx("p",{style:fd.text,children:"Creating a smartlink is mandatory to proceed with this channel."}),Ti.jsx(ns,{onClick:()=>{null==t||t.onProceed()},children:"Proceed"})]}),fd={container:{border:"1px solid #cfd8dc",borderRadius:"12px",padding:"40px",textAlign:"center",backgroundColor:"#ffffff",boxShadow:"0 0 0 1px rgba(0,0,0,0.05)",maxWidth:"800px",margin:"0 auto"},text:{fontFamily:"MuktaRegular",fontWeight:"normal",marginBottom:"20px",color:"#333"},button:{backgroundColor:"#014421",color:"#ffffff",border:"none",borderRadius:"8px",padding:"10px 24px",fontSize:"18px",cursor:"pointer"}};var xd=!1;const Sd=[{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},{deliveryTypeValue:"Alert / Rich push",deliveryTypeId:1},{deliveryTypeValue:"In page overlay",deliveryTypeId:2},{deliveryTypeValue:"In page content",deliveryTypeId:5}],Cd=[{pushLayoutValue:"-- Select layout --",pushLayoutId:0},{pushLayoutValue:"Full screen",pushLayoutId:1},{pushLayoutValue:"Banner",pushLayoutId:2},{pushLayoutValue:"Modal",pushLayoutId:3},{pushLayoutValue:"Carousel",pushLayoutId:4}],jd=[{positionValue:"-- Select position --",positionId:0},{positionValue:"Top left",positionId:1},{positionValue:"Top center",positionId:2},{positionValue:"Top right",positionId:3},{positionValue:"Center",positionId:4},{positionValue:"Center left",positionId:5},{positionValue:"Center right",positionId:6},{positionValue:"Bottom left",positionId:7},{positionValue:"Bottom center",positionId:8},{positionValue:"Bottom right",positionId:9}],Td=[{positionValue:"-- Select position --",positionId:0},{positionValue:"Top",positionId:1},{positionValue:"Bottom",positionId:2},{positionValue:"Center",positionId:2}];class Id extends Di.Component{constructor(){super(...arguments),ji(this,"state",{pushRes:!1,redisData:0,saveError:!1,errMsg:null,smartlinkErrorMessage:null,showPopUp:!1,isSecure:null==(ri=this.props.webdata)?void 0:ri.push.secure,defaultContent:null,domainList:[],inboxClassification:[],isOpenSplitResetModal:!1,isOpenCarouselResetModal:!1,splitTabIndex:0,carouselTabIndex:0,audienceCount:0,splitTabData:[{id:10011,text:"Split A"},{id:1002,text:"Split B"}],errShedule:null,rfaSchedule:!1,carouselTabData:[{id:10011,text:"Carousel A"},{id:1002,text:"Carousel B"}],errSendPushTo:null,dynamicListId:0,errDomainSite:null,errEnterURL:null,errDeliveryType:null,errInboxClassification:null,errLayout:null,errPosition:null,errContainerData:null,notificationContentError:{errContentType:null,errTitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},splitContentError:[{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}],carouselContentError:[{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},{errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}],smartAppStore:null,splitRange:"10",isSplitSettingsData:{isAutoSchedule:!0,campaignPerFormanceBy:"content",duration:8,period:"Hours"},isSplitSettings:!1,testPreviewCount:0,addTestPush:!0,sendTestPreview:!1,scheduleErrMsg:"The communication is not scheduled. Do you want to continue?",testPerviewStatus:null,clickOffStatus:null==(ci=this.props)?void 0:ci.editClickOff,showRFAModal:!1,contentInjectionData:null,getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1}),ji(this,"componentDidMount",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C;const j=new URLSearchParams(window.location.search);if(j.set("chId","8"),window.history.pushState({},"",`${window.location.pathname}?${j.toString()}`),this.getDeviceInfoRedis(this.props.domainUrl),window.scrollTo(0,0),this.setState({dynamicListId:this.props.dynamicListId}),0===this.props.webdata.push.inboxClassification.cdId){let t={cdId:0,classificationId:"-- Inbox classification --"};this.props.webdata.push.inboxClassification=t}if(((null==(a=null==(s=null==(i=null==(e=this.props.webdata)?void 0:e.push)?void 0:i.content[0])?void 0:s.title)?void 0:a.length)>0||(null==(r=null==(o=null==(l=null==(n=this.props.webdata)?void 0:n.push)?void 0:l.content[0])?void 0:o.body)?void 0:r.length)>0)&&this.setState({addTestPush:!1}),null!==(null==(c=this.props)?void 0:c.isAutoSchedule)&&null!==(null==(p=null==(d=null==this?void 0:this.props)?void 0:d.isAutoSchedule)?void 0:p.autoSchedule)&&void 0!==(null==(u=null==(h=null==this?void 0:this.props)?void 0:h.isAutoSchedule)?void 0:u.autoSchedule)){let t={isAutoSchedule:null==(v=null==(m=null==this?void 0:this.props)?void 0:m.isAutoSchedule)?void 0:v.autoSchedule,campaignPerFormanceBy:(null==(g=null==(y=null==this?void 0:this.props)?void 0:y.isAutoSchedule)?void 0:g.performedBy)||"content",duration:(null==(f=null==(b=null==this?void 0:this.props)?void 0:b.isAutoSchedule)?void 0:f.startIn)||8,period:(null==(S=null==(x=null==this?void 0:this.props)?void 0:x.isAutoSchedule)?void 0:S.periodRange)||"Hours"};this.setState({isSplitSettingsData:t})}if(this.getDomainList((t=>{var e;this.props.domainUrl&&this.props.domainUrl.length>0&&(Is("SmartAppStore ----",null==(e=this.props)?void 0:e.smartAppStore),this.getInboxClassification(this.props.domainUrl,(t=>{this.getAuidenceCount(this.props.domainUrl)})))})),this.getWebNotificationDetails(),this.getContentInjectionData(),this.getAccessData(),null!==sessionStorage.getItem("pbcampdata")&&void 0!==sessionStorage.getItem("pbcampdata")){let t=$o.decompress(sessionStorage.getItem("pbcampdata"),"zlib");return this.props.webdata.push=null==(C=null==t?void 0:t.fullData)?void 0:C.push,this.forceUpdate(),void sessionStorage.removeItem("pbcampdata")}})),ji(this,"getAccessData",(()=>{let t=!1,e=!1,i=!1;const s=Zi("Communications");1==(null==s?void 0:s.get_AddAccessData)&&(t=!0),e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(i=!0),this.setState({getAddAccessData:t,getUpdateAccessData:e,getDeleteAccessData:i})})),ji(this,"getWebNotificationDetails",(()=>{let t=Ln();os({path:En,params:{campaignId:t,channelId:8},sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,s,a;(null==t?void 0:t.status)&&null!==(null==(e=null==t?void 0:t.data)?void 0:e.statusid)&&void 0!==(null==(i=null==t?void 0:t.data)?void 0:i.statusid)&&(13===(null==(s=null==t?void 0:t.data)?void 0:s.statusid)?this.setState({clickOffStatus:!1}):12===(null==(a=null==t?void 0:t.data)?void 0:a.statusid)&&this.setState({clickOffStatus:!0}))},fail:t=>{}})})),ji(this,"getContentInjectionData",(()=>{var t;let e="contentData_"+Ln(),i=localStorage.getItem(e);if(null!=i){let e=JSON.parse(i);this.setState({contentInjectionData:(null==(t=null==e?void 0:e.contentData)?void 0:t.elementArray)||null}),this.props.webdata.push.isEnableContentInjection=(null==e?void 0:e.isContentInject)||!1,this.props.webdata.push.contentInjection=(null==e?void 0:e.contentUrl)||"",this.props.webdata.push.validContentUrl=(null==e?void 0:e.isContentValidation)||!1,this.forceUpdate()}})),ji(this,"componentDidUpdate",(t=>{})),ji(this,"getDomainList",(t=>{let e=ms();this.setState({domainList:e.domainsList}),t()})),ji(this,"getInboxClassification",((t,e)=>{let i={appId:"",domainUrl:t};this.setState({inboxClassification:[]}),os({path:Bn,params:i,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{t.status&&t.data&&t.data.webPushInboxClassification&&this.setState({inboxClassification:t.data.webPushInboxClassification}),e(t)},fail:t=>{e({status:!1})}})})),ji(this,"getAuidenceCount",(t=>{os({path:Mn,params:{appId:"",domainUrl:t},sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{if(t.status&&t.data){let e=t.data.webTokens;this.setState({audienceCount:e,totalAuidence:e})}},fail:t=>{}})})),ji(this,"createSplitObject",(t=>({splitType:t,title:"",titleColor:"",bgColor:"",url:"",subTitle:"",body:"",bodyTextColor:"",bodyBgColor:"",contentType:"",shortDesc:"",makeAlert:!1,htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",localScheduleTime:"",makeAsAlert:!0,isInteractivebuttonEnabled:!1,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"-- Select alert sound --",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"",interActivityButton2Name:"",interActivity:[],timezone:"",hashTag:[],isAutoSplit:this.state.isSplitSettingsData.isAutoSchedule,campaignPerformedBy:this.state.isSplitSettingsData.campaignPerformedBy,splitDuration:this.state.isSplitSettingsData.duration,splitPeriod:this.state.isSplitSettingsData.period}))),ji(this,"checkIsEmpty",((t,e,i,s,a=null)=>{if(ss(t)){if(null===a){let t={...this.state[i]};t[e]=s,this.setState({[i]:t},(()=>{}))}else{let t=[...this.state[i]];t[a][e]=s,this.setState({[i]:t},(()=>{}))}return!1}return!0})),ji(this,"createSplitError",(()=>({errTitle:null,errSubtitle:null,errBody:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}))),ji(this,"splitValidation",(t=>{var e,i,s,a,n,l,o,r,c,d;let p=null==(e=this.props.webdata)?void 0:e.push.content[t];if(ss(p.contentType)){let e=[...this.state.splitContentError];return e[t].errContentType="Select content type",this.setState({splitContentError:e}),!1}let h=!1;if("EDM"===p.contentType){if(void 0===(null==p?void 0:p.importContent)||null===(null==p?void 0:p.importContent)){let e=[...this.state.splitContentError];return e[t].errImportUrl="Import URL or Zip",e[t].errBody="Enter import URL",this.setState({splitContentError:e}),!1}if(void 0!==(null==p?void 0:p.importContent)&&null!==(null==p?void 0:p.importContent)&&""===(null==p?void 0:p.importContent)){let t={...this.state.splitContentError};return t.errImportUrl="Import URL or Zip",t.errBody="Enter import URL",this.setState({splitContentError:t}),!1}if(!this.checkIsEmpty(p.body,"errBody","notificationContentError",yn)){let e=[...this.state.splitContentError];return e[t].errImportUrl="Import URL or Zip",this.setState({splitContentError:e}),!1}if(h=p.makeAlert,h){if(ss(p.title)){let e=[...this.state.splitContentError];return e[t].errTitle=Ra,this.setState({splitContentError:e}),!1}if(ss(p.shortDesc)){let e=[...this.state.splitContentError];return e[t].errShortDesc="Please enter the short desc",this.setState({splitContentError:e}),!1}}}if("TEXT"===p.contentType){if(1!==(null==(i=this.props.webdata)?void 0:i.push.pushType.deliveryTypeId)&&2!=(null==(n=null==(a=null==(s=this.props.webdata)?void 0:s.push)?void 0:a.pushLayout)?void 0:n.pushLayoutId)&&""==(null==p?void 0:p.title)&&""==(null==p?void 0:p.body)&&2!=(null==(r=null==(o=null==(l=this.props.webdata)?void 0:l.push)?void 0:o.pushLayout)?void 0:r.pushLayoutId)&&(ss(null==p?void 0:p.url)||void 0===(null==p?void 0:p.url)||null===(null==p?void 0:p.url)))return this.setState({smartlinkErrorMessage:"Attach the image",showPopUp:!0}),!1;if(ss(p.title)&&1===(null==(c=this.props.webdata)?void 0:c.push.pushType.deliveryTypeId)){let e=[...this.state.splitContentError];return e[t].errTitle=Ra,this.setState({splitContentError:e}),!1}if(ss(p.body)&&1===(null==(d=this.props.webdata)?void 0:d.push.pushType.deliveryTypeId)){let e=[...this.state.splitContentError];return e[t].errBody=yn,this.setState({splitContentError:e}),!1}}let u=!1;if(p.isInterActivity){if(!(p.interActivity.length>0)){let e=[...this.state.splitContentError];return e[t].errInteractivityButton1=fn,u=!0,this.setState({splitContentError:e}),!1}{let e=0;p.interActivity.forEach((i=>{if(ss(i.actionName)){let i=[...this.state.splitContentError];return 0===e?(i[t].errInteractivityButton1=fn,u=!0):(i[t].errInteractivityButton2=Sn,u=!0),this.setState({splitContentError:i}),!1}if(e++,"Maybe later"===i.actionName){if(!i.maybeLaterTimeings.toLowerCase().includes("(s)")){let e=[...this.state.splitContentError];return e[t].errFrequencyType=xn,this.setState({splitContentError:e}),u=!0,!1}if(i.maybeLaterTimeings.split(" ").length<2){let e=[...this.state.splitContentError];return e[t].errFrequencyValue=va,u=!0,this.setState({splitContentError:e}),!1}}}))}}if(u)return!1;if(p.isExpiryButtonEnabled){if(ss(p.pushexpirySchedule)||p.pushexpirySchedule.toLowerCase().includes("select")){let e=[...this.state.splitContentError];return e[t].errExpiryType=ya,this.setState({splitContentError:e}),!1}if(ss(p.pushExpiryhours)){let e=[...this.state.splitContentError];return e[t].errExpiryValue=ga,this.setState({splitContentError:e}),!1}}return!0})),ji(this,"carouselValidation",(t=>{var e,i,s,a,n,l,o,r,c,d;let p=null==(e=this.props.webdata)?void 0:e.push.content[t],h=!0;if(""===p.contentType)return this.checkIsEmpty("","errContentType","carouselContentError","Select content type",t),!1;if("EDM"===p.contentType){if(0===t&&(h=p.makeAlert),void 0===p.importContent||null===p.importContent)return this.checkIsEmpty("","errImportUrl","carouselContentError","Import URL or Zip",t),!1;if(void 0!==p.importContent&&null!==p.importContent&&""===(null==p?void 0:p.importContent)){let e=[...this.state.carouselContentError];return e[t].errImportUrl="Import URL or Zip",e[t].errBody=yn,this.setState({carouselContentError:e}),!1}if(h&&"EDM"===p.contentType&&0===t){if(!this.checkIsEmpty(p.title,"errTitle","carouselContentError",Ra,t))return!1;if(!this.checkIsEmpty(p.shortDesc,"errShortDesc","carouselContentError","Enter the short desc",t))return!1}}if("TEXT"===p.contentType){if(1!==(null==(i=this.props.webdata)?void 0:i.push.pushType.deliveryTypeId)&&2!=(null==(n=null==(a=null==(s=this.props.webdata)?void 0:s.push)?void 0:a.pushLayout)?void 0:n.pushLayoutId)&&""==(null==p?void 0:p.title)&&""==(null==p?void 0:p.body)&&2!=(null==(r=null==(o=null==(l=this.props.webdata)?void 0:l.push)?void 0:o.pushLayout)?void 0:r.pushLayoutId)&&(ss(null==p?void 0:p.url)||void 0===(null==p?void 0:p.url)||null===(null==p?void 0:p.url)))return this.setState({smartlinkErrorMessage:"Attach the image",showPopUp:!0}),!1;if(1===(null==(c=this.props.webdata)?void 0:c.push.pushType.deliveryTypeId)&&!this.checkIsEmpty(p.title,"errTitle","carouselContentError",Ra,t))return!1;if(1===(null==(d=this.props.webdata)?void 0:d.push.pushType.deliveryTypeId)&&!this.checkIsEmpty(p.body,"errBody","carouselContentError",yn,t))return!1}let u=!1;if(p.isInteractivebuttonEnabled)if(p.interActivity.length>0){let e=0;p.interActivity.forEach((i=>{var s,a;let n="",l="";if(0===e?(n="errInteractivityButton1",l=fn):1===e&&(n="errInteractivityButton2",l=Sn),"smartlink 1"===(null==(s=null==i?void 0:i.clickBehavourValue)?void 0:s.toLowerCase())){if(0===this.props.smartAppStore.length)return n="errInteractivityButton1",l="Configure smartlink",this.checkIsEmpty("",n,"carouselContentError",l,t),u=!0,!1}else if("smartlink 2"===(null==(a=null==i?void 0:i.clickBehavourValue)?void 0:a.toLowerCase())&&this.props.smartAppStore.length<2)return n="errInteractivityButton2",l="Configure smartlink",this.checkIsEmpty("",n,"carouselContentError",l,t),u=!0,!1;if(!this.checkIsEmpty(i.actionName,n,"carouselContentError",l,t))return u=!0,!1;if(e++,"Maybe later"===i.actionName){if(!i.maybeLaterTimeings.toLowerCase().includes("(s)")&&!this.checkIsEmpty("","errFrequencyType","carouselContentError",xn,t))return u=!0,!1;if(i.maybeLaterTimeings.split(" ").length<2&&!this.checkIsEmpty("","errFrequencyType","carouselContentError",xn,t))return u=!0,!1}}))}else if(!this.checkIsEmpty("","errInteractivityButton1","carouselContentError",fn,t))return u=!0,!1;if(u)return!1;if(p.isExpiryButtonEnabled){if(ss(p.pushexpirySchedule)&&!this.checkIsEmpty("","errExpiryType","carouselContentError",ya,t))return!1;if((ss(p.pushExpiryhours)||0===p.pushExpiryhours)&&!this.checkIsEmpty("","errExpiryValue","carouselContentError",ga,t))return!1}return!0})),ji(this,"validation",((t=!1)=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O,q,V,z,$,H,G,W,_,J,Z,K,Y,X,Q,tt,et,it,st,at,nt,lt,ot,rt,ct,dt,pt,ht,ut,mt,vt,yt,gt,bt,ft,xt,St,Ct,jt,Tt,It,kt,Dt,At;if(!this.props.isSmartlinkCreated)return this.setState({smartlinkErrorMessage:"Create smartlink",showPopUp:!0}),!1;if(2===(null==(e=this.props.webdata)?void 0:e.push.domainLevel.domainLevelId)){if(ss(null==(i=this.props.webdata)?void 0:i.push.weburl))return this.setState({errEnterURL:Pn}),!1}else if(ss(null==(s=this.props.webdata)?void 0:s.push.domainName.domainUrl)||(null==(a=this.props.webdata)?void 0:a.push.domainName.domainUrl.toLowerCase().includes("select")))return this.setState({errDomainSite:Fn}),!1;if(0===(null==(n=this.props.webdata)?void 0:n.push.pushType.deliveryTypeId))return this.setState({errDeliveryType:Un}),!1;if(5!==(null==(l=this.props.webdata)?void 0:l.push.pushType.deliveryTypeId)){if(1!==(null==(o=this.props.webdata)?void 0:o.push.pushType.deliveryTypeId)&&0===(null==(r=this.props.webdata)?void 0:r.push.pushLayout.pushLayoutId))return this.setState({errLayout:Rn}),!1;if(1!==(null==(c=this.props.webdata)?void 0:c.push.pushType.deliveryTypeId)&&1!==(null==(d=this.props.webdata)?void 0:d.push.pushLayout.pushLayoutId)&&0===(null==(p=this.props.webdata)?void 0:p.push.position.positionId))return window.scrollTo(0,0),this.setState({errPosition:On}),!1}if(5===(null==(h=this.props.webdata)?void 0:h.push.pushType.deliveryTypeId)&&!((null==(v=null==(m=null==(u=this.props.webdata)?void 0:u.push)?void 0:m.containerData)?void 0:v.bannerId)>0))return this.setState({errContainerData:"Select container"}),!1;let wt=!0,Nt=!0;if(null==(y=this.props.webdata)?void 0:y.push.isSplit){let e=0;null==(g=this.props.webdata)||g.push.content.forEach((t=>{wt=this.splitValidation(e),wt?e++:this.setState({splitTabIndex:e})})),!1===t&&wt&&0===this.state.dynamicListId&&((null==(f=null==(b=this.props.webdata)?void 0:b.push)?void 0:f.content.filter((t=>""===t.scheduleDate))).length!==(null==(S=null==(x=this.props.webdata)?void 0:x.push)?void 0:S.content.length)&&this.setState({scheduleErrMsg:"Some of the split are not schedule properly, Please schedule all the split"}),null==(C=this.props.webdata)||C.push.content.map(((t,e)=>{""===t.scheduleDate&&(this.setState({splitTabIndex:e}),wt=!1,this.setState({errShedule:"Try again"}))})))}else if(null==(j=this.props.webdata)?void 0:j.push.isCarousel){let e=0;null==(T=this.props.webdata)||T.push.content.forEach((t=>{!1!==Nt&&(Nt=this.carouselValidation(e),Nt?e++:this.setState({carouselTabIndex:e}))})),Nt&&!1===t&&0===this.state.dynamicListId&&ss(null==(I=this.props.webdata)?void 0:I.push.content[0].scheduleDate)&&(Nt=!1,this.setState({errShedule:"Try again"}))}else{if(!this.checkIsEmpty(null==(k=this.props.webdata)?void 0:k.push.content[0].contentType,"errContentType","notificationContentError","Select content type"))return!1;let e=!0;if("EDM"===(null==(D=this.props.webdata)?void 0:D.push.content[0].contentType)){if(e=null==(A=this.props.webdata)?void 0:A.push.content[0].makeAlert,void 0===(null==(L=null==(N=null==(w=this.props.webdata)?void 0:w.push)?void 0:N.content[0])?void 0:L.importContent)||null===(null==(M=null==(B=null==(E=this.props.webdata)?void 0:E.push)?void 0:B.content[0])?void 0:M.importContent))return this.checkIsEmpty("","errImportUrl","notificationContentError","Import URL or Zip"),!1;if(void 0!==(null==(U=null==(F=null==(P=this.props.webdata)?void 0:P.push)?void 0:F.content[0])?void 0:U.importContent)&&null!==(null==(q=null==(O=null==(R=this.props.webdata)?void 0:R.push)?void 0:O.content[0])?void 0:q.importContent)&&""===(null==($=null==(z=null==(V=this.props.webdata)?void 0:V.push)?void 0:z.content[0])?void 0:$.importContent)){let t={...this.state.notificationContentError};return t.errImportUrl="Import URL or Zip",t.errBody="Enter import URL",this.setState({notificationContentError:t}),!1}if(!this.checkIsEmpty(null==(H=this.props.webdata)?void 0:H.push.content[0].body,"errBody","notificationContentError",yn))return this.checkIsEmpty("","errImportUrl","notificationContentError","Import URL or Zip"),!1;if(e){if(!this.checkIsEmpty(null==(G=this.props.webdata)?void 0:G.push.content[0].title,"errTitle","notificationContentError",Ra))return!1;if(!this.checkIsEmpty(null==(W=this.props.webdata)?void 0:W.push.content[0].shortDesc,"errShortDesc","notificationContentError","Enter the short desc"))return!1}}if("TEXT"===(null==(_=this.props.webdata)?void 0:_.push.content[0].contentType)){if(1!==(null==(J=this.props.webdata)?void 0:J.push.pushType.deliveryTypeId)&&""==(null==(Z=this.props.webdata)?void 0:Z.push.content[0].title)&&""==(null==(K=this.props.webdata)?void 0:K.push.content[0].body)&&2!=(null==(Q=null==(X=null==(Y=this.props.webdata)?void 0:Y.push)?void 0:X.pushLayout)?void 0:Q.pushLayoutId)&&(ss(null==(tt=this.props.webdata)?void 0:tt.push.content[0].url)||void 0===(null==(st=null==(it=null==(et=this.props.webdata)?void 0:et.push)?void 0:it.content[0])?void 0:st.url)||null===(null==(lt=null==(nt=null==(at=this.props.webdata)?void 0:at.push)?void 0:nt.content[0])?void 0:lt.url)))return this.setState({smartlinkErrorMessage:"Attach the image",showPopUp:!0}),!1;if(1===(null==(ot=this.props.webdata)?void 0:ot.push.pushType.deliveryTypeId)&&!this.checkIsEmpty(null==(rt=this.props.webdata)?void 0:rt.push.content[0].title,"errTitle","notificationContentError",Ra))return!1;if(1===(null==(ct=this.props.webdata)?void 0:ct.push.pushType.deliveryTypeId)&&!this.checkIsEmpty(null==(dt=this.props.webdata)?void 0:dt.push.content[0].body,"errBody","notificationContentError",yn))return this.forceUpdate(),!1}let i=!1;if(null==(pt=this.props.webdata)?void 0:pt.push.content[0].isInteractivebuttonEnabled)if((null==(ht=this.props.webdata)?void 0:ht.push.content[0].interActivity.length)>0){let t=0;null==(ut=this.props.webdata)||ut.push.content[0].interActivity.forEach((e=>{var s,a;let n="",l="";if(0===t?(n="errInteractivityButton1",l=fn):1===t&&(n="errInteractivityButton2",l=Sn),"smartlink 1"===(null==(s=null==e?void 0:e.clickBehavourValue)?void 0:s.toLowerCase())){if(0===this.props.smartAppStore.length)return n="errInteractivityButton1",l="Configure smartlink",this.checkIsEmpty("",n,"notificationContentError",l),i=!0,!1}else if("smartlink 2"===(null==(a=null==e?void 0:e.clickBehavourValue)?void 0:a.toLowerCase())&&this.props.smartAppStore.length<2)return n="errInteractivityButton2",l="Configure smartlink",this.checkIsEmpty("",n,"notificationContentError",l),i=!0,!1;if(!this.checkIsEmpty(e.actionName,n,"notificationContentError",l))return i=!0,!1;if(t++,"Maybe later"===e.actionName){if(!e.maybeLaterTimeings.toLowerCase().includes("(s)")&&!this.checkIsEmpty("","errFrequencyType","notificationContentError",xn))return i=!0,!1;if(e.maybeLaterTimeings.split(" ").length>0&&!this.checkIsEmpty("","errFrequencyType","notificationContentError",xn))return i=!0,!1}}))}else if(!this.checkIsEmpty("","errInteractivityButton1","notificationContentError",fn))return i=!0,!1;if(i)return!1;if(null==(mt=this.props.webdata)?void 0:mt.push.content[0].isExpiryButtonEnabled){if((ss(null==(vt=this.props.webdata)?void 0:vt.push.content[0].pushexpirySchedule)||(null==(yt=this.props.webdata)?void 0:yt.push.content[0].pushexpirySchedule.toLowerCase().includes("select")))&&!this.checkIsEmpty("","errExpiryType","notificationContentError",ya))return!1;if((""===(null==(gt=this.props.webdata)?void 0:gt.push.content[0].pushExpiryhours)||0===(null==(bt=this.props.webdata)?void 0:bt.push.content[0].pushExpiryhours))&&!this.checkIsEmpty("","errExpiryValue","notificationContentError",ga))return!1}if(!1===t&&0===this.state.dynamicListId&&ss(null==(ft=this.props.webdata)?void 0:ft.push.content[0].scheduleDate))return this.setState({errShedule:"Try again"}),!1}if(!0===this.props.webdata.push.isRequestForApproval){if(ss(null==(xt=this.props.webdata)?void 0:xt.push.content[0].scheduleDate))return void this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});if((null==(Tt=null==(jt=null==(Ct=null==(St=this.props)?void 0:St.webdata)?void 0:Ct.push)?void 0:jt.rfaList)?void 0:Tt.length)>0){let t=!1;if(null==(At=null==(Dt=null==(kt=null==(It=this.props)?void 0:It.webdata)?void 0:kt.push)?void 0:Dt.rfaList)||At.map((e=>{!0!==t&&(ss(null==e?void 0:e.approvalEmailSentTo)||"Enter new email here"===(null==e?void 0:e.approvalEmailSentTo))&&(e.errorMessage="Email is required",t=!0)})),t)return this.forceUpdate(),!1}}return!!wt&&!!Nt})),ji(this,"renderComponents",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h;let u=[...null==(e=this.props.webdata)?void 0:e.push.content],m=0;return null==(i=this.props.webdata)||i.push.content.forEach((t=>{var e;if(null==(e=this.props.webdata)?void 0:e.push.isSplit){if(void 0===this.state.splitContentError[m]&&this.state.splitContentError.push(this.createSplitError()),void 0===this.state.splitTabData[m]){var i=this.state.splitTabData.length,s={id:i="A".charCodeAt(0)+i,text:"Split "+String.fromCharCode(i)};this.state.splitTabData.push(s)}}else if(void 0===this.state.carouselContentError[m]&&this.state.carouselContentError.push(this.createSplitError()),void 0===this.state.carouselTabData[m]){let t=this.state.carouselTabData.length;t="A".charCodeAt(0)+t;let e={id:t,text:"Carousel "+String.fromCharCode(t)};this.state.carouselTabData.push(e)}m++})),(null==(s=this.props.webdata)?void 0:s.push.isSplit)&&!(null==(a=this.props.webdata)?void 0:a.push.isCarousel)?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"mb-3 borderB0",children:null==(n=this.props.webdata)?void 0:n.push.content.map(((e,i)=>{var s;return Ti.jsx(Ql,{eventKey:"tab"+i,children:Ti.jsx(Xc,{data:this.props.webdata,index:i,resData:this.state.pushRes,redis:this.props.redisData,notificationData:u[i],onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,splitError:this.state.splitContentError[i],editClickOff:this.state.clickOffStatus,name:"Raja"+t,dynamicListId:this.state.dynamicListId,pushType:null==(s=this.props.webdata)?void 0:s.push.pushType.deliveryTypeId,type:"web",pushJson:this.props.webdata,showSmartLink:()=>{this.props.showSmartLink()},sendTestPreview:t=>{this.testPreview(t)}})})}))})}):!(null==(l=this.props.webdata)?void 0:l.push.isSplit)&&(null==(o=this.props.webdata)?void 0:o.push.isCarousel)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"mb-3 borderB0",children:null==(r=this.props.webdata)?void 0:r.push.content.map(((e,i)=>{var s,a,n,l;return Ti.jsx(Ql,{eventKey:"tab"+i,children:Ti.jsx(ad,{data:this.props.webdata,index:i,notificationData:u[i],mobilepush:!1,onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,carouselError:this.state.carouselContentError[i],editClickOff:this.state.clickOffStatus,jobStatusId:null==(l=null==(n=null==(a=null==(s=this.props)?void 0:s.history)?void 0:a.location)?void 0:n.state)?void 0:l.jobStatusId,name:"Raja"+t,dynamicListId:this.state.dynamicListId,type:"web",pushType:this.props.webdata.push.pushType.deliveryTypeId,pushJson:this.props.webdata,showSmartLink:()=>{this.props.showSmartLink()},contentChange:t=>{},sendTestPreview:t=>{this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.webdata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,this.props.webdata.push.objectRequestApproval=t,this.webPushAddOrUpdate(e,!0,!1,!0)}}})})}))}),Ti.jsx("div",{className:9!==(null==(h=null==(p=null==(d=null==(c=this.props)?void 0:c.history)?void 0:d.location)?void 0:p.state)?void 0:h.jobStatusId)&&this.state.clickOffStatus?"click-off":"",children:Ti.jsx(Ac,{status:this.state.testPerviewStatus,notificationData:this.props.webdata,channel:"web push",sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.webdata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,this.props.webdata.push.objectRequestApproval=t,this.webPushAddOrUpdate(e,!0,!1,!0)}},isRequestApproval:t=>{this.props.webdata.push.isRequestForApproval=t},approverCreated:t=>{this.props.webdata.push.rfaList=t},prepareData:t=>{this.props.webdata.push.objectRequestApproval=t}})})]}):void 0})),ji(this,"webPushAddOrUpdate",((t,e=!0,i=!1,s=!1)=>{var a,n;const l=no.parse(null==(n=null==(a=this.props.history)?void 0:a.location)?void 0:n.search);let o=void 0!==l.cId?l.cId:0;if(void 0!==localStorage.getItem(`camp_${o}`)&&null!==localStorage.getItem(`camp_${o}`)){let t=ks(localStorage.getItem(`camp_${o}`));t.notifyData.mode="edit",localStorage.setItem(`camp_${o}`,ts(t))}let r=this.props.isUpdate&&!1!==e?qn:ps;(this.state.testPreviewCount>0||!0===i&&!0===e)&&(r=qn),r=!0===this.state.addTestPush?ps:qn,os({path:r,params:t,isCache:!1,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var a,n,l,o,r,c;const d=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});if(window.dispatchEvent(d),t.status){if(!0===s&&(this.setState({showRFAModal:!0}),setTimeout((()=>{this.setState({showRFAModal:!1})}),2e3)),this.setState({pushRes:!0,addTestPush:!1}),this.setState({testPreviewCount:this.state.testPreviewCount+1}),i)return void this.setState({sendTestPreview:!0,testPerviewStatus:"Test communication will be sent shortly"});let d={webUrl:null===(null==(n=null==(a=t.data)?void 0:a.objCampaignDetails)?void 0:n.weburl)||void 0===(null==(o=null==(l=t.data)?void 0:l.objCampaignDetails)?void 0:o.weburl)?this.props.domainUrl:"https://"+(null==(c=null==(r=t.data)?void 0:r.objCampaignDetails)?void 0:c.weburl),webId:t.data.objCampaignDetails.pushNotifyChannelDetailID};if(localStorage.setItem("webData",JSON.stringify(d)),e){if(!0===s)return void setTimeout((()=>{xd?(xd=!1,this.props.history.push("/campaign")):this.props.moveNext(1)}),2e3);xd?(xd=!1,this.props.history.push("/campaign")):this.props.moveNext(1)}}else this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})}})})),ji(this,"resetValues",(()=>{var t;this.props.webdata.push.pushType={deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},this.props.webdata.push.inboxClassification={cdId:0,classificationId:"-- Inbox classification --"},this.props.webdata.push.pushLayout={pushLayoutValue:"-- Select push layout --",pushLayoutId:0},this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0},this.props.webdata.push.isCarousel=!1,this.props.webdata.push.isSplit=!1;let e=[...null==(t=this.props.webdata)?void 0:t.push.content];e[0].splitType="",e[0].title="",e[0].titleColor="",e[0].contentType="",e[0].bgColor="",e[0].subTitle="",e[0].body="",e[0].hashTag=[],e[0].isInteractivebuttonEnabled=!1,e[0].interActivity=[],e[0].interActivityButton1Name="",e[0].interActivityButton2Name="",e[0].isExpiryButtonEnabled=!1,e[0].pushexpirySchedule="",e[0].pushExpiryhours=0,e[0].isAlertSound=!1,e[0].alertSound="",e[0].timezone="",e[0].timezoneId="",e[0].scheduleDate="",e[0].bodyTextColor="",e[0].bodyBgColor="",this.props.webdata.push.content=[e[0]],this.props.webdata.push.isCarousel=!1,this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0},this.forceUpdate(),this.setState({splitTabIndex:0,carouselTabIndex:0})})),ji(this,"delivaryTypeRefersh",(()=>{this.props.webdata.push.pushType={deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0}})),ji(this,"refershBtnClicked",(()=>{var t;this.setState({splitTabIndex:0,carouselTabIndex:0,isSecure:!1}),this.props.webdata.push.inboxClassification={cdId:0,classificationId:"-- Inbox classification --"},this.props.webdata.push.pushLayout={pushLayoutValue:"-- Select push layout --",pushLayoutId:0},this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0},this.props.webdata.push.isCarousel=!1,this.props.webdata.push.isSplit=!1,this.props.webdata.push.content[0].body="",this.props.webdata.push.content[0].htmlBody="",this.props.webdata.push.content[0].contentType="",this.props.webdata.push.containerData="";let e=[...null==(t=this.props.webdata)?void 0:t.push.content][0];e.contentType="",e.edmUrl="",e.splitType="",e.title="",e.titleColor="",e.contentType="",e.bgColor="",e.subTitle="",e.body="",e.hashTag=[],e.isInteractivebuttonEnabled=!1,e.interActivity=[],e.interActivityButton1Name="",e.interActivityButton2Name="",e.isExpiryButtonEnabled=!1,e.pushexpirySchedule="",e.pushExpiryhours=0,e.isAlertSound=!1,e.alertSound="",e.timezone="",e.timezoneId="",e.scheduleDate="",e.bodyTextColor="",e.url="",e.bodyBgColor="",this.props.webdata.push.content=[e],this.forceUpdate()})),ji(this,"getDeviceInfoRedis",(t=>{os({path:Vn,isCache:!1,params:{AppID:"",DomianURL:t},sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{t.status&&this.setState({redisData:t.data})},fail:t=>{}})})),ji(this,"testPreview",(t=>{var e;let i=this.validation(!0);if(void 0===i||i){let i=this.getParams();i.testPushCampaignEmailAddress=t,i.isSendTestPush=2,i.content[0].scheduleDate="";let s=!1;s=!!(null==(e=this.props)?void 0:e.isUpdate)||0!==this.state.testPreviewCount,this.webPushAddOrUpdate(i,s,!0),this.setState({testPreviewCount:this.state.testPreviewCount+1})}})),ji(this,"TestPreviewSuccessComponent",(()=>Ti.jsx(Ti.Fragment,{children:this.state.sendTestPreview&&Ti.jsxs(_l,{show:this.state.sendTestPreview,centered:!0,children:[Ti.jsx(_l.Header,{style:{border:0},children:Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({sendTestPreview:!1})}})}),Ti.jsx(_l.Body,{children:Ti.jsx("div",{children:Ti.jsx(Jl,{md:12,children:Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ka,size:"d font-xxl",color:"green",mainClass:""}),Ti.jsx("br",{}),Ti.jsx("label",{children:"Test communication will be sent shortly."})]})})})})]})}))),ji(this,"storeContentData",((t,e)=>{let i={},s="contentData_"+Ln();null!==localStorage.getItem(s)&&void 0!==localStorage.getItem(s)&&(i=JSON.parse(localStorage.getItem(s))),i[t]=e,localStorage.setItem(s,JSON.stringify(i))})),ji(this,"enableContInjectBtnClick",(t=>{this.setState({contentInjectionData:null}),this.props.webdata.push.isEnableContentInjection=!1,this.props.webdata.push.contentInjection="",this.props.webdata.push.validContentUrl=!1,this.props.webdata.push.isEnableContentInjection=t,this.storeContentData("isContentInject",t),this.storeContentData("isContentValidation",!1),this.storeContentData("contentUrl",""),this.storeContentData("contentData",null),this.forceUpdate()}))}getParams(){var t;return Bl("web",this.props.campaignId,this.props.webdata,this.props.statusId,null==(t=this.props)?void 0:t.smartAppStore)}render(){var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O,q,V,z,$,H,G,W,_,J,Z,K,Y,X,Q,tt,et,it,st;const at=(null==(t=this.props.webdata)?void 0:t.push)||{},{pushType:nt={},isSplit:lt,isCarousel:ot,pushLayout:rt={},position:ct={}}=at,dt=nt.deliveryTypeId,pt=rt.pushLayoutId,ht=ct.positionId,ut=0!==dt&&5!==dt&&!lt&&!ot,mt=2!==dt&&3!==dt||0!==pt,vt=2!==dt&&3!==dt||!((2===pt||3===pt||4===pt)&&0===ht);return Ti.jsxs(Ti.Fragment,{children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),Ti.jsx(_l,{show:this.state.showRFAModal,centered:!0,size:"md",children:Ti.jsx(_l.Body,{children:Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ka,size:"d font-xlg",color:"green",mainClass:""}),Ti.jsx("label",{style:{marginTop:10},children:"Communication has been sent successfully for approval"})]})})}),this.props.webdata?Ti.jsxs("div",{children:[this.state.smartlinkErrorMessage&&Ti.jsx(_l,{show:this.state.showPopUp,centered:!0,onHide:()=>{this.setState({smartlinkErrorMessage:null,showPopUp:!1})},children:Ti.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[Ti.jsx("label",{children:this.state.smartlinkErrorMessage}),Ti.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top-2",onClick:()=>{this.setState({smartlinkErrorMessage:null,showPopUp:!1})}})]})}),Ti.jsxs("div",{className:"reference-notification-web-push box-design bd-top-border",children:[Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{className:this.state.clickOffStatus?"click-off":"",children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{label:"Send push to",right:!0})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{required:!0,data:this.state.domainList,label:"Domain URL",textField:"domainUrl",dataItemKey:"onBoardingId",value:(null==(i=null==(e=this.props.webdata)?void 0:e.push)?void 0:i.domainName)||{domainUrl:"-- Select domain --",onBoardingId:-1},errorMessage:this.state.errDomainSite,handleChange:t=>{let e=t.target.value.domainUrl.length>0?null:Fn;this.setState({errDomainSite:e}),this.props.webdata.push.domainName=t.target.value,this.getInboxClassification(t.target.value.domainUrl,(t=>{})),this.getAuidenceCount(t.target.value.domainUrl),this.getDeviceInfoRedis(t.target.value.domainUrl),this.resetValues(),this.forceUpdate()}})}),Ti.jsx(Zl,{md:2,children:Ti.jsxs(xo,{children:[Ti.jsx(Xi,{children:Ti.jsx(Qi,{icon:Ss,mainClass:this.state.getAddAccessData?"click-on":"click-off",size:"md",tooltip:"Add domain",onClick:()=>{let t=this.props.location.state;t.type="web",t.selectIndex=0,t.webPermission=!1,t.isCampaign=!0,this.props.history.push("/preferences/communication-settings",t)}})}),0===this.state.dynamicListId&&0!==this.state.audienceCount&&Ti.jsx("div",{className:"ml15",children:"Audience: "+this.state.audienceCount})]})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{label:"Delivery type",right:!0})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{data:Sd,className:`${0===(null==(s=this.props.webdata)?void 0:s.push.pushType.deliveryTypeId)?"click-on":"click-off"} ${this.state.clickOffStatus?"click-off":""}`,disabled:0!==(null==(a=this.props.webdata)?void 0:a.push.inboxClassification.cdId),required:!0,label:"Delivery type",errorMessage:this.state.errDeliveryType,value:null==(n=this.props.webdata)?void 0:n.push.pushType,textField:"deliveryTypeValue",dataItemKey:"deliveryTypeId",handleChange:t=>{var e,i,s,a,n;this.delivaryTypeRefersh(),this.refershBtnClicked();let l=0!==t.target.value.deliveryTypeId?null:Un;this.setState({errDeliveryType:l}),((null==(a=null==(s=null==(i=null==(e=this.props)?void 0:e.webdata)?void 0:i.push)?void 0:s.domainName)?void 0:a.domainUrl)||"").length,1===t.target.value.deliveryTypeId&&(this.setState({splitTabIndex:0,carouselTabIndex:0}),this.props.webdata.push.pushLayout={pushLayoutValue:"-- Select push layout --",pushLayoutId:0},this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0},this.props.webdata.push.isCarousel=!1,this.props.webdata.push.isSplit=!1),this.props.webdata.push.pushType=t.target.value;let o=[...null==(n=this.props.webdata)?void 0:n.push.content];this.props.webdata.push.content=[o[0]],this.props.webdata.push.content[0].contentType="",this.forceUpdate()}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{data:this.state.inboxClassification.length>0?this.state.inboxClassification:[{cdId:0,classificationId:"-- Inbox classification --"}],textField:"classificationId",label:"Inbox classification",errorMessage:this.state.errInboxClassification,dataItemKey:"cdId",disabled:0===(null==(r=null==(o=null==(l=this.props.webdata)?void 0:l.push)?void 0:o.pushType)?void 0:r.deliveryTypeId),className:0!==(null==(c=this.props.webdata)?void 0:c.push.pushType.deliveryTypeId)?0!==(null==(d=this.props.webdata)?void 0:d.push.inboxClassification.cdId)?"click-off":"":this.state.inboxClassification.length>0?"click-on":"click-off",value:this.props.webdata.push.inboxClassification,handleChange:t=>{let e=0!==t.target.value.cdId?null:zn;this.setState({errInboxClassification:e}),this.props.webdata.push.inboxClassification=t.target.value,this.forceUpdate()}})})]})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[Ti.jsx(Qi,{tooltip:this.state.isSecure?"Secure message ON":"Secure message OFF",icon:"icon-rs-shield-medium",size:"md",iconClass:this.state.isSecure?"green":"blue",onClick:()=>{var t;this.setState({isSecure:!this.state.isSecure}),this.props.webdata.push.secure=!(null==(t=this.props.webdata)?void 0:t.push.secure)}}),Ti.jsx(Qi,{tooltip:"Add inbox classification",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",iconClass:`${0===(null==(p=this.props.webdata)?void 0:p.push.pushType.deliveryTypeId)?"click-off":"click-on"} ${this.state.getAddAccessData?"click-on":"click-off"}`,onClick:()=>{var t,e,i,s;let a=this.getParams();a.isUpdate=this.props.isUpdate,a.channelStatus=this.props.statusId,localStorage.setItem("wcdetails",JSON.stringify(a));let n={type:"web",webPermission:!0};n.webGuid=null==(e=null==(t=this.props.webdata)?void 0:t.push)?void 0:e.domainName.domainId,n.onBoardingId=null==(s=null==(i=this.props.webdata)?void 0:i.push)?void 0:s.domainName.onBoardingId,n.isCampaign=!0,this.props.history.push({pathname:"/preferences/communication-settings",search:`?cId=${this.props.campaignId}`,state:n})}}),0!==(null==(h=this.props.webdata)?void 0:h.push.pushType.deliveryTypeId)?Ti.jsx(Qi,{tooltip:"Refresh",icon:"icon-rs-refresh-medium",size:"md",onClick:()=>{this.delivaryTypeRefersh(),this.refershBtnClicked()}}):null]})})})]})}),5===(null==(u=this.props.webdata)?void 0:u.push.pushType.deliveryTypeId)&&Ti.jsx(gd,{resData:this.state.pushRes,redis:this.state.redisData,errContainerData:this.state.errContainerData,notificationData:this.props.webdata,smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,dynamicListId:this.state.dynamicListId,notificationError:this.state.notificationContentError,editClickOff:0===this.props.dynamicListId&&this.state.clickOffStatus,etClickOff:this.state.clickOffStatus,jobStatusId:null==(g=null==(y=null==(v=null==(m=this.props)?void 0:m.history)?void 0:v.location)?void 0:y.state)?void 0:g.jobStatusId,type:"web",pushTypeId:null==(b=this.props.webdata)?void 0:b.push.pushType.deliveryTypeId,pushType:2===(null==(f=this.props.webdata)?void 0:f.push.pushType.deliveryTypeId)||3===(null==(x=this.props.webdata)?void 0:x.push.pushType.deliveryTypeId)?2:null==(S=this.props.webdata)?void 0:S.push.pushType.deliveryTypeId,pushJson:this.props.webdata,showSmartLink:()=>{this.props.showSmartLink()},contentChange:()=>{},onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},popupButton:t=>{t&&this.webPushAddOrUpdate(this.getParams())},testPerviewStatus:this.state.testPerviewStatus,sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.webdata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,this.props.webdata.push.isRequestForApproval=!0,this.props.webdata.push.objectRequestApproval=t,this.webPushAddOrUpdate(e,!0,!1,!0)}},isRequestApproval:t=>{this.props.webdata.push.isRequestForApproval=t},approverCreated:t=>{this.props.webdata.push.rfaList=t},prepareData:t=>{this.props.webdata.push.objectRequestApproval=t},onChange:(t,e)=>{var i;this.setState({errContainerData:null}),this.props.webdata.push[t]=e,null==(i=this.props.webdata)||i.push.content.map(((t,e)=>{t.contentType="EDM",t.impressionCount=1,t.priority=1})),this.forceUpdate()}}),2===(null==(C=this.props.webdata)?void 0:C.push.pushType.deliveryTypeId)||3===(null==(j=this.props.webdata)?void 0:j.push.pushType.deliveryTypeId)?Ti.jsx($l,{children:Ti.jsxs(Jl,{className:this.state.clickOffStatus?"click-off":"",children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{label:"Layout / Position",right:!0})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{required:!0,disabled:0!==(null==(T=this.props.webdata)?void 0:T.push.pushLayout.pushLayoutId),data:Cd,value:null==(I=this.props.webdata)?void 0:I.push.pushLayout,errorMessage:this.state.errLayout,textField:"pushLayoutValue",dataItemKey:"pushLayoutId",label:"Layout",handleChange:t=>{var e;this.props.webdata.push.content[0].body="",this.props.webdata.push.content[0].htmlBody="",this.props.webdata.push.pushLayout=t.target.value;let i=0!==t.target.value.pushLayoutId?null:Rn;if(this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0},this.setState({errPosition:null}),this.setState({errLayout:i}),this.setState({notificationContentError:{errContentType:null,errTitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}}),4===t.target.value.pushLayoutId){this.props.webdata.push.isSplit=!1,this.props.webdata.push.isCarousel=!0;let t=[],e=[];for(let i=0;i<2;i++){let s="ABCD",a=t.length;a=s.charAt(i);let n={id:a,text:"Carousel "+a};t.push(n);let l=this.createSplitObject(a);e.push(l)}this.setState({carouselTabData:t}),this.props.webdata.push.content=e}else(null==(e=this.props.webdata)?void 0:e.push.isCarousel)&&this.setState({isOpenCarouselResetModal:!this.state.isOpenCarouselResetModal});this.forceUpdate()}})}),1!==this.props.webdata.push.pushLayout.pushLayoutId&&0!==this.props.webdata.push.pushLayout.pushLayoutId?Ti.jsx(Zl,{children:Ti.jsx(Ul,{required:!0,disabled:0!==(null==(k=this.props.webdata)?void 0:k.push.position.positionId),data:2===this.props.webdata.push.pushLayout.pushLayoutId?Td:jd,value:null==(D=this.props.webdata)?void 0:D.push.position,textField:"positionValue",dataItemKey:"positionId",label:"Position",errorMessage:this.state.errPosition,onChange:t=>{let e=0!==t.target.value.positionId?null:On;this.setState({errPosition:e}),this.props.webdata.push.position=t.target.value,this.forceUpdate()}})}):null]})}),0!==(null==(A=this.props.webdata)?void 0:A.push.pushLayout.pushLayoutId)&&Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:0!==(null==(w=this.props.webdata)?void 0:w.push.pushType.deliveryTypeId)?Ti.jsx(Qi,{tooltip:"Refresh",icon:"icon-rs-refresh-medium",size:"md",onClick:()=>{this.refershBtnClicked()}}):null})})})]})}):null,!1!==this.props.webdata.push.isCarousel||1!==(null==(N=this.props.webdata)?void 0:N.push.pushType.deliveryTypeId)&&2!==(null==(L=this.props.webdata)?void 0:L.push.pushType.deliveryTypeId)&&3!==(null==(E=this.props.webdata)?void 0:E.push.pushType.deliveryTypeId)?null:Ti.jsx(Ti.Fragment,{children:0===this.state.dynamicListId&&Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"position-relative split-ab-temp-container",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pl10",children:Ti.jsx(Ao,{label:"Split A/B",right:!0})}),Ti.jsx(Zl,{md:1,children:Ti.jsx("div",{className:"d-flex align-items-center click-on",children:Ti.jsx(qo,{className:`\n                            ${0===(null==(B=this.props.webdata)?void 0:B.push.pushType.deliveryTypeId)||(null==(M=this.props.webdata)?void 0:M.push.isCarousel)?"click-off":""} \n                            ${this.state.clickOffStatus?"click-off":""}\n                            ${this.state.audienceCount<99?"click-off":"click-on"}\n                            \n                          `,onChange:t=>{var e;if(t.target.value){this.props.webdata.push.isSplit=t.target.value,this.setState({splitTabIndex:0});let s=[...null==(e=this.props.webdata)?void 0:e.push.content];s[0].splitType="A",s[0].title="",s[0].titleColor="",s[0].bgColor="",s[0].subTitle="",s[0].body="",s[0].hashTag=[],s[0].isInteractivebuttonEnabled=!1,s[0].interActivity=[],s[0].interActivityButton1Name="",s[0].interActivityButton2Name="",s[0].isExpiryButtonEnabled=!1,s[0].pushexpirySchedule="",s[0].pushExpiryhours=0,s[0].isAlertSound=!1,s[0].alertSound="",s[0].timezone="",s[0].timezoneId="",s[0].scheduleDate="",s[0].bodyTextColor="",s[0].bodyBgColor="",s[0].recipientsPercentage=this.state.splitRange,s[0].isAutoSplit=this.state.isSplitSettingsData.isAutoSchedule,s[0].campaignPerformedBy=this.state.isSplitSettingsData.campaignPerformedBy,s[0].splitDuration=this.state.isSplitSettingsData.duration,s[0].splitPeriod=this.state.isSplitSettingsData.period;var i=this.state.splitTabData.length;i="A".charCodeAt(0)+(i-1),s.push(this.createSplitObject(String.fromCharCode(i)));let a=[];a.push(this.createSplitObject("A")),a.push(this.createSplitObject("B")),a.map((t=>{t.recipientsPercentage=10,t.matchedAuidence=Math.floor(this.state.totalAuidence/10*100),t.totalAuidence=this.state.totalAuidence}));let n=[{id:1001,text:"Split A"},{id:1002,text:"Split B"}];this.props.webdata.push.content=a,this.props.webdata.push.isCarousel=!1,this.setState({isSplit:!this.state.isSplit,splitTabData:n})}else this.setState({isOpenSplitResetModal:!this.state.isOpenSplitResetModal});this.forceUpdate()},checked:null==(P=this.props.webdata)?void 0:P.push.isSplit})})}),(null==(F=this.props.webdata)?void 0:F.push.isSplit)&&Ti.jsx(Zl,{md:2,className:"pl3",children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[(null==(U=this.props.webdata)?void 0:U.push.isSplit)&&Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Qi,{tooltip:"Split A/B viewing",icon:"icon-rs-circle-dropdown-mini icon-dropdown-small-del",mainClass:"mt5",size:"sm",onClick:()=>{this.setState({isShowSplitSizeModal:!this.state.isShowSplitSizeModal})}}),Ti.jsx(Qi,{tooltip:"Schedule settings",icon:"icon-rs-settings-medium",size:"md",onClick:()=>{this.setState({isSplitSettings:!this.state.isSplitSettings})}})]}),Ti.jsx(Qi,{pophover:"A minimum of 100 audience are required for split A/B testing. Check the communication listing page for results.",icon:"icon-rs-circle-question-mark-medium",iconClass:"ml5"})]})})}),this.state.isShowSplitSizeModal&&Ti.jsxs(_l,{show:this.state.isShowSplitSizeModal,size:"xl",className:"modal-top-fixed",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Split size"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isShowSplitSizeModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(cd,{isOpen:this.state.isShowSplitSizeModal,data:{splitList:null==(O=null==(R=this.props.webdata)?void 0:R.push)?void 0:O.content,splitAudience:(null==(q=this.props.webdata.push.content[0])?void 0:q.matchedAuidence)||0,totalAuidence:(null==(V=this.props.webdata.push.content[0])?void 0:V.totalAuidence)||this.state.totalAuidence,splitSizePercentage:(null==(z=this.props.webdata.push.content[0])?void 0:z.recipientsPercentage)||0},splitSizeDetails:"",onDataUpdate:t=>{this.props.webdata.push.content.map((e=>{e.recipientsPercentage=t}))},cancelBtnClicked:()=>this.setState({isShowSplitSizeModal:!1}),saveBtnClicked:t=>{this.setState({isShowSplitSizeModal:!1}),this.props.webdata.push.content.map((e=>{e.recipientsPercentage=t.percentage,e.matchedAuidence=t.matchedAuidence,e.totalAuidence=this.state.totalAuidence}))},onChangeIsOpen:t=>{this.setState({isShowSplitSizeModal:t})}})})]}),this.state.isSplitSettings&&Ti.jsx(od,{web:!0,isOpen:this.state.isSplitSettings,splitDetails:this.state.isSplitSettingsData,onDataUpdate:t=>{this.props.webdata.push.content.map((e=>{e.isAutoSplit=t.isAutoSchedule,e.campaignPerformedBy=t.campaignPerFormanceBy,e.splitDuration=t.duration,e.splitPeriod=t.splitPeriod}))},onChangeIsOpen:t=>{this.setState({isSplitSettings:t})}})]})})}),ut&&mt&&vt&&Ti.jsx("div",{children:Ti.jsx(Hc,{resData:this.state.pushRes,redis:this.state.redisData,notificationData:this.props.webdata,smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,dynamicListId:this.state.dynamicListId,notificationError:this.state.notificationContentError,editClickOff:0===this.props.dynamicListId&&this.state.clickOffStatus,etClickOff:this.state.clickOffStatus,jobStatusId:null==(W=null==(G=null==(H=null==($=this.props)?void 0:$.history)?void 0:H.location)?void 0:G.state)?void 0:W.jobStatusId,type:"web",pushTypeId:null==(K=null==(Z=null==(J=null==(_=this.props)?void 0:_.webdata)?void 0:J.push)?void 0:Z.pushLayout)?void 0:K.pushLayoutId,pushType:2===(null==(Y=this.props.webdata)?void 0:Y.push.pushType.deliveryTypeId)||3===(null==(X=this.props.webdata)?void 0:X.push.pushType.deliveryTypeId)?2:null==(Q=this.props.webdata)?void 0:Q.push.pushType.deliveryTypeId,pushJson:this.props.webdata,showSmartLink:()=>{this.props.showSmartLink()},contentChange:()=>{},onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},popupButton:t=>{t&&this.webPushAddOrUpdate(this.getParams())},testPerviewStatus:this.state.testPerviewStatus,sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.webdata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,this.props.webdata.push.isRequestForApproval=!0,this.props.webdata.push.objectRequestApproval=t,this.webPushAddOrUpdate(e,!0,!1,!0)}},isRequestApproval:t=>{this.props.webdata.push.isRequestForApproval=t},approverCreated:t=>{this.props.webdata.push.rfaList=t},prepareData:t=>{this.props.webdata.push.objectRequestApproval=t}})}),(null==(tt=this.props.webdata)?void 0:tt.push.isSplit)&&Ti.jsxs("div",{className:"split-container-del-web",children:[Ti.jsx(Pi,{defaultSelectedItem:this.state.splitTabIndex,defaultClass:"",carouselTab:!0,dynamicTab:"",activeClass:"active",tabData:this.state.splitTabData,onDelete:!0!==this.state.clickOffStatus,type:"split",mainClass:"",deleteTabData:t=>{var e;let i=[...this.state.splitTabData];i.splice(t,1);let s=[...null==(e=this.props.webdata)?void 0:e.push.content];s.splice(t,1),s.map((t=>{t.recipientsPercentage=Math.floor(20/s.length),t.matchedAuidence=Math.floor(this.state.totalAuidence*t.recipientsPercentage/100),t.totalAuidence=this.state.totalAuidence})),this.props.webdata.push.content=s,this.setState({splitTabData:i}),this.forceUpdate()},callBack:(t,e)=>{this.setState({splitTabIndex:e})},onRemove:this.state.splitTabData.length<4,onRemoveDisable:this.state.clickOffStatus,onRemoveOnClick:()=>{var t,e;let i=!0;if(null==(t=this.props.webdata)||t.push.content.map(((t,e)=>{if(!1!==i)return i=this.splitValidation(e),i?void 0:(this.setState({splitTabIndex:e}),!1)})),i&&this.state.splitTabData.length<4){let t=this.state.splitTabData.length;t="A".charCodeAt(0)+t;let i={id:t,text:"Split "+String.fromCharCode(t)},s=[...this.state.splitTabData];s.push(i),this.setState({splitTabData:s});let a=[...null==(e=this.props.webdata)?void 0:e.push.content];a.push(this.createSplitObject(String.fromCharCode(t))),a.map((t=>{t.recipientsPercentage=Math.floor(20/a.length),t.matchedAuidence=Math.floor(this.state.totalAuidence*t.recipientsPercentage/100),t.totalAuidence=this.state.totalAuidence})),this.props.webdata.push.content=a;let n=[...this.state.splitContentError];n.push(this.createSplitError()),this.setState({splitContentError:n,splitTabIndex:s.length-1})}}}),this.renderComponents(this.state.splitTabIndex)]}),1!==(null==(et=this.props.webdata)?void 0:et.push.pushType.deliveryTypeId)&&4===(null==(it=this.props.webdata)?void 0:it.push.pushLayout.pushLayoutId)&&(null==(st=this.props.webdata)?void 0:st.push.isCarousel)&&Ti.jsxs("div",{className:"split-container-del-web",children:[Ti.jsx(Pi,{defaultSelectedItem:this.state.carouselTabIndex,defaultClass:"",carouselTab:!0,dynamicTab:"",activeClass:"active",tabData:this.state.carouselTabData,onDelete:!0!==this.state.clickOffStatus,type:"split",mainClass:"",deleteTabData:t=>{var e;let i=[...this.state.carouselTabData];i.splice(t,1);let s=[...null==(e=this.props.webdata)?void 0:e.push.content];s.splice(t,1),this.props.webdata.push.content=s,this.forceUpdate();let a=[...this.state.carouselContentError];a.splice(t,1),this.setState({carouselTabData:i,carouselContentError:a})},callBack:(t,e)=>{this.setState({carouselTabIndex:e})},onRemove:this.state.carouselTabData.length<4,onRemoveDisable:this.state.clickOffStatus,onRemoveOnClick:()=>{var t,e,i,s,a,n,l,o,r,c,d,p;let h=!0;if(null==(t=this.props.webdata)||t.push.content.map(((t,e)=>{if(!1!==h)return h=this.carouselValidation(e),h?void 0:(this.setState({carouselTabIndex:e}),!1)})),h&&this.state.carouselTabData.length<4){let t=this.state.carouselTabData.length;t="A".charCodeAt(0)+t;let h={id:t,text:"Carousel "+String.fromCharCode(t)},u=[...this.state.carouselTabData];u.push(h),this.setState({carouselTabData:u});let m=[...null==(e=this.props.webdata)?void 0:e.push.content];m.push(this.createSplitObject(String.fromCharCode(t))),m[m.length-1].hashTag=null==(i=this.props.webdata)?void 0:i.push.content[0].hashTag,m[m.length-1].isExpiryButtonEnabled=null==(s=this.props.webdata)?void 0:s.push.content[0].isExpiryButtonEnabled,m[m.length-1].isAlertSound=null==(a=this.props.webdata)?void 0:a.push.content[0].isAlertSound,m[m.length-1].alertSound=null==(n=this.props.webdata)?void 0:n.push.content[0].alertSound,m[m.length-1].pushExpiryhours=null==(l=this.props.webdata)?void 0:l.push.content[0].pushExpiryhours,m[m.length-1].pushexpirySchedule=null==(o=this.props.webdata)?void 0:o.push.content[0].pushexpirySchedule,m[m.length-1].scheduleDate=null==(r=this.props.webdata)?void 0:r.push.content[0].localScheduleTime,m[m.length-1].schedule=null==(c=this.props.webdata)?void 0:c.push.content[0].schedule,m[m.length-1].timezone=null==(d=this.props.webdata)?void 0:d.push.content[0].timezone,m[m.length-1].timezoneId=null==(p=this.props.webdata)?void 0:p.push.content[0].timezoneId,this.props.webdata.push.content=m;let v=[...this.state.carouselContentError];v.push(this.createSplitError()),this.setState({carouselContentError:v,carouselTabIndex:u.length-1})}}}),this.renderComponents(this.state.carouselTabIndex)]}),this.state.isOpenSplitResetModal?Ti.jsx(kl,{para:"Are you sure you want to reset it?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{var e;if(t){let t=[...null==(e=this.props.webdata)?void 0:e.push.content];t[0].splitType="",t[0].title="",t[0].titleColor="",t[0].bgColor="",t[0].subTitle="",t[0].body="",t[0].hashTag=[],t[0].isInteractivebuttonEnabled=!1,t[0].interActivity=[],t[0].interActivityButton1Name="",t[0].interActivityButton2Name="",t[0].isExpiryButtonEnabled=!1,t[0].pushexpirySchedule="",t[0].pushExpiryhours=0,t[0].isAlertSound=!1,t[0].alertSound="",t[0].timezone="",t[0].timezoneId="",t[0].scheduleDate="",t[0].bodyTextColor="",t[0].bodyBgColor="",this.props.webdata.push.content=[t[0]],this.props.webdata.push.isSplit=!1,this.setState({isSplit:!this.state.isSplit})}this.setState({isOpenSplitResetModal:!this.state.isOpenSplitResetModal})}}):null,this.state.errShedule&&Ti.jsx(kl,{headerTitle:"Confirmation",para:this.state.scheduleErrMsg,secondaryButtonText:"Cancel",primaryButtonText:"OK",size:"lg",buttonClicked:t=>{var e,i,s,a;window.scrollTo(0,0),this.setState({errShedule:null}),(null==(i=null==(e=this.props.webdata)?void 0:e.push)?void 0:i.content.filter((t=>""===t.scheduleDate))).length===(null==(a=null==(s=this.props.webdata)?void 0:s.push)?void 0:a.content.length)&&t&&(this.setState({errSchedule:null}),this.webPushAddOrUpdate(this.getParams()))}}),this.state.rfaSchedule&&Ti.jsx(kl,{headerTitle:"Confirmation",para:"Schedule date is required.",secondaryButtonText:"Cancel",primaryButtonText:"OK",size:"lg",buttonClicked:t=>{this.setState({rfaSchedule:!1})}}),this.state.isOpenCarouselResetModal?Ti.jsx(kl,{para:"Are you sure you want to reset it?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{var e;if(t){let t=[...null==(e=this.props.webdata)?void 0:e.push.content];t[0].splitType="",t[0].title="",t[0].titleColor="",t[0].bgColor="",t[0].subTitle="",t[0].body="",t[0].hashTag=[],t[0].isInteractivebuttonEnabled=!1,t[0].interActivity=[],t[0].interActivityButton1Name="",t[0].interActivityButton2Name="",t[0].isExpiryButtonEnabled=!1,t[0].pushexpirySchedule="",t[0].pushExpiryhours=0,t[0].isAlertSound=!1,t[0].alertSound="",t[0].timezone="",t[0].timezoneId="",t[0].scheduleDate="",t[0].bodyTextColor="",t[0].bodyBgColor="",this.props.webdata.push.content=[t[0]],this.props.webdata.push.isCarousel=!1,this.props.webdata.push.position={positionValue:"-- Select position --",positionId:0}}else this.props.webdata.push.pushLayout={pushLayoutValue:"Carousel",pushLayoutId:4};this.setState({isOpenCarouselResetModal:!this.state.isOpenCarouselResetModal})}}):null]}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),Ti.jsx(zs,{className:`${this.state.clickOffStatus&&"click-off"}`,onClick:()=>{if(!0!==es())if(xd=!0,this.state.clickOffStatus)this.props.moveNext(1);else{let t=this.validation();if(void 0===t||t){let t=this.getParams();!0===this.props.webdata.push.isRequestForApproval?(t.objectRequestApproval=this.props.webdata.push.objectRequestApproval,t.isSendTestPush=1,t.isRequestForApproval=!0,this.webPushAddOrUpdate(t,!0,!1,!0)):this.webPushAddOrUpdate(t)}}else this.props.history.push("/campaign")},children:"Save"}),Ti.jsx(ns,{onClick:()=>{if(!0!==es())if(this.state.clickOffStatus)this.props.moveNext(1);else{let t=this.validation();if(void 0===t||t){xd=!1;let t=this.getParams();!0===this.props.webdata.push.isRequestForApproval?(t.objectRequestApproval=this.props.webdata.push.objectRequestApproval,t.isSendTestPush=1,t.isRequestForApproval=!0,this.webPushAddOrUpdate(t,!0,!1,!0)):this.webPushAddOrUpdate(t)}}else this.props.moveNext(1)},children:"Next "})]})]}):""]})}}ji(Id,"contextType",Ji);const kd=wi(Id),Dd=(t,e,i,s,a,n)=>!!ss(t)&&(2===n||3===n?(a[e][i]=s,!0):(a[i]=s,!0)),Ad=(t,e,i,s=0,a,n)=>{var l=!1;if(5===n&&(void 0===e.importContent||null===e.importContent||""===(null==e?void 0:e.importContent)))return i.errImportUrl="Import URL or Zip",i.errBody="Enter import URL",l=!0,!0;if(Dd(e.contentType,s,"errContentType","Select content type",i,t))return!0;let o=!0;if("EDM"===e.contentType){if(void 0!==e.importContent&&null!==e.importContent&&""===(null==e?void 0:e.importContent))return i[s].errImportUrl="Import URL or Zip",i[s].errBody="Enter import URL",l=!0,!0;if(o=e.makeAlert,2===t&&0===s?o=e.makeAlert:1!==t&&3!==t||(o=e.makeAlert),2===t&&o&&0===s&&Dd(e.title,s,"errTitle",Ra,i,t))return l=!0,!0;if(2===t&&o&&0===s&&Dd(e.shortDesc,s,"errShortDesc","Please enter the short desc",i))return l=!0,!0}if("TEXT"===e.contentType){if(1===n&&Dd(e.title,s,"errTitle",Ra,i,t))return l=!0,!0;if(1===n&&Dd(e.body,s,"errBody",yn,i,t))return l=!0,!0}return!0===wd(t,e,i,a,s)||!0===Nd(t,e,i,a)||!0===Ld(t,e,i,a)?(l=!0,!0):l},wd=(t,e,i,s,a)=>{var n,l;let o=!1;if(null==e?void 0:e.isInteractivebuttonEnabled)if((null==(n=null==e?void 0:e.interActivity)?void 0:n.length)>0){let n=0;null==(l=null==e?void 0:e.interActivity)||l.forEach((e=>{var l,r,c,d;let p=0===n?"errInteractivityButton1":"errInteractivityButton2",h=0===n?fn:Sn;if(Dd(null==e?void 0:e.actionName,a,p,h,i,t))return o=!0,o;if("smartlink 1"===(null==(l=null==e?void 0:e.clickBehavourValue)?void 0:l.toLowerCase())){if(0===(null==s?void 0:s.length)&&Dd("",a,"errInteractivityButton1","Configure smartlink",i,t))return o=!0,!0}else if("smartlink 2"===(null==(r=null==e?void 0:e.clickBehavourValue)?void 0:r.toLowerCase())&&(null==s?void 0:s.length)<2&&Dd("",a,"errInteractivityButton2","Configure smartlink",i,t))return o=!0,!0;if(n++,"Maybe later"===(null==e?void 0:e.actionName)){if(ss(null==e?void 0:e.reschedule)&&Dd("",a,"errFrequencyType",xn,i,t))return o=!0,!0;if(0===(null==e?void 0:e.interactivehours)&&Dd("",a,"errFrequencyValue",va,i,t))return o=!0,!0;if(!(null==(c=null==e?void 0:e.maybeLaterTimeings)?void 0:c.toLowerCase().includes("(s)"))&&Dd("",a,"errFrequencyType",xn,i,t))return o=!0,!0;if((null==(d=null==e?void 0:e.maybeLaterTimeings)?void 0:d.split(" ").length)<2&&Dd("",a,"errFrequencyValue",va,i,t))return o=!0,!0}}))}else if(Dd("",a,"errInteractivityButton1",fn,i,t))return o=!0,!0;return o},Nd=(t,e,i,s)=>{if(e.isExpiryButtonEnabled){if((null===e.pushexpirySchedule||ss(e.pushexpirySchedule)||e.pushexpirySchedule.toLowerCase().includes("select"))&&Dd("",s,"errExpiryType",ya,i,t))return!0;if(ss(e.pushExpiryhours)&&Dd("",s,"errExpiryType",ya,i,t))return!0}return!1},Ld=(t,e,i,s)=>!(!e.isAlertSound||!ss(e.alertSound)&&!e.alertSound.toLowerCase().includes("select")||!Dd("",s,"errAlertSound",fa,i,t));class Ed extends Di.Component{constructor(t){super(t),ji(this,"state",{pushRes:!1,redisData:0,saveError:!1,errMsg:null,smartlinkErrorMessage:null,showPopUp:!1,imgShowPopUp:!1,isSecure:(null==(pi=null==(di=this.props.mobiledata)?void 0:di.push)?void 0:pi.secure)||!1,defaultContent:null,inboxClassifications:[],isOpenSplitResetModal:!1,isOpenCarouselResetModal:!1,mobileApp:"add"===(null==(vi=null==(mi=null==(ui=null==(hi=this.props)?void 0:hi.history)?void 0:ui.location)?void 0:mi.state)?void 0:vi.mode)?this.props.mobileApp:(null==(yi=this.props)?void 0:yi.mobiledata)?null==(fi=null==(bi=null==(gi=this.props)?void 0:gi.mobiledata)?void 0:bi.push)?void 0:fi.mobileApp:null==(xi=this.props)?void 0:xi.mobiledata,deliveryType:{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},inboxClassification:{cdId:0,classificationId:"-- Inbox classification --"},layout:{pushLayoutValue:"-- Select push layout --",pushLayoutId:0},position:{positionValue:"-- Select position --",positionId:0},dynamicListId:0,audienceCount:0,isSplit:!1,isCarousel:!1,notificationErrSchedule:!1,rfaSchedule:!1,splitTabIndex:0,carouselTabIndex:0,splitTabData:[{id:10011,text:"Split A"},{id:1002,text:"Split B"}],carouselTabData:[{id:10011,text:"Carousel A"},{id:1002,text:"Carousel B"}],errMobileApp:null,errDeliveryType:null,errInboxClassification:null,errLayout:null,errPosition:null,errContainerData:null,notificationContentError:{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},splitContentError:[{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},{errTitle:null,errContentType:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}],carouselContentError:[{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null},{errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errImportUrl:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}],smartAppStore:null,splitRange:"10",isSplitSettingsData:{isAutoSchedule:!0,campaignPerFormanceBy:"content",splitDuration:8,splitInterval:"Hours"},isSplitSettings:!1,addTestPush:!0,sendTestPreview:!1,scheduleErrMsg:"The communication is not scheduled. Do you want to continue?",testPerviewStatus:null,saveButtonClicked:!1,totalAuidence:0,clickOffStatus:this.props.editClickOff,showRFAModal:!1,getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1,deliveryTypes:Md}),ji(this,"componentDidUpdate",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h;t!==this.props&&(this.setState({isSecure:null==(i=null==(e=this.props.mobiledata)?void 0:e.push)?void 0:i.secure}),t.mobileApp!==this.props.mobileApp&&(this.setState({mobileApp:this.props.mobileApp}),this.getDeviceInfoRedis(null==(a=null==(s=this.props)?void 0:s.mobileApp)?void 0:a.appGuid),this.getInboxClassification(),0===this.props.dynamicListId&&this.getAudienceCount(),((null==(r=null==(o=null==(l=null==(n=this.props.mobiledata)?void 0:n.push)?void 0:l.content[0])?void 0:o.title)?void 0:r.length)>0||(null==(h=null==(p=null==(d=null==(c=this.props.mobiledata)?void 0:c.push)?void 0:d.content[0])?void 0:p.body)?void 0:h.length)>0)&&this.setState({addTestPush:!1})))})),ji(this,"initialValueCheck",(()=>{var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L;if(this.getDeviceInfoRedis(null==(e=null==(t=this.props)?void 0:t.mobileApp)?void 0:e.appGuid),null==(s=null==(i=this.props.mobiledata)?void 0:i.push)?void 0:s.isCarousel){Is("Carousel Length",null==(a=this.props.mobiledata)?void 0:a.push);let t=[];null==(o=null==(l=null==(n=this.props.mobiledata)?void 0:n.push)?void 0:l.content)||o.map(((e,i)=>{t.push({id:i,text:"Carousel "+e.splitType})})),this.setState({carouselTabData:t})}if(0===(null==(d=null==(c=null==(r=this.props.mobiledata)?void 0:r.push)?void 0:c.inboxClassification)?void 0:d.cdId)){let t={cdId:0,classificationId:"-- Inbox classification --"};this.props.mobiledata.push.inboxClassification=t}if(((null==(m=null==(u=null==(h=null==(p=this.props.mobiledata)?void 0:p.push)?void 0:h.content[0])?void 0:u.title)?void 0:m.length)>0||(null==(b=null==(g=null==(y=null==(v=this.props.mobiledata)?void 0:v.push)?void 0:y.content[0])?void 0:g.body)?void 0:b.length)>0)&&this.setState({addTestPush:!1}),this.getInboxClassification(),0===this.props.dynamicListId&&this.getAudienceCount(),null!==(null==(f=this.props)?void 0:f.isAutoSchedule)&&null!==(null==(S=null==(x=null==this?void 0:this.props)?void 0:x.isAutoSchedule)?void 0:S.autoSchedule)&&void 0!==(null==(j=null==(C=null==this?void 0:this.props)?void 0:C.isAutoSchedule)?void 0:j.autoSchedule)){let t={isAutoSchedule:null==(I=null==(T=null==this?void 0:this.props)?void 0:T.isAutoSchedule)?void 0:I.autoSchedule,campaignPerFormanceBy:(null==(D=null==(k=null==this?void 0:this.props)?void 0:k.isAutoSchedule)?void 0:D.performedBy)||"content",duration:(null==(w=null==(A=null==this?void 0:this.props)?void 0:A.isAutoSchedule)?void 0:w.startIn)||8,period:(null==(L=null==(N=null==this?void 0:this.props)?void 0:N.isAutoSchedule)?void 0:L.periodRange)||"Hours"};this.setState({isSplitSettingsData:t})}this.getMobileNotificationDetails(),this.getAccessData()})),ji(this,"getDynamicListExsit",(t=>{os({path:Ks,params:{dynamiclistId:t},ok:t=>{var e,i;if(!0===(null==t?void 0:t.status)&&null!==(null==(e=null==t?void 0:t.data)?void 0:e.geoFence)&&void 0!==(null==(i=null==t?void 0:t.data)?void 0:i.geoFence)){let t=[...this.state.deliveryTypes];t.pop(),this.setState({deliveryTypes:t})}},fail:t=>{}})})),ji(this,"getAccessData",(()=>{let t=!1,e=!1,i=!1;const s=Zi("Communications");1==(null==s?void 0:s.get_AddAccessData)&&(t=!0),e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(i=!0),this.setState({getAddAccessData:t,getUpdateAccessData:e,getDeleteAccessData:i})})),ji(this,"getMobileNotificationDetails",(()=>{let t=Ln();os({path:En,params:{campaignId:t,channelId:14},sessionOut:this.context.globalStateData.setSessionOutData,loading:this.context.globalStateData.setIsLoadingData,ok:t=>{var e,i,s,a;(null==t?void 0:t.status)&&null!==(null==(e=null==t?void 0:t.data)?void 0:e.statusid)&&void 0!==(null==(i=null==t?void 0:t.data)?void 0:i.statusid)&&(13===(null==(s=null==t?void 0:t.data)?void 0:s.statusid)?this.setState({clickOffStatus:!1}):12===(null==(a=null==t?void 0:t.data)?void 0:a.statusid)&&this.setState({clickOffStatus:!0}))},fail:t=>{}})})),ji(this,"createSplitObject",(t=>({splitType:t,title:"",edmUrl:"",titleColor:"",bgColor:"",subTitle:"",body:"",url:"",bodyTextColor:"",bodyBgColor:"",contentType:"",htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",localScheduleTime:"",makeAsAlert:!0,isInteractivebuttonEnabled:!1,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"-- Select alert sound --",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"",interActivityButton2Name:"",interActivity:[],timezone:Xs,timezoneId:"",hashTag:[],isAutoSplit:this.state.isSplitSettingsData.isAutoSchedule,campaignPerformedBy:this.state.isSplitSettingsData.campaignPerformedBy,splitDuration:this.state.isSplitSettingsData.splitDuration,splitInterval:this.state.isSplitSettingsData.splitInterval,recipientsPercentage:10}))),ji(this,"createSplitError",(()=>({errContentType:null,errTitle:null,errSubtitle:null,errBody:null,errInteractivityButton1:null,errInteractivityButton2:null,errAlertSound:null,errExpiryType:null,errExpiryValue:null,errHashTag:null,errSchdule:null,errFrequencyType:null,errFrequencyValue:null}))),ji(this,"getInboxClassification",(t=>{var e,i,s,a,n;if(this.setState({inboxClassifications:[]}),void 0===(null==(i=null==(e=this.props)?void 0:e.smartLinkData)?void 0:i.mobilePlatform)||0===(null==(n=null==(a=null==(s=this.props)?void 0:s.smartLinkData)?void 0:a.mobilePlatform)?void 0:n.length))return;let l={appId:null==this.props.smartLinkData.mobilePlatform[0].appName.appGuid?"":this.props.smartLinkData.mobilePlatform[0].appName.appGuid,domainUrl:""};os({path:Bn,params:l,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{t.status&&t.data&&t.data.mobileAppInboxClassification&&this.setState({inboxClassifications:t.data.mobileAppInboxClassification})},fail:t=>{}})})),ji(this,"getAudienceCount",(t=>{var e,i,s,a,n;if(0!==this.state.audienceCount)return;if(void 0===(null==(i=null==(e=this.props)?void 0:e.smartLinkData)?void 0:i.mobilePlatform)||0===(null==(n=null==(a=null==(s=this.props)?void 0:s.smartLinkData)?void 0:a.mobilePlatform)?void 0:n.length))return;let l={appId:null==this.props.smartLinkData.mobilePlatform[0].appName.appGuid?"":this.props.smartLinkData.mobilePlatform[0].appName.appGuid,domainUrl:""};os({path:Mn,params:l,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{if(t.status&&t.data){let e=t.data.pushTokens;this.setState({audienceCount:e,totalAuidence:e})}},fail:t=>{}})})),ji(this,"checkIsEmpty",((t,e,i,s,a)=>{if(ss(t)){let t=[...a];return t[e][i]=s,this.setState({errContent:t}),!0}return!1})),ji(this,"validation",((t=!1)=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O,q,V,z,$,H,G,W,_,J,Z,K,Y,X,Q,tt,et,it,st,at,nt,lt,ot,rt,ct,dt,pt,ht,ut,mt,vt,yt,gt,bt,ft,xt,St,Ct,jt,Tt,It,kt,Dt,At,wt,Nt;if(null!==this.props.smartLinkData&&void 0!==this.props.smartLinkData&&void 0!==(null==(e=this.props.smartLinkData)?void 0:e.mobilePlatform)&&0!==(null==(i=this.props.smartLinkData)?void 0:i.mobilePlatform.length)||this.setState({smartlinkErrorMessage:"Please create smartlink",showPopUp:!0}),0===(null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType)?void 0:n.deliveryTypeId))return this.setState({errDeliveryType:Un}),!1;if(1===(null==(r=null==(o=null==(l=this.props.mobiledata)?void 0:l.push)?void 0:o.deliveryType)?void 0:r.deliveryTypeId)||2===(null==(p=null==(d=null==(c=this.props.mobiledata)?void 0:c.push)?void 0:d.deliveryType)?void 0:p.deliveryTypeId)){if(0===(null==(m=null==(u=null==(h=this.props.mobiledata)?void 0:h.push)?void 0:u.pushLayout)?void 0:m.pushLayoutId))return this.setState({errLayout:Rn}),!1;if(1!==(null==(g=null==(y=null==(v=this.props.mobiledata)?void 0:v.push)?void 0:y.deliveryType)?void 0:g.deliveryTypeId)&&1!==(null==(x=null==(f=null==(b=this.props.mobiledata)?void 0:b.push)?void 0:f.pushLayout)?void 0:x.pushLayoutId)&&2!==(null==(j=null==(C=null==(S=this.props.mobiledata)?void 0:S.push)?void 0:C.pushLayout)?void 0:j.pushLayoutId)&&0===(null==(T=this.props.mobiledata)?void 0:T.push.position.positionId))return window.scrollTo(0,0),this.setState({errPosition:On}),!1}if(5===(null==(D=null==(k=null==(I=this.props.mobiledata)?void 0:I.push)?void 0:k.deliveryType)?void 0:D.deliveryTypeId)&&!((null==(A=this.props.mobiledata.push.containerData)?void 0:A.bannerId)>0))return this.setState({errContainerData:"Select container"}),!1;let Lt=!0,Et=!0;if(null==(w=this.props.mobiledata)?void 0:w.push.isSplit){let e=0;if(null==(N=this.props.mobiledata)||N.push.content.map(((t,i)=>{var s,a,n,l,o,r,c,d;!1!==Lt&&(2===(null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType)?void 0:n.deliveryTypeId)&&"TEXT"===(null==(o=null==(l=this.props.mobiledata)?void 0:l.push)?void 0:o.content[0].contentType)&&""==(null==t?void 0:t.title)&&""==(null==t?void 0:t.body)&&(ss(null==t?void 0:t.url)||void 0===(null==t?void 0:t.url)||null===(null==t?void 0:t.url))&&(Lt=!1,this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0})),!0===Ad(3,t,this.state.splitContentError,i,this.props.smartAppStore,null==(d=null==(c=null==(r=this.props.mobiledata)?void 0:r.push)?void 0:c.deliveryType)?void 0:d.deliveryTypeId)&&(Lt=!1,this.setState({splitContentError:this.state.splitContentError})),Lt?e++:this.setState({splitTabIndex:e}))})),!1===t&&Lt&&0===this.props.dynamicListId&&((null==(E=null==(L=this.props.mobiledata)?void 0:L.push)?void 0:E.content.filter((t=>""===t.scheduleDate))).length!==(null==(P=null==(M=null==(B=this.props.mobiledata)?void 0:B.push)?void 0:M.content)?void 0:P.length)&&this.setState({scheduleErrMsg:"Some of the split are not schedule properly, Please schedule all the split"}),null==(F=this.props.mobiledata)||F.push.content.map(((t,e)=>{""===t.scheduleDate&&(this.setState({splitTabIndex:e}),Lt=!1,this.setState({notificationErrSchedule:!0}))}))),2===(null==(O=null==(R=null==(U=this.props.mobiledata)?void 0:U.push)?void 0:R.deliveryType)?void 0:O.deliveryTypeId)&&"TEXT"===(null==(z=null==(V=null==(q=this.props.mobiledata)?void 0:q.push)?void 0:V.content[0])?void 0:z.contentType)&&(ss(null==($=this.props.mobiledata)?void 0:$.push.content[0].url)||void 0===(null==(W=null==(G=null==(H=this.props.mobiledata)?void 0:H.push)?void 0:G.content[0])?void 0:W.url)||null===(null==(Z=null==(J=null==(_=this.props.mobiledata)?void 0:_.push)?void 0:J.content[0])?void 0:Z.url)))return this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1}else{if(!(null==(K=this.props.mobiledata)?void 0:K.push.isCarousel))return 2!==(null==(ut=null==(ht=null==(pt=this.props.mobiledata)?void 0:pt.push)?void 0:ht.deliveryType)?void 0:ut.deliveryTypeId)||"TEXT"!==(null==(mt=this.props.mobiledata)?void 0:mt.push.content[0].contentType)||""!==(null==(vt=this.props.mobiledata)?void 0:vt.push.content[0].title)||""!==(null==(bt=null==(gt=null==(yt=this.props.mobiledata)?void 0:yt.push)?void 0:gt.content[0])?void 0:bt.body)||!ss(null==(ft=this.props.mobiledata)?void 0:ft.push.content[0].url)&&void 0!==(null==(Ct=null==(St=null==(xt=this.props.mobiledata)?void 0:xt.push)?void 0:St.content[0])?void 0:Ct.url)&&null!==(null==(It=null==(Tt=null==(jt=this.props.mobiledata)?void 0:jt.push)?void 0:Tt.content[0])?void 0:It.url)?!0===Ad(1,null==(kt=this.props.mobiledata)?void 0:kt.push.content[0],this.state.notificationContentError,0,this.props.smartAppStore,null==(wt=null==(At=null==(Dt=this.props.mobiledata)?void 0:Dt.push)?void 0:At.deliveryType)?void 0:wt.deliveryTypeId)?(this.setState({notificationContentError:this.state.notificationContentError}),!1):!1!==t||0!==this.props.dynamicListId||!ss(null==(Nt=this.props.mobiledata)?void 0:Nt.push.content[0].scheduleDate)||(this.setState({notificationErrSchedule:!0}),!1):(this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1);{let e=0;if(null==(Y=this.props.mobiledata)||Y.push.content.map(((t,i)=>{var s,a,n,l,o,r,c;if(!1!==Et){if(2===(null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType)?void 0:n.deliveryTypeId)&&"TEXT"===(null==(l=this.props.mobiledata)?void 0:l.push.content[0].contentType)&&""==(null==t?void 0:t.title)&&""==(null==t?void 0:t.body)&&(ss(null==t?void 0:t.url)||void 0===(null==t?void 0:t.url)||null===(null==t?void 0:t.url)))return Et=!1,this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1;!0===Ad(2,t,this.state.carouselContentError,i,this.props.smartAppStore,null==(c=null==(r=null==(o=this.props.mobiledata)?void 0:o.push)?void 0:r.deliveryType)?void 0:c.deliveryTypeId)&&(Et=!1,this.setState({carouselContentError:this.state.carouselContentError})),Et?e++:this.setState({carouselTabIndex:e})}})),Et&&0===this.props.dynamicListId&&!1===t&&ss(null==(X=this.props.mobiledata)?void 0:X.push.content[0].scheduleDate)&&(Et=!1,this.setState({notificationErrSchedule:!0})),2===(null==(et=null==(tt=null==(Q=this.props.mobiledata)?void 0:Q.push)?void 0:tt.deliveryType)?void 0:et.deliveryTypeId)&&"TEXT"===(null==(st=null==(it=this.props.mobiledata)?void 0:it.push)?void 0:st.content[0].contentType)&&(ss(null==(at=this.props.mobiledata)?void 0:at.push.content[0].url)||void 0===(null==(ot=null==(lt=null==(nt=this.props.mobiledata)?void 0:nt.push)?void 0:lt.content[0])?void 0:ot.url)||null===(null==(dt=null==(ct=null==(rt=this.props.mobiledata)?void 0:rt.push)?void 0:ct.content[0])?void 0:dt.url)))return this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1}}return!!Lt&&!!Et})),ji(this,"renderComponents",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h;let u=[...null==(e=this.props.mobiledata)?void 0:e.push.content],m=0;return null==(i=this.props.mobiledata)||i.push.content.forEach((t=>{var e;if(null==(e=this.props.mobiledata)?void 0:e.push.isSplit){if(void 0===this.state.splitContentError[m]&&this.state.splitContentError.push(this.createSplitError()),void 0===this.state.splitTabData[m]){var i=this.state.splitTabData.length,s={id:i="A".charCodeAt(0)+i,text:"Split "+String.fromCharCode(i)};this.state.splitTabData.push(s)}}else{if(void 0===this.state.carouselContentError[m]){let t=[...this.state.carouselContentError];t.push(this.createSplitError()),this.setState({carouselContentError:t})}if(void 0===this.state.carouselTabData[m]){let t=this.state.carouselTabData.length;t="A".charCodeAt(0)+t;let e={id:t,text:"Carousel "+String.fromCharCode(t)};this.state.carouselTabData.push(e)}}m++})),(null==(s=this.props.mobiledata)?void 0:s.push.isSplit)&&!(null==(a=this.props.mobiledata)?void 0:a.push.isCarousel)?Ti.jsx(Ti.Fragment,{children:Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"mb-3 borderB0",children:null==(n=this.props.mobiledata)?void 0:n.push.content.map(((e,i)=>{var s,a,n,l,o,r,c,d,p;return Is("Mobile Notification",null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType)?void 0:n.deliveryTypeId),Ti.jsx(Ql,{eventKey:"tab"+i,children:Ti.jsx(Xc,{data:this.props.mobiledata,index:i,showPreview:(null==(r=null==(o=null==(l=this.props)?void 0:l.mobileApp)?void 0:o.appGuid)?void 0:r.length)>0,notificationData:u[i],onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,splitError:this.state.splitContentError[i],editClickOff:this.state.clickOffStatus,name:"Raja"+t,type:"mobile",pushType:null==(p=null==(d=null==(c=this.props.mobiledata)?void 0:c.push)?void 0:d.deliveryType)?void 0:p.deliveryTypeId,dynamicListId:this.props.dynamicListId,pushJson:this.props.mobiledata,showSmartLink:()=>{this.props.showSmartLink()},contentChange:t=>{},sendTestPreview:t=>{this.testPreview(t)}})})}))})}):!(null==(l=this.props.mobiledata)?void 0:l.push.isSplit)&&(null==(o=this.props.mobiledata)?void 0:o.push.isCarousel)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"mb-3 borderB0",onChange:()=>{},children:null==(r=this.props.mobiledata)?void 0:r.push.content.map(((e,i)=>{var s,a,n,l,o,r,c;return Ti.jsx(Ql,{eventKey:"tab"+i,children:Ti.jsx(ad,{data:this.props.mobiledata,index:i,notificationData:u[i],onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},smartAppStore:this.props.smartAppStore,campaignPlan:this.props.campaignPlan,carouselError:this.state.carouselContentError[i],pushType:null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType)?void 0:n.deliveryTypeId,editClickOff:this.state.clickOffStatus,jobStatusId:null==(c=null==(r=null==(o=null==(l=this.props)?void 0:l.history)?void 0:o.location)?void 0:r.state)?void 0:c.jobStatusId,mobilepush:!0,name:"Raja"+t,type:"mobile",dynamicListId:this.props.dynamicListId,pushJson:this.props.mobiledata,showSmartLink:()=>{this.props.showSmartLink()},sendTestPreview:t=>{this.testPreview(t)}})})}))}),Ti.jsx("div",{className:9!==(null==(h=null==(p=null==(d=null==(c=this.props)?void 0:c.history)?void 0:d.location)?void 0:p.state)?void 0:h.jobStatusId)&&this.state.clickOffStatus?"click-off":"",children:Ti.jsx(Ac,{status:this.state.testPerviewStatus,notificationData:this.props.mobiledata,channel:"mobile push",sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.mobiledata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,e.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,e.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,e.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.setState({clickOffStatus:!0}),this.props.mobiledata.push.objectRequestApproval=t,this.mobilePushAddorUpdate(!1,e,!0,!1,!0)}},isRequestApproval:t=>{this.props.mobiledata.push.isRequestForApproval=t},approverCreated:t=>{this.props.mobiledata.push.rfaList=t},prepareData:t=>{this.props.mobiledata.push.objectRequestApproval=t}})})]}):void 0})),ji(this,"mobilePushAddorUpdate",((t=!1,e,i=!0,s=!1,a=!0)=>{var n,l;const o=no.parse(null==(l=null==(n=this.props.history)?void 0:n.location)?void 0:l.search);let r=void 0!==o.cId?o.cId:0;if(void 0!==localStorage.getItem(`camp_${r}`)&&null!==localStorage.getItem(`camp_${r}`)){let t=ks(localStorage.getItem(`camp_${r}`));t.notifyData.mode="edit",localStorage.setItem(`camp_${r}`,ts(t))}let c=Gn;this.props.isUpdate&&!1!==i||(c=ds),c=!0===this.state.addTestPush?ds:Gn,os({path:c,params:e,isCache:!1,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,n;if(t.status){if(!0===a&&(this.setState({showRFAModal:!0}),setTimeout((()=>{this.setState({showRFAModal:!1})}),2e3)),this.setState({pushRes:!0,addTestPush:!1}),!0===s)return void this.setState({testPerviewStatus:"Test communication will be sent shortly"});this.setState({pushRes:!0});let l={appId:null==(n=null==(e=t.data)?void 0:e.objCampaignDetails)?void 0:n.appId,appChannelId:t.data.objCampaignDetails.pushNotifyChannelDetailID};if(localStorage.setItem("appData",JSON.stringify(l)),i){if(!0===a)return void setTimeout((()=>{this.state.saveButtonClicked?(this.setState({saveButtonClicked:!1}),this.props.history.push("/campaign")):this.props.moveNext(2)}),2e3);this.state.saveButtonClicked?(this.setState({saveButtonClicked:!1}),this.props.history.push("/campaign")):this.props.moveNext(2)}}else this.setState({saveError:!0});const l=new CustomEvent("myCustomEvent",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(l)},fail:t=>{}})})),ji(this,"delivaryTypeRefersh",(()=>{this.props.mobiledata.push.deliveryType={deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0}})),ji(this,"refershBtnClicked",(()=>{this.setState({splitTabIndex:0,carouselTabIndex:0,isSecure:!1}),this.props.mobiledata.push.inboxClassification={cdId:0,classificationId:"-- Inbox classification --"},this.props.mobiledata.push.pushLayout={pushLayoutValue:"-- Select push layout --",pushLayoutId:0},this.props.mobiledata.push.position={positionValue:"-- Select position --",positionId:0},this.props.mobiledata.push.isSplit=!1,this.props.mobiledata.push.isCarousel=!1,this.props.mobiledata.push.isExpiryButtonEnabled=!1,this.props.mobiledata.push.isAlertSound=!1,this.props.mobiledata.push.pushexpirySchedule="",this.props.mobiledata.push.pushExpiryhours="",this.props.mobiledata.push.alertSound="",this.props.mobiledata.push.containerData="";let t=this.createSplitObject("A");this.props.mobiledata.push.content=[t],this.forceUpdate()})),ji(this,"getDeviceInfoRedis",(t=>{os({path:Vn,params:{AppID:t,DomianURL:""},ok:t=>{t.status&&this.setState({redisData:t.data})},fail:t=>{}})})),ji(this,"testPreview",(t=>{var e;let i=this.validation(!0);if(void 0===i||i){let i=this.getParams();i.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,i.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,i.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,i.testPushCampaignEmailAddress=t,i.isSendTestPush=2;let s=!1;s=!!(null==(e=this.props)?void 0:e.isUpdate)||0!==this.state.testPreviewCount,this.mobilePushAddorUpdate(!1,i,s,!0,!1),this.setState({testPreviewCount:this.state.testPreviewCount+1})}})),ji(this,"TestPreviewSuccessComponent",(()=>Ti.jsx(Ti.Fragment,{children:this.state.sendTestPreview&&Ti.jsxs(_l,{show:this.state.sendTestPreview,centered:!0,children:[Ti.jsx(_l.Header,{style:{border:0},children:Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({sendTestPreview:!1})}})}),Ti.jsx(_l.Body,{children:Ti.jsx("div",{children:Ti.jsx(Jl,{md:12,children:Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ka,size:"d font-xxl",color:"green",mainClass:""}),Ti.jsx("br",{}),Ti.jsx("label",{children:"Test communication will be sent shortly."})]})})})})]})})))}componentDidMount(){var t;if(window.scrollTo(0,0),0!==this.props.dynamicListId&&this.getDynamicListExsit(this.props.dynamicListId),!this.props.mobileApp)return;const e=new URL(window.location.href),i=new URLSearchParams(e.search);if(i.set("chId","14"),window.history.pushState({},"",`${e.pathname}?${i.toString()}`),null!==sessionStorage.getItem("pbcampdata")&&void 0!==sessionStorage.getItem("pbcampdata")){let e=$o.decompress(sessionStorage.getItem("pbcampdata"),"zlib");return this.props.mobiledata.push=null==(t=null==e?void 0:e.fullData)?void 0:t.push,this.setState({carouselTabIndex:(null==e?void 0:e.currentIndex)||0}),this.initialValueCheck(),this.forceUpdate(),void sessionStorage.removeItem("pbcampdata")}this.initialValueCheck()}getParams(){return Bl("mobile",this.props.campaignId,this.props.mobiledata,this.props.statusId,this.props.smartAppStore)}render(){var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O,q,V,z,$,H,G,W,_,J,Z,K,Y,X,Q,tt,et,it,st,at,nt,lt,ot,rt,ct,dt,pt,ht,ut,mt,vt,yt,gt,bt,ft,xt,St,Ct,jt,Tt,It,kt,Dt,At,wt,Nt,Lt,Et,Bt,Mt,Pt,Ft,Ut,Rt,Ot,qt,Vt,zt,$t,Ht,Gt,Wt,_t,Jt,Zt,Kt,Yt,Xt,Qt,te,ee,ie,se,ae,ne,le,oe,re,ce,de,pe,he,ue,me,ve,ye,ge,be,fe,xe,Se,Ce,je,Te,Ie,ke,De,Ae,we,Ne,Le,Ee,Be,Me,Pe,Fe,Ue;return null===this.props.smartLinkData||void 0===this.props.smartLinkData||void 0===(null==(t=this.props.smartLinkData)?void 0:t.mobilePlatform)||0===(null==(e=this.props.smartLinkData)?void 0:e.mobilePlatform.length)?Ti.jsx("div",{className:"reference-notification-web-push box-design bd-top-border",children:Ti.jsx(bd,{onProceed:()=>{var t;null==(t=this.props)||t.showSmartLink()}})}):Ti.jsxs(Ti.Fragment,{children:[this.props.mobiledata?Ti.jsxs("div",{children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),this.state.smartlinkErrorMessage&&Ti.jsxs(_l,{show:this.state.showPopUp,centered:!0,onHide:()=>{this.setState({showPopUp:!1,smartlinkErrorMessage:null})},children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Alert"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({showPopUp:!1,smartlinkErrorMessage:null})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx("p",{className:"text-center",children:"Generate the smart Link for mobile channel"})}),Ti.jsx(_l.Footer,{children:Ti.jsx("div",{className:"mt15",children:Ti.jsxs("div",{className:"btn-container d-flex justify-content-end",children:[Ti.jsx(as,{onClick:()=>{this.setState({showPopUp:!1,smartlinkErrorMessage:null})},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>{this.setState({showPopUp:!1,smartlinkErrorMessage:null}),this.props.enableSmartLink()},children:"Create"})]})})})]}),this.state.smartlinkErrorMessage&&!this.state.showPopUp&&Ti.jsx(_l,{show:this.state.imgShowPopUp,centered:!0,onHide:()=>{this.setState({smartlinkErrorMessage:null,imgShowPopUp:!1})},children:Ti.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[Ti.jsx("label",{children:this.state.smartlinkErrorMessage}),Ti.jsx("i",{className:"icon-rs-close-mini color-primary-blue cp p-close icons-sm posr top-2",onClick:()=>{this.setState({smartlinkErrorMessage:null,imgShowPopUp:!1})}})]})}),Ti.jsx(_l,{show:this.state.showRFAModal,centered:!0,size:"md",children:Ti.jsx(_l.Body,{children:Ti.jsxs("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Ti.jsx(Qi,{icon:Ka,size:"d font-xlg",color:"green",mainClass:""}),Ti.jsx("label",{style:{marginTop:10},children:"Communication has been sent successfully for approval"})]})})}),Ti.jsxs("div",{className:"reference-notification-mobile-push box-design bd-top-border "+((null==(s=null==(i=this.props.mobiledata)?void 0:i.push)?void 0:s.isSplit)&&this.state.isShowSplitSizeModal?"split-overlay-open":""),children:[Ti.jsx($l,{className:"mt30",children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Mobile app"})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{required:!0,data:null==(a=this.props.mobiledata)?void 0:a.mobileApps,label:"Mobile app",dataItemKey:"appId",textField:"appName",className:"click-off",disabled:this.state.clickOffStatus,value:"add"===(null==(r=null==(o=null==(l=null==(n=this.props)?void 0:n.history)?void 0:l.location)?void 0:o.state)?void 0:r.mode)?void 0!==this.state.mobileApp&&""!==this.state.mobileApp?this.state.mobileApp:{appName:"-- Select mobile app --",appId:"0"}:(null==(p=null==(d=null==(c=this.props.mobiledata)?void 0:c.push)?void 0:d.mobileApp)?void 0:p.length)?null==(u=null==(h=this.props.mobiledata)?void 0:h.push)?void 0:u.mobileApp:{appName:(null==(g=null==(y=null==(v=null==(m=this.props)?void 0:m.smartLinkData)?void 0:v.mobilePlatform[0])?void 0:y.appName)?void 0:g.appName)||"-- Select mobile app --",appId:"0"},onChange:t=>{let e=t.target.value.appName.length>0?null:$n;this.setState({errMobileApp:e}),this.props.mobiledata.push.mobileApp=t.target.value,this.setState({mobileApp:t.target.value}),this.forceUpdate()}})}),Ti.jsx(Zl,{md:2,children:Ti.jsxs(xo,{disabled:this.state.clickOffStatus,children:[Ti.jsx(Xi,{className:this.state.getAddAccessData?"click-on":"click-off",children:Ti.jsx(Qi,{icon:Ss,tooltip:"Create mobile app",onClick:()=>{this.props.history.push({pathname:"/preferences/communication-settings",search:`?cId=${this.props.campaignId}`,state:{type:"mobile",appPermission:!1,mobileOnBoarding:!0,isCampaign:!0}})}})}),0===this.state.dynamicListId&&0!==this.state.audienceCount&&Ti.jsx("div",{className:"ml10",children:"Audience: "+this.state.audienceCount})]})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Delivery type"})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{className:`${0!==(null==(x=null==(f=null==(b=this.props.mobiledata)?void 0:b.push)?void 0:f.deliveryType)?void 0:x.deliveryTypeId)&&"click-off"} ${this.state.clickOffStatus?"click-off":""}`,data:this.state.deliveryTypes,required:!0,label:"Delivery type",errorMessage:this.state.errDeliveryType,disabled:0!==(null==(j=null==(C=null==(S=this.props.mobiledata)?void 0:S.push)?void 0:C.inboxClassification)?void 0:j.cdId),value:null==(I=null==(T=this.props.mobiledata)?void 0:T.push)?void 0:I.deliveryType,textField:"deliveryTypeValue",dataItemKey:"deliveryTypeId",onChange:t=>{let e=0!==t.target.value.deliveryTypeId?null:Un;this.setState({errDeliveryType:e}),this.props.mobiledata.push.deliveryType=t.target.value,4===t.target.value.deliveryTypeId&&(this.props.mobiledata.push.isSplit=!1),this.props.mobiledata.push.content=[this.createSplitObject("A")],this.setState({deliveryType:t.target.value}),this.props.mobiledata.push.pushLayout={pushLayoutValue:"-- Select push layout --",pushLayoutId:0},this.props.mobiledata.push.position={positionValue:"-- Select position --",positionId:0},this.refershBtnClicked(),this.forceUpdate(),0===this.props.dynamicListId&&this.getAudienceCount()}})}),Ti.jsx(Zl,{md:6,children:Ti.jsx(Ul,{data:this.state.inboxClassifications,textField:"classificationId",dataItemKey:"cdId",required:!0,label:"Inbox classification",errorMessage:this.state.errInboxClassification,className:`${0!==(null==(A=null==(D=null==(k=this.props.mobiledata)?void 0:k.push)?void 0:D.deliveryType)?void 0:A.deliveryTypeId)?0!==(null==(L=null==(N=null==(w=this.props.mobiledata)?void 0:w.push)?void 0:N.inboxClassification)?void 0:L.cdId)?"click-off":"":this.state.inboxClassifications.length>0?"click-on":"click-off"} ${this.state.clickOffStatus?"click-off":""}`,value:null==(B=null==(E=this.props.mobiledata)?void 0:E.push)?void 0:B.inboxClassification,onChange:t=>{this.props.mobiledata.push.inboxClassification=t.target.value;let e=0!==t.target.value.cdId?null:zn;this.setState({errInboxClassification:e}),this.forceUpdate()}})})]})}),Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[Ti.jsx(Qi,{mainClass:!0===this.state.clickOffStatus?"click-off":"click-on",tooltip:this.state.isSecure?"Secure message ON":"Secure message OFF",icon:"icon-rs-shield-medium",size:"md",iconClass:this.state.isSecure?"green":"blue",onClick:()=>{var t;this.setState({isSecure:!this.state.isSecure}),this.props.mobiledata.push.secure=!(null==(t=this.props.mobiledata)?void 0:t.push.secure)}}),Ti.jsx(Qi,{mainClass:`${!0===this.state.clickOffStatus?"click-off":"click-on"} ${this.state.getAddAccessData?"click-off":"click-on"}`,tooltip:"Add inbox classification",icon:"icon-rs-circle-plus-fill-edge-medium",size:"md",iconClass:""!==this.props.mobileApp?"click-on":"click-off",onClick:()=>{var t,e,i,s,a,n,l,o;let r={};r.appDetails={appName:(null==(s=null==(i=null==(e=null==(t=this.props)?void 0:t.smartLinkData)?void 0:e.mobilePlatform[0])?void 0:i.appName)?void 0:s.appName)||"-- mobile app --",appId:(null==(o=null==(l=null==(n=null==(a=this.props)?void 0:a.smartLinkData)?void 0:n.mobilePlatform[0])?void 0:l.appName)?void 0:o.appGuid)||"appId"},r.type="mobile",r.appPermission=!0,r.appGuId=this.props.mobileApp.appGuid,r.onBoardingId=this.props.mobileApp.mpId,r.isCampaign=!0;let c=this.getParams();c.isUpdate=this.props.isUpdate,c.channelStatus=this.props.statusId,localStorage.setItem("mcdetails",JSON.stringify(c)),this.props.history.push({pathname:"/preferences/communication-settings",search:`?cId=${this.props.campaignId}`,state:r})}}),0!==(null==(U=null==(F=null==(P=null==(M=this.props)?void 0:M.mobiledata)?void 0:P.push)?void 0:F.deliveryType)?void 0:U.deliveryTypeId)?Ti.jsx(Qi,{mainClass:!0===this.state.clickOffStatus?"click-off":"click-on",tooltip:"Refresh",icon:"icon-rs-refresh-medium",size:"md",onClick:()=>{this.delivaryTypeRefersh(),this.refershBtnClicked()}}):null]})})})]})}),5===(null==(q=null==(O=null==(R=this.props.mobiledata)?void 0:R.push)?void 0:O.deliveryType)?void 0:q.deliveryTypeId)&&Ti.jsx(gd,{redis:this.state.redisData,resData:this.state.pushRes,mobileApp:this.props.mobileApp,errContainerData:this.state.errContainerData,notificationData:this.props.mobiledata,notificationError:this.state.notificationContentError,editClickOff:Hn(this.props.dynamicListId,this.state.clickOffStatus),etClickOff:this.state.clickOffStatus,jobStatusId:null==(H=null==($=null==(z=null==(V=this.props)?void 0:V.history)?void 0:z.location)?void 0:$.state)?void 0:H.jobStatusId,campaignPlan:this.props.campaignPlan,type:"mobile",dynamicListId:this.props.dynamicListId,showSmartLink:()=>{this.props.showSmartLink()},pushType:null==(_=null==(W=null==(G=this.props.mobiledata)?void 0:G.push)?void 0:W.deliveryType)?void 0:_.deliveryTypeId,pushJson:this.props.mobiledata,smartAppStore:this.props.smartAppStore,contentChange:()=>{},popupButton:t=>{if(t){let t=this.getParams();t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.mobilePushAddorUpdate(!1,t)}},testPerviewStatus:this.state.testPerviewStatus,sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.mobiledata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,e.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,e.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,e.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.setState({clickOffStatus:!0}),this.props.mobiledata.push.objectRequestApproval=t,this.mobilePushAddorUpdate(!1,e,!0,!1,!0),setTimeout((()=>{}),2e3)}},isRequestApproval:t=>{this.props.mobiledata.push.isRequestForApproval=t},approverCreated:t=>{this.props.mobiledata.push.rfaList=t},prepareData:t=>{this.props.mobiledata.push.objectRequestApproval=t},onChange:(t,e)=>{var i;this.setState({errContainerData:null});let s=this.createSplitObject("A");this.props.mobiledata.push.content=[s],this.props.mobiledata.push[t]=e,null==(i=this.props.mobiledata)||i.push.content.map(((t,e)=>{t.contentType="EDM",t.impressionCount=1,t.priority=1})),this.forceUpdate()}}),0!==(null==(K=null==(Z=null==(J=this.props.mobiledata)?void 0:J.push)?void 0:Z.deliveryType)?void 0:K.deliveryTypeId)&&(1===(null==(Q=null==(X=null==(Y=this.props.mobiledata)?void 0:Y.push)?void 0:X.deliveryType)?void 0:Q.deliveryTypeId)||2===(null==(it=null==(et=null==(tt=this.props.mobiledata)?void 0:tt.push)?void 0:et.deliveryType)?void 0:it.deliveryTypeId))||3===(null==(nt=null==(at=null==(st=this.props.mobiledata)?void 0:st.push)?void 0:at.deliveryType)?void 0:nt.deliveryTypeId)?Ti.jsx(Ti.Fragment,{children:Ti.jsx($l,{disabled:this.state.clickOffStatus,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:2,offset:0},children:Ti.jsx(Ao,{right:!0,label:"Layout / Position"})}),Ti.jsx(Zl,{md:6,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:Ti.jsx(Ul,{required:!0,label:"Layout type",disabled:0!==(null==(rt=null==(ot=null==(lt=this.props.mobiledata)?void 0:lt.push)?void 0:ot.pushLayout)?void 0:rt.pushLayoutId),errorMessage:this.state.errLayout,data:1===this.props.mobiledata.push.deliveryType.deliveryTypeId?[{pushLayoutValue:"Default",pushLayoutId:5},{pushLayoutValue:"Carousel",pushLayoutId:4}]:Tr,value:null==(ct=this.props.mobiledata)?void 0:ct.push.pushLayout,textField:"pushLayoutValue",dataItemKey:"pushLayoutId",onChange:t=>{var e;let i=0!==t.target.value.pushLayoutId?null:Rn;if(this.setState({errLayout:i}),this.setState({layout:t.target.value}),this.props.mobiledata.push.pushLayout=t.target.value,4===t.target.value.pushLayoutId){this.props.mobiledata.push.isSplit=!1,this.setState({isCarousel:!this.state.isCarousel}),this.props.mobiledata.push.isCarousel=!0;let t=[],e=[];for(let i=0;i<2;i++){let s="ABCD",a=t.length;a=s.charAt(i);let n={id:a,text:"Carousel "+a};t.push(n);let l=this.createSplitObject(a);e.push(l)}this.setState({carouselTabData:t}),this.props.mobiledata.push.content=e}else(null==(e=this.props.mobiledata)?void 0:e.push.isCarousel)&&this.setState({isOpenCarouselResetModal:!this.state.isOpenCarouselResetModal});this.forceUpdate()}})}),0!==(null==(ht=null==(pt=null==(dt=this.props.mobiledata)?void 0:dt.push)?void 0:pt.pushLayout)?void 0:ht.pushLayoutId)&&1!==(null==(vt=null==(mt=null==(ut=this.props.mobiledata)?void 0:ut.push)?void 0:mt.pushLayout)?void 0:vt.pushLayoutId)&&2!==(null==(bt=null==(gt=null==(yt=this.props.mobiledata)?void 0:yt.push)?void 0:gt.pushLayout)?void 0:bt.pushLayoutId)&&1!==(null==(ft=this.props.mobiledata)?void 0:ft.push.deliveryType.deliveryTypeId)?Ti.jsx(Zl,{children:Ti.jsx(Ul,{required:!0,label:"Position type",errorMessage:this.state.errPosition,disabled:0!==(null==(xt=this.props.mobiledata)?void 0:xt.push.position.positionId),data:Ir,value:null==(St=this.props.mobiledata)?void 0:St.push.position,textField:"positionValue",dataItemKey:"positionId",onChange:t=>{let e=0!==t.target.value.positionId?null:On;this.setState({errPosition:e}),this.props.mobiledata.push.position=t.target.value,this.setState({position:t.target.value}),this.forceUpdate()}})}):null]})}),0!==(null==(Tt=null==(jt=null==(Ct=this.props.mobiledata)?void 0:Ct.push)?void 0:jt.pushLayout)?void 0:Tt.pushLayoutId)&&Ti.jsx(Zl,{md:3,children:Ti.jsx(xo,{children:Ti.jsx(Xi,{children:0!==(null==(It=this.props.webdata)?void 0:It.push.pushType.deliveryTypeId)?Ti.jsx(Qi,{tooltip:"Refresh",icon:"icon-rs-refresh-medium",onClick:()=>{this.refershBtnClicked()}}):null})})})]})})}):null,0===this.props.dynamicListId&&4!==(null==(At=null==(Dt=null==(kt=this.props.mobiledata)?void 0:kt.push)?void 0:Dt.deliveryType)?void 0:At.deliveryTypeId)&&5!==(null==(Nt=null==(wt=this.props.mobiledata)?void 0:wt.push)?void 0:Nt.deliveryType)&&0!==(null==(Bt=null==(Et=null==(Lt=this.props.mobiledata)?void 0:Lt.push)?void 0:Et.deliveryType)?void 0:Bt.deliveryTypeId)?Ti.jsx(Ti.Fragment,{children:0===this.props.dynamicListId&&0!==(null==(Ft=null==(Pt=null==(Mt=this.props.mobiledata)?void 0:Mt.push)?void 0:Pt.deliveryType)?void 0:Ft.deliveryTypeId)&&4!==(null==(Ot=null==(Rt=null==(Ut=this.props.mobiledata)?void 0:Ut.push)?void 0:Rt.pushLayout)?void 0:Ot.pushLayoutId)&&5!==(null==(zt=null==(Vt=null==(qt=this.props.mobiledata)?void 0:qt.push)?void 0:Vt.deliveryType)?void 0:zt.deliveryTypeId)?Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"position-relative split-ab-temp-container",children:[Ti.jsx(Zl,{md:{span:2,offset:0},className:"pl10",children:Ti.jsx(Ao,{right:!0,label:"Split A/B test"})}),Ti.jsx(Zl,{md:1,children:Ti.jsx("div",{className:"d-flex align-items-center "+(this.state.audienceCount<99?"click-off":"click-on"),children:Ti.jsx(qo,{disabled:!1,checked:null==($t=this.props.mobiledata)?void 0:$t.push.isSplit,onChange:t=>{if(t.target.value){this.props.mobiledata.push.isSplit=t.target.value;let e=[],i=[];for(let t=0;t<2;t++){let s="ABCD",a=e.length;a=s.charAt(t);let n={id:a,text:"Split "+a};e.push(n);let l=this.createSplitObject(a);i.push(l)}this.setState({splitTabData:e}),i.map((t=>{t.recipientsPercentage=Math.floor(20/i.length),t.matchedAuidence=Math.floor(this.state.totalAuidence*t.recipientsPercentage/100),t.totalAuidence=this.state.totalAuidence})),this.props.mobiledata.push.content=i,this.props.mobiledata.push.isCarousel=!1,this.setState({isSplit:!this.state.isSplit})}else this.setState({isOpenSplitResetModal:!this.state.isOpenSplitResetModal});this.forceUpdate()}})})}),Ti.jsx(Zl,{md:2,className:"pl3",children:(null==(Ht=this.props.mobiledata)?void 0:Ht.push.isSplit)&&Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[Ti.jsx(Qi,{icon:"icon-rs-circle-dropdown-medium",size:"md",onClick:()=>{this.setState({isShowSplitSizeModal:!0})}}),Ti.jsx(Qi,{icon:"icon-rs-settings-medium",size:"md",onClick:()=>{this.setState({isSplitSettings:!this.state.isSplitSettings})}}),Ti.jsx(Qi,{pophover:"A minimum of 100 audience are required for split A/B testing. Check the communication listing page for results",icon:"icon-rs-circle-question-mark-medium",size:"md"})]})})}),(null==(Gt=this.props.mobiledata)?void 0:Gt.push.isSplit)&&this.state.isShowSplitSizeModal&&Ti.jsxs(_l,{show:this.state.isShowSplitSizeModal,size:"xl",className:"modal-top-fixed",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Split size"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isShowSplitSizeModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(Ti.Fragment,{children:Ti.jsx(cd,{isOpen:this.state.isShowSplitSizeModal,data:{splitList:this.props.mobiledata.push.content,splitAudience:(null==(Wt=this.props.mobiledata.push.content[0])?void 0:Wt.matchedAuidence)||0,totalAuidence:(null==(_t=this.props.mobiledata.push.content[0])?void 0:_t.totalAuidence)||this.state.totalAuidence,splitSizePercentage:(null==(Jt=this.props.mobiledata.push.content[0])?void 0:Jt.recipientsPercentage)||0},splitSizeDetails:"",onDataUpdate:t=>{this.props.mobiledata.push.content.map((e=>{e.recipientsPercentage=t}))},cancelBtnClicked:()=>this.setState({isShowSplitSizeModal:!1}),saveBtnClicked:t=>{this.setState({isShowSplitSizeModal:!1}),this.props.mobiledata.push.content.map((e=>{e.recipientsPercentage=t.percentage,e.matchedAuidence=t.matchedAuidence,e.totalAuidence=this.state.totalAuidence}))},onChangeIsOpen:t=>{this.setState({isShowSplitSizeModal:t})}})})})]})]})}):null}):null,this.state.isSplitSettings&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(od,{mob:!0,campaignId:this.props.campaignId,isOpen:this.state.isSplitSettings,splitDetails:this.state.isSplitSettingsData,onDataUpdate:t=>{this.props.mobiledata.push.content.map((e=>{e.isAutoSchedule=t.isAutoSchedule,e.campaignPerformedBy=t.campaignPerFormanceBy,e.splitDuration=t.duration,e.splitInterval=t.splitPeriod}))},onChangeIsOpen:t=>{this.setState({isSplitSettings:t})}})}),4===(null==(Yt=null==(Kt=null==(Zt=this.props.mobiledata)?void 0:Zt.push)?void 0:Kt.deliveryType)?void 0:Yt.deliveryTypeId)&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(Hc,{notificationData:this.props.mobiledata,mobileApp:this.props.mobileApp,onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},notificationError:this.state.notificationContentError,editClickOff:Hn(this.props.dynamicListId,this.state.clickOffStatus),etClickOff:this.state.clickOffStatus,jobStatusId:null==(ee=null==(te=null==(Qt=null==(Xt=this.props)?void 0:Xt.history)?void 0:Qt.location)?void 0:te.state)?void 0:ee.jobStatusId,campaignPlan:this.props.campaignPlan,type:"mobile",dynamicListId:this.props.dynamicListId,pushType:null==(ae=null==(se=null==(ie=this.props.mobiledata)?void 0:ie.push)?void 0:se.deliveryType)?void 0:ae.deliveryTypeId,showSmartLink:()=>{this.props.showSmartLink()},pushJson:this.props.mobiledata,smartAppStore:this.props.smartAppStore,contentChange:()=>{},popupButton:t=>{if(t){let t=this.getParams();t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.mobilePushAddorUpdate(!1,t)}},testPerviewStatus:this.state.testPerviewStatus,sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.mobiledata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,e.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,e.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,e.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.setState({clickOffStatus:!0}),this.props.mobiledata.push.objectRequestApproval=t,this.mobilePushAddorUpdate(!1,e,!1,!0,!0),setTimeout((()=>{}),2e3)}},isRequestApproval:t=>{this.props.mobiledata.push.isRequestForApproval=t},approverCreated:t=>{this.props.mobiledata.push.rfaList=t},prepareData:t=>{this.props.mobiledata.push.objectRequestApproval=t}})}),0!==(null==(oe=null==(le=null==(ne=this.props.mobiledata)?void 0:ne.push)?void 0:le.deliveryType)?void 0:oe.deliveryTypeId)&&!(null==(ce=null==(re=this.props.mobiledata)?void 0:re.push)?void 0:ce.isSplit)&&!(null==(pe=null==(de=this.props.mobiledata)?void 0:de.push)?void 0:pe.isCarousel)&&0!==(null==(me=null==(ue=null==(he=this.props.mobiledata)?void 0:he.push)?void 0:ue.pushLayout)?void 0:me.pushLayoutId)&&!((3===(null==(ge=null==(ye=null==(ve=this.props.mobiledata)?void 0:ve.push)?void 0:ye.pushLayout)?void 0:ge.pushLayoutId)||4===(null==(xe=null==(fe=null==(be=this.props.mobiledata)?void 0:be.push)?void 0:fe.pushLayout)?void 0:xe.pushLayoutId))&&0===(null==(je=null==(Ce=null==(Se=this.props.mobiledata)?void 0:Se.push)?void 0:Ce.position)?void 0:je.positionId))&&Ti.jsx("div",{children:Ti.jsx(Hc,{redis:this.state.redisData,resData:this.state.pushRes,mobileApp:this.props.mobileApp,notificationData:this.props.mobiledata,onClickShortlinkBtnClick:t=>{this.props.onClickShortlinkBtnClick(t)},notificationError:this.state.notificationContentError,editClickOff:Hn(this.props.dynamicListId,this.state.clickOffStatus),etClickOff:this.state.clickOffStatus,jobStatusId:null==(De=null==(ke=null==(Ie=null==(Te=this.props)?void 0:Te.history)?void 0:Ie.location)?void 0:ke.state)?void 0:De.jobStatusId,campaignPlan:this.props.campaignPlan,type:"mobile",dynamicListId:this.props.dynamicListId,showSmartLink:()=>{this.props.showSmartLink()},pushType:null==(Ne=null==(we=null==(Ae=this.props.mobiledata)?void 0:Ae.push)?void 0:we.deliveryType)?void 0:Ne.deliveryTypeId,pushJson:this.props.mobiledata,smartAppStore:this.props.smartAppStore,contentChange:()=>{},popupButton:t=>{if(t){let t=this.getParams();t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.mobilePushAddorUpdate(!1,t)}},testPerviewStatus:this.state.testPerviewStatus,sendTestPreview:t=>{this.setState({testPerviewStatus:null}),this.testPreview(t)},sendRFA:t=>{var e;let i=this.validation(!0);if(ss(null==(e=this.props.mobiledata)?void 0:e.push.content[0].scheduleDate))this.setState({rfaSchedule:!0,scheduleErrMsg:"Schedule date is required"});else if(void 0===i||i){let e=this.getParams();e.objectRequestApproval=t,e.isSendTestPush=1,e.isRequestForApproval=!0,e.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,e.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,e.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.setState({clickOffStatus:!0}),this.props.mobiledata.push.objectRequestApproval=t,this.mobilePushAddorUpdate(!1,e,!0,!1,!0),setTimeout((()=>{}),2e3)}},isRequestApproval:t=>{this.props.mobiledata.push.isRequestForApproval=t},approverCreated:t=>{this.props.mobiledata.push.rfaList=t},prepareData:t=>{this.props.mobiledata.push.objectRequestApproval=t}})}),!0===(null==(Le=this.props.mobiledata)?void 0:Le.push.isSplit)?Ti.jsxs("div",{className:"split-container-del-mobile",children:[Ti.jsx(Pi,{carouselTab:!0,defaultSelectedItem:this.state.splitTabIndex,defaultClass:"",dynamicTab:"",activeClass:"active",tabData:this.state.splitTabData,onDelete:!0!==(null==(Ee=this.props)?void 0:Ee.editClickOff),type:"split",mainClass:"",deleteTabData:t=>{var e;let i=[...this.state.splitTabData];i.splice(t,1);let s=[...null==(e=this.props.mobiledata)?void 0:e.push.content];s.splice(t,1),s.map((t=>{t.recipientsPercentage=Math.floor(20/s.length),t.matchedAuidence=Math.floor(this.state.totalAuidence*t.recipientsPercentage/100),t.totalAuidence=this.state.totalAuidence})),this.props.mobiledata.push.content=s,this.setState({splitTabData:i}),this.forceUpdate()},callBack:(t,e)=>{this.setState({splitTabIndex:e})},onRemove:this.state.splitTabData.length<4,onRemoveDisable:this.state.clickOffStatus,onRemoveOnClick:()=>{var t,e;let i=!1;if(null==(t=this.props.mobiledata)||t.push.content.map(((t,e)=>{var s,a,n,l,o,r;if(!0!==i)return 2!==(null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.deliveryType.deliveryTypeId)||"TEXT"!==(null==(n=this.props.mobiledata)?void 0:n.push.content[0].contentType)||!ss(t.url)&&void 0!==(null==t?void 0:t.url)&&null!==(null==t?void 0:t.url)?(i=Ad(2,t,this.state.splitContentError,e,this.props.appStore,null==(r=null==(o=null==(l=this.props.mobiledata)?void 0:l.push)?void 0:o.deliveryType)?void 0:r.deliveryTypeId),i?(this.setState({splitTabIndex:e}),!1):void 0):(i=!0,this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1)})),!i&&this.state.splitTabData.length<4){let t=this.state.splitTabData.length;t="A".charCodeAt(0)+t;let i={id:t,text:"Split "+String.fromCharCode(t)},s=[...this.state.splitTabData];s.push(i),this.setState({splitTabData:s});let a=[...null==(e=this.props.mobiledata)?void 0:e.push.content];a.push(this.createSplitObject(String.fromCharCode(t))),a.map((t=>{t.recipientsPercentage=Math.floor(20/a.length),t.matchedAuidence=Math.floor(this.state.totalAuidence*t.recipientsPercentage/100),t.totalAuidence=this.state.totalAuidence})),this.props.mobiledata.push.content=a;let n=[...this.state.splitContentError];n.push(this.createSplitError()),this.setState({splitContentError:n,splitTabIndex:s.length-1})}}}),this.renderComponents(this.state.splitTabIndex)]}):null,4===(null==(Pe=null==(Me=null==(Be=this.props.mobiledata)?void 0:Be.push)?void 0:Me.pushLayout)?void 0:Pe.pushLayoutId)&&(null==(Fe=this.props.mobiledata)?void 0:Fe.push.isCarousel)&&Ti.jsxs("div",{className:"split-container-del-mobile",children:[Ti.jsx(Pi,{defaultSelectedItem:this.state.carouselTabIndex,defaultClass:"",carouselTab:!0,dynamicTab:"",activeClass:"active",tabData:this.state.carouselTabData,onDelete:!0!==(null==(Ue=this.props)?void 0:Ue.editClickOff),type:"split",mainClass:"",deleteTabData:t=>{var e;let i=[...this.state.carouselTabData];i.splice(t,1);let s=[...null==(e=this.props.mobiledata)?void 0:e.push.content];s.splice(t,1),this.props.mobiledata.push.content=s;let a=[...this.state.carouselContentError];a.splice(t,1),this.setState({carouselTabData:i,carouselContentError:a}),this.forceUpdate()},callBack:(t,e)=>{this.setState({carouselTabIndex:e})},onRemove:4!==this.state.carouselTabData.length,onRemoveDisable:this.state.clickOffStatus,onRemoveOnClick:()=>{var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k;let D=!0;if(null==(t=this.props.mobiledata)||t.push.content.map(((t,e)=>{var i,s,a,n,l,o,r,c;if(!1!==D)return 2!==(null==(a=null==(s=null==(i=this.props.mobiledata)?void 0:i.push)?void 0:s.deliveryType)?void 0:a.deliveryTypeId)||"TEXT"!==(null==(l=null==(n=this.props.mobiledata)?void 0:n.push)?void 0:l.content[0].contentType)||!ss(t.url)&&void 0!==(null==t?void 0:t.url)&&null!==(null==t?void 0:t.url)?(!0===Ad(2,t,this.state.carouselContentError,e,this.props.smartAppStore,null==(c=null==(r=null==(o=this.props.mobiledata)?void 0:o.push)?void 0:r.deliveryType)?void 0:c.deliveryTypeId)&&(D=!1),D?void 0:(this.setState({carouselTabIndex:e}),!1)):(D=!1,this.setState({smartlinkErrorMessage:"Attach the image",imgShowPopUp:!0}),!1)})),D&&this.state.carouselTabData.length<4){let t=this.state.carouselTabData.length,D="";2===t?D="C":3===t&&(D="D"),t="A".charCodeAt(0)+t;let A={id:t,text:"Carousel "+D},w=[...this.state.carouselTabData];w.push(A),this.setState({carouselTabData:w});let N=[...null==(e=this.props.mobiledata)?void 0:e.push.content];N.push(this.createSplitObject(String.fromCharCode(t))),N[N.length-1].hashTag=null==(i=this.props.mobiledata)?void 0:i.push.content[0].hashTag,N[N.length-1].isExpiryButtonEnabled=null==(s=this.props.mobiledata)?void 0:s.push.content[0].isExpiryButtonEnabled,N[N.length-1].isAlertSound=null==(a=this.props.mobiledata)?void 0:a.push.content[0].isAlertSound,N[N.length-1].alertSound=null==(n=this.props.mobiledata)?void 0:n.push.content[0].alertSound,N[N.length-1].pushExpiryhours=null==(l=this.props.mobiledata)?void 0:l.push.content[0].pushExpiryhours,N[N.length-1].pushexpirySchedule=null==(o=this.props.mobiledata)?void 0:o.push.content[0].pushexpirySchedule,N[N.length-1].scheduleDate=null==(r=this.props.mobiledata)?void 0:r.push.content[0].localScheduleTime,N[N.length-1].schedule=null==(c=this.props.mobiledata)?void 0:c.push.content[0].schedule,N[N.length-1].timezone=null==(d=this.props.mobiledata)?void 0:d.push.content[0].timezone,N[N.length-1].timezoneId=null==(p=this.props.mobiledata)?void 0:p.push.content[0].timezoneId,N[N.length-1].mobTimerTTL=(null==(m=null==(u=null==(h=this.props.mobiledata)?void 0:h.push)?void 0:u.content[0])?void 0:m.mobTimerTTL)||"",N[N.length-1].offerString=(null==(g=null==(y=null==(v=this.props.mobiledata)?void 0:v.push)?void 0:y.content[0])?void 0:g.offerString)||"",N[N.length-1].mobTimerTTLLocalTime=(null==(x=null==(f=null==(b=this.props.mobiledata)?void 0:b.push)?void 0:f.content[0])?void 0:x.mobTimerTTLLocalTime)||"",N[N.length-1].mobTimerTextColor=(null==(j=null==(C=null==(S=this.props.mobiledata)?void 0:S.push)?void 0:C.content[0])?void 0:j.mobTimerTextColor)||"",N[N.length-1].mobTimerBgColor=(null==(k=null==(I=null==(T=this.props.mobiledata)?void 0:T.push)?void 0:I.content[0])?void 0:k.mobTimerBgColor)||"",this.props.mobiledata.push.content=N;let L=[...this.state.carouselContentError];L.push(this.createSplitError()),this.setState({carouselContentError:L,carouselTabIndex:w.length-1})}}}),this.renderComponents(this.state.carouselTabIndex)]})]}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),Ti.jsx(zs,{className:`${this.state.clickOffStatus&&"click-off"}`,onClick:()=>{if(!0!==es())if(this.setState({saveButtonClicked:!0}),JSON.stringify(this.props.mobiledata),this.state.clickOffStatus)this.props.history.push("/campaign");else{let t=this.validation();if(void 0===t||t){let t=this.getParams();t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.mobilePushAddorUpdate(!0,t)}}else this.props.history.push("/campaign")},children:"Save"}),Ti.jsx(ns,{onClick:()=>{if(this.state.clickOffStatus||!0===es())this.props.moveNext(2);else{let t=this.validation();if(void 0===t||t){let t=this.getParams();t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,!0===this.props.mobiledata.push.isRequestForApproval?(t.objectRequestApproval=this.props.mobiledata.push.objectRequestApproval,t.isSendTestPush=1,t.isRequestForApproval=!0,this.mobilePushAddorUpdate(!1,t,!0,!1,!0)):this.mobilePushAddorUpdate(!1,t,!0,!1,!1)}}},children:"Next"})]}),this.state.notificationErrSchedule&&Ti.jsx(kl,{headerTitle:"Confirmation",para:this.state.scheduleErrMsg,secondaryButtonText:"Cancel",primaryButtonText:"OK",size:"lg",buttonClicked:t=>{var e,i,s,a,n;if(this.setState({notificationErrSchedule:!1}),(null==(i=null==(e=this.props.mobiledata)?void 0:e.push)?void 0:i.content.filter((t=>""===t.scheduleDate))).length===(null==(n=null==(a=null==(s=this.props.mobiledata)?void 0:s.push)?void 0:a.content)?void 0:n.length)&&t){let t=this.getParams();t.content[0].localScheduleTime="",t.appId=this.props.smartLinkData.mobilePlatform[0].appName.appGuid,t.mpId=this.props.smartLinkData.mobilePlatform[0].appName.mpId,t.appName=this.props.smartLinkData.mobilePlatform[0].appName.appName,this.mobilePushAddorUpdate(!1,t,!0,!1,!1)}}}),this.state.rfaSchedule&&Ti.jsx(kl,{headerTitle:"Confirmation",para:"Schedule time is required",secondaryButtonText:"Cancel",primaryButtonText:"OK",size:"lg",buttonClicked:t=>{this.setState({rfaSchedule:!1})}}),this.state.isOpenSplitResetModal?Ti.jsx(kl,{para:"Are you sure you want to reset it?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{t&&(this.props.mobiledata.push.content=[this.createSplitObject("A")],this.props.mobiledata.push.isSplit=!1,this.setState({isSplit:!this.state.isSplit})),this.setState({isOpenSplitResetModal:!this.state.isOpenSplitResetModal})}}):null,this.state.isOpenCarouselResetModal?Ti.jsx(kl,{para:"Are you sure you want to reset it?",pClass:"text-center mb0",secondaryButtonText:"Cancel",primaryButtonText:"OK",buttonClicked:t=>{t?(this.props.mobiledata.push.content=[this.createSplitObject("A")],this.props.mobiledata.push.isCarousel=!1,this.props.mobiledata.push.position={positionValue:"-- Select position --",positionId:0}):this.props.mobiledata.push.pushLayout={pushLayoutValue:"Carousel",pushLayoutId:4},this.setState({isOpenCarouselResetModal:!this.state.isOpenCarouselResetModal})}}):null]}):""," "]})}}ji(Ed,"contextType",Ji);const Bd=wi(Ed);let Md=[{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},{deliveryTypeValue:"Alert / Rich push",deliveryTypeId:1},{deliveryTypeValue:"In-app messaging",deliveryTypeId:2},{deliveryTypeValue:"In-app inbox",deliveryTypeId:4},{deliveryTypeValue:"In-page content",deliveryTypeId:5}];const Pd="/assets/png/webAppEvent-5ae701c8.png";var Fd;class Ud extends Di.Component{constructor(t){super(t),ji(this,"state",{formName:"",platformName:"",formpageUrl:"",authCode:"",showAuthCode:!1,currentActivity:"",currentImg:null,imageData:null,clientData:null,controlsArray:[],selectElement:null,elementArray:[],screenTracking:{minDuration:"",screenTrackCond:"And",minLength:""},errScreenTracking:{errMinDuration:null,errMinLength:null},event:{eventName:"",eventType:"",eventDescription:""},errEvent:{errEventName:null,errEventType:null,errEventDescription:null},selectControls:[],markAsGoal:!1,deviceInformation:null,editModeOn:!1,editIndex:0,cprop:null,cValue:null,showColorPicker:!1}),ji(this,"selfClose",!1),ji(this,"getFieldTrackData",(()=>{var t,e,i,s,a,n,l="iOS";null==(t=this.props.fieldTrackData)||t.appId;var o="iPhone";(null==(i=null==(e=this.props.fieldTrackData)?void 0:e.deviceType)?void 0:i.toLowerCase().includes("an"))&&(l="Android",o=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),no.parse(null==(n=null==(a=this.props.history)?void 0:a.location)?void 0:n.search);let r={campaignId:Ln(),deviceOs:l,deviceType:o,goalType:"P"};this.getDataFromServer(r)})),ji(this,"getDataFromServer",(t=>{os({path:Wn,params:t,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,s,a;(null==t?void 0:t.status)&&(null==(i=null==(e=null==t?void 0:t.data)?void 0:e.capturedFields)?void 0:i.length)>0&&(null==(a=null==(s=null==t?void 0:t.data)?void 0:s.capturedFields)||a.map((t=>{var e,i;let s=JSON.parse(t.formFieldsToCapture),a=s.imageData;null!=a&&this.setState({currentImg:a.imageData,imageData:a});let n=null==(e=s.fieldsInfo)?void 0:e.pageContent.controls;if(null!=n){this.setState({showAuthCode:!1,clientData:n,controlsArray:n});let t=null==(i=null==s?void 0:s.fieldsInfo)?void 0:i.fieldCaptureList,e=[],a={minDuration:"",screenTrackCond:"And",minLength:""},l={};t.length>0&&t.map((t=>{a.minDuration=t.minDuration,a.screenTrackCond=null==t?void 0:t.screenfilter,a.minLength=t.minLength,l={eventName:t.eventName,eventType:t.captureType,eventDescription:t.description,markAsGoal:t.markAsGoal,trackingType:t.captureType},t.screenName,t.viewType;let i={field:t,screenTracking:a,eventTracking:l};e.push(i)})),!0===(null==l?void 0:l.markAsGoal)&&this.setState({markAsGoal:!0}),this.setState({elementArray:e,screenTracking:a})}})))},fail:t=>{}})})),ji(this,"socketInit",(()=>{var t,e,i,s,a={userName:"Browser"},n="iOS",l=null==(t=this.props.fieldTrackData)?void 0:t.appId,o="iPhone";(null==(i=null==(e=this.props.fieldTrackData)?void 0:e.deviceType)?void 0:i.toLowerCase().includes("an"))&&(n="Android",o=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),a.appId=String(n+o+l).replace(/ /g,""),Fd=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0}),JSON.stringify(a),Fd.on("connect",(()=>{Fd.emit("receiver-handshake-request",a)})),Fd.on("receiver-handshake-response",(t=>{})),Fd.on("client-handshake-response",(t=>{})),Fd.on("client-handshake-request",(t=>{})),Fd.on("client-information",(t=>{})),Fd.on("disconnect",(t=>{})),Fd.on("message-client-disconnect",(t=>{})),Fd.on("message-from-client-image",(t=>{if(this.state.elementArray.length>0)return;Fd.off("show-auth-code"),this.setState({showAuthCode:!1});let e=JSON.parse(t);this.setState({currentActivity:e.screenName,currentImg:e.imageData,imageData:e}),this.state.currentActivity!==e.screenName&&this.setState({currentActivity:e.screenName,currentImg:e.imageData,imageData:e})})),Fd.on("message-from-client-data",(t=>{Fd.off("show-auth-code");let e=JSON.parse(t),i=JSON.parse(e.controls);this.state.selectControls.map((t=>{i.map((e=>{t.viewId===e.viewId&&(e.click=!0,e.select=(null==t?void 0:t.select)||!1)}))})),i.map((t=>{var e;let i=[];(null==(e=t.subviews)?void 0:e.length)>0&&JSON.parse(t.subviews).length>0&&(i=JSON.parse(t.subviews)),t.subviews=i})),this.setState({showAuthCode:!1,clientData:e,controlsArray:i})})),Fd.on("show-auth-code",(t=>{let e=JSON.parse(t);this.setState({authCode:e.oAuthCode,showAuthCode:!1,deviceInformation:e}),Fd.off("show-auth-code")})),Fd.on("client-auth-code",(t=>{let e=JSON.parse(t);this.setState({authCode:e.oAuthCode,showAuthCode:!0});var i=new Object;i.appId=String(n+o+l).replace(/ /g,"");var s=JSON.stringify(i);Fd.emit("marketer-acceptance-message",s),setTimeout((()=>{this.setState({authCode:"",showAuthCode:!1})}),12e4)}))})),ji(this,"webSocketInit",(()=>{var t,e;let i=localStorage.getItem("fdomain")||"",s=new URL(i),a=(null==s?void 0:s.origin)||"";const n=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let l=void 0!==n.cId?n.cId:0;(Fd=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0})).on("connect",(()=>{Fd.emit("new_user",{userName:"fieldtrack",domainName:a,appId:parseInt(l)})})),Fd.on("closed",(t=>{try{(void 0).close(),t.status}catch(e){}})),Fd.on("data_post",(t=>{var e,i,s;if(this.context.globalStateData.setIsLoadingData(!1),this.state.controlsArray.length>0)return;let a={imageData:null==(e=null==t?void 0:t.data)?void 0:e.PageScreenShot,width:(null==(i=t.data)?void 0:i.Width)||0,height:(null==(s=t.data)?void 0:s.Height)||0};this.setState({currentActivity:t.domainName,currentImg:a.imageData,imageData:a}),t.data.PageContentJson.map(((t,e)=>{t.id=e+1,t.viewId=e+1,t.isShow=!0,t.category=t.tagname})),this.setState({controlsArray:t.data.PageContentJson})})),Fd.on("data_receive",(t=>{var e,i,s,a;if(this.state.controlsArray.length>0)return;let n={imageData:(null==(e=null==t?void 0:t.data)?void 0:e.PageScreenShot)||(null==(i=null==t?void 0:t.data)?void 0:i.image),width:(null==(s=t.data)?void 0:s.Width)||0,height:(null==(a=t.data)?void 0:a.Height)||0};this.setState({currentActivity:t.domainName,currentImg:n.imageData,imageData:n}),t.data.PageContentJson.map(((t,e)=>{t.id=e+1,t.viewId=e+1,t.isShow=!0,t.category=t.tagname})),this.setState({controlsArray:t.data.PageContentJson})}))})),ji(this,"webSocketClosed",(()=>{var t,e;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let s=void 0!==i.cId?i.cId:0,a=localStorage.getItem("fdomain")||"";this.selfClose=!0,Fd&&(Fd.emit("close",{userName:"fieldtrack",domainName:a,appId:parseInt(s),status:!0}),Fd.emit("closed",{userName:"fieldtrack",domainName:a,appId:parseInt(s),status:!1}),Fd.emit("close",{userName:"fieldtrack",domainName:a,appId:parseInt(s),status:!1})),setTimeout((()=>{window.close()}),1e3)})),ji(this,"checkLocalStorage",(()=>{let t=Qo;if(null!==t&&this.setState({currentImg:t.imageData,imageData:t}),null!==Xo){let t=JSON.parse(Xo.controls);this.state.selectControls.map((e=>{t.map((t=>{e.viewId===t.viewId&&(t.click=!0,t.select=(null==e?void 0:e.select)||!1)}))})),0===this.state.controlsArray.length&&(t.map((t=>{var e;let i=[];(null==(e=t.subviews)?void 0:e.length)>0&&JSON.parse(t.subviews).length>0&&(i=JSON.parse(t.subviews)),t.subviews=i})),this.setState({showAuthCode:!1,clientData:Xo,controlsArray:t}))}})),ji(this,"createField",(t=>t.map(((t,e)=>this.createSingleWebField(t,e))))),ji(this,"createSingleMobileField",((t,e,i=!1)=>{var s,a,n=t.top+t.translationY-t.scrollY,l=t.left+t.translationX-t.scrollX,o=t.width,r=t.height,c="array"+t.id;if(null!==document.getElementById(c)){var d=document.getElementById(c);d.setAttribute("data-viewId",t.viewId),d.setAttribute("data-viewType",t.viewType)}return Ti.jsx("div",{className:`C ${!0===t.isShow&&"fieldTracking"} ${null==t?void 0:t.viewId} ${!0===(null==t?void 0:t.click)&&"fieldTrackingClick"} ${!0===(null==t?void 0:t.select)&&"fieldTrackingSelect"}`,id:t.id,data:t,style:{position:"absolute",top:n,left:l,width:o,height:r},onClick:e=>{if(!0===t.select)return;let i=[...this.state.controlsArray],s=e.target,a=null;i.map((t=>{t.click=!1}));let n=i.filter((t=>String(t.id)===s.id));if(!1===n[0].isShow)return;n[0].click=!0,a=n[0];let l=[...this.state.selectControls];l=l.filter((t=>!0===t.select)),l.push(n[0]),l=l.filter(((t,e,i)=>e===i.findIndex((e=>e.viewId===t.viewId&&e.viewId===t.viewId)))),this.setState({selectControls:l,controlsArray:i,selectElement:a,event:{eventName:"",eventType:"",eventDescription:""}}),window.scrollTo(0,0),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:0,behavior:"smooth"}),document.querySelector(".modal-body").scrollTo({top:0,behavior:"smooth"})},children:!1===t.isShow&&(null==(s=t.subviews)?void 0:s.length)>0&&(null==(a=null==t?void 0:t.subviews)?void 0:a.map((t=>{let e=this.state.controlsArray.filter((e=>e.id.toString()===t.toString()));return e.length>0?e.map(((t,e)=>this.createSingleMobileField(t,e,i))):Ti.jsx("div",{id:`array${t.toString()}`,viewId:t.toString()})})))})})),ji(this,"createSingleWebField",((t,e)=>{var i,s=t.top,a=t.left,n=t.width,l=t.height,o="array"+e;if(null!==document.getElementById(o)){var r=document.getElementById(o);r.setAttribute("data-viewId",t.viewId),r.setAttribute("data-viewType",t.viewType)}return Ti.jsx("div",{className:`C ${!0===t.isShow&&"fieldTracking"} ${null==t?void 0:t.viewId} ${!0===(null==t?void 0:t.click)&&"fieldTrackingClick"} ${!0===(null==t?void 0:t.select)&&"fieldTrackingSelect"}`,id:t.id,style:{position:"absolute",top:s,left:a,width:n,height:l},onClick:e=>{if(!0===(null==t?void 0:t.select))return;let i=[...this.state.controlsArray],s=e.target,a=null;i.map((t=>{t.click=!1}));let n=i.filter((t=>String(t.id)===s.id));n[0].click=!0,a=n[0];let l=[...this.state.selectControls];l=l.filter((t=>!0===t.select)),l.push(n[0]),l=l.filter(((t,e,i)=>e===i.findIndex((e=>e.viewId===t.viewId&&e.viewId===t.viewId)))),this.setState({selectControls:l,controlsArray:i,selectElement:a,event:{eventName:"",eventType:"",eventDescription:""}}),window.scrollTo(0,0),document.querySelector(".field-tracking-cost-wrapper").scrollTo({top:0,behavior:"smooth"}),document.querySelector(".modal-body").scrollTo({top:0,behavior:"smooth"})},children:(null==(i=t.subviews)?void 0:i.length)>0&&JSON.parse(t.subviews).length>0&&JSON.parse(t.subviews).map((t=>{let e=this.state.controlsArray.filter((e=>e.id.toString()===t.toString()));return e.length>0?e.map(((t,e)=>this.createSingleWebField(t,t.id))):Ti.jsx("div",{id:`array${t.toString()}`,viewId:t.toString()})}))})})),ji(this,"createWebField",(t=>t.map(((t,e)=>this.createSingleWebField(t,e))))),ji(this,"validateEvents",(()=>{var t;if(ss(null==(t=this.state.cprop)?void 0:t.name)){let t={...this.state.errEvent};return t.errEventName="Enter event name",this.setState({errEvent:t}),!1}if(ss(this.state.cValue)){let t={...this.state.errEvent};return t.eventType="Select Event",this.setState({errEvent:t}),!1}return!0})),ji(this,"addBtnClick",(t=>{var e;if(5===this.state.elementArray.length){let t={...this.state.errEvent};return t.errEventName="Can not add more than 5 elements",this.setState({errEvent:t}),void setTimeout((()=>{let t={...this.state.errEvent};t.errEventName=null,this.setState({errEvent:t})}),2e3)}if(this.validateEvents()){const t=no.parse(null==(e=window.location)?void 0:e.search);null==t||t.webft;let i=[...this.state.controlsArray],s={};i.map((t=>{t.viewId===this.state.selectElement.viewId&&(t.select=!0,s=t)}));let a=[...this.state.selectControls];a.map((t=>{t.viewId===this.state.selectElement.viewId&&(t.select=!0,t.click=!0,s=t)}));let n=[...this.state.elementArray];if(!0===this.state.editModeOn){let t=n.filter((t=>{var e;return(null==(e=null==t?void 0:t.field)?void 0:e.viewId)===s.viewId}));(null==t?void 0:t.length)>0&&(t[0].name=this.state.cprop.name,t[0].value=this.state.cValue)}else{let t={name:this.state.cprop.name,value:this.state.cValue,field:s};n.push(t)}this.setState({selectControls:a,elementArray:n,selectElement:null,cprop:null,cValue:null,showColorPicker:!1,editModeOn:!1})}})),ji(this,"editField",(t=>{let e=[...this.state.elementArray];e[this.state.editIndex].eventTracking.eventName=t.eventName,e[this.state.editIndex].eventTracking.eventDescription=t.eventDescription,e[this.state.editIndex].eventTracking.selectInputType=t.selectInputType,e[this.state.editIndex].eventTracking.trackingType=t.trackingType,e[this.state.editIndex].eventTracking.markAsGoal=t.markAsGoal,e[this.state.editIndex].eventTracking.friendlyName=t.friendlyName,e[this.state.editIndex].eventTracking.mandadory=t.mandadory,this.setState({elementArray:e})})),ji(this,"getDeviceType",(t=>{switch(t){case"Android phone":return Ti.jsx("div",{className:"andriod-wrapper",children:Ti.jsxs("div",{class:"andriod-mobile",children:[Ti.jsx("div",{class:"inner"}),Ti.jsx("div",{class:"overflow",children:Ti.jsx("div",{class:"shadow"})}),Ti.jsx("div",{class:"speaker"}),Ti.jsx("div",{class:"sensors"}),Ti.jsx("div",{class:"more-sensors"}),Ti.jsx("div",{class:"camera"})]})});case"iPhone":return Ti.jsxs("div",{class:"iphone-mobile",children:[Ti.jsx("div",{class:"top-bar"}),Ti.jsx("div",{class:"camera"}),Ti.jsx("div",{class:"sensor"}),Ti.jsx("div",{class:"speaker"}),Ti.jsx("div",{class:"screen"}),Ti.jsx("div",{class:"home"}),Ti.jsx("div",{class:"bottom-bar"})]})}})),ji(this,"fieldTrackingSaveSuccess",(()=>{var t,e,i;const s=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let a=void 0!==s.cId?s.cId:0;var n=window.location.protocol+"//"+window.location.host+window.location.pathname+"?cId="+a;if(window.history.pushState({path:n},"",n),this.props.isWebFieldTrack){if(this.props.isEdit){const t=new CustomEvent("ftracksuccess",{detail:{message:"Hello from custom event!"}});return window.dispatchEvent(t),void this.props.saveBtnClicked()}let t=localStorage.getItem("fdomain")||"";this.selfClose=!0,Fd&&(Fd.emit("close",{userName:"fieldtrack",domainName:t,appId:parseInt(a),status:!0}),Fd.emit("closed",{userName:"fieldtrack",domainName:t,appId:parseInt(a),status:!1}),Fd.emit("close",{userName:"fieldtrack",domainName:t,appId:parseInt(a),status:!1})),setTimeout((()=>{window.close()}),3e3);const e=new CustomEvent("ftracksuccess",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(e)}"add"===(null==(i=this.props.fieldTrackData)?void 0:i.mode)&&this.disconnectSocket(),this.props.saveBtnClicked()})),ji(this,"saveMobileFieldTracking",(()=>{let t={campaignId:Ln(),contentData:this.state},e={},i="contentData_"+Ln();null!==localStorage.getItem(i)&&void 0!==localStorage.getItem(i)&&(e=JSON.parse(localStorage.getItem(i))),e.contentData=this.state,localStorage.setItem(i,JSON.stringify(e)),localStorage.setItem("contentInjData",JSON.stringify(t)),this.fieldTrackingSaveSuccess()})),ji(this,"AddMobileEvents",(()=>Ti.jsxs(Jl,{children:[Ti.jsxs("div",{className:"align-items-center d-flex mb10",children:[Ti.jsx("i",{className:"icon-rs-events-medium icons-md color-primary-blue"}),Ti.jsx("h4",{className:"mb-0 ml10",children:"Events"})]}),this.state.elementArray.length>0&&this.state.elementArray.map(((t,e)=>Ti.jsxs("div",{className:"event-tracking-list",children:[Ti.jsxs("div",{className:"event-actions mr10",children:[Ti.jsx("span",{children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{let i=this.state.controlsArray.filter((e=>e.viewId===t.field.viewId));i.length>0&&(i[0].injname=t.name,i[0].injvalue=t.value,this.setState({cprop:{name:t.name,value:t.value},cValue:t.value,showColorPicker:!1,selectElement:i[0],editModeOn:!0,editIndex:e}),this.setState({selectElement:i[0],editModeOn:!0,editIndex:e}))}})}),Ti.jsx("span",{children:Ti.jsx("i",{className:"color-primary-blue cursor-pointer icon-rs-delete-medium icons-md",onClick:()=>{let e=[...this.state.elementArray];const i=e.indexOf(t);i>-1&&e.splice(i,1);let s=[...this.state.controlsArray];s.map((e=>{e.viewId===t.field.viewId&&(e.select=!1,e.click=!1)}));let a=[...this.state.selectControls];a.map((e=>{e.viewId===t.field.viewId&&(e.select=!1,e.click=!1)})),this.setState({elementArray:e,selectControls:a,controlsArray:s})}})})]}),Ti.jsxs("div",{className:"event-section",children:[Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Name:"}),Ti.jsx("span",{className:"label-value truncate",children:t.name})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Value:"}),Ti.jsx("span",{className:"label-value truncate",children:t.value})]})]})]})))]}))),ji(this,"disconnectSocket",(()=>{var t,e,i,s,a={},n="iOS",l=null==(t=this.props.fieldTrackData)?void 0:t.appId,o="iPhone";(null==(i=null==(e=this.props.fieldTrackData)?void 0:e.deviceType)?void 0:i.toLowerCase().includes("an"))&&(n="Android",o=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),a.appId=String(n+o+l).replace(/ /g,""),null==Fd||Fd.emit("disconnect-receiver",JSON.stringify(a)),null==Fd||Fd.off("receiver-handshake-response"),null==Fd||Fd.off("client-information"),null==Fd||Fd.off("message-from-client-image"),null==Fd||Fd.off("message-from-client-data"),null==Fd||Fd.off("receiver-handshake-response"),null==Fd||Fd.off("show-auth-code"),null==Fd||Fd.disconnect()})),ji(this,"marketerAcceptance",(()=>{var t,e,i,s;this.setState({deviceInformation:null,showAuthCode:!0});var a=new Object,n="iOS",l=null==(t=this.props.fieldTrackData)?void 0:t.appId,o="iPhone";(null==(i=null==(e=this.props.fieldTrackData)?void 0:e.deviceType)?void 0:i.toLowerCase().includes("an"))&&(n="Android",o=null==(s=this.props.fieldTrackData)?void 0:s.deviceType),a.appId=String(n+o+l).replace(/ /g,"");var r=JSON.stringify(a);Fd.emit("marketer-acceptance-message",r),setTimeout((()=>{this.setState({authCode:"",showAuthCode:!1})}),12e4)})),ji(this,"handleClickOutside",(t=>{this.colorPickerRef.current&&!this.colorPickerRef.current.contains(t.target)&&this.setState({isShow:!1})})),ji(this,"ColorPickerComponent",(()=>Ti.jsx("div",{ref:this.colorPickerRef,children:Ti.jsx(Oo,{anchor:this.fontcoloranochor,show:this.state.showColorPicker,selectColor:"",cancelBtnClicked:()=>{this.setState({showColorPicker:!1})},applyBtnClicked:t=>{var e=t.split("("),i=parseInt(e[1].split(",")[0]),s=parseInt(e[1].split(",")[1]),a=parseInt(e[1].split(",")[2]),n=Pa(i,s,a);this.setState({titleColor:n,cValue:n}),this.setState({showColorPicker:!1})}})}))),ji(this,"TextInputComponent",(()=>{var t,e,i,s;return Ti.jsxs(Jl,{children:[!0===this.state.showColorPicker&&Ti.jsx(this.ColorPickerComponent,{}),Ti.jsx(Zl,{md:"color"===(null==(t=this.state.cprop)?void 0:t.type)?11:12,children:Ti.jsx(ql,{required:!0,label:null==(e=this.state.cprop)?void 0:e.name,placeholder:`Enter ${null==(i=this.state.cprop)?void 0:i.name}`,val:this.state.cValue,onChange:t=>{this.setState({cValue:t.target.value})},onBlur:t=>{this.setState({cValue:t.target.value})}})}),"color"===(null==(s=this.state.cprop)?void 0:s.type)&&Ti.jsx(Zl,{md:1,children:Ti.jsx(ws,{text:"Color",position:"top",children:Ti.jsx("i",{className:"icon-rs-colorpicker-bg-medium color-primary-blue icons-md cp",ref:this.colorPickerRef,onClick:()=>this.setState({showColorPicker:!0})})})})]})})),ji(this,"ContentInjComponent",(()=>{var t,e,i,s,a,n;return Ti.jsxs("div",{className:null===this.state.selectElement?"click-off":"click-on",children:[Ti.jsx("label",{children:"Content injection"}),Ti.jsxs("div",{className:null===this.state.selectElement?"click-off":"click-on",children:[Ti.jsx($l,{className:"mt10",children:Ti.jsx(ql,{required:!0,placeholder:"Element type",disabled:!0,val:null==(t=this.state.selectElement)?void 0:t.category,onChange:t=>{}})}),Ti.jsx($l,{className:"mt10",children:Ti.jsx(Ul,{required:!0,label:"Properties",data:this.getHtmlStyleProps(null==(i=null==(e=this.state)?void 0:e.selectElement)?void 0:i.category),textField:"name",dataItemKey:"name",value:""!==this.state.cprop?this.state.cprop:"Select",onChange:t=>{this.setState({cprop:t.target.value})}})}),(null==(a=null==(s=this.state.cprop)?void 0:s.name)?void 0:a.length)>0&&Ti.jsx($l,{className:"mt10",children:Ti.jsx(this.TextInputComponent,{})})]}),Ti.jsxs("div",{className:"",children:[Ti.jsx(as,{onClick:()=>{this.setState({cprop:null,cValue:null,showColorPicker:!1,editModeOn:!1})},children:"Cancel"}),Ti.jsx(ns,{onClick:()=>this.addBtnClick(),children:!0===(null==(n=this.props)?void 0:n.editModeOn)?"Update":"Add"})]})]})})),this.colorPickerRef=Ni.createRef(),this.fontcoloranochor=Ni.createRef()}componentDidMount(){var t,e;if(this.contentRef=Ni.createRef(),!0===this.props.isWebFieldTrack)if(this.props.isEdit){let t={campaignId:Ln(),deviceOs:"",deviceType:"Web",goalType:"P"};this.getDataFromServer(t)}else this.context.globalStateData.setIsLoadingData(!0),this.webSocketInit();else"add"===(null==(t=this.props.fieldTrackData)?void 0:t.mode)?this.socketInit():"edit"===(null==(e=this.props.fieldTrackData)?void 0:e.mode)&&this.getFieldTrackData();window.addEventListener("socketClosed",(()=>{this.disconnectSocket()})),window.addEventListener("webclosed",(()=>{this.webSocketClosed()})),document.addEventListener("mousedown",this.handleClickOutside)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)}getHtmlStyleProps(t){if(null==t)return[];const e=[{name:"Color",type:"color"},{name:"Background Color",type:"color"},{name:"Font Size",type:"text"},{name:"Font Family",type:"text"},{name:"Margin",type:"text"},{name:"Padding",type:"text"}],i=[{name:"Placeholder",type:"text"},{name:"Text Color",type:"color"},{name:"Border",type:"text"},{name:"Width",type:"text"},{name:"Height",type:"text"}],s=[{name:"Text Color",type:"color"},{name:"Background Color",type:"color"},{name:"Border",type:"text"},{name:"Width",type:"text"},{name:"Height",type:"text"}],a=[{name:"Checked Color",type:"color"},{name:"Unchecked Color",type:"color"},{name:"Border",type:"text"},{name:"Width",type:"text"},{name:"Height",type:"text"}],n=[{name:"Src",type:"text"},{name:"Alt",type:"text"},{name:"width",type:"text"},{name:"Loading",type:"text"},{name:"Height",type:"text"}];switch(t.toLowerCase()){case"input":return[...e,...i];case"a":return[...e,...s];case"checkbox":return[...e,...a];case"img":return[...e,...n];default:return e}}render(){var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U;return Ti.jsxs("div",{ref:this.contentRef,className:"field-content-injection",children:[null!==this.state.deviceInformation&&Ti.jsx(kl,{headerTitle:"Confirmation",para:"Device is : "+this.state.deviceInformation.deviceModel,primaryButtonText:"Accept",secondaryButtonText:"Reject",buttonClicked:t=>{!0===t?this.marketerAcceptance():(this.disconnectSocket(),this.socketInit())}}),!0===this.state.showAuthCode&&Ti.jsx(kl,{headerTitle:"One-time password",otp:this.state.authCode,otpClass:"bg-tertiary-blue color-primary-blue",buttonClicked:t=>{this.setState({authCode:"",showAuthCode:!1})}}),Ti.jsx("div",{className:"",children:Ti.jsxs(Jl,{className:"field-tracking-container mobile-field",style:{height:this.props.isWebFieldTrack?"100%":(null==(e=null==(t=this.state)?void 0:t.imageData)?void 0:e.width)>0?580:500},children:[Ti.jsx(Zl,{className:!0===this.state.editModeOn?"click-off":"on",md:(this.props.isWebFieldTrack,8),children:Ti.jsx("div",{className:"field-tracking-content-wrapper d-flex align-items-center "+(!1===this.props.isWebFieldTrack&&null!==this.state.imageData?"justify-content-center":""),children:null===this.state.imageData&&!1===this.props.isWebFieldTrack?Ti.jsx("div",{className:"text-center",children:Ti.jsxs(Jl,{children:[Ti.jsxs("h3",{className:"mb15 font-medium blue",children:[this.props.fieldTrackData.deviceType," app event tracking setup"]}),Ti.jsx("img",{className:"mb15 mobile-flip",src:mo}),Ti.jsx("h3",{className:"mb15 font-medium blue",children:"Establishing connection"}),Ti.jsxs("h4",{className:"mb15",children:["Open ",Ti.jsx("span",{children:Ti.jsx("strong",{children:this.props.fieldTrackData.appName})})," app and flip your mobile phone 6 times as shown above"]}),Ti.jsx("small",{children:"Note - The connection will not be established if the SDK is missing/broken in the mobile app"})]})}):Ti.jsx("div",{className:"mb25",children:!0===this.props.isWebFieldTrack?Ti.jsxs(Ti.Fragment,{children:[!1===this.props.isWebFieldTrack&&Ti.jsxs("h3",{className:"mb15 font-medium color-primary-blue text-center",style:{position:"absolute",top:0,width:"100%"},children:[!0===this.props.isWebFieldTrack?"Web":(null==(s=null==(i=this.props)?void 0:i.fieldTrackData)?void 0:s.deviceType)+" app"," event tracking setup"]}),Ti.jsx("div",{className:"css-scrollbar",style:{height:"calc(100% - 20px)",position:"absolute",width:"100%",top:0,paddingRight:25},children:null==this.state.imageData?Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{class:"Load-container_head",children:Ti.jsx("div",{class:"Load-spinnerData"})})}):Ti.jsx("div",{className:"P mx-auto",style:{width:"100%",height:(null==(n=null==(a=this.state)?void 0:a.imageData)?void 0:n.height)||0,backgroundImage:`url(${null==(o=null==(l=this.state)?void 0:l.imageData)?void 0:o.imageData})`,backgroundSize:"cover",position:"relative",zoom:(this.props.isWebFieldTrack,.7)},children:(null==(r=this.state.controlsArray)?void 0:r.length)>0&&this.createWebField(this.state.controlsArray)})})]}):Ti.jsx("div",{className:"device-screen "+("iPhone"===(null==(c=this.props.fieldTrackData)?void 0:c.deviceType)?"iphone-container":"andriod-container"),style:{width:(null==(p=null==(d=this.state)?void 0:d.imageData)?void 0:p.width)+10||380},children:Ti.jsxs("div",{className:"iPhone"===(null==(h=this.props.fieldTrackData)?void 0:h.deviceType)?"iphone-wrapper":"",children:[this.getDeviceType(null==(u=this.props.fieldTrackData)?void 0:u.deviceType),Ti.jsx("div",{className:"device-image-render",style:{width:(null==(v=null==(m=this.state)?void 0:m.imageData)?void 0:v.width)+10||380,maxHeight:(null==(g=null==(y=this.state)?void 0:y.imageData)?void 0:g.height)||600},children:Ti.jsx("div",{className:"device-image-inner css-scrollbar",style:{width:(null==(f=null==(b=this.state)?void 0:b.imageData)?void 0:f.width)||380,maxHeight:(null==(S=null==(x=this.state)?void 0:x.imageData)?void 0:S.height)||600},children:Ti.jsx("div",{className:"P mx-auto",style:{width:(null==(j=null==(C=this.state)?void 0:C.imageData)?void 0:j.width)||0,height:(null==(I=null==(T=this.state)?void 0:T.imageData)?void 0:I.height)||0,backgroundImage:`url(${null==(D=null==(k=this.state)?void 0:k.imageData)?void 0:D.imageData})`},children:Ti.jsx("div",{style:{width:(null==(w=null==(A=this.state)?void 0:A.imageData)?void 0:w.width)||0,height:(null==(L=null==(N=this.state)?void 0:N.imageData)?void 0:L.height)||0,position:"relative"},children:(null==(E=this.state.controlsArray)?void 0:E.length)>0&&this.createSingleMobileField(this.state.controlsArray[0],null==(B=this.state.controlsArray[0])?void 0:B.id)})})})})]})})})})}),Ti.jsxs(Zl,{md:(this.props.isWebFieldTrack,4),children:[Ti.jsxs("div",{className:"field-tracking-cost-wrapper mb30 css-scrollbar",style:{top:0,right:0,height:this.props.isWebFieldTrack?"auto":(null==(P=null==(M=this.state)?void 0:M.imageData)?void 0:P.width)>0?550:570},children:[Ti.jsx(this.ContentInjComponent,{data:this.state.screenTracking,error:this.state.errScreenTracking,contentdata:this.state.elementArray,element:this.state.selectElement,onChange:t=>{this.setState({screenTracking:t});let e={...this.state.errScreenTracking};""!==t.minDuration&&(e.errMinDuration=null),""!==t.minLength&&(e.errMinLength=null),this.setState({errScreenTracking:e})},callback:t=>{this.state.editModeOn?(this.editField(t),this.setState({selectElement:null,editModeOn:!1})):this.setState({event:t},(()=>{this.addBtnClick(t.trackingType)}))}}),(null==(F=this.state.elementArray)?void 0:F.length)>0&&Ti.jsx("div",{className:!0===this.state.editModeOn?"click-off":"click-on",children:Ti.jsx(this.AddMobileEvents,{})})]}),Ti.jsxs("div",{className:"d-flex justify-content-end mb30 ",children:[Ti.jsx(as,{onClick:()=>{var t,e;"add"===(null==(t=this.props.fieldTrackData)?void 0:t.mode)&&this.disconnectSocket(),(null==(e=this.props)?void 0:e.isWebFieldTrack)&&this.webSocketClosed(),this.context.globalStateData.setIsLoadingData(!0),setTimeout((()=>{this.context.globalStateData.setIsLoadingData(!1),this.props.cancelBtnClicked()}),2e3)},children:"Cancel"}),Ti.jsx(ns,{className:(null==(U=this.state.elementArray)?void 0:U.length)>0?"":"click-off",onClick:()=>{if(!1===this.props.isForm){if(ss(this.state.screenTracking.minDuration)){let t={...this.state.errScreenTracking};return t.errMinDuration="Select min duration",void this.setState({errScreenTracking:t})}if(ss(this.state.screenTracking.minLength)){let t={...this.state.errScreenTracking};return t.minLength="Select min length",void this.setState({errScreenTracking:t})}}this.saveMobileFieldTracking()},children:"Save"})]})]})]})})]})}}ji(Ud,"contextType",Ji);const Rd=wi(Ud);var Od,qd=null;function Vd(){return{errorMessage:null,domainNameSuccess:null,isError:!0,isLoading:!1}}class zd extends Di.Component{constructor(){super(...arguments),ji(this,"state",{preferenceModule:null,goalType:null,webFieldTrackData:null,tickIcon:!1,smartUrls:"",saveError:!1,errMsg:null,conversationUrl:null!=this.props.smartlinkUrl?this.props.smartlinkUrl:"",errAnalyticsPlatform:null,errDomainName:null,errConversionAction:null,elementArray:[],WebFieldTrackData:[],WebFieldTrackData_conversion:[],isDomainAddBtnClicked:!1,isOpenEventModal:!1,analyticsList:Gd,selectAnalytics:{name:"SmartDX analytics",id:3,domainType:"SX"},domainList:[],selectWebDomain:{domainUrl:"-- Select web domain",domainId:"0"},selectConversation:{name:"-- Select conversation --",short:"A"},errConversionURL:Array(6).fill(null).map(Vd),isWebFieldTrack:!1,fieldTrackFullData:null,fieldTrackList:[],fieldTrackSuccess:!1,fieldTrackClose:!1,editButton:!1,savePreference:!1,getAddAccessData:!1,getUpdateAccessData:!1,getDeleteAccessData:!1}),ji(this,"componentDidUpdate",((t,e)=>{var i;if(Is("this.props.data rece",null==(i=this.props)?void 0:i.data),this.props!==t&&this.props.data!==t.data){let t=ms();this.setState({domainList:t.domainsList})}this.props!==t&&this.props.proceedBtnClick!==t.proceedBtnClick&&!0===this.props.proceedBtnClick&&(this.context.globalStateData.setIsLoadingData(!0),setTimeout((()=>{this.context.globalStateData.setIsLoadingData(!1)}),3e3))})),ji(this,"componentDidMount",(()=>{this.getDataFromServer(),this.getAccessData();let t=ms();if(this.setState({domainList:t.domainsList,isWebFieldTrack:this.props.isWebFieldTrack}),null!==this.props.data)if(void 0!==this.props.data.domainUrlList){let t=this.props.data.domainUrlList.map((t=>(t.conversionUrl=t.domainNameURL,t)));this.props.webAnalytics.conversionURLs=t,this.setState({selectAnalytics:Hd.filter((t=>3===t.id))[0]})}else{let t=[{conversionUrl:"https://"}];this.props.webAnalytics.conversionURLs=t,this.setState({selectAnalytics:Hd.filter((t=>3===t.id))[0]})}this.forceUpdate()})),ji(this,"getAccessData",(()=>{let t=!1,e=!1,i=!1;const s=Zi("Communications");1==(null==s?void 0:s.get_AddAccessData)&&(t=!0),e=1==(null==s?void 0:s.accessUpdateData),(null==s?void 0:s.accessDeleteData)&&(i=!0),this.setState({getAddAccessData:t,getUpdateAccessData:e,getDeleteAccessData:i})})),ji(this,"getFieldTrackData",((t,e)=>{var i,s;const a=no.parse(null==(s=null==(i=this.props.history)?void 0:i.location)?void 0:s.search);let n=void 0!==a.cId?a.cId:0;os({path:Wn,params:{campaignId:n,deviceOs:"",deviceType:"Web",goalType:"P"},ok:t=>{var i,s,a,n,l,o,r;if(t.status&&(null==(s=null==(i=null==t?void 0:t.data)?void 0:i.capturedFields)?void 0:s.length)>0){let i=JSON.parse(null==(a=null==t?void 0:t.data)?void 0:a.capturedFields[0].formFieldsToCapture);"Engagement"==this.state.goalType&&this.setState({WebFieldTrackData:null==(n=null==i?void 0:i.fieldsInfo)?void 0:n.fieldCaptureList}),"Conversion"==this.state.goalType&&this.setState({WebFieldTrackData_conversion:null==(l=null==i?void 0:i.fieldsInfo)?void 0:l.fieldCaptureList}),this.setState({fieldTrackList:(null==(o=null==i?void 0:i.fieldsInfo)?void 0:o.fieldCaptureList)||[],fieldTrackFullData:null==(r=null==t?void 0:t.data)?void 0:r.capturedFields}),e({status:!0})}else e({status:!1})},fail:t=>{e({status:!1})}})})),ji(this,"FieldTrackingCom",(t=>{var e,i;let s="",a="",n="",l="",o="";return null!==this.state.fieldTrackList&&void 0!==this.state.fieldTrackList&&this.state.fieldTrackList.length>0&&(null==(e=this.state.fieldTrackList)||e.map((t=>{n=null==t?void 0:t.minDuration,l=null==t?void 0:t.minLength,o=null==t?void 0:t.screenfilter,1==(null==t?void 0:t.markAsGoal)&&(a=null==t?void 0:t.eventName),s=s+t.eventName+","})),s=s.substring(0,s.length-1)),Ti.jsx(Ti.Fragment,{children:null!==this.state.fieldTrackList&&void 0!==this.state.fieldTrackList&&(null==(i=this.state.fieldTrackList)?void 0:i.length)>0&&Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"custom-column",children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{label:"Goal setup",right:!0})}),Ti.jsx(Zl,{md:6,children:Ti.jsx("div",{className:"event-tracking-list",children:Ti.jsxs("div",{className:"event-section",children:[Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Goal"}),Ti.jsx("span",{className:"label-value",children:a})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Screen"}),Ti.jsxs("span",{className:"label-value",children:[Ti.jsx("span",{className:"blue",children:"Min duration: "+n}),Ti.jsx("span",{children:" "+o.toUpperCase()}),Ti.jsx("span",{className:"blue",children:" Min length:"+l})," "]})]})]})})}),Ti.jsx(Zl,{children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue ml-30 cp paddingL10",onClick:()=>{this.setState({editButton:!0,isWebFieldTrack:!0})}})})]})})})})),ji(this,"FieldTrackingGrid",(t=>{const{goalType:e,fieldTrackList:i,WebFieldTrackData:s,WebFieldTrackData_conversion:a,preferenceModule:n}=this.state,l="Conversion"==e?a:s;let o="",r="",c="",d="",p="";return l&&l.length>0&&(l.map((t=>(c=null==t?void 0:t.minDuration,d=null==t?void 0:t.minLength,p=null==t?void 0:t.screenfilter,!0===(null==t?void 0:t.markAsGoal)&&(r=null==t?void 0:t.eventName),o+=`${t.eventName},`,null))),o=o.slice(0,-1)),Ti.jsx(Ti.Fragment,{children:l&&l.length>0&&n&&Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"custom-column",children:[Ti.jsx(Zl,{md:{span:4,offset:0},children:Ti.jsx(Ao,{label:"Goal setup",right:!0})}),Ti.jsx(Zl,{md:6,children:Ti.jsx("div",{className:"event-tracking-list",children:Ti.jsxs("div",{className:"event-section",children:[Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Goal"}),Ti.jsx("span",{className:"label-value",children:r})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Screen"}),Ti.jsxs("span",{className:"label-value",children:[Ti.jsx("span",{className:"blue",children:"Min duration: "+c}),Ti.jsx("span",{children:" "+p.toUpperCase()}),Ti.jsx("span",{className:"blue",children:" Min length:"+d})]})]})]})})}),Ti.jsx(Zl,{children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue ml-30 cp",onClick:()=>{this.setState({editButton:!0,isWebFieldTrack:!0})}})})]})})})})),ji(this,"getDataFromServer",(()=>{var t,e;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let s=void 0!==i.cId?i.cId:0;"true"===(void 0!==i.webft?i.webft:"false")?this.context.globalStateData.setIsLoadingData(!1):this.context.globalStateData.setIsLoadingData(!0),os({path:_n,params:{campaignId:s},sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,s;if(this.props.webAnalytics.conversionURLs=[{conversionUrl:""}],t.status&&t.data&&null!==t.data.analyticsjson&&void 0!==t.data.analyticsjson&&t.data.analyticsjson.length>0){let a=JSON.parse(t.data.analyticsjson);this.setState({smartUrls:null==(e=null==a?void 0:a.domainUrlList[0])?void 0:e.domainNameURL}),""!=(null==(i=null==a?void 0:a.domainUrlList[0])?void 0:i.domainNameURL)?this.setState({conversationUrl:null==(s=null==a?void 0:a.domainUrlList[0])?void 0:s.domainNameURL}):this.setState({conversationUrl:this.props.smartlinkUrl}),""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1}),this.setState({selectAnalytics:Hd.filter((t=>3===t.id))[0]}),ms();let n=[...this.state.errConversionURL],l=a.domainUrlList.map(((t,e)=>(t.conversionUrl=t.domainNameURL,t.validUrl=!0,n[e].domainNameSuccess=!0,t)));this.props.webAnalytics.conversionURLs=l,this.setState({errConversionURL:n})}else{let t=[...this.state.errConversionURL];t[0].domainNameSuccess=!0,this.setState({errConversionURL:t}),this.props.webAnalytics.conversionURLs=[{conversionUrl:this.props.smartlinkUrl,validUrl:!0}],this.setState({conversationUrl:this.props.smartlinkUrl},(()=>{""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1})}))}this.getFieldTrackData(!0,(t=>{this.context.globalStateData.setIsLoadingData(!1)})),this.forceUpdate()},fail:t=>{""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1}),this.setState({conversationUrl:this.props.smartlinkUrl})}})})),ji(this,"getClickOff",(()=>this.props.webAnalytics.conversationArray&&this.props.webAnalytics.conversationArray.length>4?"click-off":"")),ji(this,"submit",(t=>{var e,i,s,a;if(this.props.webAnalytics.conversionURLs[0].conversionUrl=this.state.conversationUrl,!(this.props.webAnalytics.conversionURLs.length>0)||ss(this.props.webAnalytics.conversionURLs[0].conversionUrl)){let t=[...this.state.errConversionURL];return t[0].errorMessage=`Enter ${(null==(i=null==(e=this.props.campaignPlan)?void 0:e.primaryTargetCode)?void 0:i.toLowerCase())||(null==(a=null==(s=this.props.campaignPlan)?void 0:s.goal)?void 0:a.toLowerCase())} URL`,void this.setState({errConversionURL:t})}{let t=!1,e=0;if(this.props.webAnalytics.conversionURLs.forEach((i=>{if(ss(i.conversionUrl)||null!==this.state.errConversionURL[e].errorMessage){let i=[...this.state.errConversionURL];return i[e].errorMessage=i[e].errorMessage,this.setState({errConversionURL:i}),void(t=!0)}e++})),t)return}this.saveWebAnalytics(t)})),ji(this,"saveWebAnalytics",(t=>{if(!0===es()){if(0===t)this.props.history.push("/campaign");else if(1===this.props.analyticsType.length){let t=JSON.parse(this.props.smartAppStoreUrl[0].smartAppStoreUrl).web.url;this.props.history.push("completion",{campaignId:Ln(),smartAppStore:t,dynamicListId:this.props.dynamicListId})}else this.props.moveNext(1);return}let e=[];this.props.webAnalytics.conversionURLs.map((t=>{let i={domainNameURL:t.conversionUrl};e.push(i)}));let i={domainType:this.state.selectAnalytics.domainType,analyticsSettingId:this.state.selectAnalytics.id,campaignId:this.props.campaignId,channelId:6,domainUrlList:e};os({path:Jn,params:i,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{if(e.status)if(0===t)this.props.history.push("/campaign");else if(1===this.props.analyticsType.length){let t=JSON.parse(this.props.smartAppStoreUrl[0].smartAppStoreUrl).web.url;this.props.history.push("completion",{campaignId:Ln(),smartAppStore:t,dynamicListId:this.props.dynamicListId})}else this.props.moveNext(1);else this.setState({saveError:!0,errMsg:(null==e?void 0:e.message)||cs})},fail:t=>{}})})),ji(this,"checkWebsiteLocal",(async(t,e,i,s)=>{let a=new AbortController,n=!1;try{fetch(t,{method:"HEAD",mode:"no-cors",signal:a.signal}).then((t=>{t.status<=226?!1===n&&(n=!0,i({status:!0,message:"Valid"})):!1===n&&(n=!0,s({status:!1,isabort:!1,message:"Not Valid"}))})).catch((t=>{})),setTimeout((()=>{a.abort(),!1===n&&(n=!0,s({status:!1,isabort:!0,message:"Not Valid"}))}),3e3)}catch(l){!1===n&&(n=!0,l({status:!1,isabort:!1,message:"Not Valid"}))}})),ji(this,"domainNameValidation",((t,e)=>{if(t.includes("https://"))this.checkWebsiteLocal(t,this.context,(t=>{if(!1===t.status){let t=[...this.state.errConversionURL],e=Zn;t[0].errorMessage=e,t[0].isError=!0}}),(t=>{if(!0===t.isabort){let t=[...this.state.errConversionURL],e=null;t[0].errorMessage=e,t[0].isError=!1}else{let t=[...this.state.errConversionURL],e=Zn;t[0].errorMessage=e,t[0].isError=!0}}));else{let t=[...this.state.errConversionURL],e="Your site is not secure";t[0].errorMessage=e,t[0].isError=!0}})),ji(this,"addOrRemoveAnalytics",(t=>{var e,i,s,a,n,l,o,r,c,d;if(0===t){let c=!1;if(!((null==(i=null==(e=this.props)?void 0:e.webAnalytics)?void 0:i.conversionURLs.length)>0)){let e=[...this.state.errConversionURL];return e[t].errorMessage=Zn,void this.setState({errConversionURL:e})}if(null==(a=null==(s=this.props)?void 0:s.webAnalytics)||a.conversionURLs.map(((t,e)=>{var i,s;if((null==(i=null==t?void 0:t.conversionUrl)?void 0:i.length)<=8||ss(null==t?void 0:t.conversionUrl)||null!==this.state.errConversionURL[e].errorMessage){let t=[...this.state.errConversionURL],i=`Enter ${null==(s=this.props)?void 0:s.campaignPlan.primaryTargetCode.toLowerCase()} URL`;return t[e].errorMessage=i,this.setState({errConversionURL:t}),void(c=!0)}})),c)return;if(!0===this.checkUrlisExisit(t))return;(null==(l=null==(n=this.props)?void 0:n.webAnalytics)?void 0:l.conversionURLs.length)<5&&(null==(r=null==(o=this.props)?void 0:o.webAnalytics)||r.conversionURLs.push({conversionUrl:"https://",domainNameUrl:"https://"}),this.forceUpdate())}else null==(d=null==(c=this.props)?void 0:c.webAnalytics)||d.conversionURLs.splice(t,1),this.forceUpdate()})),ji(this,"validateURLCheck",(t=>!!new RegExp("^(https?:\\/\\/)?((([a-zA-Z]+[a-zA-Z\\d-]*)\\.?)+[a-zA-Z]{2,})(\\:\\d+)?(\\/[-a-zA-Z\\d%_.~+]*)*(\\?[;&a-zA-Z\\d%_.~+=-]*)?(\\#[-a-zA-Z\\d_]*)?$","i").test(t))),ji(this,"checkDomainExists",(async t=>{try{const e=await fetch(t,{method:"HEAD",mode:"no-cors"});return e.ok||"opaque"===e.type}catch(e){return!1}})),ji(this,"textHandler",((t,e)=>{var i,s,a,n;let l=e.length>0?null:`Enter ${(null==(s=null==(i=this.props.campaignPlan)?void 0:i.primaryTargetCode)?void 0:s.toLowerCase())||(null==(n=null==(a=this.props.campaignPlan)?void 0:a.goal)?void 0:n.toLowerCase())} URL`,o=e.trim();if(o.length>=0){let i=e.length>0&&null,s=[...this.state.errConversionURL];s[t].errorMessage=l,s[t].isError=!0,s[t].domainNameSuccess=i,o.toString().slice(0,8),this.setState({conversationUrl:e,errConversionURL:s,tickIcon:!1}),this.props.webAnalytics.conversionURLs[t].conversionUrl=e}else this.props.webAnalytics.conversionURLs[t].conversionUrl="https://",this.forceUpdate();return e.length>0})),ji(this,"checkUrlisExisit",(t=>{var e,i,s,a,n;let l=!1;if(void 0!==(null==(e=this.props.webAnalytics)?void 0:e.conversionURLs)&&(null==(i=this.props.webAnalytics)?void 0:i.conversionURLs.length)>0&&this.getUniqueListBy(null==(s=this.props.webAnalytics)?void 0:s.conversionURLs,"conversionUrl").length!==(null==(n=null==(a=this.props.webAnalytics)?void 0:a.conversionURLs)?void 0:n.length)){let e=[...this.state.errConversionURL];return e.map((t=>{t.errorMessage=null,t.isError=!1})),e[t].errorMessage="URL already exists",e[t].isError=!0,e[t].domainNameSuccess=!1,this.setState({errConversionURL:e}),l=!0,l}return l})),ji(this,"addErrMsg",((t,e,i)=>{let s=[...this.state.errConversionURL];s[t].errorMessage=e,s[t].isError=!0,s[t].domainNameSuccess=!1,this.setState({conversationUrl:i,errConversionURL:s})})),ji(this,"checkDomainNameValidation",((t,e)=>{if(Kn(e)&&this.validateURLCheck(e))if(e.includes("https://")){let i=[...this.state.errConversionURL];i[t].isLoader=!0,this.setState({errConversionURL:i}),this.checkWebsiteLocal(e,this.context,(s=>{let a=[...this.state.errConversionURL];if(!1===s.status){let s=Zn;a[t].errorMessage=s,a[t].isError=!0,a[t].domainNameSuccess=!1,a[t].isLoader=!1,this.setState({conversationUrl:e,errConversionURL:a}),this.setState({errConversionURL:i})}else a[t].errorMessage=null,a[t].isError=!1,a[t].domainNameSuccess=!0,a[t].isLoader=!1;this.setState({errConversionURL:a})}),(i=>{if(!0===i.isabort){let i=[...this.state.errConversionURL];if((e.match(/https:\/\//g)||[]).length>1){let e="Enter valid URL";i[t].errorMessage=e,i[t].isError=!0,i[t].isLoader=!1,i[t].domainNameSuccess=!1,this.setState({errConversionURL:i})}else{let s=null;i[t].errorMessage=s,i[t].isError=!1,i[t].domainNameSuccess=!0,i[t].isLoader=!1,this.setState({conversationUrl:e,errConversionURL:i})}}}))}else{let i="Your site is not secured";this.addErrMsg(t,i,e)}else{let i="Enter valid URL";this.addErrMsg(t,i,e)}})),ji(this,"enableFieldTracking",(t=>{var e,i;const s=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let a=void 0!==s.cId?s.cId:0;(Od=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0})).on("connect",(()=>{Od.emit("new_user",{userName:"platform",domainName:t.domainNameURL,appId:parseInt(a)})})),Od.on("closed",(t=>{try{qd.close();let i=!1;if(t.status||i){if(i=!0,localStorage.getItem("ea")){let t=ks(localStorage.getItem("ea")),i={elementArray:t.elementArray,controlArray:t.controlsArray,pageUrl:t.currentActivity,imageData:null==t?void 0:t.imageData};var e=!1;e=(0!=this.state.WebFieldTrackData.length||0!=this.state.WebFieldTrackData_conversion.length)&&!(this.state.WebFieldTrackData.length>=1||this.state.WebFieldTrackData_conversion.length>=1),"Engagement"==this.state.goalType&&this.setState({WebFieldTrackData:i.elementArray}),"Conversion"==this.state.goalType&&this.setState({WebFieldTrackData_conversion:i.elementArray})}!1===e&&this.setState({fieldTrackSuccess:!0},(()=>{this.props.fieldTrackSuccess(!0),this.context.globalStateData.setIsLoadingData(!0),this.getFieldTrackData(!0,(t=>{this.context.globalStateData.setIsLoadingData(!1)}))}))}else!1===this.state.fieldTrackClose&&(this.setState({fieldTrackClose:!0},(()=>{this.props.clientClose(!0)})),this.getFieldTrackData(!0,(t=>{this.context.globalStateData.setIsLoadingData(!1)})))}catch(i){}})),localStorage.setItem("fdomain",t.conversionUrl);let n=window.location.pathname+window.location.search+"&webft=true",l=btoa(this.props.campaignId);qd=window.open(`${t.conversionUrl}?_sdxId=${l}&path=${n}`),this.props.isFieldTrackEnabled(!0)})),ji(this,"resetFieldTracking",(t=>{var e,i;const s=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let a={campaignId:void 0!==s.cId?s.cId:0,deviceType:"web",domainName:t.conversionUrl,deviceOs:"",imageData:null,goalType:"P",fieldsInfo:null,formFieldsToCapture:null};os({path:Yn,params:a,ok:t=>{},fail:t=>{}})})),ji(this,"handlePreferenceCheckbox",(t=>{this.setState({preferenceModule:!this.state.preferenceModule})})),ji(this,"FieldTrackingComponent",(t=>{const e=no.parse(window.location.search);return 0!==(void 0!==(null==e?void 0:e.contentInj)?null==e?void 0:e.contentInj:0)?Ti.jsx(Rd,{isEdit:!!this.state.editButton,fullData:this.state.fullData,isWebFieldTrack:this.state.isWebFieldTrack,fieldTrackData:this.state.fieldTrackData,domainName:this.state.conversationUrl,campaignId:this.props.campaignId,saveBtnClicked:()=>{this.setState({isWebFieldTrack:!1}),this.context.globalStateData.setIsLoadingData(!0),this.getFieldTrackData(!0,(t=>{this.context.globalStateData.setIsLoadingData(!1)}))},cancelBtnClicked:()=>{this.setState({isWebFieldTrack:!1})}}):Ti.jsx(tr,{isEdit:!!this.state.editButton,fullData:this.state.fullData,isWebFieldTrack:this.state.isWebFieldTrack,fieldTrackData:this.state.fieldTrackData,domainName:this.state.conversationUrl,campaignId:this.props.campaignId,saveBtnClicked:()=>{this.setState({isWebFieldTrack:!1}),this.context.globalStateData.setIsLoadingData(!0),this.getFieldTrackData(!0,(t=>{this.context.globalStateData.setIsLoadingData(!1)}))},cancelBtnClicked:()=>{this.setState({isWebFieldTrack:!1})}})}))}getUniqueListBy(t,e){return[...new Map(t.map((t=>[t[e],t]))).values()]}render(){var t,e,i,s,a,n,l,o;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs("div",{className:"box-design bd-top-border",children:[this.state.isWebFieldTrack&&Ti.jsxs(_l,{className:"web-field-tracking-fullscreen-wrapper",fullscreen:!0,show:this.state.isWebFieldTrack,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{const t=new CustomEvent("webclosed",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t),this.props.clientClose(!0),this.setState({isWebFieldTrack:!1})}}),Ti.jsx(Jl,{style:{width:"80%"},children:Ti.jsx(Zl,{md:4,children:Ti.jsx("h2",{children:"Custom Event"})})})]}),Ti.jsx(_l.Body,{children:this.FieldTrackingComponent()})]}),void 0!==(null==(e=null==(t=this.props)?void 0:t.webAnalytics)?void 0:e.conversionURLs)&&(null==(s=null==(i=this.props)?void 0:i.webAnalytics)?void 0:s.conversionURLs.length)>0&&(null==(n=null==(a=this.props)?void 0:a.webAnalytics)?void 0:n.conversionURLs.map(((t,e)=>{var i,s,a,n,l,o,r,c;return Ti.jsx($l,{className:"mt30 web-analytics-tab",disabled:this.props.editClickOff,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{className:`${0!==e&&"d-none"}`,label:`${Xn(null==(i=this.props.campaignPlan)?void 0:i.primaryTargetCode)||Xn(null==(s=this.props.campaignPlan)?void 0:s.goal)}\n                      URL`,right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(ql,{required:!0,placeholder:`${(null==(a=this.props.campaignPlan)?void 0:a.primaryTargetCode)||(null==(n=this.props.campaignPlan)?void 0:n.goal)} URL`,isLoading:this.state.errConversionURL[e].isLoader,iconPlaceholder:!0,iconName:(null==(l=null==t?void 0:t.conversionUrl)?void 0:l.length)>0&&null!==this.state.errConversionURL[e].domainNameSuccess?!0===this.state.errConversionURL[e].domainNameSuccess?"icon-rs-circle-tick-medium icons-md green":"icon-rs-circle-close-edge-mini icons-md red":"",val:t.conversionUrl,errorMessage:this.state.errConversionURL[e].errorMessage,handleOnchange:t=>{const i=t.trim();this.textHandler(e,i)},handleOnBlur:t=>{let i=t,s=t.slice(0,8);if(s.includes("https://")||(i="https://"+t),s.includes("http://")&&(i=t.replace("http://","https://")),!0===this.textHandler(e,i)){if(!0===this.checkUrlisExisit(e))return;this.checkDomainNameValidation(e,i)}},onFocus:t=>{let i=t.target.value;i.startsWith("https://")&&(i=i.replace("https://","")),this.props.webAnalytics.conversionURLs[e].conversionUrl=i,this.forceUpdate()}})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[0==e&&Ti.jsx(Qi,{icon:0===(null==(r=null==(o=this.state)?void 0:o.fieldTrackList)?void 0:r.length)?Qn:tl,iconColor:"blue",iconSize:"md",tooltip:"Field tracking",color:"blue",onClick:()=>{var e,i;(null==(i=null==(e=this.state)?void 0:e.fieldTrackList)?void 0:i.length)>0?this.resetFieldTracking(t):this.enableFieldTracking(t)}}),Ti.jsx(Qi,{disabled:0===e&&5===(null==(c=this.props.webAnalytics)?void 0:c.conversionURLs.length),mainClass:this.state.getAddAccessData?"click-on":"click-off",icon:0===e?Ss:el,iconColor:"red",iconSize:"md",tooltip:0===e?"Add":"Remove",color:0===e?"blue":"red",onClick:()=>{this.addOrRemoveAnalytics(e)}})]})})}),Ti.jsx("div",{children:0==e&&this.state.preferenceModule&&Ti.jsx(er,{savePreference:this.state.savePreference,propsData:this.props,webFieldTrack:this.state.isWebFieldTrack,WebFieldTrackData_conversion:this.state.WebFieldTrackData_conversion,WebFieldTrackData_engagement:this.state.WebFieldTrackData,webAnalytics:this.state,changeSavePreference:t=>{this.setState({savePreference:t})},goalTypeChange:t=>{null!=t&&this.setState({goalType:t})},fieldTrackIconClick:(t,e,i)=>{const s=t[0];let a={conversionUrl:s,validUrl:e,domainNameURL:s};null!=i&&this.setState({goalType:i}),this.setState({fieldTrackClose:!1}),this.enableFieldTracking(a)},submit:()=>{this.submit(1)},fieldTrackData:this.state.fieldTrackList,deviceType:t=>{this.fieldTrackingCom()},fieldTrackingCom:Ti.jsx(this.FieldTrackingGrid,{deviceType:"Web"})})})]})})}))),(null==(o=null==(l=this.state)?void 0:l.fieldTrackList)?void 0:o.length)>0&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.FieldTrackingCom,{deviceType:"Web"})}),this.state.isDomainAddBtnClicked&&Ti.jsxs(_l,{show:this.state.isDomainAddBtnClicked,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Google Analytics"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isDomainAddBtnClicked:!1})}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx("label",{children:"Select domain"}),Ti.jsx("div",{className:"portlet-box-theme border1 p0 mb15 css-scrollbar checkbox-list-box",children:Ti.jsx("ul",{className:"checkbox-list-modal",children:this.state.analyticsList.map(((t,e)=>Ti.jsx(Vl,{className:e%2==0?"even mb0":"mb0",lbl:t.text,checked:t.value,cb:i=>{t.value=i;let s=[...this.state.analyticsList];s[e].value=i,this.setState({analyticsList:s})}})))})})]}),Ti.jsx(_l.Footer,{children:Ti.jsx(ns,{className:"m0",onClick:()=>{!0!==es()&&this.setState({isDomainAddBtnClicked:!1})},children:"Add"})})]}),this.state.isOpenEventModal&&Ti.jsxs(_l,{show:this.state.isOpenEventModal,size:"xl",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Event track"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isOpenEventModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx("img",{src:Pd})}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isOpenEventModal:!1})},children:"Cancel"}),Ti.jsx(ns,{className:"m0",onClick:()=>{!0!==es()&&this.setState({isOpenEventModal:!1})},children:"Set event"})]})]}),!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}})]}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),this.props.isNext?Ti.jsx(zs,{onClick:()=>{this.submit(0)},children:"Save"}):Ti.jsx(ns,{onClick:()=>{this.submit(0)},children:"Save"}),this.props.isNext&&Ti.jsx("div",{className:(this.props.analyticsType.length," "),children:Ti.jsx(ns,{onClick:()=>{this.submit(1)},children:"Next"})})]})]})}}ji(zd,"contextType",Ji);const $d=wi(zd),Hd=[{name:"SmartDX analytics",id:3,domainType:"SX"}],Gd=[{text:"www.facebook.com/VisionBankAsiaBankways",value:!1},{text:"www.facebook.com/VisionBankJapan/",value:!1},{text:"www.facebook.com/VisionBankAustralia/",value:!1},{text:"www.facebook.com/VisionBankNZ/",value:!1},{text:"https://www.facebook.com/VisionBankIndia/",value:!1},{text:"https://www.facebook.com/VisionBankIndonesia/",value:!1},{text:"https://www.facebook.com/VisionBankMalaysia/",value:!1}],Wd=t=>{let e=!1;return ss(t.deviceType)?(e=!0,t.errorMessage.errDevice="Select device",e):ss(t.appName.appName)?(e=!0,t.errorMessage.errAppname="Select app name",e):ss(t.mainScreenName.displayName)?(e=!0,t.errorMessage.errMainscreen="Select screen",e):e};class _d extends Di.Component{constructor(){super(...arguments),ji(this,"state",{index:0,isFieldTrack:!1,fieldTrackData:null}),ji(this,"tabs",[{text:"Primary goal"}]),ji(this,"renderComponents",(t=>{var e,i;return Ti.jsx("div",{children:1==this.state.isFieldTrack?Ti.jsx(Ti.Fragment,{}):Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"m0 border-0",children:null==(i=null==(e=this.props)?void 0:e.json)?void 0:i.map(((t,e)=>Ti.jsx(Ql,{eventKey:"tab"+e,children:t.mobile.length>0&&t.mobile.map(((t,e)=>{var i;return Ti.jsx(Zd,{savePreference:null==(i=this.props)?void 0:i.savePreference,changeSavePreference:t=>{this.props.changeSavePreference(t)},clickOff:this.props.clickOff,index:e,item:t,campaignId:this.props.campaignId,context:this.props.context,history:this.props.history,filedTrack:t=>{this.setState({isFieldTrack:!0,fieldTrackData:t})}})}))})))})})}))}componentDidMount(){}render(){return Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"split-container br0",children:this.renderComponents(this.state.index)})})}}ji(_d,"contextType",Ji);const Jd=wi(_d);let Zd=(Si=class extends Di.Component{constructor(){super(...arguments),ji(this,"state",{activationKey:"0",treeUpdate:0,mobileAppList:[],appScreenList:[],appSubScreenList:[],saveError:!1,errMsg:null,fieldTrackList:[],fieldTrackList_Engagement:[],fieldTrackList_Conversion:[],isFieldTrack:!1,fieldTrackData:null,platform_ErrMsg:null,goalTypeErrMsg:null,Role:null,Engagement:!1,goalTypeData:[],goalTypeTab:null,engagementType:[],engagementPrimary:!1,engagementData:[],engagementLandingPage:null,engagementURL_isIcon:[!1,!1,!1,!1,!1],engagementURL_isLoading:[!1,!1,!1,!1,!1],engagementCE_ErrMsg:null,engagementCustomEvent:null,inputValues:["https://"],engagementURL_ErrMsg:[],engagementAddBtn_Disable:null,engagementCustomEventValue:null,engagementCustomEventData:[],conversionType:[],conversionPrimary:!1,conversionPricingData:[],Conversion:!1,conversionData:[],ConversionCustomEventData:[],conversionCustomEvent:null,conversionCustomEventValue:null,conversionCE_ErrMsg:null,conversionPricing_ErrMsg:null,converationAction_ErrMsg:null,conversionPricingValue:null,conversation_ErrMsg:null,conversionThankPage:null,conversionFormSubmission_Data:[],conversionFormSubmission_value:null,converationActionValue:null,conversionFormSubmission_ErrMsg:null,conversionInputValue:null,conversionInput_ErrMsg:null,conversionDropValue:null,conversionFormSubmission:null,conversationActionValue:null,conversionActionData:["Submitted","Not submitted","Partially submitted"],enagement_ErrMsg:null,ConversionDropValue_ErrMsg:null}),ji(this,"saveConversionDuplicte",(()=>{var t;let e=!1;if(this.state.Conversion&&null==this.state.conversionCustomEvent&&null==this.state.conversionFormSubmission)return!0;if(this.state.conversionCustomEvent&&(null!=this.state.conversionCustomEventValue&&0!==(null==(t=this.state.conversionCustomEventValue)?void 0:t.length)||(e=!0)),null!=this.state.conversionCustomEventValue){if(null==this.state.conversionDropValue)return!0;if(null!=this.state.conversionDropValue&&null==this.state.conversionInputValue)return!0;if(null==this.state.conversionPricingValue)return!0}if(this.state.conversionFormSubmission){if(null==this.state.conversionFormSubmission_value)return!0;if(null==this.state.converationActionValue)return!0}return e})),ji(this,"saveEngagement",(()=>{const{Role:t,domainURLValue:e,engagementCustomEvent:i,engagementCustomEventValue:s,engagementType:a,Engagement:n,Conversion:l,receiveConversion:o,goalTypeTab:r}=this.state;if(0==r&&n){if(null==a||0==a.length)return void this.setState({enagement_ErrMsg:sr});if(i&&(null==s||0===s.length))return void this.setState({engagementCE_ErrMsg:ar});if(o&&this.saveConversionDuplicte())return void this.setState({goalTypeTab:1});if(o)return}if(1==r&&l){if(this.saveConversion())return;this.converationErrMsgCheck()}})),ji(this,"converationErrMsgCheck",(()=>{const{conversation_ErrMsg:t,engagementCE_ErrMsg:e,conversionForm_ErrMsg:i,conversionCE_ErrMsg:s,conversionPricing_ErrMsg:a,converationAction_ErrMsg:n,conversionURL_ErrMsg:l,conversionFormSubmission_ErrMsg:o,conversionInput_ErrMsg:r,conversionDropValue_ErrMsg:c}=this.state;let d=!1;const p=[t,e,i,s,a,n,l,o,r,c].every((t=>null===t||Array.isArray(t)&&0===t.length));return p?(!0===p&&this.saveConversion()&&(this.setState({goalTypeTab:1}),d=!0),d):(this.setState({goalTypeTab:1}),d=!0,d)})),ji(this,"conversionCheckSaveEngagement",(()=>{let t=!1;if(1==this.state.Engagement)return null!=this.state.engagementType&&0!==this.state.engagementType.length||(t=!0),1!=this.state.engagementCustomEvent&&null!=this.state.engagementCustomEvent||null!=this.state.engagementCustomEventValue&&0!==this.state.engagementCustomEventValue.length||(t=!0),t})),ji(this,"saveConversion",(()=>{var t;let e=!1;if(null!=this.state.conversionType&&0!==this.state.conversionType.length||(this.setState({conversation_ErrMsg:nr}),e=!0),this.state.conversionCustomEvent&&(null!=this.state.conversionCustomEventValue&&0!==(null==(t=this.state.conversionCustomEventValue)?void 0:t.length)||(this.setState({conversionCE_ErrMsg:ar}),e=!0)),null!=this.state.conversionCustomEventValue){if(null==this.state.conversionDropValue)return this.setState({conversionDropValue_ErrMsg:lr}),!0;if(null!=this.state.conversionDropValue&&null==this.state.conversionInputValue)return this.setState({conversionInput_ErrMsg:or}),!0;if(null==this.state.conversionPricingValue)return this.setState({conversionPricing_ErrMsg:rr}),!0}if(this.state.conversionFormSubmission){if(null==this.state.conversionFormSubmission_value)return this.setState({conversionFormSubmission_ErrMsg:cr}),!0;if(null==this.state.converationActionValue)return this.setState({converationAction_ErrMsg:dr}),!0}return 1==this.state.Engagement&&0==e&&this.conversionCheckSaveEngagement()?(this.setState({goalTypeTab:0}),!0):(!1===this.state.Engagement&&!1===e&&this.props.submit(),e)})),ji(this,"componentDidMount",(t=>{let e=ms();this.getEngagementData(),this.setState({mobileAppList:e.mobileAppsList}),this.getAppScreenList(),this.getAppSubScreenList(),this.getFieldTrackData(),this.getEventDetails()})),ji(this,"getEventDetails",(()=>{os({path:il,params:{channel:"MP"},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{if(1==t.status&&(t.data,t.data)){const e=t.data.filter((t=>"Android phone"==t.deviceType));if(e.length>0){const t=e.map((t=>t.customEventName));t.length>0&&this.setState({engagementCustomEventData:t,ConversionCustomEventData:t})}}},fail:t=>{this.setState({showLoader:!0})}})})),ji(this,"getEngagementData",(()=>{const t=ms(),e=Zs();if(e&&e.currencyMaster){const t=e.currencyMaster.map((t=>t.currencyName));this.setState({conversionPricingData:t})}if(t){if(t.engagementList){const e=t.engagementList.map((t=>t.conversionName));this.setState({engagementData:e})}if(t.conversionTypeList){const e=t.conversionTypeList.map((t=>t.conversionName));this.setState({conversionData:e})}}})),ji(this,"getFieldTrackData",(()=>{os({path:sl,params:{campaignId:this.props.campaignId,CampaignId:this.props.campaignId},loading:this.context.globalStateData.setIsLoadingData,ok:t=>{var e,i,s,a,n;t.status&&(null==(i=null==(e=null==t?void 0:t.data)?void 0:e.capturedFields)?void 0:i.length)>0&&(0==this.state.goalTypeTab&&this.setState({fieldTrackList_Engagement:null==(s=null==t?void 0:t.data)?void 0:s.capturedFields}),1==this.state.goalTypeTab&&this.setState({fieldTrackList_Conversion:null==(a=null==t?void 0:t.data)?void 0:a.capturedFields}),this.setState({fieldTrackList:null==(n=null==t?void 0:t.data)?void 0:n.capturedFields}))},fail:t=>{}})})),ji(this,"getAnalyticsData",(t=>{let e={eventName:""},i="",s=0==this.state.goalTypeTab?this.state.fieldTrackList_Engagement:1==this.state.goalTypeTab?this.state.fieldTrackList_Conversion:this.state.fieldTrackList;s!=[]&&0!=(null==s?void 0:s.length)||(s=this.state.fieldTrackList);let a=s.filter((e=>e.deviceType.toLowerCase()===t.toLowerCase()));if(a.length>0){try{let t=JSON.parse(a[0].formFieldsToCapture);if(void 0===t.fieldsInfo||null===t.fieldsInfo||""===t.fieldsInfo)return;let s=t.fieldsInfo;s.fieldCaptureList.map((t=>{"true"!==t.markAsGoal&&!0!==t.markAsGoal||(i=t.eventName),e.eventName=e.eventName.length>0?e.eventName+","+t.eventName:t.eventName,e.minDuration=t.minDuration,e.minLength=t.minLength,e.screenfilter=s.screenfilter}))}catch(n){}return e.goalName=i,e}return e})),ji(this,"FieldTrackingCom",(t=>{let e=this.getAnalyticsData(t.deviceType);return Ti.jsx(Ti.Fragment,{children:null!=e&&""!==(null==e?void 0:e.eventName)&&Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"marginT30",children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Goal setup",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx("div",{className:"event-tracking-list",children:Ti.jsxs("div",{className:"event-section",children:[Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Goal"}),Ti.jsx("span",{className:"label-value",children:e.goalName})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Screen"}),Ti.jsxs("span",{className:"label-value",children:[Ti.jsx("span",{className:"blue",children:"Min duration: "+e.minDuration}),Ti.jsx("span",{children:" "+e.screenfilter.toUpperCase()}),Ti.jsx("span",{className:"blue",children:" Min length:"+e.minLength})," "]})]})]})})}),Ti.jsx(Zl,{children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue cp ml-30 paddingL10",onClick:()=>{var t;let e={appName:this.props.item.appName.appName,appId:this.props.item.appName.appGuid,deviceType:null==(t=this.props.item)?void 0:t.deviceType,mode:"edit"};this.state.fi,this.setState({fieldTrackData:e},(()=>{this.setState({isFieldTrack:!0})}))}})})]})})})})),ji(this,"getDeviceList",(()=>Kd)),ji(this,"getAppScreenList",(t=>{let e={appId:this.props.item.appName.appId,deviceType:void 0!==this.props.item.deviceType&&""!==this.props.item.deviceType?this.props.item.deviceType:"Mobile",isdeepLink:this.props.item.isDeeplinkEnabled,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:al,params:e,ok:t=>{var e;t.status?this.setState({appScreenList:(null==(e=null==t?void 0:t.data)?void 0:e.appScreensList)||[]}):this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})})),ji(this,"getAppSubScreenList",(()=>{var t,e,i;if((null==(i=null==(e=null==(t=this.props.item)?void 0:t.mainScreenName)?void 0:e.displayName)?void 0:i.length)>0){let t={appId:this.props.item.appName.appId,deviceType:void 0!==this.props.item.deviceType&&""!==this.props.item.deviceType?this.props.item.deviceType:"Mobile",screenName:this.props.item.mainScreenName.displayName,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:nl,params:t,ok:t=>{t.status?this.setState({appSubScreenList:t.data.appSubScreensList}):this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})}})),ji(this,"disconnectSocket",(()=>{var t,e,i,s,a={},n="iOS",l=null==(t=this.state.fieldTrackData)?void 0:t.appId,o="iPhone";(null==(i=null==(e=this.state.fieldTrackData)?void 0:e.deviceType)?void 0:i.toLowerCase().includes("an"))&&(n="Android",o=null==(s=this.state.fieldTrackData)?void 0:s.deviceType),a.appId=String(n+o+l).replace(/ /g,"");var r=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0});r.on("connect",(()=>{r.emit("receiver-handshake-request",a),r.emit("disconnect-receiver",JSON.stringify(a)),r.off("receiver-handshake-response"),r.off("client-information"),r.off("message-from-client-image"),r.off("message-from-client-data"),r.off("receiver-handshake-response"),r.off("show-auth-code"),r.disconnect()}))})),ji(this,"handleEngagementCheckbox",(t=>{let e;if(this.setState({goalTypeErrMsg:!1}),!0===t){if(this.state.Conversion)return e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)"},{id:1002,text:"Conversion"}]:this.state.conversionPrimary?[{id:1001,text:"Engagement "},{id:1002,text:"Conversion (Primary)"}]:[{id:1001,text:"Engagement "},{id:1002,text:"Conversion"}],void this.setState({goalTypeData:e,Engagement:t,goalTypeTab:0});e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)"},{id:1002,text:"Conversion",disable:!0}]:this.state.conversionPrimary?[{id:1001,text:"Engagement "},{id:1002,text:"Conversion (Primary)",disable:!0}]:[{id:1001,text:"Engagement "},{id:1002,text:"Conversion",disable:!0}],this.setState({goalTypeData:e,Engagement:t,goalTypeTab:0})}else e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)",disable:!0},{id:1002,text:"Conversion"}]:this.state.conversionPrimary?[{id:1001,text:"Engagement ",disable:!0},{id:1002,text:"Conversion (Primary)"}]:[{id:1001,text:"Engagement ",disable:!0},{id:1002,text:"Conversion"}],this.setState({goalTypeData:e,Engagement:t,goalTypeTab:1,engagementType:[],enagement_ErrMsg:null,inputValues:["https://"],engagementURLErrMsg:[]})})),ji(this,"handleConversionCheckbox",(t=>{let e;if(this.setState({goalTypeErrMsg:!1}),!0===t){if(this.state.Engagement)return e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)"},{id:1002,text:"Conversion"}]:this.state.conversionPrimary?[{id:1001,text:"Engagement "},{id:1002,text:"Conversion (Primary)"}]:[{id:1001,text:"Engagement "},{id:1002,text:"Conversion "}],void this.setState({goalTypeData:e,Conversion:t,goalTypeTab:1});e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)",disable:!0},{id:1002,text:"Conversion"}]:this.state.conversionPrimary?[{id:1001,text:"Engagement ",disable:!0},{id:1002,text:"Conversion (Primary)"}]:[{id:1001,text:"Engagement ",disable:!0},{id:1002,text:"Conversion"}],this.setState({goalTypeData:e,Conversion:t,goalTypeTab:1})}else e=this.state.engagementPrimary?[{id:1001,text:"Engagement (Primary)"},{id:1002,text:"Conversion",disable:!0}]:this.state.conversionPrimary?[{id:1001,text:"Engagement "},{id:1002,text:"Conversion (Primary)",disable:!0}]:[{id:1001,text:"Engagement "},{id:1002,text:"Conversion",disable:!0}],this.setState({goalTypeData:e,goalTypeTab:0,Conversion:t},this.resetConversionValue())})),ji(this,"resetConversionValue",(()=>{this.setState({conversionType:null,conversionThankPage:null,conversionCustomEvent:null,conversionCustomEventValue:null,conversionFormSubmission:null,conversionDropValue:null,conversionInputValue:null,conversionPricingValue:null,conversionInputURL:["https://"],conversionFormSubmission_value:null,converationActionValue:null,conversion_ErrMsg:null,conversionCE_ErrMsg:null,conversionInput_ErrMsg:null,conversionDropValue_ErrMsg:null,conversionPricing_ErrMsg:null,converationAction_ErrMsg:null,conversionFormSubmission_ErrMsg:null})})),ji(this,"selectEnagagemetValue",(t=>{var e;t.value,0===t.value.length?this.setState({enagement_ErrMsg:"Choose engagement type",engagementType:null}):void 0!==t.value&&this.setState({enagement_ErrMsg:null,engagementType:t.value,receiveConversion:!0});const i=t.value.includes("Landing page");i&&(this.state.fieldTrackList_Engagement!=[]&&0!=(null==(e=this.state.fieldTrackList_Engagement)?void 0:e.length)||this.setState({fieldTrackList_Engagement:this.state.fieldTrackList})),this.setState({engagementLandingPage:i}),this.setState({engagementLandingPage:i}),i||this.setState({inputValues:["https://"],engagementURL_ErrMsg:[]}),t.value;const s=["Form submission","Custom event"].some((e=>t.value.includes(e)));s&&this.setState({engagementCE_ErrMsg:null}),this.setState({engagementCustomEvent:s})})),ji(this,"selectConversionValue",(t=>{const e=t.value;0===e.length?this.setState({conversation_ErrMsg:"Choose engagement type",conversionType:null}):void 0!==e&&this.setState({conversation_ErrMsg:null,conversionType:e});const i=e.includes("Thank you page");i||this.setState({conversionInputURL:["https://"],conversionURL_ErrMsg:[]}),this.setState({conversionThankPage:i});const s=e.includes("Custom event");s||this.setState({conversionCE_ErrMsg:null,conversionInputValue:null,conversionInput_ErrMsg:null,conversionDropValue_ErrMsg:null,conversionDropValue:null,conversionPricing_ErrMsg:null,conversionPricingValue:null}),this.setState({conversionCustomEvent:s});const a=e.includes("Form submission");a||this.setState({conversionFormSubmission_ErrMsg:null,conversionFormSubmission_value:null,conversationAction_ErrMsg:null,conversationActionValue:null}),this.setState({conversionFormSubmission:a})}))}componentDidUpdate(t,e){var i,s;if(this.state,(null==(i=this.props)?void 0:i.savePreference)&&(null==(s=this.props)?void 0:s.savePreference)!=t.savePreference){if(this.props.changeSavePreference(!1),null==this.state.Role)return void this.setState({platform_ErrMsg:ir});if(null!=this.state.Role&&0==this.state.Engagement&&0==this.state.Conversion)return void this.setState({goalTypeErrMsg:"Choose goal type"});this.state.Engagement&&this.saveEngagement()}}render(){var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B,M,P,F,U,R,O;return Ti.jsxs("div",{className:"rs-accordin-container accordin-container-fluid analytics-goal-type",children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),this.state.isFieldTrack&&Ti.jsxs(_l,{show:this.state.isFieldTrack,fullscreen:!0,className:"modal-top-fixed fluid-container-modal field-track-mobile-modal",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Field tracking"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{const t=new CustomEvent("socketClosed",{detail:{message:"Hello from custom event!"}});window.dispatchEvent(t),this.setState({isFieldTrack:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(tr,{isWebFieldTrack:!1,fieldTrackData:this.state.fieldTrackData,saveBtnClicked:()=>{this.setState({isFieldTrack:!1}),this.getFieldTrackData()},cancelBtnClicked:()=>{this.setState({isFieldTrack:!1})}})})]}),Ti.jsx(to,{className:"rs-accordin",activeKey:this.state.activationKey,children:Ti.jsxs(eo,{eventKey:this.props.index.toString(),children:[Ti.jsx(eo.Header,{onClick:()=>{this.state.activationKey===this.props.index.toString()?this.setState({activationKey:"-1"}):this.setState({activationKey:this.props.index.toString()})},children:Ti.jsx("div",{className:"rs-accordin-header",children:Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx("i",{className:`icons-md ${this.state.activationKey!==this.props.index.toString()?"icon-rs-square-plus-fill-medium blue":"icon-rs-square-minus-fill-medium grey-medium"} marginR8`}),Ti.jsxs("h3",{className:"marginB0",children:[" ",""!==(null==(t=this.props.item)?void 0:t.deviceType)?null==(e=this.props.item)?void 0:e.deviceType:"Device types"," "]})]})})}),Ti.jsx(to.Collapse,{eventKey:this.props.index.toString(),children:Ti.jsx(eo.Body,{children:Ti.jsx("div",{className:`rs-accordin-panel ${!0===this.props.clickOff&&"click-off"}`,children:Ti.jsxs("div",{className:"rs-accordin-body",id:"collapseOne","aria-labelledby":"headingOne",children:[Ti.jsx("div",{className:"marginT5"}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{label:"Mobile platform",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Device",disabled:!0,errorMessage:null==(a=null==(s=null==(i=this.props)?void 0:i.item)?void 0:s.errorMessage)?void 0:a.errDevice,data:this.getDeviceList()||[],value:void 0!==(null==(n=this.props.item)?void 0:n.deviceType)&&""!==(null==(l=this.props.item)?void 0:l.deviceType)?null==(o=this.props.item)?void 0:o.deviceType:"-- Select --",onChange:t=>{this.props.item.deviceType=t.target.value,this.props.item.errorMessage.errDevice=t.target.value.length>0?null:"Select device",this.setState({treeUpdate:this.state.treeUpdate+1})}})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{label:"Mobile app",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Mobile app",disabled:!0,errorMessage:null==(d=null==(c=null==(r=this.props)?void 0:r.item)?void 0:c.errorMessage)?void 0:d.errAppname,data:["Vision bank 1","Vision bank 2","Vision bank 3","Vision bank 4"],value:void 0!==(null==(u=null==(h=null==(p=this.props)?void 0:p.item)?void 0:h.appName)?void 0:u.appName)&&""!==(null==(y=null==(v=null==(m=this.props)?void 0:m.item)?void 0:v.appName)?void 0:y.appName)?null==(f=null==(b=null==(g=this.props)?void 0:g.item)?void 0:b.appName)?void 0:f.appName:"-- Select --",onChange:t=>{this.props.item.appname=t.target.value,this.props.item.errorMessage.errAppname=t.target.value.length>0?null:"Select app name",this.setState({treeUpdate:this.state.treeUpdate+1}),this.forceUpdate()}})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(ws,{text:"Field tracking",position:"top",children:Ti.jsx("i",{className:this.state.fieldTrackList.length>0&&(null==(S=null==(x=this.getAnalyticsData(this.props.item.deviceType))?void 0:x.eventName)?void 0:S.length)>0?"icon-rs-refresh-medium icons-md blue cp":"icon-rs-event-tracking-medium color-primary-blue icons-md cp",onClick:()=>{var t,e;if((null==(t=this.getAnalyticsData(this.props.item.deviceType))?void 0:t.eventName.length)>0){let t={formFieldsToCapture:"",campaignId:this.props.campaignId,appId:this.props.item.appName.appGuid,deviceOs:this.props.item.deviceType.toLowerCase().includes("an")?"Android":"iOS",deviceType:this.props.item.deviceType,goalType:"P"};os({path:ll,params:t,ok:t=>{!0===t.status&&this.getFieldTrackData()},fail:t=>{}})}else{let t={appName:this.props.item.appName.appName,appId:this.props.item.appName.appGuid,deviceType:null==(e=this.props.item)?void 0:e.deviceType,mode:"add"};this.setState({isFieldTrack:!0,fieldTrackData:t})}}})})})]})}),""!==(null==(C=this.props.item)?void 0:C.deviceType)&&""!==(null==(j=this.props.item)?void 0:j.appname)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{end:!0!==(null==(T=this.props.item)?void 0:T.deviceType.toLowerCase().includes("android"))||null===this.props.item.subScreenName||""===this.props.item.subScreenName,children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{label:"Conversion screen",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Conversion screen",errorMessage:null==(D=null==(k=null==(I=this.props)?void 0:I.item)?void 0:k.errorMessage)?void 0:D.errMainscreen,data:this.state.appScreenList||[],textField:"displayName",dataItemKey:"activityName",value:""!==(null==(N=null==(w=null==(A=this.props)?void 0:A.item)?void 0:w.mainScreenName)?void 0:N.displayName)?null==(E=null==(L=this.props)?void 0:L.item)?void 0:E.mainScreenName:"-- Select screen --",onChange:t=>{this.props.item.mainScreenName=t.target.value,this.props.item.errorMessage.errMainscreen=t.target.value.displayName.length>0?null:"Select screen",this.forceUpdate()}})})]})}),Ti.jsx(Ti.Fragment,{children:!0===(null==(B=this.props.item)?void 0:B.deviceType.toLowerCase().includes("android"))&&null!==this.props.item.subScreenName&&""!==this.props.item.subScreenName?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:{span:3,offset:0},children:Ti.jsx(Ao,{label:"Conversion sub screen",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Conversion sub screen",errorMessage:null==(F=null==(P=null==(M=this.props)?void 0:M.item)?void 0:P.errorMessage)?void 0:F.errSubscreen,data:this.state.appSubScreenList||[],value:null==(R=null==(U=this.props)?void 0:U.item)?void 0:R.subScreenName,onChange:t=>{this.props.item.subScreenName=t.target.value,this.props.item.errorMessage.errSubscreen=t.target.value.length>0?null:"Select sub screen",this.forceUpdate()}})})]})}):null})]}):null,this.state.fieldTrackList.length>0&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.FieldTrackingCom,{deviceType:null==(O=this.props.item)?void 0:O.deviceType})})]})})})})]})})]})}},ji(Si,"contextType",Ji),Si);const Kd=["Android phone","iPhone","Android tablet","iPad"],Yd=[{text:"Primary goal",mobile:[{device:"",appName:"",mainscreen:"",subscreen:"",template:""}]}];class Xd extends Di.Component{constructor(){super(...arguments),ji(this,"state",{saveError:!1,errMsg:null,json:Yd,platformArr:Yd.platform,screenList:[],subscreen:[],mobileApps:{},errAnalyticsPlatform:null,errConversionForm:null,selectAnalytics:{name:"-- Select analytics --",id:0},treeUpdate:0,goalList:[{text:"Goal 1",mobile:[]}],savePreference:!1}),ji(this,"componentDidUpdate",(t=>{var e;if(this.props!==t){if(null!==this.props.smartAppStoreUrl&&(null==(e=this.props.smartAppStoreUrl[0])?void 0:e.smartAppStoreUrl)){let t=[{text:"Goal 1",mobile:JSON.parse(this.props.smartAppStoreUrl[0].smartAppStoreUrl).mobilePlatform}];this.props.appAnalytics.Goals=t,this.props.appAnalytics.Goals.map(((t,e)=>{t.mobile.map(((t,e)=>{t.errorMessage={errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null}}))})),this.setState({goalList:t})}let t=tp.filter((t=>t.domainType===this.props.appAnalytics.analyticsType))[0];this.setState({selectAnalytics:t}),this.forceUpdate()}})),ji(this,"getDataFromServer",(()=>{os({path:ol,params:{campaignId:this.props.campaignId},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{if(!0===t.status&&t.data){if(null!==t.data.objanalyticsjson.smartAppStoreUrl&&void 0!==t.data.objanalyticsjson.smartAppStoreUrl){let e=[{text:"Goal 1",mobile:JSON.parse(t.data.objanalyticsjson.smartAppStoreUrl).mobilePlatform}];this.props.appAnalytics.Goals=e,this.props.appAnalytics.Goals.map(((t,e)=>{t.mobile.map(((t,e)=>{t.errorMessage={errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null}}))})),this.setState({goalList:e}),this.forceUpdate()}if(null!==t.data.objanalyticsjson.appDataJSON&&void 0!==t.data.objanalyticsjson.appDataJSON){let e=JSON.parse(t.data.objanalyticsjson.appDataJSON),i=[{text:"Goal 1",mobile:e.mobileDataJson}];if(null!==e.analyticsType&&void 0!==e.analyticsType){let t=tp.filter((t=>t.domainType===e.analyticsType))[0];this.setState({selectAnalytics:t})}this.props.appAnalytics.Goals=i,this.props.appAnalytics.Goals.map(((t,e)=>{t.mobile.map(((t,e)=>{t.errorMessage={errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null}}))})),this.setState({goalList:i}),this.forceUpdate()}}else this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})})),ji(this,"saveMobileAppAnalytics",(t=>{let e=JSON.parse(this.props.smartAppStoreUrl[0].smartAppStoreUrl).web.url;if(!0===es())return void(t?this.props.history.push("/campaign"):this.props.history.push("completion",{campaignId:Ln(),smartAppStore:e,dynamicListId:this.props.dynamicListId}));let i=this.props.appAnalytics.Goals[0].mobile,s={analyticsType:this.state.selectAnalytics.domainType,campaignId:this.props.campaignId,mobileAppGuId:i[0].appName.appGuid,mobileDataJson:i,recipientFormID:"0"};os({path:rl,params:s,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:i=>{i.status?t?this.props.history.push("/campaign"):this.props.history.push("completion",{campaignId:this.props.campaignId,smartAppStore:e,dynamicListId:this.props.dynamicListId}):this.setState({saveError:!0,errMsg:(null==i?void 0:i.message)||cs})},fail:t=>{}})})),ji(this,"nextMobileApp",(()=>{if(Is("JSON",this.props.appAnalytics.Goals),0===this.state.selectAnalytics.id)return void this.setState({errAnalyticsPlatform:cl});let t=!1;for(let e=0;e<this.props.appAnalytics.Goals[0].mobile.length;e++){let i=this.props.appAnalytics.Goals[0].mobile[e];!1===Wd(i)&&(this.setState({treeUpdate:this.state.treeUpdate+1}),t=!0)}t&&this.saveMobileAppAnalytics(!1)}))}componentDidMount(){var t;if(null!==this.props.smartAppStoreUrl&&(null==(t=this.props.smartAppStoreUrl[0])?void 0:t.smartAppStoreUrl)){let t=[{text:"Goal 1",mobile:JSON.parse(this.props.smartAppStoreUrl[0].smartAppStoreUrl).mobilePlatform}];this.props.appAnalytics.Goals=t,this.props.appAnalytics.Goals.map(((t,e)=>{t.mobile.map(((t,e)=>{t.errorMessage={errDevice:null,errAppname:null,errMainscreen:null,errSubscreen:null,errTemplate:null}}))})),this.setState({goalList:t})}let e=tp.filter((t=>t.domainType===this.props.appAnalytics.analyticsType))[0];this.setState({selectAnalytics:e}),this.forceUpdate()}render(){return Ti.jsxs("div",{className:"box-design bd-top-border reference-analytics-carousal",children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),Ti.jsxs(Jl,{className:"custom-column d-none",children:[Ti.jsx(Zl,{md:4,children:Ti.jsx("label",{className:"label-row",children:"Analytics platform"})}),Ti.jsx(Zl,{md:7,children:Ti.jsxs("div",{className:"position-relative",children:[this.state.errAnalyticsPlatform&&Ti.jsx("div",{className:"validation-message",children:this.state.errAnalyticsPlatform}),Ti.jsx(Hl,{data:tp,textField:"name",dataItemKey:"id",value:this.state.selectAnalytics,onChange:t=>{let e=t.target.value.name.length>0?null:cl;this.setState({errAnalyticsPlatform:e}),this.props.appAnalytics.analyticsPlatform=t.target.value,this.setState({selectAnalytics:t.target.value}),this.forceUpdate()}})]})})]}),this.state.goalList[0].mobile.length>0&&Ti.jsx("div",{children:Ti.jsx(Jd,{savePreference:this.state.savePreference,clickOff:this.props.editClickOff,json:this.props.appAnalytics.Goals,campaignId:this.props.campaignId,changeSavePreference:t=>{this.setState({savePreference:t})}})}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),Ti.jsx(zs,{onClick:()=>{if(Is("JSON",this.props.appAnalytics.Goals),0===this.state.selectAnalytics.id)return void this.setState({errAnalyticsPlatform:cl});let t=!1;for(let e=0;e<this.props.appAnalytics.Goals[0].mobile.length;e++){let i=this.props.appAnalytics.Goals[0].mobile[e];!1===Wd(i)&&(this.setState({treeUpdate:this.state.treeUpdate+1}),t=!0)}t&&this.saveMobileAppAnalytics(!0)},children:"Save"}),Ti.jsx(ns,{onClick:()=>{if(Is("JSON",this.props.appAnalytics.Goals),0===this.state.selectAnalytics.id)return void this.setState({errAnalyticsPlatform:cl});let t=!1;for(let e=0;e<this.props.appAnalytics.Goals[0].mobile.length;e++){let i=this.props.appAnalytics.Goals[0].mobile[e];!1===Wd(i)&&(this.setState({treeUpdate:this.state.treeUpdate+1}),t=!0)}t&&this.saveMobileAppAnalytics(!1)},children:"Next"})]})]})}}ji(Xd,"contextType",Ji);const Qd=wi(Xd),tp=[{name:"SmartDX Analytics",id:3,domainType:"RA"}];class ep extends Di.Component{constructor(){super(...arguments),ji(this,"state",{index:0,loading:!1,appanalyticksJson:null,smartAppStoreUrl:null,webanalyticksJson:null,tabData:[{text:"Web",iconLeft:"icon-rs-web-analytics-medium icons-lg"},{text:"Mobile",iconLeft:"icon-rs-mobile-analytics-medium icons-lg"}],saveBtn:!0,saveError:!1,errMsg:null}),ji(this,"renderComponents",[]),ji(this,"addTabData",(()=>{var t,e,i,s;if(0===this.state.index){let a=null==(e=null==(t=this.props)?void 0:t.analyticsType)?void 0:e.map((t=>({text:t,iconLeft:sp[t.toLowerCase()]})));this.setState({index:(null==(s=null==(i=this.props)?void 0:i.analyticsType)?void 0:s.length)>1&&16===this.props.channelId?1:(16===this.props.channelId||this.props.channelId,0),tabData:a||[]})}})),ji(this,"componentDidUpdate",((t,e)=>{this.props!==t&&this.props.history.location.pathname})),ji(this,"componentDidMount",(t=>{this.addTabData()})),ji(this,"RenderComponents",(t=>{var e;let i=[];return null==(e=this.props.analyticsType)||e.map((t=>{"web"===t.toLowerCase()?i.push(Ti.jsx($d,{isWebFieldTrack:this.props.isWebFieldTrack,campaignPlan:this.props.campaignPlan,webAnalytics:this.props.webAnalytics,smartlinkUrl:this.props.smartlinkUrl,data:this.props.webAnalytics,webData:this.props.webData,mobileData:this.props.mobileData,dynamicListId:this.props.dynamicListId,smartAppStoreUrl:this.props.smartAppStore,editClickOff:this.props.editClickOff,isNext:!0,analyticsType:this.props.analyticsType,campaignId:this.props.campaignId,proceedBtnClick:this.props.proceedBtnClick,moveNext:t=>{this.setState({index:t})},isFieldTrackEnabled:t=>{this.props.isFieldTrackEnabled(t)},clientClose:t=>{this.props.clientClose(t)},fieldTrackSuccess:t=>{this.props.fieldTrackSuccess(t)}})):i.push(Ti.jsx(Qd,{campaignPlan:this.props.campaignPlan,appAnalytics:this.props.appAnalytics,data:this.props.appAnalytics,webData:this.props.webData,mobileData:this.props.mobileData,editClickOff:this.props.editClickOff,dynamicListId:this.props.dynamicListId,analyticsType:this.props.analyticsType,smartAppStoreUrl:this.props.smartAppStore,campaignId:this.props.campaignId,proceedBtnClick:this.props.proceedBtnClick,isSaveBtn:t=>{this.setState({isSaveBtn:t})}}))})),i[t]})),ji(this,"getDataFromServer",(()=>{os({path:dl,isCache:!1,params:{campaignId:this.props.campaignId},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,s,a,n,l;t.status&&t.data?this.setState({webanalyticksJson:(null==(e=t.data)?void 0:e.webanalyticksJson)&&JSON.parse(null==(i=t.data)?void 0:i.webanalyticksJson),appanalyticksJson:(null==(s=t.data)?void 0:s.appanalyticksJson)&&JSON.parse(null==(a=t.data)?void 0:a.appanalyticksJson),smartAppStoreUrl:(null==(n=t.data)?void 0:n.smartAppStoreUrl)&&JSON.parse(null==(l=t.data)?void 0:l.smartAppStoreUrl)}):this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})}))}render(){return Ti.jsxs(Ti.Fragment,{children:[Ti.jsx("div",{className:"horizontal-tab-wrapper",children:this.state.tabData?Ti.jsx(Pi,{defaultSelectedItem:this.state.index,defaultClass:"",dynamicTab:"rs-tab-icon rs-tab-horizontal",activeClass:"active",tabData:this.state.tabData,callBack:(t,e)=>{this.setState({index:e})}}):null}),Ti.jsx("div",{className:"clearfix"}),this.RenderComponents(this.state.index),!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}})]})}}ji(ep,"contextType",Ji);const ip=wi(ep),sp={web:"icon-rs-web-analytics-medium icons-lg",app:"icon-rs-mobile-analytics-medium icons-lg"},ap={authuringType:"Web push",campaignName:"Amazon campaign",campaignPeriod:"Wed, Oct 28 - Fri, Nov 05",campaignType:"Promotion",campaignGoal:"Conversion",domainList:[{sdkDomain:"mybank.com",domainUrl:"https://mybank.com"},{sdkDomain:"mybank.com",domainUrl:"https://mybank.com"},{sdkDomain:"visionbank.com",domainUrl:"https://visionbank.com"},{sdkDomain:"visionbank.com",domainUrl:"https://visionbank.com"},{sdkDomain:"visionbank.com",domainUrl:"https://visionbank.com"},{sdkDomain:"www.visionretail.com",domainUrl:"https://www.visionretail.com"}],webInboxClassifications:["Credit card","Debit card"],push:{chennalName:"Web push",domainId:"",domainName:{domainUrl:"-- Select domain --",onBoardingId:-1},domainLevel:{domainLevelId:0,domainLevel:"-- Select push type --"},weburl:"",pushType:{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},inboxClassification:{cdId:0,classificationId:"-- Inbox classification --"},pushLayout:{pushLayoutValue:"-- Select push layout --",pushLayoutId:0},position:{positionValue:"-- Select position --",positionId:0},isCarousel:!1,isSplit:!1,secure:!1,sound:"",expiry:"",requestForApproval:{isWorkflowEnabled:!1,matchType:"",matchCount:"",approvarList:[{approvarId:"",approvarName:"",flag:!1}]},content:[{splitType:"",title:"",shortDesc:"",titleColor:"",bgColor:"",makeAlert:!1,subTitle:"",body:"",bodyTextColor:"",bodyBgColor:"",contentType:"",htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",timezone:"",timezoneId:"",makeAsAlert:!0,isInteractivebuttonEnabled:!1,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"-- Select alert sound --",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"",interActivityButton2Name:"",interActivity:[],hashTag:[]}]}},np={authuringType:"Mobile push",campaignName:"Flipkart campaign",campaignPeriod:"Wed, Oct 06, 2021 - Fri, Nov 05,",campaignType:"Awareness",campaignGoal:"Conversion",mobileApps:[{appName:"Vision Bank",appId:"6036e22e-4a43-40e1-ba90-b6000917dc45"},{appName:"Vision Retail",appId:"7036e22e-4a43-40e1-ba90-b6000917dc40"}],deliveryTypes:[{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},{deliveryTypeValue:"Alert / Rich push",deliveryTypeId:1},{deliveryTypeValue:"In-app messaging",deliveryTypeId:2},{deliveryTypeValue:"In-app inbox",deliveryTypeId:3}],customSounds:["Notification","Emergency"],layoutPositions:[{pushLayoutValue:"-- Select push layout --",pushLayoutId:0},{pushLayoutValue:"Full screen",pushLayoutId:1},{pushLayoutValue:"Modal",pushLayoutId:3},{pushLayoutValue:"Carousel",pushLayoutId:4}],positions:[{positionValue:"-- Select position --",positionId:0},{positionValue:"Top",positionId:1},{positionValue:"Bottom",positionId:2},{positionValue:"Center",positionId:3}],push:{appId:"6036e22e-4a43-40e1-ba90-b6000917dc45",appName:"Vision Bank",mobileApp:{appName:"-- Mobile app --",appId:"0"},deliveryType:{deliveryTypeValue:"-- Delivery type --",deliveryTypeId:0},inboxClassification:{cdId:0,classificationId:"-- Inbox classification --"},pushLayout:{pushLayoutValue:"-- Select push layout --",pushLayoutId:0},position:{positionValue:"-- Select position --",positionId:0},isCarousel:!1,isSplit:!1,secure:!1,sound:"",expiry:"",requestForApproval:{isWorkflowEnabled:!1,matchType:"",matchCount:"",approvarList:[{approvarId:"",approvarName:"",flag:!1}]},content:[{splitType:"",title:"",shortDesc:"",titleColor:"",bgColor:"",subTitle:"",body:"",bodyTextColor:"",bodyBgColor:"",contentType:"",htmlContent:"",htmlContentUrl:"",templateId:null,templateName:"",banner:"",bannerType:"",edmContent:"",bannerImage:"",scheduleDate:"",localScheduleTime:"",timezoneId:"",timezone:"",makeAsAlert:!0,splitRange:2,isAutoSchedule:!0,campaignPerFormanceBy:"content",splitDuration:8,splitInterval:"Hours",isInteractivebuttonEnabled:!1,isExpiryButtonEnabled:!1,isAlertSound:!1,alertSound:"-- Select alert sound --",pushExpiryhours:0,pushexpirySchedule:"",interActivityButton1Name:"-- Select --",interActivityButton2Name:"-- Select --",interActivity:[],hashTag:[]}]}},lp={analyticsPlatform:"",domainName:"",conversionAction:"",conversionURLs:[{conversionUrl:""}],analyticsPlatforms:["Resulticks Analytics","Google Analytics"],conversionActions:["Signup","Purchase","Lead"],domainNames:["http://www.visionbank.com/home/","http://visionbank.com/item/view?id=360703170135"]},op={analyticsPlatform:"",conversionForm:"",analyticsType:"RA",Goals:[{text:"Primary goal",mobile:[{deviceType:"",appName:{appName:"",appGuid:""},appGuid:"",mainScreenName:{displayName:"",activityName:"",deepLinkUrl:""},subScreenName:"",conversionScreen:"",conversionSubscreen:"",conversionTemplate:""}]}],analyticsPlatforms:["Resulticks mobile app analytics","Google mobile app analytics"],conversionForms:["Promotional credit card offers Form","International travel card Form","Credit card form","Invest smartly, save money Form"]},rp=wi((t=>{const{smartAppStore:e,authorizationData:i,accessToken:s,handleNext:a,handleNextLoading:n,showSmartLink:l,history:o}=t,r=Di.useContext(Ji),[c,d]=Di.useState(null),[p,h]=Di.useState(!1);return Di.useState(s||""),Di.useEffect((()=>{i&&Object.keys(i).length>0&&(d(i),h(!0))}),[i]),Di.useEffect((()=>{r.globalStateData.setIsLoadingData(!0),setTimeout((()=>{r.globalStateData.setIsLoadingData(!1)}),2e3)}),[]),p?Ti.jsx("div",{className:"email-notification-container",children:c&&Ti.jsx(pr,{authorizationData:c,emailAuthoring:!0,handleNext:a,handleNextLoading:n,MoveEmailOnboard:e=>{e&&t.history.push({pathname:"/preferences/communication-settings",search:"?addSmtp=true"})},MoveEmailOnboardFooter:e=>{e&&t.history.push({pathname:"/preferences/communication-settings",search:"?isFooter=true"})},MoveUnsubscriptionModule:e=>{e&&t.history.push({pathname:"/preferences/communication-settings",search:"?isUnsubscription=true"})}})}):Ti.jsx("div",{className:"email-notification-container",children:Ti.jsx("div",{className:"loading-state",children:"Loading authorization data..."})})}));class cp extends Di.Component{render(){var t;return Ti.jsx(dp,{history:null==(t=this.props)?void 0:t.history,context:this.context})}}ji(cp,"contextType",Ji);class dp extends Di.Component{constructor(){super(...arguments),ji(this,"state",{isGetWebData:!1,isGetMobileData:!1,isWebUpdate:!1,isMobileUpdate:!1,index:0,dynamicListId:0,webdata:null,mobiledata:null,header:null,webnotification:{},mobilenotification:{},webAnalytics:Bs({...lp}),appAnalytics:Bs({...op}),smartAppStore:null,confirmAlert:!1,mobileApp:"",isSmartlinkCreated:!1,tabData:[],domainUrl:"",channelId:null,isWebFieldTrack:!1,smartLinkData:null,analyticsType:null,campaignPlan:null,cdata:null,campaignId:0,mode:"edit",smartlinkUrl:"",isFieldTrackEnabled:!1,clientClose:!1,fieldTrackSuccess:!1,proceedBtnClick:!1,websplitabSchedule:null,mobsplitabSchedule:null,rfaList:[],authData:{},accessToken:"",tabChannelId:null}),ji(this,"parsed",no.parse(window.location.search)),ji(this,"getEmail_DomainData",(()=>{const t=fs();let e={clientId:null==t?void 0:t.clientId,userId:null==t?void 0:t.userId};os({path:pl,isCache:!1,payLoad:e,ok:t=>{(null==t?void 0:t.status)?(this.setState((e=>({authData:{...e.authData,authoringData:{...e.authData.authoringData,domainData:null==t?void 0:t.data}}}))),this.getApprovalList_Data(e)):this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,domainData:[]}}})))},fail:t=>{this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,domainData:[]}}})))}})})),ji(this,"getApprovalList_Data",(t=>{Ja(),os({path:Za,isCache:!1,payLoad:t,ok:e=>{(null==e?void 0:e.status)?(this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,approvalMailListData:(null==e?void 0:e.data)||[]}}}))),this.getUnsub_Data(t)):this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,approvalMailListData:[]}}})))},fail:t=>{this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,approvalMailListData:[]}}})))}})})),ji(this,"getEmail_FooterData",(t=>{os({path:hl,isCache:!1,payLoad:t,ok:e=>{(null==e?void 0:e.status)?(this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,footerData:null==e?void 0:e.data}}}))),this.getUnsub_Data(t)):this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,footerData:[]}}})))},fail:t=>{this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,footerData:[]}}})))}})})),ji(this,"getUnsub_Data",(t=>{os({path:ul,isCache:!1,payLoad:t,ok:t=>{(null==t?void 0:t.status)?this.setState((e=>({authData:{...e.authData,authoringData:{...e.authData.authoringData,unsubscriptionMessageListData:null==t?void 0:t.data}}}))):this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,unsubscriptionMessageListData:[]}}})))},fail:t=>{this.setState((t=>({authData:{...t.authData,authoringData:{...t.authData.authoringData,unsubscriptionMessageListData:[]}}})))}})})),ji(this,"componentDidMount",(t=>{var e,i,s,a,n;const l=localStorage.getItem("session"),o=JSON.parse(l),r=o?o.accessToken:"";this.setState({accessToken:r});const c=fs();window.addEventListener("ftracksuccess",(()=>{this.setState({clientClose:!0})}));const d=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let p=void 0!==d.cId?d.cId:0;if(void 0!==localStorage.getItem(`camp_${p}`)&&null!==localStorage.getItem(`camp_${p}`)){let t=ks(localStorage.getItem(`camp_${p}`)),e=(null==(s=null==t?void 0:t.notifyData)?void 0:s.channelId)||null;null!==(null==d?void 0:d.chId)&&void 0!==(null==d?void 0:d.chId)&&(e=parseInt(null==d?void 0:d.chId));let i={authoringData:{accessId:{campaignId:p,channelId:this.state.channelId,clientId:null==c?void 0:c.clientId,userId:null==c?void 0:c.userId,campaignType:"T",campaignGuid:"",accessToken:r,projectId:"1"},tabsData:[],senderName:"resuluser24acc ",senderDomainName:"New domian setting",senderEmailAddress:"infotest",domainData:[{smtpDomainSettingId:1,createdDate:"2025-06-28 06:29:21",domainName:"abc.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:2,createdDate:"2025-06-28 06:29:21",domainName:"resul.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:3,createdDate:"2025-06-28 06:29:21",domainName:"new.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:4,createdDate:"2025-06-28 06:29:21",domainName:"seg.com",senderEmailID:null,senderName:null}],audienceListData:[{value:"auidence10 (3)",label:"Auidence 10 (3)"},{value:"auidence20 (30)",label:"Auidence 20 (30)"},{value:"auidence30 (90)",label:"Auidence 30 (90)"},{value:"auidence40 (30)",label:"Auidence 40 (30)"},{value:"auidence50 (30)",label:"Auidence 50 (30)"},{value:"auidence60 (30)",label:"Auidence 60 (30)"}],unsubscriptionMessageListData:[]}};this.setState({cdata:t,campaignId:p,channelId:e,authData:i}),"add"===(null==(a=null==t?void 0:t.notifyData)?void 0:a.mode)?(this.setState({mode:"add"}),this.prepareCampaignHeader(null==(n=null==t?void 0:t.notifyData)?void 0:n.campaignJson,!0)):this.getWebNotificationDetails(!0,p,this.state.channelId,(t=>{}))}else this.getWebNotificationDetails(!0,p,this.state.channelId,(t=>{}))})),ji(this,"prepareCampaignHeader",((t,e)=>{var i,s,a;let n=JSON.parse(t);e?this.setState({dynamicListId:parseInt(null==(i=null==n?void 0:n.dynamicList)?void 0:i.dynamicListId)}):this.setState({dynamicListId:parseInt(null==n?void 0:n.dynamicListId)}),this.setState({campaignPlan:n});let l=[],o="channelType";e&&(o="channelTypes"),n[o].map((t=>{"web push"===t.toLowerCase()?l.push({text:"Web push",iconLeft:"icon-rs-web-notification-large icons-lg",channelId:8}):"email"===t.toLowerCase()?l.push({text:"Email",iconLeft:"icon-rs-mobile-notification-medium icons-lg",channelId:1}):"mobile push"===t.toLowerCase()&&l.push({text:"Mobile push",iconLeft:"icon-rs-mobile-notification-medium icons-lg",channelId:14})})),(null==n?void 0:n.analyticsType.length)>0&&l.push({text:"Analytics",iconLeft:"icon-rs-analytics-medium icons-lg",channelId:6});const r=no.parse(null==(a=null==(s=this.props.history)?void 0:s.location)?void 0:a.search);void 0!==r.webft&&r.webft&&this.setState({channelId:6,isWebFieldTrack:!0}),l.some((t=>1===(null==t?void 0:t.channelId)))&&this.getEmail_DomainData(),this.setState({tabData:l,analyticsType:n.analyticsType});const c=ms(),d={name:n.campaignName,startDate:n.startDate,endDate:n.endDate,goal:(null==n?void 0:n.primaryTargetCode)||(null==n?void 0:n.goal),type:!0===e?n.campaignAttribute.attributeName:c.campaignAttributeList.filter((t=>t.campaignAttributeId===n.campaignAttributeId))[0].attributeName};this.setState({header:d}),e&&(this.setState({webdata:{notificationData:Bs({...ap})},mobiledata:{notificationData:Bs({...np})}}),this.setState({confirmAlert:!1,isSmartlinkCreated:!1}))})),ji(this,"getEmailData",(t=>{var e,i,s,a,n,l,o,r,c,d,p;const h=fs();let u={authoringData:{accessId:{campaignId:null==t?void 0:t.campaignId,channelId:this.state.channelId,clientId:null==h?void 0:h.clientId,userId:null==h?void 0:h.userId,campaignType:null==t?void 0:t.campaignType,campaignGuid:"",accessToken:this.state.accessToken,projectId:"1"},tabsData:[],senderName:null==t?void 0:t.senderName,smtpDomainSettingID:null==t?void 0:t.smtpDomainSettingID,senderDomainName:"resul.com",senderEmailAddress:null==t?void 0:t.senderEmail,isReplyMailEnabled:null==t?void 0:t.isReplyMailEnabled,splitAB:null==t?void 0:t.senderEmail,subjectLineData:null==(e=null==t?void 0:t.content[0])?void 0:e.subjectLine,contentType:null==(i=null==t?void 0:t.content[0])?void 0:i.contentType,contentUrl:null==(s=null==t?void 0:t.content[0])?void 0:s.contentUrl,isRequestForApprovalEnabled:null==t?void 0:t.isRequestForApprovalEnabled,isRequestForApprovalScheduled:null==t?void 0:t.isRequestForApprovalScheduled,testCampaignEmailAddress:null==t?void 0:t.testCampaignEmailAddress,requestForApproval:null==t?void 0:t.requestForApproval,messagesEditor:null==(a=null==t?void 0:t.content[0])?void 0:a.body,isUnsubscribeEnabled:null==(n=null==t?void 0:t.content[0])?void 0:n.isUnsubscribeEnabled,inboxFirstLineMessage:null==(l=null==t?void 0:t.content[0])?void 0:l.inboxFirstLineMessage,unsubscriptionMessage:null==(o=null==t?void 0:t.content[0])?void 0:o.unsubscriptionMessage,footerId:null==(r=null==t?void 0:t.content[0])?void 0:r.footerId,isFooterEnabled:null==(c=null==t?void 0:t.content[0])?void 0:c.isFooterEnabled,messageEditor:null==(d=null==t?void 0:t.content[0])?void 0:d.body,edm_ChannelId:null==(p=null==t?void 0:t.content[0])?void 0:p.edmChannelId,domainData:[{smtpDomainSettingId:1,createdDate:"2025-06-28 06:29:21",domainName:"abc.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:2,createdDate:"2025-06-28 06:29:21",domainName:"resul.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:3,createdDate:"2025-06-28 06:29:21",domainName:"new.com",senderEmailID:null,senderName:null},{smtpDomainSettingId:4,createdDate:"2025-06-28 06:29:21",domainName:"seg.com",senderEmailID:null,senderName:null}],audienceListData:[{value:"auidence10 (3)",label:"Auidence 10 (3)"},{value:"auidence20 (30)",label:"Auidence 20 (30)"},{value:"auidence30 (90)",label:"Auidence 30 (90)"},{value:"auidence40 (30)",label:"Auidence 40 (30)"},{value:"auidence50 (30)",label:"Auidence 50 (30)"},{value:"auidence60 (30)",label:"Auidence 60 (30)"}],unsubscriptionMessageListData:[],approvalMailListData:[]}};this.setState({authData:u})})),ji(this,"getWebNotificationDetails",((t,e,i,s)=>{var a,n;let l={campaignId:e,channelId:null!=i?i:8},o=1==i?vl:yl;const r=no.parse(null==(n=null==(a=this.props.history)?void 0:a.location)?void 0:n.search);void 0!==r.cId&&r.cId,null==r||r.webft,this.props.context.globalStateData.setIsLoadingData,os({path:o,isCache:!1,params:l,sessionOut:this.props.context.globalStateData.setSessionOutData,retry:2,retryTime:5e3,ok:e=>{var i,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f,x,S,C,j,T,I,k,D,A,w,N,L,E,B;if(this.setState({isGetWebData:!0}),no.parse(window.location.search),e.status){if((null==(a=null==(i=e.data)?void 0:i.emailchannelJson)?void 0:a.length)>0){let t=JSON.parse(null==(n=e.data)?void 0:n.emailchannelJson);this.getEmailData(t)}if(this.setState({smartlinkUrl:null==(o=null==(l=e.data)?void 0:l.smartappurl[0])?void 0:o.smartUrl}),null!==(null==(r=null==e?void 0:e.data)?void 0:r.websplitabSchedule)&&void 0!==(null==(c=null==e?void 0:e.data)?void 0:c.websplitabSchedule)&&this.setState({websplitabSchedule:null==(d=null==e?void 0:e.data)?void 0:d.websplitabSchedule}),null!==(null==(p=null==e?void 0:e.data)?void 0:p.mobsplitabSchedule)&&void 0!==(null==(h=null==e?void 0:e.data)?void 0:h.mobsplitabSchedule)&&this.setState({mobsplitabSchedule:null==(u=null==e?void 0:e.data)?void 0:u.mobsplitabSchedule}),null===e.data.campaignJson||void 0===e.data.campaignJson||""==e.data.campaignJson){const t={name:"Channel Name",startDate:new Date,endDate:new Date,goal:"Awareness",type:"Reach"};return void this.setState({header:t})}if(this.prepareCampaignHeader(e.data.campaignJson),null!==(null==(m=e.data)?void 0:m.smartappurl)&&void 0!==(null==(v=e.data)?void 0:v.smartappurl)&&""!==(null==(y=e.data)?void 0:y.smartappurl)&&this.setState({smartAppStore:e.data.smartappurl}),null==(b=null==(g=e.data)?void 0:g.smartappurl)?void 0:b.length){let t=null==(f=e.data)?void 0:f.smartappurl,i=JSON.parse(null==(x=t[0])?void 0:x.smartAppStoreUrl);if(this.setState({confirmAlert:!1,smartLinkData:i,isSmartlinkCreated:!0,smartLinkPopUp:!1}),void 0!==i.mobilePlatform&&i.mobilePlatform.length>0){let t={appId:i.mobilePlatform[0].appName.appGuid};localStorage.setItem("appDet",ts(t)),this.setState({mobileApp:i.mobilePlatform[0].appName||{appName:"-- Select app--",appGuid:"123435556"}})}}else this.setState({confirmAlert:!1});if(!1===t)return;if(void 0!==localStorage.getItem("wcdetails")&&null!==localStorage.getItem("wcdetails")){let t=Ml(JSON.parse(localStorage.getItem("wcdetails")));this.setState({domainUrl:t.push.domainName.domainUrl});let e={notificationData:Bs({...t})};this.setState({webdata:e,isWebUpdate:!0})}else if(null!==(null==(S=e.data)?void 0:S.webchannelJson)&&void 0!==(null==(C=e.data)?void 0:C.webchannelJson)&&""!==(null==(j=e.data)?void 0:j.webchannelJson)){let t=Ml(JSON.parse(null==(T=e.data)?void 0:T.webchannelJson)),i={webUrl:t.push.domainName.domainUrl};localStorage.setItem("webDet",ts(i)),this.setState({domainUrl:t.push.domainName.domainUrl});let s={notificationData:Bs({...t})};this.setState({webdata:s,isWebUpdate:!0})}else this.setState({webdata:{notificationData:Bs({...ap})}});if(void 0!==localStorage.getItem("mcdetails")&&null!==localStorage.getItem("mcdetails")){let t=Pl(JSON.parse(localStorage.getItem("mcdetails"))),e={notificationData:Bs({...t})};this.setState({mobiledata:e,isMobileUpdate:!0})}else if(null!==(null==(I=e.data)?void 0:I.mobilechannelJson)&&void 0!==(null==(k=e.data)?void 0:k.mobilechannelJson)&&""!==(null==(D=e.data)?void 0:D.mobilechannelJson)){let t=Pl(JSON.parse(e.data.mobilechannelJson)),i={notificationData:Bs({...t})};this.setState({mobiledata:i,isMobileUpdate:!0})}else this.setState({mobiledata:{notificationData:Bs({...np})}});if(null!==(null==(A=e.data)?void 0:A.appanalyticksJson)&&void 0!==(null==(w=e.data)?void 0:w.appanalyticksJson)&&""!==(null==(N=e.data)?void 0:N.appanalyticksJson)){Is("appanalyticksJson",JSON.parse(e.data.appanalyticksJson));let t=JSON.parse(e.data.appanalyticksJson);this.setState({appAnalytics:t})}if(null!==(null==(L=e.data)?void 0:L.webanalyticksJson)&&void 0!==(null==(E=e.data)?void 0:E.webanalyticksJson)&&""!==(null==(B=e.data)?void 0:B.webanalyticksJson)){Is("appanalyticksJson",JSON.parse(e.data.webanalyticksJson));let t=JSON.parse(e.data.webanalyticksJson);this.setState({webAnalytics:t})}}else this.setState({websplitabSchedule:!1,mobsplitabSchedule:!1}),this.setState({webdata:{notificationData:Bs({...ap})},mobiledata:{notificationData:Bs({...np})}});s(!0)},fail:t=>{this.setState({isGetWebData:!0,webdata:{notificationData:Bs({...ap})},mobiledata:{notificationData:Bs({...np})}}),s(!0)}})})),ji(this,"allComponents",(t=>{var e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g,b,f;return{5:Ti.jsx(jo,{clickoff:null==(i=null==(e=this.state.cdata)?void 0:e.notifyData)?void 0:i.editClickOff,smartlinks:[],mode:"edit",isNotification:!0,campaignId:this.state.campaignId,plannerData:JSON.parse(localStorage.getItem("cpsmartlink"+this.state.campaignId)),buttonClicked:t=>{var e,i,s,a;const n=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let l=void 0!==n.cId?n.cId:0;if(void 0!==localStorage.getItem(`camp_${l}`)&&null!==localStorage.getItem(`camp_${l}`)){let t=ks(localStorage.getItem(`camp_${l}`));t.notifyData.mode="edit",localStorage.setItem(`camp_${l}`,ts(t))}void 0!==t&&void 0!==t[0]&&(null==(a=null==(s=t[0])?void 0:s.channels)?void 0:a.length)>0&&(this.getWebNotificationDetails(!1,this.state.campaignId,this.state.channelId,(e=>{let i={web:void 0!==t[0].web?t[0].web:{},mobilePlatform:void 0!==t[0].mobile?t[0].mobile:[]};this.setState({confirmAlert:!1,smartLinkData:i,smartLinkPopUp:!1,mobileApp:t[0]&&t[0].mobile[0]&&t[0].mobile[0].appName||""})})),this.setState({mode:"edit"})),this.setState({smartLinkPopUp:!1})}}),8:Ti.jsx(kd,{campaignId:this.state.campaignId,webdata:null==(s=this.state.webdata)?void 0:s.notificationData,dynamicListId:this.state.dynamicListId,isSmartlinkCreated:this.state.isSmartlinkCreated,smartAppStore:this.state.smartAppStore,isAutoSchedule:this.state.websplitabSchedule,editClickOff:null==(n=null==(a=this.state.cdata)?void 0:a.notifyData)?void 0:n.editClickOff,isUpdate:this.state.isWebUpdate,statusId:null==(o=null==(l=this.state.cdata)?void 0:l.notifyData)?void 0:o.statusId,domainUrl:this.state.domainUrl,campaignPlan:this.state.campaignPlan,onClickShortlinkBtnClick:t=>{this.setState({smartLinkPopUp:t})},showSmartLink:()=>{this.setState({smartLinkPopUp:!0})},moveNext:t=>{var e;if(Is("moveNext",null==(e=this.state.webdata)?void 0:e.notificationData),this.setState({isWebUpdate:!0}),1===this.state.tabData.length){let t=JSON.parse(this.state.smartAppStore[0].smartAppStoreUrl).web.url;this.props.history.push("completion",{campaignId:this.state.campaignId,smartAppStore:t,dynamicListId:this.state.dynamicListId})}if(this.state.tabData.length>t){let e=this.state.tabData[t];return 1===e.channelId?void this.setState({index:t,channelId:1}):14===e.channelId?void this.setState({index:t,channelId:14}):void this.setState({index:this.state.tabData.length-1,channelId:this.state.analyticsType.length>1||"App"===this.state.analyticsType[0]?6:16})}},isFieldTrackEnabled:()=>{this.setState({isFieldTrackEnabled:!0,clientClose:!1,fieldTrackSuccess:!1})}}),1:Ti.jsx(rp,{smartAppStore:this.state.smartAppStore,showSmartLink:()=>{this.setState({smartLinkPopUp:!0})},authorizationData:this.state.authData,accessToken:this.state.accessToken,emailAuthoring:!0,handleNext:t=>{if(this.props.context.globalStateData.setIsLoadingData(!1),1===this.state.tabData.length){let t=JSON.parse(this.state.smartAppStore[0].smartAppStoreUrl).web.url;this.props.history.push("completion",{campaignId:this.state.campaignId,smartAppStore:t,dynamicListId:this.state.dynamicListId})}if(this.state.tabData.length>t){let e=this.state.tabData[t];return 1===e.channelId?void this.setState({index:t,channelId:1}):14===e.channelId?void this.setState({index:t,channelId:14}):void this.setState({index:this.state.tabData.length-1,channelId:this.state.analyticsType.length>1||"App"===this.state.analyticsType[0]?6:16})}},handleNextLoading:t=>{t&&this.props.context.globalStateData.setIsLoadingData(!0)},MoveEmailOnboard:t=>{t&&this.props.history.push({pathname:"/preferences/communication-settings",search:"?footer=true"})}}),14:Ti.jsx(Bd,{campaignId:this.state.campaignId,mobileApp:this.state.mobileApp,smartLinkData:this.state.smartLinkData,dynamicListId:this.state.dynamicListId,isSmartlinkCreated:this.state.isSmartlinkCreated,smartAppStore:this.state.smartAppStore,isAutoSchedule:this.state.mobsplitabSchedule,campaignPlan:this.state.campaignPlan,onClickShortlinkBtnClick:t=>{this.setState({smartLinkPopUp:t})},mobiledata:null==(r=this.state.mobiledata)?void 0:r.notificationData,editClickOff:null==(d=null==(c=this.state.cdata)?void 0:c.notifyData)?void 0:d.editClickOff,statusId:null==(p=this.state.cdata)?void 0:p.statusId,isUpdate:this.state.isMobileUpdate,enableSmartLink:()=>{this.setState({smartLinkPopUp:!0})},showSmartLink:()=>{this.setState({smartLinkPopUp:!0})},moveNext:t=>{if(this.setState({isMobileUpdate:!0}),1===this.state.tabData.length){let t=JSON.parse(this.state.smartAppStore[0].smartAppStoreUrl).web.url;this.props.history.push("completion",{campaignId:this.state.campaignId,smartAppStore:t,dynamicListId:this.state.dynamicListId})}if(2===this.state.tabData.length){let e=this.state.tabData[t-1];if(1===e.channelId)return void this.setState({index:t,channelId:1});if(14===e.channelId){let t=JSON.parse(this.state.smartAppStore[0].smartAppStoreUrl).web.url;return void this.props.history.push("completion",{campaignId:this.state.campaignId,smartAppStore:t,dynamicListId:this.state.dynamicListId})}this.setState({index:t,channelId:this.state.analyticsType.length>1?6:"App"===this.state.analyticsType[0]?16:6})}if(this.state.tabData.length>t){if(1===this.state.tabData[t].channelId)return void this.setState({index:t,channelId:1})}else this.setState({index:t,channelId:this.state.analyticsType.length>1?6:"App"===this.state.analyticsType[0]?16:6})}}),6:Ti.jsx(ip,{isWebFieldTrack:this.state.isWebFieldTrack,smartlinkUrl:this.state.smartlinkUrl,campaignPlan:this.state.campaignPlan,channelId:this.state.channelId,webAnalytics:this.state.webAnalytics,webData:null==(h=this.state.webdata)?void 0:h.notificationData,mobileData:null==(u=this.state.mobiledata)?void 0:u.notificationData,dynamicListId:this.state.dynamicListId,appAnalytics:this.state.appAnalytics,analyticsType:this.state.analyticsType,smartAppStore:this.state.smartAppStore,editClickOff:null==(v=null==(m=this.state.cdata)?void 0:m.notifyData)?void 0:v.editClickOff,campaignId:this.state.campaignId,proceedBtnClick:this.state.proceedBtnClick,isFieldTrackEnabled:()=>{this.setState({isFieldTrackEnabled:!0,clientClose:!1,fieldTrackSuccess:!1})},clientClose:()=>{this.setState({clientClose:!0,fieldTrackSuccess:!1})},fieldTrackSuccess:()=>{this.setState({fieldTrackSuccess:!0,clientClose:!1})}}),16:Ti.jsx(ip,{isWebFieldTrack:this.state.isWebFieldTrack,smartlinkUrl:this.state.smartlinkUrl,campaignPlan:this.state.campaignPlan,channelId:this.state.channelId,webAnalytics:this.state.webAnalytics,webData:null==(y=this.state.webdata)?void 0:y.notificationData,mobileData:null==(g=this.state.mobiledata)?void 0:g.notificationData,appAnalytics:this.state.appAnalytics,dynamicListId:this.state.dynamicListId,smartAppStore:this.state.smartAppStore,editClickOff:null==(f=null==(b=this.state.cdata)?void 0:b.notifyData)?void 0:f.editClickOff,analyticsType:this.state.analyticsType,campaignId:this.state.campaignId,proceedBtnClick:this.state.proceedBtnClick,isFieldTrackEnabled:()=>{this.setState({isFieldTrackEnabled:!0})},clientClose:()=>{this.setState({clientClose:!0})},fieldTrackSuccess:()=>{this.setState({fieldTrackSuccess:!0})}})}[t]})),ji(this,"progressSteps",[{status:"complete",steps:"1",steps_title:"Plan"},{status:"inProcess",steps:"2",steps_title:"Create"},{status:"pending",steps:"3",steps_title:"Analyze and execute"}]),ji(this,"getContentData",(()=>{let t="";return this.state.isFieldTrackEnabled?t="Waiting for event set":this.state.clientClose||this.state.fieldTrackSuccess,t}))}render(){var t,e,i,s,a,n,l,o,r,c;return Ti.jsxs(Ti.Fragment,{children:[Ti.jsxs(Ui,{children:[!0===this.state.confirmAlert?Ti.jsx(kl,{para:ml,secondaryButtonText:"Not now",primaryButtonText:"Yes",buttonClicked:t=>{!0===t&&this.setState({smartLinkPopUp:!0})}}):null,Ti.jsx(Kl,{fluid:!0,className:"main-heading-wrapper mb0",children:Ti.jsxs(Kl,{className:"mhw-container",children:[Ti.jsx("div",{className:"mhwc-left",children:Ti.jsx("h1",{children:Ti.jsx("div",{className:"mh-wrapper",children:Ti.jsx("span",{className:"mh-text",children:"Create communication"})})})}),Ti.jsx("div",{className:"mhwc-right"})]})}),Ti.jsxs(Kl,{className:"page-header",children:[null!==this.state.header?Ti.jsx(To,{progressSteps:this.progressSteps,progressStepsClass:"reference-notification-progress-label theme-space-mx-del",header:this.state.header,type:"editplan",editsmart:!0,isSmartlinkCreate:this.state.isSmartlinkCreated,buttonClicked:t=>{var e,i,s,a;if(2===t)this.setState({smartLinkPopUp:!0});else if(1===t){const t=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let n="";n=(null==t?void 0:t.cs)?t.cs:null==(a=null==(s=this.state.cdata)?void 0:s.notifyData)?void 0:a.statusId,this.props.history.push({pathname:"/campaign/planning",search:`?cId=${Ln()}&sl=false&cs=${n}`})}}}):Ti.jsx(go,{}),Ti.jsx("div",{className:"",children:Ti.jsxs("div",{className:"tabs-wrapper",children:[Ti.jsx("div",{className:"tabs-vertical",children:null!==this.state.header?Ti.jsx(Pi,{mainClass:"stricky-window vertical-notification",tabData:this.state.tabData,defaultSelectedItem:this.state.index,defaultSelectedObjectKey:"channelId",defaultSelectedObjectValue:16===(null==(t=this.state)?void 0:t.channelId)?6:(null==(e=this.state)?void 0:e.channelId)||null,defaultClass:"",dynamicTab:"vertical-tabs",activeClass:"active",callBack:(t,e)=>{this.setState({index:e,channelId:null==t?void 0:t.channelId,tabChannelId:null==t?void 0:t.channelId}),this.getWebNotificationDetails(!1,this.state.campaignId,null==t?void 0:t.channelId,(t=>{}))}}):null}),Ti.jsx("div",{className:"tab-vertical-content",children:this.state.mobiledata||this.state.webdata?(null==(i=this.state)?void 0:i.channelId)?this.allComponents(null==(s=this.state)?void 0:s.channelId):(null==(n=null==(a=this.state)?void 0:a.tabData[this.state.index])?void 0:n.channelId)?this.allComponents(null==(o=null==(l=this.state)?void 0:l.tabData[this.state.index])?void 0:o.channelId):null:null})]})}),Ti.jsxs(_l,{show:this.state.smartLinkPopUp,size:"xl",className:"modal-top-fixed",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Smart Link"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>this.setState({smartLinkPopUp:!1})})]}),Ti.jsx(_l.Body,{children:Ti.jsx("div",{className:"smart-link-popup-ui",children:Ti.jsx(jo,{clickoff:null==(c=null==(r=this.state.cdata)?void 0:r.notifyData)?void 0:c.editClickOff,smartlinks:[],mode:"edit",isNotification:!0,campaignId:this.state.campaignId,plannerData:JSON.parse(localStorage.getItem("cpsmartlink"+this.state.campaignId)),buttonClicked:t=>{var e,i,s,a;const n=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let l=void 0!==n.cId?n.cId:0;if(void 0!==localStorage.getItem(`camp_${l}`)&&null!==localStorage.getItem(`camp_${l}`)){let t=ks(localStorage.getItem(`camp_${l}`));t.notifyData.mode="edit",localStorage.setItem(`camp_${l}`,ts(t))}void 0!==t&&void 0!==t[0]&&(null==(a=null==(s=t[0])?void 0:s.channels)?void 0:a.length)>0&&(this.getWebNotificationDetails(!1,this.state.campaignId,this.state.channelId,(e=>{let i={web:void 0!==t[0].web?t[0].web:{},mobilePlatform:void 0!==t[0].mobile?t[0].mobile:[]};this.setState({confirmAlert:!1,smartLinkData:i,smartLinkPopUp:!1,mobileApp:t[0]&&t[0].mobile[0]&&t[0].mobile[0].appName||""})})),this.setState({mode:"edit"})),this.setState({smartLinkPopUp:!1})}})})})]})]})]}),this.getContentData().length>1&&Ti.jsx(hr,{content:this.getContentData(),isShowBtn:!0,proceedBtnClick:()=>{this.setState({isFieldTrackEnabled:!1,clientClose:!1,fieldTrackSuccess:!1,proceedBtnClick:!0}),window.location.reload(),setTimeout((()=>{this.setState({proceedBtnClick:!1})}),5e3)}})]})}}var pp,hp=null;class up extends Di.Component{constructor(){super(...arguments),ji(this,"state",{tickIcon:!1,smartUrls:"",saveError:!1,errMsg:null,conversationUrl:"",campaignPlan:null,errAnalyticsPlatform:null,errDomainName:null,errConversionAction:null,isDomainAddBtnClicked:!1,isOpenEventModal:!1,analyticsList:yp,selectAnalytics:{name:"SmartDX analytics",id:3,domainType:"SX"},domainList:[],selectWebDomain:{domainUrl:"-- Select web domain",domainId:"0"},selectConversation:{name:"-- Select conversation --",short:"A"},errConversionURL:[{errorMessage:null,domainNameSuccess:null,isError:!0},{errorMessage:null,domainNameSuccess:null,isError:!0},{errorMessage:null,domainNameSuccess:null,isError:!0},{errorMessage:null,domainNameSuccess:null,isError:!0},{errorMessage:null,domainNameSuccess:null,isError:!0}],conversationUrlList:[],isWebFieldTrack:!1,fieldTrackList:[],domainNameLoader:!1,domainNameSuccess:null,loaderPosition:null}),ji(this,"componentDidMount",(()=>{var t,e;let i=ms();this.setState({domainList:i.domainsList}),this.getDataFromServer(),this.getFieldTrackData();const s=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);void 0!==s.webft&&s.webft&&this.setState({isWebFieldTrack:!0});let a=void 0!==s.cId?parseInt(s.cId):0,n=localStorage.getItem(`camp_${a}`);if(null!=n){let t=ks(n);null!==t.plan&&void 0!==t.plan&&this.setState({campaignPlan:t.plan})}})),ji(this,"getFieldTrackData",(()=>{let t={campaignId:this.props.campaignId,deviceOs:"",deviceType:"Web",goalType:"P"};os({path:Wn,params:t,ok:t=>{var e,i,s,a,n,l,o,r,c;if(t.status&&(null==(i=null==(e=null==t?void 0:t.data)?void 0:e.capturedFields)?void 0:i.length)>0&&(null==(n=null==(a=null==(s=null==t?void 0:t.data)?void 0:s.capturedFields[0])?void 0:a.formFieldsToCapture)?void 0:n.length)>0){let e=JSON.parse(null==(o=null==(l=null==t?void 0:t.data)?void 0:l.capturedFields[0])?void 0:o.formFieldsToCapture);null==(r=null==e?void 0:e.fieldsInfo)||r.fieldCaptureList,this.setState({fieldTrackList:null==(c=null==t?void 0:t.data)?void 0:c.capturedFields})}},fail:t=>{}})})),ji(this,"FieldTrackingCom",(t=>{var e,i,s,a=null;return this.state.fieldTrackList.length>0&&(a=(null==(i=null==(e=null==(a=JSON.parse(this.state.fieldTrackList[0].formFieldsToCapture))?void 0:a.fieldsInfo)?void 0:e.fieldCaptureList)?void 0:i.length)>0?null==(s=null==a?void 0:a.fieldsInfo)?void 0:s.fieldCaptureList[0]:null),Ti.jsx(Ti.Fragment,{children:null!=a&&""!==(null==a?void 0:a.eventName)&&Ti.jsx($l,{children:Ti.jsxs(Jl,{className:"custom-column",children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Goal setup",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx("div",{className:"event-tracking-list",children:Ti.jsxs("div",{className:"event-section",children:[Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Event name"}),Ti.jsx("span",{className:"label-value",children:a.eventName})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Min duration"}),Ti.jsx("span",{className:"label-value",children:a.minDuration})]}),Ti.jsxs("div",{className:"event-row",children:[Ti.jsx("span",{className:"label-field",children:"Min length"}),Ti.jsx("span",{className:"label-value",children:a.minLength})]})]})})})]})})})})),ji(this,"setDefaultAnalytics",(()=>{Is("SLWebAnalytics",this.props.data),null!==this.props.data&&""!==this.props.data?(this.setState({conversationUrlList:[this.props.data]}),this.setState({selectAnalytics:vp.filter((t=>3===t.id))[0]})):this.setState({conversationUrlList:[""]})})),ji(this,"getDataFromServer",(()=>{os({path:_n,params:{campaignId:this.props.campaignId},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e;if(t.status&&t.data&&null!==t.data.analyticsjson&&void 0!==t.data.analyticsjson&&t.data.analyticsjson.length>0){let i=JSON.parse(t.data.analyticsjson);this.setState({smartUrls:null==(e=null==i?void 0:i.domainUrlList[0])?void 0:e.domainNameURL}),""!=this.state.smartUrls?this.setState({conversationUrl:this.state.smartUrls}):this.setState({conversationUrl:this.props.data}),""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1}),this.setState({selectAnalytics:vp.filter((t=>3===t.id))[0]}),ms();let s=[],a=[...this.state.errConversionURL];i.domainUrlList.map(((t,e)=>(t.conversionUrl=t.domainNameURL,t.validUrl=!0,s.push(t.domainNameURL),a[e].domainNameSuccess=!0,a[e].errorMessage=null,a[e].isError=!0,t))),this.setState({conversationUrlList:s,errConversionURL:a})}else{let t=[];t.push(this.props.data);let e=[...this.state.errConversionURL];t.map(((t,i)=>{e[i].domainNameSuccess=!0,e[i].errorMessage=null,e[i].isError=!0})),this.setState({conversationUrlList:t,errConversionURL:e}),this.setState({conversationUrl:this.props.data},(()=>{""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1})})),this.setDefaultAnalytics()}},fail:t=>{""!==this.state.conversationUrl?this.setState({tickIcon:!0}):this.setState({tickIcon:!1}),this.setDefaultAnalytics()}})})),ji(this,"getClickOff",(()=>this.state.conversationUrlList&&this.state.conversationUrlList.length>4?"click-off":"")),ji(this,"submit",(t=>{var e,i,s,a,n,l;let o=!1;if(!(this.state.conversationUrlList.length>0)){let t=[...this.state.errConversionURL];return t[0].errorMessage=`Enter valid  ${null==(l=null==(n=null==(a=null==(s=null==(i=null==(e=this.props)?void 0:e.history)?void 0:i.location)?void 0:s.state)?void 0:a.data)?void 0:n.campaignHeader)?void 0:l.goal.toLowerCase()} URL`,this.setState({errConversionURL:t}),void(o=!0)}!0!==o&&(this.state.conversationUrlList.map(((t,e)=>{var i,s,a,n,l,r;if(ss(t)||null!==this.state.errConversionURL[e].errorMessage){let t=[...this.state.errConversionURL];return t[e].errorMessage=`Enter valid  ${null==(r=null==(l=null==(n=null==(a=null==(s=null==(i=this.props)?void 0:i.history)?void 0:s.location)?void 0:a.state)?void 0:n.data)?void 0:l.campaignHeader)?void 0:r.goal.toLowerCase()} URL`,t[e].errorMessage=t[e].errorMessage,this.setState({errConversionURL:t}),void(o=!0)}})),!1!==o||this.saveWebAnalytics(t))})),ji(this,"saveWebAnalytics",(t=>{let e=[];this.state.conversationUrlList.map((t=>{let i={domainNameURL:t};e.push(i)}));let i={domainType:this.state.selectAnalytics.domainType,analyticsSettingId:this.state.selectAnalytics.id,campaignId:this.props.campaignId,channelId:6,domainUrlList:e};os({path:Jn,params:i,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{e.status?0===t?this.props.history.push("/campaign"):this.props.moveNext(1):this.setState({saveError:!0,errMsg:(null==e?void 0:e.message)||cs})},fail:t=>{}})})),ji(this,"checkWebsiteLocal",((t,e,i,s)=>{os({path:gl,params:{website:t},sessionOut:e.globalStateData.setSessionOutData,ok:t=>i(t),fail:t=>s(t)})})),ji(this,"domainNameValidation",((t,e,i)=>{this.setState({domainNameLoader:!0,loaderPosition:t}),this.checkWebsiteLocal(e,this.context,(t=>{this.setState({domainNameLoader:!1,loaderPosition:null}),i(t)}),(t=>{this.setState({domainNameLoader:!1,loaderPosition:null}),i({status:!1})}))})),ji(this,"addOrRemoveAnalytics",(t=>{if(0===t){if(!(this.state.conversationUrlList.length>0)){let e=[...this.state.errConversionURL];return e[t].errorMessage=Zn,void this.setState({errConversionURL:e})}{let t=!1;if(this.state.conversationUrlList.map(((e,i)=>{var s,a,n,l,o,r;if(ss(e)||null!==this.state.errConversionURL[i].errorMessage){let e=[...this.state.errConversionURL],c=`Enter ${null==(r=null==(o=null==(l=null==(n=null==(a=null==(s=this.props)?void 0:s.history)?void 0:a.location)?void 0:n.state)?void 0:l.data)?void 0:o.campaignHeader)?void 0:r.goal.toLowerCase()} URL`;return e[i].errorMessage=c,this.setState({errConversionURL:e}),void(t=!0)}})),this.getUniqueListBy1(this.state.conversationUrlList,"conversionUrl").length>0){let e=[...this.state.errConversionURL];return e[this.state.conversationUrlList.length-1].errorMessage="URL already exists",this.setState({errConversionURL:e}),void(t=!0)}if(t)return}if(this.state.conversationUrlList.length<5){let t=[...this.state.conversationUrlList],e=t[t.length-1],i=t.findIndex(((t,e)=>"https://"==t));if(!(e.length>=9)){let t=[...this.state.errConversionURL];return t[i].errorMessage=Zn,void this.setState({errConversionURL:t})}t.push("https://"),this.setState({conversationUrlList:t})}}else{let e=[...this.state.conversationUrlList];e.splice(t,1),this.setState({conversationUrlList:e});let i=[...this.state.errConversionURL];i[t].errorMessage=null,this.setState({errConversionURL:i})}})),ji(this,"enableFieldTracking",(t=>{var e,i;const s=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let a=void 0!==s.cId?s.cId:0;(pp=window.io.connect("https://mobsoc.resu.io/",{reconnection:!0})).on("connect",(()=>{pp.emit("new_user",{userName:"platform",domainName:t,appId:parseInt(a)})})),pp.on("closed",(t=>{try{hp.close(),t.status?!1===this.state.fieldTrackSuccess&&this.setState({fieldTrackSuccess:!0},(()=>{this.props.fieldTrackSuccess(!0)})):!1===this.state.fieldTrackClose&&this.setState({fieldTrackClose:!0},(()=>{this.props.clientClose(!0)}))}catch(e){}})),localStorage.setItem("fdomain",t);let n=window.location.pathname+window.location.search+"&webft=true",l=btoa(this.props.campaignId);hp=window.open(`${t}?_sdxId=${l}&path=${n}`),this.props.isFieldTrackEnabled(!0)})),ji(this,"onchangeConversionURL",((t,e)=>{var i,s,a,n,l,o;let r=t.length>0?null:`Enter valid  ${null==(o=null==(l=null==(n=null==(a=null==(s=null==(i=this.props)?void 0:i.history)?void 0:s.location)?void 0:a.state)?void 0:n.data)?void 0:l.campaignHeader)?void 0:o.goal.toLowerCase()} URL`,c=t.trim();if(c.length>=8){let t=[...this.state.errConversionURL];t[e].errorMessage=r,t[e].isError=!0,t[e].domainNameSuccess=null;let i=[...this.state.conversationUrlList];"https://"===c.toString().slice(0,8)&&(i[e]=c,this.setState({conversationUrl:c,errConversionURL:t,tickIcon:!1}),this.setState({conversationUrlList:i,tickIcon:!1,domainNameSuccess:null}))}}))}getUniqueListBy(t,e){return[...new Map(t.map((t=>[t[e],t]))).values()]}getUniqueListBy1(t,e){return t.filter(((e,i)=>t.indexOf(e)!==i))}render(){return Ti.jsxs("div",{className:"mt45 marginL23",children:[this.state.isWebFieldTrack&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs(_l,{fullscreen:!0,show:this.state.isWebFieldTrack,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Field tracking"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isWebFieldTrack:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(tr,{isWebFieldTrack:!0,fieldTrackData:this.state.fieldTrackData,domainName:this.state.conversationUrl,campaignId:this.props.campaignId,saveBtnClicked:t=>{this.setState({isWebFieldTrack:!1}),this.getFieldTrackData()},cancelBtnClicked:()=>{this.setState({isWebFieldTrack:!1})}})})]})}),this.state.conversationUrlList.length>0&&this.state.conversationUrlList.map(((t,e)=>{var i,s,a,n,l,o,r,c;return Ti.jsx($l,{children:Ti.jsxs(Jl,{className:`custom-column ${"Draft"===(null==(l=null==(n=null==(a=null==(s=null==(i=this.props)?void 0:i.history)?void 0:s.location)?void 0:a.state)?void 0:n.data)?void 0:l.status)?"":"edit"===(null==(o=this.props)?void 0:o.mode)&&"click-off"}`,children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{className:`${0!==e&&"d-none"}`,label:`${null==(r=this.state.campaignPlan)?void 0:r.goal} URL`,right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(ql,{required:!0,placeholder:`${null==(c=this.state.campaignPlan)?void 0:c.goal} URL`,val:t,isLoading:e==this.state.loaderPosition,iconPlaceholder:!0,iconName:null!==this.state.errConversionURL[e].domainNameSuccess?(this.state.errConversionURL[e].domainNameSuccess,""):"",errorMessage:this.state.errConversionURL[e].errorMessage,handleOnchange:t=>{this.onchangeConversionURL(t,e)},handleOnBlur:t=>{if(this.setState({tickIcon:!0}),0!==t.length){if(this.getUniqueListBy1(this.state.conversationUrlList,"conversionUrl").length>0){let t=[...this.state.errConversionURL];return t.map((t=>{t.errorMessage=null,t.isError=!1})),t[e].errorMessage="URL already exists",void this.setState({errConversionURL:t})}this.domainNameValidation(e,t,(i=>{var s,a,n,l,o,r;let c=null,d=[...this.state.errConversionURL];if(d.map((t=>{t.errorMessage=null,t.isError=!1})),!1===i.status){let t=`Enter valid ${null==(r=null==(o=null==(l=null==(n=null==(a=null==(s=this.props)?void 0:s.history)?void 0:a.location)?void 0:n.state)?void 0:l.data)?void 0:o.campaignHeader)?void 0:r.goal.toLowerCase()} URL`;d[e].errorMessage=t,d[e].isError=!0,d[e].domainNameSuccess=!1,c=!1}else d[e].errorMessage=null,d[e].isError=!1,d[e].domainNameSuccess=!0,c=!0;this.setState({conversationUrl:t,errConversionURL:d,domainNameSuccess:c});let p=[...this.state.conversationUrlList];p[e]=t,this.setState({conversationUrlList:p})}))}},onFocus:t=>{}})}),Ti.jsx(Zl,{md:1,children:Ti.jsx(xo,{children:Ti.jsxs(Xi,{children:[0===e&&Ti.jsx(Qi,{icon:Qn,iconColor:"blue",iconSize:"md",tooltip:"Field tracking",color:"blue",onClick:()=>{this.enableFieldTracking(t)}}),Ti.jsx(Qi,{icon:0===e?Ss:el,iconColor:"red",iconSize:"md",tooltip:0===e?"Add":"Remove",color:0===e?"blue":"red",mainClass:0===e&&5===this.state.conversationUrlList.length?"click-off":"",onClick:()=>{this.addOrRemoveAnalytics(e)}})]})})})]})})})),this.state.fieldTrackList.length>0&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.FieldTrackingCom,{deviceType:"Web"})}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),1===this.props.tabData.length?Ti.jsx(ns,{onClick:()=>{this.submit(0)},children:"Save"}):null,2===this.props.tabData.length?Ti.jsx(zs,{onClick:()=>{this.submit(0)},children:"Save"}):null,2===this.props.tabData.length&&Ti.jsx("div",{children:Ti.jsx(ns,{onClick:()=>{this.submit(1)},children:"Next"})})]}),this.state.isDomainAddBtnClicked&&Ti.jsxs(_l,{show:this.state.isDomainAddBtnClicked,centered:!0,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Google Analytics"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isDomainAddBtnClicked:!1})}})]}),Ti.jsxs(_l.Body,{children:[Ti.jsx("label",{children:"Select domain"}),Ti.jsx("div",{className:"portlet-box-theme border1 p0 mb15 css-scrollbar checkbox-list-box",children:Ti.jsx("ul",{className:"checkbox-list-modal",children:this.state.analyticsList.map(((t,e)=>Ti.jsx(Vl,{className:e%2==0?"even mb0":"mb0",lbl:t.text,checked:t.value,cb:i=>{t.value=i;let s=[...this.state.analyticsList];s[e].value=i,this.setState({analyticsList:s})}})))})})]}),Ti.jsx(_l.Footer,{children:Ti.jsx(ns,{className:"m0",onClick:()=>{this.setState({isDomainAddBtnClicked:!1})},children:"Add"})})]}),this.state.isOpenEventModal&&Ti.jsxs(_l,{show:this.state.isOpenEventModal,size:"xl",children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Event track"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isOpenEventModal:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx("img",{src:Pd})}),Ti.jsxs(_l.Footer,{children:[Ti.jsx(as,{onClick:()=>{this.setState({isOpenEventModal:!1})},children:"Cancel"}),Ti.jsx(ns,{className:"m0",onClick:()=>{this.setState({isOpenEventModal:!1})},children:"Set event"})]})]}),!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}})]})}}ji(up,"contextType",Ji);const mp=wi(up),vp=[{name:"SmartDX analytics",id:3,domainType:"SX"}],yp=[{text:"www.facebook.com/VisionBankAsiaBankways",value:!1},{text:"www.facebook.com/VisionBankJapan/",value:!1},{text:"www.facebook.com/VisionBankAustralia/",value:!1},{text:"www.facebook.com/VisionBankNZ/",value:!1},{text:"https://www.facebook.com/VisionBankIndia/",value:!1},{text:"https://www.facebook.com/VisionBankIndonesia/",value:!1},{text:"https://www.facebook.com/VisionBankMalaysia/",value:!1}],gp=t=>{let e=!1;return ss(t.deviceType)?(e=!0,t.errorMessage.errDevice="Select device",e):ss(t.appName.appName)?(e=!0,t.errorMessage.errAppname="Select app name",e):ss(t.mainScreenName.displayName)?(e=!0,t.errorMessage.errMainscreen="Select screen",e):e};class bp extends Di.Component{constructor(){super(...arguments),ji(this,"state",{index:0,mainClass:this.props.mainClass,isFieldTrack:!1,fieldTrackData:null}),ji(this,"tabs",[{text:"Primary goal"}]),ji(this,"renderComponents",(t=>{var e,i;return Ti.jsx("div",{children:Ti.jsx(Xl,{activeKey:"tab"+t,id:"uncontrolled-tab-example",className:"m0 border-0",children:Ti.jsx(Ql,{eventKey:"tab0",children:null==(i=null==(e=this.props)?void 0:e.json)?void 0:i.map(((t,e)=>Ti.jsx(xp,{history:this.props.history,mainClass:this.state.mainClass,index:e,item:t,context:this.props.context,filedTrack:t=>{this.setState({isFieldTrack:!0,fieldTrackData:t})}})))})})})}))}componentDidMount(){}render(){return Ti.jsx(Ti.Fragment,{children:Ti.jsx("div",{className:"split-container br0",children:this.renderComponents(this.state.index)})})}}ji(bp,"contextType",Ji);const fp=wi(bp);class xp extends Di.Component{constructor(){super(...arguments),ji(this,"state",{activationKey:"0",treeUpdate:0,mobileAppList:[],appScreenList:[],appSubScreenList:[],saveError:!1,errMsg:null,fieldTrackList:[],isFieldTrack:!1,fieldTrackData:null}),ji(this,"componentDidMount",(t=>{let e=ms();this.setState({mobileAppList:e.mobileAppsList}),this.getAppScreenList(),this.getAppSubScreenList(),this.getFieldTrackData()})),ji(this,"getFieldTrackData",(()=>{var t,e;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let s=void 0!==i.cId?i.cId:0;os({path:sl,params:{campaignId:s},ok:t=>{var e,i,s;t.status&&(null==(i=null==(e=null==t?void 0:t.data)?void 0:e.capturedFields)?void 0:i.length)>0&&this.setState({fieldTrackList:null==(s=null==t?void 0:t.data)?void 0:s.capturedFields})},fail:t=>{}})})),ji(this,"getAnalyticsData",(t=>{let e={eventName:""},i=this.state.fieldTrackList.filter((e=>e.deviceType.toLowerCase()===t.toLowerCase()));if(i.length>0){try{let t=JSON.parse(i[0].formFieldsToCapture);if(""===t.fieldsInfo)return;t.fieldsInfo.fieldCaptureList.map((t=>{e.goalName="true"===t.markAsGoal&&t.eventName,e.eventName=e.eventName.length>0?e.eventName+","+t.eventName:t.eventName,e.minDuration=t.minDuration,e.minLength=t.minLength}))}catch(s){}return e}return e})),ji(this,"FieldTrackingCom",(t=>{let e=this.getAnalyticsData(t.deviceType);return Ti.jsx(Ti.Fragment,{children:null!=e&&""!==(null==e?void 0:e.eventName)&&Ti.jsx(Ti.Fragment,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Goal setup",right:!0})}),Ti.jsxs(Zl,{md:7,children:[Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:"Goal"}),Ti.jsx(Zl,{children:e.goalName})]}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:"Event name"}),Ti.jsx(Zl,{children:e.eventName})]}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:"Min duration"}),Ti.jsx(Zl,{children:e.minDuration})]}),Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{children:"Min length"}),Ti.jsx(Zl,{children:e.minLength})]})]}),Ti.jsx(Zl,{children:Ti.jsx("i",{className:"icon-rs-pencil-edit-medium icons-md blue",onClick:()=>{var t;let e={appName:this.props.item.appName.appName,appId:this.props.item.appName.appGuid,deviceType:null==(t=this.props.item)?void 0:t.deviceType,mode:"edit"};this.props.filedTrack(e)}})})]})})})})),ji(this,"getDeviceList",(()=>Sp)),ji(this,"getAppScreenList",(t=>{var e,i;let s={appId:null==(i=null==(e=this.props.item)?void 0:e.appName)?void 0:i.appId,deviceType:void 0!==this.props.item.deviceType&&""!==this.props.item.deviceType?this.props.item.deviceType:"Mobile",isdeepLink:this.props.item.isDeeplinkEnabled,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:al,params:s,ok:t=>{var e;t.status?this.setState({appScreenList:(null==(e=null==t?void 0:t.data)?void 0:e.appScreensList)||[]}):this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})})),ji(this,"getAppSubScreenList",(()=>{var t,e;let i={appId:null==(e=null==(t=this.props.item)?void 0:t.appName)?void 0:e.appId,deviceType:void 0!==this.props.item.deviceType&&""!==this.props.item.deviceType?this.props.item.deviceType:"Mobile",screenName:this.props.item.mainScreenName.displayName,databaseName:"SmartDX_e7be7449_b573_4e29_a427_a46e36288409"};os({path:nl,params:i,ok:t=>{var e;t.status?this.setState({appSubScreenList:(null==(e=null==t?void 0:t.data)?void 0:e.appSubScreensList)||[]}):this.setState({saveError:!0,errMsg:(null==t?void 0:t.message)||cs})},fail:t=>{}})}))}render(){var t,e,i,s,a,n,l,o,r,c,d,p,h,u,m,v,y,g;return Ti.jsxs("div",{className:`rs-accordin-container ${this.props.mainClass??""}`,children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),this.state.isFieldTrack&&Ti.jsxs(_l,{fullscreen:!0,show:this.state.isFieldTrack,children:[Ti.jsxs(_l.Header,{children:[Ti.jsx("h2",{children:"Field tracking"}),Ti.jsx(zl,{mainClass:"close",size:"md",handleClose:()=>{this.setState({isFieldTrack:!1})}})]}),Ti.jsx(_l.Body,{children:Ti.jsx(tr,{isWebFieldTrack:!1,fieldTrackData:this.state.fieldTrackData,saveBtnClicked:t=>{this.setState({isFieldTrack:!1}),this.getFieldTrackData()},cancelBtnClicked:()=>{this.setState({isFieldTrack:!1})}})})]}),Ti.jsx(to,{className:"rs-accordin",activeKey:this.state.activationKey,children:Ti.jsxs(eo,{eventKey:this.props.index.toString(),children:[Ti.jsx(eo.Header,{onClick:()=>{this.state.activationKey===this.props.index.toString()?this.setState({activationKey:"-1"}):this.setState({activationKey:this.props.index.toString()})},children:Ti.jsx("div",{className:"rs-accordin-header",children:Ti.jsxs("div",{className:"d-flex align-items-center",children:[Ti.jsx("i",{className:`icons-md ${this.state.activationKey!==this.props.index.toString()?"icon-rs-square-plus-fill-medium blue":"icon-rs-square-minus-fill-medium grey-medium"} marginR8`}),Ti.jsxs("h3",{className:"marginB0",children:[" ",""!==(null==(t=this.props.item)?void 0:t.deviceType)?null==(e=this.props.item)?void 0:e.deviceType:"Device types"," "]})]})})}),Ti.jsx(to.Collapse,{eventKey:this.props.index.toString(),children:Ti.jsx(eo.Body,{children:Ti.jsx("div",{className:"rs-accordin-panel",children:Ti.jsxs("div",{className:"rs-accordin-body",id:"collapseOne","aria-labelledby":"headingOne",children:[Ti.jsx("div",{className:"marginT5"}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Device type",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,disabled:!0,label:"Device type",errorMessage:null==(a=null==(s=null==(i=this.props)?void 0:i.item)?void 0:s.errorMessage)?void 0:a.errDevice,data:this.getDeviceList()||[],value:void 0!==(null==(n=this.props.item)?void 0:n.deviceType)&&""!==(null==(l=this.props.item)?void 0:l.deviceType)?null==(o=this.props.item)?void 0:o.deviceType:"-- Select --",onChange:t=>{this.props.item.deviceType=t.target.value,this.props.item.errorMessage.errDevice=t.target.value.length>0?null:"Select device",this.setState({treeUpdate:this.state.treeUpdate+1})}})})]})}),Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Mobile app",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Mobile app",errorMessage:null==(d=null==(c=null==(r=this.props)?void 0:r.item)?void 0:c.errorMessage)?void 0:d.errAppname,disabled:!0,data:[],value:void 0!==this.props.item.appName.appName&&""!==this.props.item.appName.appName?this.props.item.appName.appName:"-- Select --",onChange:t=>{this.props.item.appname=t.target.value,this.props.item.errorMessage.errAppname=t.target.value.length>0?null:"Select app name",this.setState({treeUpdate:this.state.treeUpdate+1}),this.forceUpdate()}})}),Ti.jsx(Zl,{md:2,children:Ti.jsx(ws,{text:"Field tracking",position:"top",children:Ti.jsx("i",{className:this.state.fieldTrackList.length>0&&this.getAnalyticsData(this.props.item.deviceType).eventName.length>0?"icon-rs-refresh-medium icons-md blue":"icon-rs-event-tracking-medium color-primary-blue icons-md",onClick:()=>{var t;if(this.getAnalyticsData(this.props.item.deviceType).eventName.length>0){let t={formFieldsToCapture:"",campaignId:this.props.campaignId,appId:this.props.item.appName.appId,deviceOs:this.props.item.deviceType.toLowerCase().includes("an")?"Android":"iOS",deviceType:this.props.item.deviceType,goalType:"P"};os({path:SAVE_FIELD_TRACK,params:t,ok:t=>{!0===t.status&&this.getFieldTrackData()},fail:t=>{}})}else{let e={appName:this.props.item.appName.appName,appId:this.props.item.appName.appGuid,deviceType:null==(t=this.props.item)?void 0:t.deviceType,mode:"add"};this.setState({fieldTrackData:e,isFieldTrack:!0}),this.props.filedTrack(e)}}})})})]})}),""!==(null==(p=this.props.item)?void 0:p.deviceType)&&""!==(null==(h=this.props.item)?void 0:h.appname)?Ti.jsxs(Ti.Fragment,{children:[Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Conversion screen",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Screen name",errorMessage:null==(v=null==(m=null==(u=this.props)?void 0:u.item)?void 0:m.errorMessage)?void 0:v.errMainscreen,data:this.state.appScreenList||[],textField:"displayName",dataItemKey:"activityName",value:""!==this.props.item.mainScreenName.displayName?this.props.item.mainScreenName:"-- Select screen --",onChange:t=>{this.props.item.mainScreenName=t.target.value,this.props.item.errorMessage.errMainscreen=t.target.value.displayName.length>0?null:"Select screen",this.forceUpdate()}})})]})}),Ti.jsx(Ti.Fragment,{children:!0===(null==(y=this.props.item)?void 0:y.deviceType.toLowerCase().includes("android"))&&null!==this.props.item.subScreenName&&""!==this.props.item.subScreenName?Ti.jsx($l,{children:Ti.jsxs(Jl,{children:[Ti.jsx(Zl,{md:3,children:Ti.jsx(Ao,{label:"Conversion sub screen",right:!0})}),Ti.jsx(Zl,{md:7,children:Ti.jsx(Ul,{required:!0,label:"Sub screen",data:this.state.appSubScreenList||[],value:this.props.item.subScreenName,onChange:t=>{this.props.item.subScreenName=t.target.value,this.props.item.errorMessage.errSubscreen=t.target.value.length>0?null:"Select sub screen",this.forceUpdate()}})})]})}):null})]}):null,this.state.fieldTrackList.length>0&&Ti.jsx(Ti.Fragment,{children:Ti.jsx(this.FieldTrackingCom,{deviceType:null==(g=this.props.item)?void 0:g.deviceType})})]})})})})]})})]})}}ji(xp,"contextType",Ji);const Sp=["Android phone","iPhone","Android tablet","iPad"];class Cp extends Di.Component{constructor(){super(...arguments),ji(this,"state",{saveError:!1,errMsg:null,screenList:[],subscreen:[],mobileApps:{},errAnalyticsPlatform:null,errConversionForm:null,selectAnalytics:{name:"SmartDX Analytics",id:3},treeUpdate:0,goalList:[{text:"Goal 1",mobile:[]}],mobileAnalyticsList:[]}),ji(this,"componentDidUpdate",(t=>{})),ji(this,"getDataFromServer",(()=>{var t,e;const i=no.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let s=void 0!==i.cId&&i.cId;os({path:ol,params:{campaignId:this.props.campaignId},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,a,n,l,o,r,c,d;if(!0===t.status&&t.data)if(null!==(null==(i=null==(e=t.data)?void 0:e.objanalyticsjson)?void 0:i.appDataJSON)&&void 0!==(null==(n=null==(a=t.data)?void 0:a.objanalyticsjson)?void 0:n.appDataJSON)){let e=JSON.parse(null==(o=null==(l=t.data)?void 0:l.objanalyticsjson)?void 0:o.appDataJSON);this.setState({mobileAnalyticsList:e.mobileDataJson})}else if(null!==t.data.objanalyticsjson.smartAppStoreUrl&&void 0!==t.data.objanalyticsjson.smartAppStoreUrl){let e=JSON.parse(t.data.objanalyticsjson.smartAppStoreUrl);if((null==(r=null==e?void 0:e.mobilePlatform)?void 0:r.length)>0)this.setState({mobileAnalyticsList:e.mobilePlatform});else{let t=localStorage.setItem(`camp_${s}`);if(null!=t){let e=ts(t);(null==(c=null==e?void 0:e.mobileAnaltics)?void 0:c.length)>0&&this.setState({mobileAnalyticsList:null==e?void 0:e.mobileAnaltics})}}}else{let t=localStorage.getItem(`camp_${s}`);if(null!=t){let e=ks(t);(null==(d=null==e?void 0:e.mobileAnaltics)?void 0:d.length)>0&&this.setState({mobileAnalyticsList:null==e?void 0:e.mobileAnaltics})}}},fail:t=>{}})})),ji(this,"saveMobileAppAnalytics",(t=>{let e=this.state.mobileAnalyticsList,i={analyticsType:this.state.selectAnalytics.domainType,campaignId:this.props.campaignId,mobileAppGuId:e[0].appName.appGuid,mobileDataJson:e,recipientFormID:"0"};os({path:rl,params:i,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:e=>{e.status?t&&this.props.history.push("/campaign"):this.setState({saveError:!0,errMsg:(null==e?void 0:e.message)||cs})},fail:t=>{}})}))}componentDidMount(){this.getDataFromServer()}render(){var t,e,i,s,a,n,l,o;return Ti.jsxs("div",{className:"theme-space-mt marginL20-del",children:[!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:this.state.errMsg,primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}}),Ti.jsx("div",{className:`custom-column ${"Draft"===(null==(a=null==(s=null==(i=null==(e=null==(t=this.props)?void 0:t.history)?void 0:e.location)?void 0:i.state)?void 0:s.data)?void 0:a.status)?"":"edit"===(null==(n=this.props)?void 0:n.mode)&&"click-off"}`,children:(null==(l=this.state.mobileAnalyticsList)?void 0:l.length)>0&&Ti.jsx(fp,{mainClass:"w100p",json:this.state.mobileAnalyticsList})}),Ti.jsxs("div",{className:"btn-container d-flex justify-content-end theme-space-mt",children:[Ti.jsx(as,{onClick:()=>{this.props.history.push("/campaign")},children:"Cancel"}),(null==(o=this.state.mobileAnalyticsList)?void 0:o.length)?Ti.jsx(ns,{className:"",onClick:()=>{var t;if(0===this.state.selectAnalytics.id)return void this.setState({errAnalyticsPlatform:cl});let e=!1;for(let i=0;i<(null==(t=this.state.mobileAnalyticsList)?void 0:t.length);i++){let t=this.state.mobileAnalyticsList[i];!1===gp(t)&&(this.setState({treeUpdate:this.state.treeUpdate+1}),e=!0)}e&&this.saveMobileAppAnalytics(!0)},children:"Save"}):null]})]})}}ji(Cp,"contextType",Ji);const jp=wi(Cp);class Tp extends Di.Component{constructor(){super(...arguments),ji(this,"state",{index:0,loading:!1,appanalyticksJson:null,smartAppStoreUrl:null,webanalyticksJson:null,tabData:[],saveBtn:!0,saveError:!1,progressSteps:[{status:"complete",steps:"1",steps_title:"Plan"},{status:"complete",steps:"2",steps_title:"Create"},{status:"inProcess",steps:"3",steps_title:"Finish"}],webUrl:"",mobileData:[],header:null,plannedData:null,campaignId:0,mode:"",isFieldTrackEnabled:!1,clientClose:!1,fieldTrackSuccess:!1}),ji(this,"renderComponents",[]),ji(this,"addTabData",(t=>{let e=[];t.map((t=>{"web"===t.toLowerCase()&&e.push({text:"Web",iconLeft:"icon-rs-web-analytics-medium icons-lg"}),"app"===t.toLowerCase()&&e.push({text:"Mobile",iconLeft:"icon-rs-mobile-analytics-medium icons-lg"})})),this.setState({tabData:e})})),ji(this,"componentDidMount",(t=>{var e,i;const s=no.parse(null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.search);let a=void 0!==s.cId?parseInt(s.cId):0,n=localStorage.getItem(`camp_${a}`);if(null!=n){let t=ks(n);if(this.setState({header:t.plan,campaignId:a,plannedData:t}),t.mobileAnaltics.length>0)this.addTabData(t.analyticsType);else{let e=[];e.push(t.analyticsType[0]),this.addTabData(e)}}})),ji(this,"getDataFromServer",(()=>{var t,e,i,s,a;const n={campaignId:null==(a=null==(s=null==(i=null==(e=null==(t=this.props)?void 0:t.history)?void 0:e.location)?void 0:i.state)?void 0:s.data)?void 0:a.campaignId};os({path:bl,params:n,loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{var e,i,s,a,n;if(t.status&&void 0!==t.data&&null!==t.data[0].smartAppStoreUrl){let l=Io(t.data,null==(n=null==(a=null==(s=null==(i=null==(e=this.props)?void 0:e.history)?void 0:i.location)?void 0:s.state)?void 0:a.data)?void 0:n.campaignId,!1);this.setState({webUrl:l[0].web.url,mobileData:l[0].mobile})}},fail:t=>{}})})),ji(this,"getContentData",(()=>{let t="";return this.state.isFieldTrackEnabled?t="Waiting for event set":this.state.clientClose?t="Client closed unexpected":this.state.fieldTrackSuccess&&(t="Field tracking enabled successfully"),t})),ji(this,"RenderComponents",(t=>{let e=[];return this.state.tabData.map((t=>{var i,s,a,n,l,o,r,c,d,p,h,u;"web"===t.text.toLowerCase()?e.push(Ti.jsx(mp,{data:null==(i=this.state.plannedData)?void 0:i.webAnalytics,mode:null==(o=null==(l=null==(n=null==(a=null==(s=this.props)?void 0:s.history)?void 0:a.location)?void 0:n.state)?void 0:l.data)?void 0:o.mode,campaignId:this.state.campaignId,tabData:this.state.tabData,isFieldTrackEnabled:()=>{this.setState({isFieldTrackEnabled:!0,clientClose:!1,fieldTrackSuccess:!1})},clientClose:()=>{this.setState({clientClose:!0,isFieldTrackEnabled:!1,fieldTrackSuccess:!1})},fieldTrackSuccess:()=>{this.setState({fieldTrackSuccess:!0,isFieldTrackEnabled:!1,clientClose:!1})},moveNext:t=>{this.setState({index:t})}})):e.push(Ti.jsx(jp,{data:null==(r=this.state.plannedData)?void 0:r.mobileAnaltics,mode:null==(u=null==(h=null==(p=null==(d=null==(c=this.props)?void 0:c.history)?void 0:d.location)?void 0:p.state)?void 0:h.data)?void 0:u.mode,tabData:this.state.tabData,campaignId:this.state.campaignId}))})),e[t]})),ji(this,"PageHeader",(t=>Ti.jsx(Ti.Fragment,{children:Ti.jsxs("div",{className:"header-title d-flex justify-content-between",children:[Ti.jsx("h1",{children:"Create communication"}),Ti.jsxs("div",{className:"back-text",onClick:()=>this.props.history.push("/campaign"),children:[Ti.jsx(Qi,{icon:sa,size:"sm"}),"Back"]})]})}))),ji(this,"PageHeader2",(()=>Ti.jsx("div",{className:"marginB23",children:Ti.jsx(To,{progressSteps:[{status:"complete",steps:"1",steps_title:"Plan"},{status:"complete",steps:"2",steps_title:"Create"},{status:"inProcess",steps:"3",steps_title:"Finish"}],header:this.state.header,buttonClicked:t=>{var e,i,s,a,n,l,o,r,c,d,p,h;this.props.history.push("/campaign/planning",{mode:null==(a=null==(s=null==(i=null==(e=this.props.history)?void 0:e.location)?void 0:i.state)?void 0:s.data)?void 0:a.mode,isSmartlinkCampaign:!0,status:null==(r=null==(o=null==(l=null==(n=this.props.history)?void 0:n.location)?void 0:l.state)?void 0:o.data)?void 0:r.status,campaignId:null==(h=null==(p=null==(d=null==(c=this.props.history)?void 0:c.location)?void 0:d.state)?void 0:p.data)?void 0:h.campaignId})}})})))}render(){return Ti.jsxs(Ui,{children:[this.getContentData().length>1&&Ti.jsx(hr,{content:this.getContentData(),isShowBtn:!this.state.isFieldTrackEnabled,proceedBtnClick:()=>{this.setState({isFieldTrackEnabled:!1,clientClose:!1,fieldTrackSuccess:!1})}}),Ti.jsx(Kl,{fluid:!0,className:"main-heading-wrapper mb0",children:Ti.jsxs(Kl,{className:"mhw-container",children:[Ti.jsx("div",{className:"mhwc-left",children:Ti.jsx("h1",{children:Ti.jsx("div",{className:"mh-wrapper",children:Ti.jsx("span",{className:"mh-text",children:"Create communication"})})})}),Ti.jsx("div",{className:"mhwc-right"})]})}),Ti.jsx(Kl,{className:"page-header",children:Ti.jsxs(Kl,{children:[Ti.jsxs("div",{className:"",children:[null!==this.state.header&&Ti.jsx(this.PageHeader2,{}),Ti.jsxs("div",{className:"portlet-box-theme bgWhite padding10",children:[this.state.tabData.length>0?Ti.jsx("div",{className:"rs-tabs-with-heading rs-tabs-bg-fill "+(-1===this.state.index?"rs-tabs-closed-wrapper":"rs-tabs-opened-wrapper transition"),children:Ti.jsx("div",{className:"rs-flat-tabs",style:{marginLeft:5},children:Ti.jsx("div",{class:"position-relative",children:Ti.jsx(Pi,{defaultSelectedItem:this.state.index,defaultClass:"",dynamicTab:"rs-content-tabs-flat rs-tab-horizontal "+(-1===this.state.index?"rsctf-closed":"rsctf-opened"),activeClass:"active",tabData:this.state.tabData,callBack:(t,e)=>{this.setState({index:e})}})})})}):null,this.state.tabData.length>0&&this.RenderComponents(this.state.index)]})]}),!0===this.state.saveError&&Ti.jsx(Il,{headerTitle:"Sorry",para:"Please try again after sometime...",primaryButtonText:"OK",buttonClicked:t=>{this.setState({saveError:!1})}})]})})]})}}ji(Tp,"contextType",Ji);const Ip=wi(Tp);Di.lazy((()=>ki((()=>import("./CompanyList-5f0901f8.js")),["/assets/js/CompanyList-5f0901f8.js","/assets/js/pdf-editor-be9d2bd2.js","/assets/js/react-vendor-379f659a.js","/assets/css/pdf-editor-1e521ea9.css","/assets/js/LayoutPageWrapper-c659fc07.js","/assets/js/ui-a5a97ebf.js","/assets/js/kendo-5d73125a.js","/assets/css/kendo-8498baa5.css","/assets/js/drag-drop-4af74c4a.js","/assets/js/index-44141e50.js","/assets/js/get-4aa85b1a.js","/assets/js/index-75225e0a.js","/assets/js/utils-16c7e021.js","/assets/css/index-ecae0031.css","/assets/js/AccountSetup-17aa619a.js","/assets/js/RSKendoDropdown-89bac735.js","/assets/js/RSCheckbox-6c51a528.js","/assets/js/style-a86a43a5.js","/assets/css/style-e8a0ccb9.css","/assets/js/RSUploadImageComponent-41ad002a.js","/assets/js/RSIcon-40715e67.js","/assets/js/RSDropdowns-9012b9eb.js","/assets/js/charts-f2096496.js","/assets/js/map-99306e6f.js","/assets/js/maps-b8c6f010.js","/assets/js/maker-47de0917.js","/assets/js/RSBrandLogo-46ae6cee.js","/assets/js/export-data-a2401fa3.js","/assets/js/constants-82903eb8.js","/assets/css/constants-2d54d6dc.css","/assets/js/SkeletonTable-f73684ed.js","/assets/js/RSConfirmAlert-c9e1da8b.js","/assets/js/Skeleton-e3c7c022.js","/assets/js/constantObject-ca27cf51.js","/assets/js/RSFormGroup-2e23951f.js","/assets/js/CompanyListConstants-60d947f2.js","/assets/js/index-ea0ef9a3.js"],import.meta.url))),Di.lazy((()=>ki((()=>import("./ChannalBenchMark-be6b1914.js")),["/assets/js/ChannalBenchMark-be6b1914.js","/assets/js/pdf-editor-be9d2bd2.js","/assets/js/react-vendor-379f659a.js","/assets/css/pdf-editor-1e521ea9.css","/assets/js/index-75225e0a.js","/assets/js/ui-a5a97ebf.js","/assets/js/kendo-5d73125a.js","/assets/css/kendo-8498baa5.css","/assets/js/drag-drop-4af74c4a.js","/assets/js/utils-16c7e021.js","/assets/css/index-ecae0031.css","/assets/js/RSKendoDropdown-89bac735.js","/assets/js/get-4aa85b1a.js","/assets/js/RSCheckbox-6c51a528.js","/assets/js/style-a86a43a5.js","/assets/css/style-e8a0ccb9.css","/assets/js/RTabbar-119e28fb.js","/assets/js/RSDropdowns-9012b9eb.js","/assets/js/FormLabel-7c8c6237.js","/assets/js/SmallText-769b7f67.js","/assets/js/LayoutPageWrapper-c659fc07.js","/assets/js/react-router-dom.min-6f8d67fa.js"],import.meta.url))),Di.lazy((()=>ki((()=>import("./SmtpDetails-8e9c15a0.js")),["/assets/js/SmtpDetails-8e9c15a0.js","/assets/js/pdf-editor-be9d2bd2.js","/assets/js/react-vendor-379f659a.js","/assets/css/pdf-editor-1e521ea9.css","/assets/js/index-75225e0a.js","/assets/js/ui-a5a97ebf.js","/assets/js/kendo-5d73125a.js","/assets/css/kendo-8498baa5.css","/assets/js/drag-drop-4af74c4a.js","/assets/js/utils-16c7e021.js","/assets/css/index-ecae0031.css","/assets/js/RSKendoDropdown-89bac735.js","/assets/js/get-4aa85b1a.js","/assets/js/RSCheckbox-6c51a528.js","/assets/js/style-a86a43a5.js","/assets/css/style-e8a0ccb9.css","/assets/js/inputLimit-ce03b0f6.js"],import.meta.url))),Di.lazy((()=>ki((()=>import("./RSPCatelogue-5734a2ea.js")),["/assets/js/RSPCatelogue-5734a2ea.js","/assets/js/pdf-editor-be9d2bd2.js","/assets/js/react-vendor-379f659a.js","/assets/css/pdf-editor-1e521ea9.css","/assets/js/Features.styled-9337e765.js","/assets/js/ui-a5a97ebf.js","/assets/js/kendo-5d73125a.js","/assets/css/kendo-8498baa5.css","/assets/js/drag-drop-4af74c4a.js","/assets/js/BootstrapDropdown-f79019e1.js","/assets/js/index-75225e0a.js","/assets/js/utils-16c7e021.js","/assets/css/index-ecae0031.css","/assets/js/RSPPricing-045f3017.js","/assets/js/RSConfirmAlert-c9e1da8b.js","/assets/js/RSIcon-40715e67.js","/assets/js/RSKendoDropdown-89bac735.js","/assets/js/get-4aa85b1a.js","/assets/js/RSCheckbox-6c51a528.js","/assets/js/style-a86a43a5.js","/assets/css/style-e8a0ccb9.css","/assets/js/RSDropdowns-9012b9eb.js","/assets/js/FormFieldIcon-388bc468.js","/assets/js/LayoutPageWrapper-c659fc07.js","/assets/js/CompanyListDropdown-aceaadaa.js"],import.meta.url)));const kp=()=>{const t=ms();let e=zo.useHistory();const i=zo.useLocation(),[s,a]=Di.useState(null),n=Di.useContext(Ji),[l,o]=Di.useState([]),[r,c]=Di.useState(0),[d,p]=Di.useState(!1),[h,u]=Di.useState(null),[m,v]=Di.useState(null);Di.useState((null==m?void 0:m.templateName)||""),Di.useState(null),Di.useState(),Di.useState(null);const[y,g]=Di.useState([]),[b,f]=Di.useState(null),[x,S]=Di.useState(!1),[C,j]=Di.useState(0);Di.useEffect((()=>{var t,s;gs(n,(t=>{}));let o=Zs();(null==(t=null==o?void 0:o.timeZone)?void 0:t.length)>0&&g(null==o?void 0:o.timeZone);let r=fs().clientDetailsLocalization,d=null==o?void 0:o.timeZone,p=(null==d?void 0:d.filter((t=>(null==t?void 0:t.timezoneId)===(null==r?void 0:r.timeZoneId)))[0])||d[0];null!==(null==r?void 0:r.timeZoneId)&&void 0!==(null==r?void 0:r.timeZoneId)&&0!==(null==r?void 0:r.timeZoneId)||(p=d[0]),Object.keys(p).length>0&&f(p);let h=no.parse(null==(s=window.location)?void 0:s.search);const u=i.state;fl.info("back from form",u);let m=Go;"9"===(null==h?void 0:h.ch)&&(m=Wo),null!==(null==h?void 0:h.tId)&&void 0!==(null==h?void 0:h.tId)&&c(parseInt(null==h?void 0:h.tId));let y=null,b="",x="";if(void 0!==sessionStorage.getItem("tmldata")&&null!==sessionStorage.getItem("tmldata"))try{let t=ks(sessionStorage.getItem("tmldata"));y=t.data,b=t.templateName,x=t.templateDescription,v(t)}catch{}const S={...m,isRouter:!0,personalisationData:[],formList:l,getFormListCallback:()=>{k()},selectedForm:null,getSelectedFormCallback:t=>{D(t)},selectData:y,templateName:b,templateDescription:x,saveButtonClick:t=>{fl.info("saved data",t),I(t)},imageUpload:t=>{T(t)},dataFromForm:u||null,formNavigation:t=>{fl.info("navigating to form with data",t),e.push({pathname:"form-generation",search:t})}};a(S)}),[]),Di.useEffect((()=>{if(null!==h){let t=no.parse(window.location.search);parseInt((null==t?void 0:t.tId)||0)>0?A():p(!0)}}),[h]);const T=t=>{var e;let i=no.parse(null==(e=window.location)?void 0:e.search),s=na;null==i||i.ch,os({path:s,params:t,loading:n.globalStateData.setIsLoadingData,ok:t=>{if(null==t?void 0:t.status){let e=mn.slice(0,-1)+(null==t?void 0:t.data);_o.postMessage({type:"imageUpload",result:e||""})}},fail:t=>{}})},I=t=>{u(t)},k=()=>{const t={clientId:Ja(),tenentId:cn()};os({path:dn,params:t,loading:n.globalStateData.setIsLoadingData,ok:t=>{var e,i;if((null==t?void 0:t.status)&&(null==(e=null==t?void 0:t.data)?void 0:e.length)>0){let e=null==(i=null==t?void 0:t.data)?void 0:i.filter((t=>"Brand owned form"!==(null==t?void 0:t.formType)));o((null==t?void 0:t.data)||[]),_o.postMessage({type:"formList",result:e||[]})}},fail:t=>{}})},D=t=>{os({path:pn,params:{recipientFormID:t},loading:n.globalStateData.setIsLoadingData,ok:e=>{if(null==e?void 0:e.status){let i={formData:(null==e?void 0:e.data)||[],formId:t};_o.postMessage({type:"selectForm",result:i})}},fail:t=>{}})},A=()=>{let i=(()=>{var e;let i=no.parse(window.location.search),s=null==h?void 0:h.data,a=parseInt((null==i?void 0:i.tId)||0);if(r>0&&(a=r),void 0===sessionStorage.getItem("tmldata")||null===sessionStorage.getItem("tmldata"))return s.TemplateName="templateName",s.TemplateCategoryID="",s.Text="",s.TemplateID=a,s;try{let i=ks(sessionStorage.getItem("tmldata"));s.TemplateName=i.templateName,s.TemplateID=null==i?void 0:i.templateId;let a=null==(e=null==t?void 0:t.productCategorysList)?void 0:e.filter((t=>t.categoryName===i.templateDescription));if((null==a?void 0:a.length)>0){let t=a[0];s.TemplateCategoryID=null==t?void 0:t.categoryId,s.Text=null==t?void 0:t.categoryName}return s}catch{return s.TemplateName="templateName",s.TemplateCategoryID="",s.Text="",s.TemplateID=a,s}})();os({path:rn,params:i,loading:n.globalStateData.setIsLoadingData,sessionOut:n.globalStateData.setSessionOutData,ok:t=>{e.push({pathname:"pushbuilder",search:window.location.search})}})};return Ti.jsx(Ti.Fragment,{children:null!==s&&Ti.jsxs(Ti.Fragment,{children:[!0===x?Ti.jsx(kl,{size:"md",headerTitle:"Forms",para:5==C?"You've reached your form limit. Contact support for assistance.":1==C?"You've reached your form limit. Upgrade your package to create more forms.":2==C?"You've reached your form limit. Upgrade to Premier or Ultimate to create more forms.":3==C?"You've reached your form limit. Upgrade to Ultimate to create more forms.":null,primaryButtonText:5==C?"Okay":"Proceed",secondaryButtonText:5==C?null:"Cancel",buttonClicked:t=>{S(!1),5!=C&&!0===t&&e.push("/subscription")}}):null,d&&Ti.jsx(Jo,{isShow:d,templateData:h,close:()=>p(!1)}),Ti.jsx(Ho,{builderId:1,pconfig:s,timeZoneData:y,selectTimeZone:b,callback:t=>{e.push({pathname:"pushbuilder",search:window.location.search})},addForm:t=>{let i=$o.compress(t,"zlib");if(sessionStorage.setItem("pbstore",i),!1===hn(null==l?void 0:l.length))S(!0),j((null==l?void 0:l.length)||0);else{let t=window.location.search,[i,...s]=t,a=s.join("");a=window.btoa(a),e.push({pathname:"/preferences/form-generation",search:`path=/preferences/addPushBuilder&data=${a}`})}},editForm:t=>{let i=$o.compress(t,"zlib");if(sessionStorage.setItem("pbstore",i),!1===hn(null==l?void 0:l.length))S(!0),j((null==l?void 0:l.length)||0);else{let i=window.location.search,[s,...a]=i,n=a.join("");n=window.btoa(n),e.push({pathname:"/preferences/form-generation",search:`path=/preferences/addPushBuilder&data=${n}&recipientFormID=${t.formId}`})}}})]})})},Dp=t=>{let e=Ei(),i=Ai();return Ti.jsxs(Bi,{children:[Ti.jsxs(Mi,{exact:!0,path:`${e.url}/`,children:[" ",Ti.jsx(qr,{history:i}),"  "]}),Ti.jsxs(Mi,{exact:!0,path:`${e.url}/planning`,children:[" ",Ti.jsx(nc,{}),"  "]}),Ti.jsxs(Mi,{exact:!0,path:`${e.url}/creation-smartlink`,children:[" ",Ti.jsx(ko,{showHeader:!0}),"  "]}),Ti.jsxs(Mi,{exact:!0,path:`${e.url}/creation-notification`,children:[" ",Ti.jsx(cp,{history:i}),"  "]}),Ti.jsxs(Mi,{exact:!0,path:`${e.url}/completion`,children:[" ",Ti.jsx(Do,{}),"  "]}),Ti.jsx(Mi,{exact:!0,path:`${e.url}/slcompletion`,children:Ti.jsx(Ip,{})}),Ti.jsx(Mi,{exact:!0,path:`${e.url}/fieldtracking`,children:Ti.jsx(tr,{})}),Ti.jsx(Mi,{exact:!0,path:`${e.url}/cpushbuilder`,children:Ti.jsx(kp,{})})]})};export{Dp as default};
