var t,e=Object.defineProperty,s=(t,s,a)=>(((t,s,a)=>{s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a})(t,"symbol"!=typeof s?s+"":s,a),a);import{j as a}from"./pdf-editor-be9d2bd2.js";import{L as i}from"./LayoutPageWrapper-c659fc07.js";import{w as r,r as l}from"./react-vendor-379f659a.js";import{B as o}from"./BOFPlatform-b50f84c2.js";import{B as n}from"./BOFWeb-8b056da6.js";import{q as d}from"./utils-16c7e021.js";import{F as m}from"./FieldTracking-406ae247.js";import{z as c,ai as h,M as f,Cs as p,ar as u,aS as j,aK as k,Cu as x}from"./index-75225e0a.js";import b from"./RSBanner-2c94f2e5.js";import{R as S}from"./RSFormGroup-2e23951f.js";import{R as g}from"./RSKendoDropdown-89bac735.js";import"./RSCheckbox-6c51a528.js";import"./style-a86a43a5.js";import"./RSDropdowns-9012b9eb.js";import{F as N}from"./FormLabel-7c8c6237.js";import{R as w}from"./RSIcon-40715e67.js";import{M as C,R as v,a as D,C as F}from"./ui-a5a97ebf.js";import"./BOFController-1a1b9fda.js";import"./mobx-e1586d6a.js";import"./FormFieldIcon-388bc468.js";import"./index-44141e50.js";import"./get-4aa85b1a.js";import"./kendo-5d73125a.js";import"./RSConfirmAlert-c9e1da8b.js";import"./drag-drop-4af74c4a.js";import"./Features.styled-9337e765.js";import"./RSSwitch-b5eda9e2.js";import"./NewAttribute-c47792e6.js";import"./index-ea0ef9a3.js";class T extends l.Component{constructor(){super(...arguments),s(this,"state",{formName:"",platformName:"",webUrl:"",formpageUrl:"",lSocket:null,isSocketConnect:!1,errorMessage:"",fieldTrackClose:null,fieldTrackWait:null,fieldTrackSuccess:null,fullData:null,originalData:null,isEdit:!1}),s(this,"editFormGenerator",(t=>{f({path:p,params:{recipientFormID:t},loading:this.context.globalStateData.setIsLoadingData,sessionOut:this.context.globalStateData.setSessionOutData,ok:t=>{if(null==t?void 0:t.status){let s=null==t?void 0:t.data,a=JSON.parse(s.jsondata),i=null==a?void 0:a.deviceType,r=!0;"web"!==i.toLowerCase()&&(i="Mobile",r=!1);var e=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search+`&isWeb=${r}`;window.history.pushState({path:e},"",e);let l=(null==a?void 0:a.fullData)||null;if(null!==l){let t=JSON.stringify(l);this.setState({originalData:t})}this.setState({webUrl:null==a?void 0:a.domainName,fullData:null==a?void 0:a.fullData,platformName:i,formName:null==a?void 0:a.formName})}},fail:t=>{}})})),s(this,"socketClosed",(()=>{t.on("closed",(t=>{try{t.status}catch(e){}}))})),s(this,"socketInit",(e=>{const s=io("https://mobsoc.resu.io/");this.setState({lSocket:s},(()=>{this.state.lSocket.on("connect",(()=>{t.emit("new_user",{userName:"platform",domainName:e,appId:14441}),this.socketClosed()}))}))})),s(this,"formNameCheck",(t=>{f({path:x,params:{formName:t},ok:t=>{t.status&&this.setState({errorMessage:null==t?void 0:t.message})},fail:t=>{}})})),s(this,"getContentData",(()=>{var t;const e=d.parse(null==(t=window.location)?void 0:t.search);if("true"===(void 0!==e.isEdit&&e.isEdit))return!1;let s="";return this.state.fieldTrackWait?s="Waiting for event set":this.state.fieldTrackData?s="Client closed unexpected":this.state.fieldTrackSuccess&&(s="Field tracking enabled successfully"),s}))}componentDidMount(){var t,e;const s=d.parse(null==(e=null==(t=this.props.history)?void 0:t.location)?void 0:e.search);let a=void 0!==s.webft&&s.webft,i=void 0!==s.isEdit&&s.isEdit,r=void 0!==s.cId?s.cId:0;h(this.context,(()=>{})),"true"===a&&this.setState({isWebFieldTrack:!0,platformName:"Web"}),"true"===i&&this.editFormGenerator(parseInt(r))}render(){var t,e;return a.jsxs(i,{children:[this.state.isWebFieldTrack&&a.jsx(a.Fragment,{children:a.jsxs(C,{fullscreen:!0,className:"brandown-form",show:this.state.isWebFieldTrack,children:[a.jsxs(C.Header,{children:[a.jsx(w,{mainClass:"close",size:"md",handleClose:()=>{if(null!==this.state.originalData){let t=JSON.parse(this.state.originalData);this.setState({fullData:t})}this.setState({isWebFieldTrack:!1,isEdit:!1})}}),a.jsx(v,{md:12,style:{width:"80%"},children:a.jsx(D,{md:3,children:a.jsx("h2",{children:"Brand owned form"})})})]}),a.jsx(C.Body,{children:a.jsx(m,{isForm:!0,isEdit:this.state.isEdit,isWebFieldTrack:!0,fieldTrackData:this.state.fullData,domainName:t=>{this.socketInit(t)},cancelBtnClicked:()=>{if(null!==this.state.originalData){let t=JSON.parse(this.state.originalData);this.setState({fullData:t})}this.setState({isWebFieldTrack:!1,isEdit:!1})},saveBtnClicked:t=>{let e={...t};this.setState({fieldTrackData:t,isWebFieldTrack:!1,fullData:t,originalData:JSON.stringify(e),isEdit:!1})}})})]})}),this.getContentData().length>1&&a.jsx(b,{content:this.getContentData(),isShowBtn:!0,proceedBtnClick:()=>{this.setState({fieldTrackWait:!1,fieldTrackSucess:!1,fieldTrackClose:!1})}}),a.jsx(F,{fluid:!0,className:"main-heading-wrapper mb0",children:a.jsxs(F,{className:"mhw-container",children:[a.jsx("div",{className:"mhwc-left",children:a.jsx("h1",{children:a.jsx("div",{className:"mh-wrapper",children:a.jsx("span",{className:"mh-text",children:"Brand owned form"})})})}),a.jsx("div",{className:"mhwc-right",children:a.jsxs("div",{className:"back-text",onClick:()=>{sessionStorage.removeItem("AppNameTracking"),this.props.history.push("form-generator")},children:[a.jsx(u,{icon:j,size:"sm"}),"Back"]})})]})}),a.jsx(F,{className:"page-header",children:a.jsx(F,{children:a.jsx("div",{className:"portlet-box-theme bgWhite padding10",children:a.jsxs(F,{className:k()?"click-off":"",children:[a.jsx(S,{className:"mt20 mb30",children:a.jsxs(v,{children:[a.jsx(D,{md:3,children:a.jsx(N,{label:"Platform",right:!0})}),"mobile"===this.state.platformName.toLowerCase()&&a.jsx(D,{md:1,className:"ml30"}),a.jsx(D,{md:5,children:a.jsx(g,{required:!0,label:""===this.state.platformName?"Select platform":"Platform",data:["Web","Mobile"],value:""===this.state.platformName?"-- Select platform --":this.state.platformName,onChange:t=>{this.setState({platformName:t.target.value})}})})]})}),!0===this.state.isEdit?null:a.jsxs(a.Fragment,{children:["web"===this.state.platformName.toLowerCase()&&a.jsx(a.Fragment,{children:a.jsx(n,{web:!0,webUrl:this.state.webUrl,formName:this.state.formName,fullData:(null==(t=this.state)?void 0:t.fullData)||[],onChange:t=>{},editBtnClick:()=>{this.setState({isEdit:!0,isWebFieldTrack:!0})},socketChange:(t,e,s)=>{this.setState({fieldTrackWait:t,fieldTrackSucess:e,fieldTrackClose:s})}})}),"mobile"===this.state.platformName.toLowerCase()&&a.jsx(a.Fragment,{children:a.jsx(v,{children:a.jsx(D,{md:{offset:2,span:9},children:a.jsx(o,{formName:this.state.formName,fullData:(null==(e=this.state)?void 0:e.fullData)||[],onChange:t=>{},editBtnClick:()=>{this.setState({isEdit:!0,isWebFieldTrack:!1})},socketChange:(t,e,s)=>{this.setState({fieldTrackWait:t,fieldTrackSucess:e,fieldTrackClose:s})}})})})})]})]})})})}),a.jsx(F,{className:k()?"click-off":""})]})}}s(T,"contextType",c);const W=r(T);export{W as default};
